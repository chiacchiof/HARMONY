/*! For license information please see main.33d69d97.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},153:(e,t,n)=>{var a=n(43),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,l=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var a,i={},c=null,u=null;for(a in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)r.call(t,a)&&!s.hasOwnProperty(a)&&(i[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===i[a]&&(i[a]=t[a]);return{$$typeof:o,type:e,key:c,ref:u,props:i,_owner:l.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},202:(e,t)=>{var n=Symbol.for("react.element"),a=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),s=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.iterator;var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||h}function b(){}function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||h}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=v.prototype;var x=y.prototype=new b;x.constructor=y,f(x,v.prototype),x.isPureReactComponent=!0;var C=Array.isArray,S=Object.prototype.hasOwnProperty,w={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function N(e,t,a){var o,i={},r=null,l=null;if(null!=t)for(o in void 0!==t.ref&&(l=t.ref),void 0!==t.key&&(r=""+t.key),t)S.call(t,o)&&!k.hasOwnProperty(o)&&(i[o]=t[o]);var s=arguments.length-2;if(1===s)i.children=a;else if(1<s){for(var c=Array(s),u=0;u<s;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(o in s=e.defaultProps)void 0===i[o]&&(i[o]=s[o]);return{$$typeof:n,type:e,key:r,ref:l,props:i,_owner:w.current}}function j(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var E=/\/+/g;function M(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function T(e,t,o,i,r){var l=typeof e;"undefined"!==l&&"boolean"!==l||(e=null);var s=!1;if(null===e)s=!0;else switch(l){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case n:case a:s=!0}}if(s)return r=r(s=e),e=""===i?"."+M(s,0):i,C(r)?(o="",null!=e&&(o=e.replace(E,"$&/")+"/"),T(r,t,o,"",function(e){return e})):null!=r&&(j(r)&&(r=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(r,o+(!r.key||s&&s.key===r.key?"":(""+r.key).replace(E,"$&/")+"/")+e)),t.push(r)),1;if(s=0,i=""===i?".":i+":",C(e))for(var c=0;c<e.length;c++){var u=i+M(l=e[c],c);s+=T(l,t,o,u,r)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=m&&e[m]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(l=e.next()).done;)s+=T(l=l.value,t,o,u=i+M(l,c++),r);else if("object"===l)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function P(e,t,n){if(null==e)return e;var a=[],o=0;return T(e,a,"","",function(e){return t.call(n,e,o++)}),a}function z(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var _={current:null},R={transition:null},A={ReactCurrentDispatcher:_,ReactCurrentBatchConfig:R,ReactCurrentOwner:w};function I(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:P,forEach:function(e,t,n){P(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return P(e,function(){t++}),t},toArray:function(e){return P(e,function(e){return e})||[]},only:function(e){if(!j(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=o,t.Profiler=r,t.PureComponent=y,t.StrictMode=i,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=A,t.act=I,t.cloneElement=function(e,t,a){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=f({},e.props),i=e.key,r=e.ref,l=e._owner;if(null!=t){if(void 0!==t.ref&&(r=t.ref,l=w.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(c in t)S.call(t,c)&&!k.hasOwnProperty(c)&&(o[c]=void 0===t[c]&&void 0!==s?s[c]:t[c])}var c=arguments.length-2;if(1===c)o.children=a;else if(1<c){s=Array(c);for(var u=0;u<c;u++)s[u]=arguments[u+2];o.children=s}return{$$typeof:n,type:e.type,key:i,ref:r,props:o,_owner:l}},t.createContext=function(e){return(e={$$typeof:s,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:l,_context:e},e.Consumer=e},t.createElement=N,t.createFactory=function(e){var t=N.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=j,t.lazy=function(e){return{$$typeof:p,_payload:{_status:-1,_result:e},_init:z}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=R.transition;R.transition={};try{e()}finally{R.transition=t}},t.unstable_act=I,t.useCallback=function(e,t){return _.current.useCallback(e,t)},t.useContext=function(e){return _.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return _.current.useDeferredValue(e)},t.useEffect=function(e,t){return _.current.useEffect(e,t)},t.useId=function(){return _.current.useId()},t.useImperativeHandle=function(e,t,n){return _.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return _.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return _.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return _.current.useMemo(e,t)},t.useReducer=function(e,t,n){return _.current.useReducer(e,t,n)},t.useRef=function(e){return _.current.useRef(e)},t.useState=function(e){return _.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return _.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return _.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var a=n-1>>>1,o=e[a];if(!(0<i(o,t)))break e;e[a]=t,e[n]=o,n=a}}function a(e){return 0===e.length?null:e[0]}function o(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var a=0,o=e.length,r=o>>>1;a<r;){var l=2*(a+1)-1,s=e[l],c=l+1,u=e[c];if(0>i(s,n))c<o&&0>i(u,s)?(e[a]=u,e[c]=n,a=c):(e[a]=s,e[l]=n,a=l);else{if(!(c<o&&0>i(u,n)))break e;e[a]=u,e[c]=n,a=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var r=performance;t.unstable_now=function(){return r.now()}}else{var l=Date,s=l.now();t.unstable_now=function(){return l.now()-s}}var c=[],u=[],d=1,p=null,m=3,h=!1,f=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=a(u);null!==t;){if(null===t.callback)o(u);else{if(!(t.startTime<=e))break;o(u),t.sortIndex=t.expirationTime,n(c,t)}t=a(u)}}function C(e){if(g=!1,x(e),!f)if(null!==a(c))f=!0,R(S);else{var t=a(u);null!==t&&A(C,t.startTime-e)}}function S(e,n){f=!1,g&&(g=!1,b(j),j=-1),h=!0;var i=m;try{for(x(n),p=a(c);null!==p&&(!(p.expirationTime>n)||e&&!T());){var r=p.callback;if("function"===typeof r){p.callback=null,m=p.priorityLevel;var l=r(p.expirationTime<=n);n=t.unstable_now(),"function"===typeof l?p.callback=l:p===a(c)&&o(c),x(n)}else o(c);p=a(c)}if(null!==p)var s=!0;else{var d=a(u);null!==d&&A(C,d.startTime-n),s=!1}return s}finally{p=null,m=i,h=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var w,k=!1,N=null,j=-1,E=5,M=-1;function T(){return!(t.unstable_now()-M<E)}function P(){if(null!==N){var e=t.unstable_now();M=e;var n=!0;try{n=N(!0,e)}finally{n?w():(k=!1,N=null)}}else k=!1}if("function"===typeof y)w=function(){y(P)};else if("undefined"!==typeof MessageChannel){var z=new MessageChannel,_=z.port2;z.port1.onmessage=P,w=function(){_.postMessage(null)}}else w=function(){v(P,0)};function R(e){N=e,k||(k=!0,w())}function A(e,n){j=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||h||(f=!0,R(S))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return a(c)},t.unstable_next=function(e){switch(m){case 1:case 2:case 3:var t=3;break;default:t=m}var n=m;m=t;try{return e()}finally{m=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=m;m=e;try{return t()}finally{m=n}},t.unstable_scheduleCallback=function(e,o,i){var r=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?r+i:r:i=r,e){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return e={id:d++,callback:o,priorityLevel:e,startTime:i,expirationTime:l=i+l,sortIndex:-1},i>r?(e.sortIndex=i,n(u,e),null===a(c)&&e===a(u)&&(g?(b(j),j=-1):g=!0,A(C,i-r))):(e.sortIndex=l,n(c,e),f||h||(f=!0,R(S))),e},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(e){var t=m;return function(){var n=m;m=t;try{return e.apply(this,arguments)}finally{m=n}}}},330:(e,t,n)=>{var a=n(43);var o="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},i=a.useState,r=a.useEffect,l=a.useLayoutEffect,s=a.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!o(e,n)}catch(a){return!0}}var u="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),a=i({inst:{value:n,getSnapshot:t}}),o=a[0].inst,u=a[1];return l(function(){o.value=n,o.getSnapshot=t,c(o)&&u({inst:o})},[e,n,t]),r(function(){return c(o)&&u({inst:o}),e(function(){c(o)&&u({inst:o})})},[e]),s(n),n};t.useSyncExternalStore=void 0!==a.useSyncExternalStore?a.useSyncExternalStore:u},391:(e,t,n)=>{var a=n(950);t.createRoot=a.createRoot,t.hydrateRoot=a.hydrateRoot},443:(e,t,n)=>{e.exports=n(717)},461:(e,t,n)=>{e.exports=n(330)},579:(e,t,n)=>{e.exports=n(153)},717:(e,t,n)=>{var a=n(43),o=n(461);var i="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},r=o.useSyncExternalStore,l=a.useRef,s=a.useEffect,c=a.useMemo,u=a.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,a,o){var d=l(null);if(null===d.current){var p={hasValue:!1,value:null};d.current=p}else p=d.current;d=c(function(){function e(e){if(!s){if(s=!0,r=e,e=a(e),void 0!==o&&p.hasValue){var t=p.value;if(o(t,e))return l=t}return l=e}if(t=l,i(r,e))return t;var n=a(e);return void 0!==o&&o(t,n)?(r=e,t):(r=e,l=n)}var r,l,s=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,n,a,o]);var m=r(e,d[0],d[1]);return s(function(){p.hasValue=!0,p.value=m},[m]),u(m),m}},730:(e,t,n)=>{var a=n(43),o=n(853);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,l={};function s(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(l[e]=t,e=0;e<t.length;e++)r.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},h={};function f(e,t,n,a,o,i,r){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=a,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=r}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new f(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new f(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new f(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new f(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new f(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new f(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}function y(e,t,n,a){var o=g.hasOwnProperty(t)?g[t]:null;(null!==o?0!==o.type:a||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,a){if(null===t||"undefined"===typeof t||function(e,t,n,a){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!a&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,a))return!0;if(a)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,o,a)&&(n=null),a||null===o?function(e){return!!d.call(h,e)||!d.call(m,e)&&(p.test(e)?h[e]=!0:(m[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=null===n?3!==o.type&&"":n:(t=o.attributeName,a=o.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(o=o.type)||4===o&&!0===n?"":""+n,a?e.setAttributeNS(a,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,b);g[t]=new f(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,b);g[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,b);g[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)});var x=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,C=Symbol.for("react.element"),S=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),j=Symbol.for("react.provider"),E=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),z=Symbol.for("react.memo"),_=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var R=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var A=Symbol.iterator;function I(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=A&&e[A]||e["@@iterator"])?e:null}var D,O=Object.assign;function F(e){if(void 0===D)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);D=t&&t[1]||""}return"\n"+D+e}var L=!1;function B(e,t){if(!e||L)return"";L=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var a=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){a=c}e.call(t.prototype)}else{try{throw Error()}catch(c){a=c}e()}}catch(c){if(c&&a&&"string"===typeof c.stack){for(var o=c.stack.split("\n"),i=a.stack.split("\n"),r=o.length-1,l=i.length-1;1<=r&&0<=l&&o[r]!==i[l];)l--;for(;1<=r&&0<=l;r--,l--)if(o[r]!==i[l]){if(1!==r||1!==l)do{if(r--,0>--l||o[r]!==i[l]){var s="\n"+o[r].replace(" at new "," at ");return e.displayName&&s.includes("<anonymous>")&&(s=s.replace("<anonymous>",e.displayName)),s}}while(1<=r&&0<=l);break}}}finally{L=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function U(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function H(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case w:return"Fragment";case S:return"Portal";case N:return"Profiler";case k:return"StrictMode";case T:return"Suspense";case P:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case E:return(e.displayName||"Context")+".Consumer";case j:return(e._context.displayName||"Context")+".Provider";case M:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case z:return null!==(t=e.displayName||null)?t:H(e.type)||"Memo";case _:t=e._payload,e=e._init;try{return H(e(t))}catch(n){}}return null}function W(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return H(t);case 8:return t===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function V(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Y(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var o=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){a=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return a},setValue:function(e){a=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function X(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),a="";return e&&(a=G(e)?e.checked?"true":"false":e.value),(e=a)!==n&&(t.setValue(e),!0)}function K(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function q(e,t){var n=t.checked;return O({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function $(e,t){var n=null==t.defaultValue?"":t.defaultValue,a=null!=t.checked?t.checked:t.defaultChecked;n=V(null!=t.value?t.value:n),e._wrapperState={initialChecked:a,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function Q(e,t){J(e,t);var n=V(t.value),a=t.type;if(null!=n)"number"===a?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===a||"reset"===a)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,V(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!("submit"!==a&&"reset"!==a||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&K(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,a){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&a&&(e[n].defaultSelected=!0)}else{for(n=""+V(n),t=null,o=0;o<e.length;o++){if(e[o].value===n)return e[o].selected=!0,void(a&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function ae(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return O({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function oe(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:V(n)}}function ie(e,t){var n=V(t.value),a=V(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=a&&(e.defaultValue=""+a)}function re(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function le(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function se(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?le(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,a){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function pe(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var me={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},he=["Webkit","ms","Moz","O"];function fe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||me.hasOwnProperty(e)&&me[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var a=0===n.indexOf("--"),o=fe(n,t[n],a);"float"===n&&(n="cssFloat"),a?e.setProperty(n,o):e[n]=o}}Object.keys(me).forEach(function(e){he.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),me[t]=me[e]})});var ve=O({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function be(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function Ce(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Se=null,we=null,ke=null;function Ne(e){if(e=xo(e)){if("function"!==typeof Se)throw Error(i(280));var t=e.stateNode;t&&(t=So(t),Se(e.stateNode,e.type,t))}}function je(e){we?ke?ke.push(e):ke=[e]:we=e}function Ee(){if(we){var e=we,t=ke;if(ke=we=null,Ne(e),t)for(e=0;e<t.length;e++)Ne(t[e])}}function Me(e,t){return e(t)}function Te(){}var Pe=!1;function ze(e,t,n){if(Pe)return e(t,n);Pe=!0;try{return Me(e,t,n)}finally{Pe=!1,(null!==we||null!==ke)&&(Te(),Ee())}}function _e(e,t){var n=e.stateNode;if(null===n)return null;var a=So(n);if(null===a)return null;n=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(a=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!a;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var Re=!1;if(u)try{var Ae={};Object.defineProperty(Ae,"passive",{get:function(){Re=!0}}),window.addEventListener("test",Ae,Ae),window.removeEventListener("test",Ae,Ae)}catch(ue){Re=!1}function Ie(e,t,n,a,o,i,r,l,s){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var De=!1,Oe=null,Fe=!1,Le=null,Be={onError:function(e){De=!0,Oe=e}};function Ue(e,t,n,a,o,i,r,l,s){De=!1,Oe=null,Ie.apply(Be,arguments)}function He(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function We(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ve(e){if(He(e)!==e)throw Error(i(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=He(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,a=t;;){var o=n.return;if(null===o)break;var r=o.alternate;if(null===r){if(null!==(a=o.return)){n=a;continue}break}if(o.child===r.child){for(r=o.child;r;){if(r===n)return Ve(o),e;if(r===a)return Ve(o),t;r=r.sibling}throw Error(i(188))}if(n.return!==a.return)n=o,a=r;else{for(var l=!1,s=o.child;s;){if(s===n){l=!0,n=o,a=r;break}if(s===a){l=!0,a=o,n=r;break}s=s.sibling}if(!l){for(s=r.child;s;){if(s===n){l=!0,n=r,a=o;break}if(s===a){l=!0,a=r,n=o;break}s=s.sibling}if(!l)throw Error(i(189))}}if(n.alternate!==a)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?Ye(e):null}function Ye(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ye(e);if(null!==t)return t;e=e.sibling}return null}var Xe=o.unstable_scheduleCallback,Ke=o.unstable_cancelCallback,qe=o.unstable_shouldYield,$e=o.unstable_requestPaint,Je=o.unstable_now,Qe=o.unstable_getCurrentPriorityLevel,Ze=o.unstable_ImmediatePriority,et=o.unstable_UserBlockingPriority,tt=o.unstable_NormalPriority,nt=o.unstable_LowPriority,at=o.unstable_IdlePriority,ot=null,it=null;var rt=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(lt(e)/st|0)|0},lt=Math.log,st=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function pt(e,t){var n=e.pendingLanes;if(0===n)return 0;var a=0,o=e.suspendedLanes,i=e.pingedLanes,r=268435455&n;if(0!==r){var l=r&~o;0!==l?a=dt(l):0!==(i&=r)&&(a=dt(i))}else 0!==(r=n&~o)?a=dt(r):0!==i&&(a=dt(i));if(0===a)return 0;if(0!==t&&t!==a&&0===(t&o)&&((o=a&-a)>=(i=t&-t)||16===o&&0!==(4194240&i)))return t;if(0!==(4&a)&&(a|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=a;0<t;)o=1<<(n=31-rt(t)),a|=e[n],t&=~o;return a}function mt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ht(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-rt(t)]=n}function bt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var a=31-rt(n),o=1<<a;o&t|e[a]&t&&(e[a]|=t),n&=~o}}var yt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var Ct,St,wt,kt,Nt,jt=!1,Et=[],Mt=null,Tt=null,Pt=null,zt=new Map,_t=new Map,Rt=[],At="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function It(e,t){switch(e){case"focusin":case"focusout":Mt=null;break;case"dragenter":case"dragleave":Tt=null;break;case"mouseover":case"mouseout":Pt=null;break;case"pointerover":case"pointerout":zt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":_t.delete(t.pointerId)}}function Dt(e,t,n,a,o,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:a,nativeEvent:i,targetContainers:[o]},null!==t&&(null!==(t=xo(t))&&St(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function Ot(e){var t=yo(e.target);if(null!==t){var n=He(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=We(n)))return e.blockedOn=t,void Nt(e.priority,function(){wt(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=xo(n))&&St(t),e.blockedOn=n,!1;var a=new(n=e.nativeEvent).constructor(n.type,n);xe=a,n.target.dispatchEvent(a),xe=null,t.shift()}return!0}function Lt(e,t,n){Ft(e)&&n.delete(t)}function Bt(){jt=!1,null!==Mt&&Ft(Mt)&&(Mt=null),null!==Tt&&Ft(Tt)&&(Tt=null),null!==Pt&&Ft(Pt)&&(Pt=null),zt.forEach(Lt),_t.forEach(Lt)}function Ut(e,t){e.blockedOn===t&&(e.blockedOn=null,jt||(jt=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Bt)))}function Ht(e){function t(t){return Ut(t,e)}if(0<Et.length){Ut(Et[0],e);for(var n=1;n<Et.length;n++){var a=Et[n];a.blockedOn===e&&(a.blockedOn=null)}}for(null!==Mt&&Ut(Mt,e),null!==Tt&&Ut(Tt,e),null!==Pt&&Ut(Pt,e),zt.forEach(t),_t.forEach(t),n=0;n<Rt.length;n++)(a=Rt[n]).blockedOn===e&&(a.blockedOn=null);for(;0<Rt.length&&null===(n=Rt[0]).blockedOn;)Ot(n),null===n.blockedOn&&Rt.shift()}var Wt=x.ReactCurrentBatchConfig,Vt=!0;function Gt(e,t,n,a){var o=yt,i=Wt.transition;Wt.transition=null;try{yt=1,Xt(e,t,n,a)}finally{yt=o,Wt.transition=i}}function Yt(e,t,n,a){var o=yt,i=Wt.transition;Wt.transition=null;try{yt=4,Xt(e,t,n,a)}finally{yt=o,Wt.transition=i}}function Xt(e,t,n,a){if(Vt){var o=qt(e,t,n,a);if(null===o)Va(e,t,a,Kt,n),It(e,a);else if(function(e,t,n,a,o){switch(t){case"focusin":return Mt=Dt(Mt,e,t,n,a,o),!0;case"dragenter":return Tt=Dt(Tt,e,t,n,a,o),!0;case"mouseover":return Pt=Dt(Pt,e,t,n,a,o),!0;case"pointerover":var i=o.pointerId;return zt.set(i,Dt(zt.get(i)||null,e,t,n,a,o)),!0;case"gotpointercapture":return i=o.pointerId,_t.set(i,Dt(_t.get(i)||null,e,t,n,a,o)),!0}return!1}(o,e,t,n,a))a.stopPropagation();else if(It(e,a),4&t&&-1<At.indexOf(e)){for(;null!==o;){var i=xo(o);if(null!==i&&Ct(i),null===(i=qt(e,t,n,a))&&Va(e,t,a,Kt,n),i===o)break;o=i}null!==o&&a.stopPropagation()}else Va(e,t,a,null,n)}}var Kt=null;function qt(e,t,n,a){if(Kt=null,null!==(e=yo(e=Ce(a))))if(null===(t=He(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=We(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function $t(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case at:return 536870912;default:return 16}default:return 16}}var Jt=null,Qt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Qt,a=n.length,o="value"in Jt?Jt.value:Jt.textContent,i=o.length;for(e=0;e<a&&n[e]===o[e];e++);var r=a-e;for(t=1;t<=r&&n[a-t]===o[i-t];t++);return Zt=o.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function an(){return!1}function on(e){function t(t,n,a,o,i){for(var r in this._reactName=t,this._targetInst=a,this.type=n,this.nativeEvent=o,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(r)&&(t=e[r],this[r]=t?t(o):o[r]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?nn:an,this.isPropagationStopped=an,this}return O(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var rn,ln,sn,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=on(cn),dn=O({},cn,{view:0,detail:0}),pn=on(dn),mn=O({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Nn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sn&&(sn&&"mousemove"===e.type?(rn=e.screenX-sn.screenX,ln=e.screenY-sn.screenY):ln=rn=0,sn=e),rn)},movementY:function(e){return"movementY"in e?e.movementY:ln}}),hn=on(mn),fn=on(O({},mn,{dataTransfer:0})),gn=on(O({},dn,{relatedTarget:0})),vn=on(O({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),bn=O({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yn=on(bn),xn=on(O({},cn,{data:0})),Cn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=wn[e])&&!!t[e]}function Nn(){return kn}var jn=O({},dn,{key:function(e){if(e.key){var t=Cn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Sn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Nn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),En=on(jn),Mn=on(O({},mn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Tn=on(O({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Nn})),Pn=on(O({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),zn=O({},mn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),_n=on(zn),Rn=[9,13,27,32],An=u&&"CompositionEvent"in window,In=null;u&&"documentMode"in document&&(In=document.documentMode);var Dn=u&&"TextEvent"in window&&!In,On=u&&(!An||In&&8<In&&11>=In),Fn=String.fromCharCode(32),Ln=!1;function Bn(e,t){switch(e){case"keyup":return-1!==Rn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Hn=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Wn[e.type]:"textarea"===t}function Gn(e,t,n,a){je(a),0<(t=Ya(t,"onChange")).length&&(n=new un("onChange","change",null,n,a),e.push({event:n,listeners:t}))}var Yn=null,Xn=null;function Kn(e){Fa(e,0)}function qn(e){if(X(Co(e)))return e}function $n(e,t){if("change"===e)return t}var Jn=!1;if(u){var Qn;if(u){var Zn="oninput"in document;if(!Zn){var ea=document.createElement("div");ea.setAttribute("oninput","return;"),Zn="function"===typeof ea.oninput}Qn=Zn}else Qn=!1;Jn=Qn&&(!document.documentMode||9<document.documentMode)}function ta(){Yn&&(Yn.detachEvent("onpropertychange",na),Xn=Yn=null)}function na(e){if("value"===e.propertyName&&qn(Xn)){var t=[];Gn(t,Xn,e,Ce(e)),ze(Kn,t)}}function aa(e,t,n){"focusin"===e?(ta(),Xn=n,(Yn=t).attachEvent("onpropertychange",na)):"focusout"===e&&ta()}function oa(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return qn(Xn)}function ia(e,t){if("click"===e)return qn(t)}function ra(e,t){if("input"===e||"change"===e)return qn(t)}var la="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function sa(e,t){if(la(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(a=0;a<n.length;a++){var o=n[a];if(!d.call(t,o)||!la(e[o],t[o]))return!1}return!0}function ca(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ua(e,t){var n,a=ca(e);for(e=0;a;){if(3===a.nodeType){if(n=e+a.textContent.length,e<=t&&n>=t)return{node:a,offset:t-e};e=n}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=ca(a)}}function da(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?da(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function pa(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(a){n=!1}if(!n)break;t=K((e=t.contentWindow).document)}return t}function ma(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function ha(e){var t=pa(),n=e.focusedElem,a=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&da(n.ownerDocument.documentElement,n)){if(null!==a&&ma(n))if(t=a.start,void 0===(e=a.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var o=n.textContent.length,i=Math.min(a.start,o);a=void 0===a.end?i:Math.min(a.end,o),!e.extend&&i>a&&(o=a,a=i,i=o),o=ua(n,i);var r=ua(n,a);o&&r&&(1!==e.rangeCount||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==r.node||e.focusOffset!==r.offset)&&((t=t.createRange()).setStart(o.node,o.offset),e.removeAllRanges(),i>a?(e.addRange(t),e.extend(r.node,r.offset)):(t.setEnd(r.node,r.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fa=u&&"documentMode"in document&&11>=document.documentMode,ga=null,va=null,ba=null,ya=!1;function xa(e,t,n){var a=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;ya||null==ga||ga!==K(a)||("selectionStart"in(a=ga)&&ma(a)?a={start:a.selectionStart,end:a.selectionEnd}:a={anchorNode:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset},ba&&sa(ba,a)||(ba=a,0<(a=Ya(va,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:a}),t.target=ga)))}function Ca(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Sa={animationend:Ca("Animation","AnimationEnd"),animationiteration:Ca("Animation","AnimationIteration"),animationstart:Ca("Animation","AnimationStart"),transitionend:Ca("Transition","TransitionEnd")},wa={},ka={};function Na(e){if(wa[e])return wa[e];if(!Sa[e])return e;var t,n=Sa[e];for(t in n)if(n.hasOwnProperty(t)&&t in ka)return wa[e]=n[t];return e}u&&(ka=document.createElement("div").style,"AnimationEvent"in window||(delete Sa.animationend.animation,delete Sa.animationiteration.animation,delete Sa.animationstart.animation),"TransitionEvent"in window||delete Sa.transitionend.transition);var ja=Na("animationend"),Ea=Na("animationiteration"),Ma=Na("animationstart"),Ta=Na("transitionend"),Pa=new Map,za="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _a(e,t){Pa.set(e,t),s(t,[e])}for(var Ra=0;Ra<za.length;Ra++){var Aa=za[Ra];_a(Aa.toLowerCase(),"on"+(Aa[0].toUpperCase()+Aa.slice(1)))}_a(ja,"onAnimationEnd"),_a(Ea,"onAnimationIteration"),_a(Ma,"onAnimationStart"),_a("dblclick","onDoubleClick"),_a("focusin","onFocus"),_a("focusout","onBlur"),_a(Ta,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ia="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Da=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ia));function Oa(e,t,n){var a=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,a,o,r,l,s,c){if(Ue.apply(this,arguments),De){if(!De)throw Error(i(198));var u=Oe;De=!1,Oe=null,Fe||(Fe=!0,Le=u)}}(a,t,void 0,e),e.currentTarget=null}function Fa(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var a=e[n],o=a.event;a=a.listeners;e:{var i=void 0;if(t)for(var r=a.length-1;0<=r;r--){var l=a[r],s=l.instance,c=l.currentTarget;if(l=l.listener,s!==i&&o.isPropagationStopped())break e;Oa(o,l,c),i=s}else for(r=0;r<a.length;r++){if(s=(l=a[r]).instance,c=l.currentTarget,l=l.listener,s!==i&&o.isPropagationStopped())break e;Oa(o,l,c),i=s}}}if(Fe)throw e=Le,Fe=!1,Le=null,e}function La(e,t){var n=t[go];void 0===n&&(n=t[go]=new Set);var a=e+"__bubble";n.has(a)||(Wa(t,e,2,!1),n.add(a))}function Ba(e,t,n){var a=0;t&&(a|=4),Wa(n,e,a,t)}var Ua="_reactListening"+Math.random().toString(36).slice(2);function Ha(e){if(!e[Ua]){e[Ua]=!0,r.forEach(function(t){"selectionchange"!==t&&(Da.has(t)||Ba(t,!1,e),Ba(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ua]||(t[Ua]=!0,Ba("selectionchange",!1,t))}}function Wa(e,t,n,a){switch($t(t)){case 1:var o=Gt;break;case 4:o=Yt;break;default:o=Xt}n=o.bind(null,t,n,e),o=void 0,!Re||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),a?void 0!==o?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):void 0!==o?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function Va(e,t,n,a,o){var i=a;if(0===(1&t)&&0===(2&t)&&null!==a)e:for(;;){if(null===a)return;var r=a.tag;if(3===r||4===r){var l=a.stateNode.containerInfo;if(l===o||8===l.nodeType&&l.parentNode===o)break;if(4===r)for(r=a.return;null!==r;){var s=r.tag;if((3===s||4===s)&&((s=r.stateNode.containerInfo)===o||8===s.nodeType&&s.parentNode===o))return;r=r.return}for(;null!==l;){if(null===(r=yo(l)))return;if(5===(s=r.tag)||6===s){a=i=r;continue e}l=l.parentNode}}a=a.return}ze(function(){var a=i,o=Ce(n),r=[];e:{var l=Pa.get(e);if(void 0!==l){var s=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":s=En;break;case"focusin":c="focus",s=gn;break;case"focusout":c="blur",s=gn;break;case"beforeblur":case"afterblur":s=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":s=hn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":s=fn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":s=Tn;break;case ja:case Ea:case Ma:s=vn;break;case Ta:s=Pn;break;case"scroll":s=pn;break;case"wheel":s=_n;break;case"copy":case"cut":case"paste":s=yn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":s=Mn}var u=0!==(4&t),d=!u&&"scroll"===e,p=u?null!==l?l+"Capture":null:l;u=[];for(var m,h=a;null!==h;){var f=(m=h).stateNode;if(5===m.tag&&null!==f&&(m=f,null!==p&&(null!=(f=_e(h,p))&&u.push(Ga(h,f,m)))),d)break;h=h.return}0<u.length&&(l=new s(l,c,null,n,o),r.push({event:l,listeners:u}))}}if(0===(7&t)){if(s="mouseout"===e||"pointerout"===e,(!(l="mouseover"===e||"pointerover"===e)||n===xe||!(c=n.relatedTarget||n.fromElement)||!yo(c)&&!c[fo])&&(s||l)&&(l=o.window===o?o:(l=o.ownerDocument)?l.defaultView||l.parentWindow:window,s?(s=a,null!==(c=(c=n.relatedTarget||n.toElement)?yo(c):null)&&(c!==(d=He(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(s=null,c=a),s!==c)){if(u=hn,f="onMouseLeave",p="onMouseEnter",h="mouse","pointerout"!==e&&"pointerover"!==e||(u=Mn,f="onPointerLeave",p="onPointerEnter",h="pointer"),d=null==s?l:Co(s),m=null==c?l:Co(c),(l=new u(f,h+"leave",s,n,o)).target=d,l.relatedTarget=m,f=null,yo(o)===a&&((u=new u(p,h+"enter",c,n,o)).target=m,u.relatedTarget=d,f=u),d=f,s&&c)e:{for(p=c,h=0,m=u=s;m;m=Xa(m))h++;for(m=0,f=p;f;f=Xa(f))m++;for(;0<h-m;)u=Xa(u),h--;for(;0<m-h;)p=Xa(p),m--;for(;h--;){if(u===p||null!==p&&u===p.alternate)break e;u=Xa(u),p=Xa(p)}u=null}else u=null;null!==s&&Ka(r,l,s,u,!1),null!==c&&null!==d&&Ka(r,d,c,u,!0)}if("select"===(s=(l=a?Co(a):window).nodeName&&l.nodeName.toLowerCase())||"input"===s&&"file"===l.type)var g=$n;else if(Vn(l))if(Jn)g=ra;else{g=oa;var v=aa}else(s=l.nodeName)&&"input"===s.toLowerCase()&&("checkbox"===l.type||"radio"===l.type)&&(g=ia);switch(g&&(g=g(e,a))?Gn(r,g,n,o):(v&&v(e,l,a),"focusout"===e&&(v=l._wrapperState)&&v.controlled&&"number"===l.type&&ee(l,"number",l.value)),v=a?Co(a):window,e){case"focusin":(Vn(v)||"true"===v.contentEditable)&&(ga=v,va=a,ba=null);break;case"focusout":ba=va=ga=null;break;case"mousedown":ya=!0;break;case"contextmenu":case"mouseup":case"dragend":ya=!1,xa(r,n,o);break;case"selectionchange":if(fa)break;case"keydown":case"keyup":xa(r,n,o)}var b;if(An)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Hn?Bn(e,n)&&(y="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(y="onCompositionStart");y&&(On&&"ko"!==n.locale&&(Hn||"onCompositionStart"!==y?"onCompositionEnd"===y&&Hn&&(b=en()):(Qt="value"in(Jt=o)?Jt.value:Jt.textContent,Hn=!0)),0<(v=Ya(a,y)).length&&(y=new xn(y,e,null,n,o),r.push({event:y,listeners:v}),b?y.data=b:null!==(b=Un(n))&&(y.data=b))),(b=Dn?function(e,t){switch(e){case"compositionend":return Un(t);case"keypress":return 32!==t.which?null:(Ln=!0,Fn);case"textInput":return(e=t.data)===Fn&&Ln?null:e;default:return null}}(e,n):function(e,t){if(Hn)return"compositionend"===e||!An&&Bn(e,t)?(e=en(),Zt=Qt=Jt=null,Hn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return On&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(a=Ya(a,"onBeforeInput")).length&&(o=new xn("onBeforeInput","beforeinput",null,n,o),r.push({event:o,listeners:a}),o.data=b))}Fa(r,t)})}function Ga(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ya(e,t){for(var n=t+"Capture",a=[];null!==e;){var o=e,i=o.stateNode;5===o.tag&&null!==i&&(o=i,null!=(i=_e(e,n))&&a.unshift(Ga(e,i,o)),null!=(i=_e(e,t))&&a.push(Ga(e,i,o))),e=e.return}return a}function Xa(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Ka(e,t,n,a,o){for(var i=t._reactName,r=[];null!==n&&n!==a;){var l=n,s=l.alternate,c=l.stateNode;if(null!==s&&s===a)break;5===l.tag&&null!==c&&(l=c,o?null!=(s=_e(n,i))&&r.unshift(Ga(n,s,l)):o||null!=(s=_e(n,i))&&r.push(Ga(n,s,l))),n=n.return}0!==r.length&&e.push({event:t,listeners:r})}var qa=/\r\n?/g,$a=/\u0000|\uFFFD/g;function Ja(e){return("string"===typeof e?e:""+e).replace(qa,"\n").replace($a,"")}function Qa(e,t,n){if(t=Ja(t),Ja(e)!==t&&n)throw Error(i(425))}function Za(){}var eo=null,to=null;function no(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ao="function"===typeof setTimeout?setTimeout:void 0,oo="function"===typeof clearTimeout?clearTimeout:void 0,io="function"===typeof Promise?Promise:void 0,ro="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof io?function(e){return io.resolve(null).then(e).catch(lo)}:ao;function lo(e){setTimeout(function(){throw e})}function so(e,t){var n=t,a=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&8===o.nodeType)if("/$"===(n=o.data)){if(0===a)return e.removeChild(o),void Ht(t);a--}else"$"!==n&&"$?"!==n&&"$!"!==n||a++;n=o}while(n);Ht(t)}function co(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function uo(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var po=Math.random().toString(36).slice(2),mo="__reactFiber$"+po,ho="__reactProps$"+po,fo="__reactContainer$"+po,go="__reactEvents$"+po,vo="__reactListeners$"+po,bo="__reactHandles$"+po;function yo(e){var t=e[mo];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fo]||n[mo]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=uo(e);null!==e;){if(n=e[mo])return n;e=uo(e)}return t}n=(e=n).parentNode}return null}function xo(e){return!(e=e[mo]||e[fo])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Co(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function So(e){return e[ho]||null}var wo=[],ko=-1;function No(e){return{current:e}}function jo(e){0>ko||(e.current=wo[ko],wo[ko]=null,ko--)}function Eo(e,t){ko++,wo[ko]=e.current,e.current=t}var Mo={},To=No(Mo),Po=No(!1),zo=Mo;function _o(e,t){var n=e.type.contextTypes;if(!n)return Mo;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var o,i={};for(o in n)i[o]=t[o];return a&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Ro(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ao(){jo(Po),jo(To)}function Io(e,t,n){if(To.current!==Mo)throw Error(i(168));Eo(To,t),Eo(Po,n)}function Do(e,t,n){var a=e.stateNode;if(t=t.childContextTypes,"function"!==typeof a.getChildContext)return n;for(var o in a=a.getChildContext())if(!(o in t))throw Error(i(108,W(e)||"Unknown",o));return O({},n,a)}function Oo(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Mo,zo=To.current,Eo(To,e),Eo(Po,Po.current),!0}function Fo(e,t,n){var a=e.stateNode;if(!a)throw Error(i(169));n?(e=Do(e,t,zo),a.__reactInternalMemoizedMergedChildContext=e,jo(Po),jo(To),Eo(To,e)):jo(Po),Eo(Po,n)}var Lo=null,Bo=!1,Uo=!1;function Ho(e){null===Lo?Lo=[e]:Lo.push(e)}function Wo(){if(!Uo&&null!==Lo){Uo=!0;var e=0,t=yt;try{var n=Lo;for(yt=1;e<n.length;e++){var a=n[e];do{a=a(!0)}while(null!==a)}Lo=null,Bo=!1}catch(o){throw null!==Lo&&(Lo=Lo.slice(e+1)),Xe(Ze,Wo),o}finally{yt=t,Uo=!1}}return null}var Vo=[],Go=0,Yo=null,Xo=0,Ko=[],qo=0,$o=null,Jo=1,Qo="";function Zo(e,t){Vo[Go++]=Xo,Vo[Go++]=Yo,Yo=e,Xo=t}function ei(e,t,n){Ko[qo++]=Jo,Ko[qo++]=Qo,Ko[qo++]=$o,$o=e;var a=Jo;e=Qo;var o=32-rt(a)-1;a&=~(1<<o),n+=1;var i=32-rt(t)+o;if(30<i){var r=o-o%5;i=(a&(1<<r)-1).toString(32),a>>=r,o-=r,Jo=1<<32-rt(t)+o|n<<o|a,Qo=i+e}else Jo=1<<i|n<<o|a,Qo=e}function ti(e){null!==e.return&&(Zo(e,1),ei(e,1,0))}function ni(e){for(;e===Yo;)Yo=Vo[--Go],Vo[Go]=null,Xo=Vo[--Go],Vo[Go]=null;for(;e===$o;)$o=Ko[--qo],Ko[qo]=null,Qo=Ko[--qo],Ko[qo]=null,Jo=Ko[--qo],Ko[qo]=null}var ai=null,oi=null,ii=!1,ri=null;function li(e,t){var n=zc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function si(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ai=e,oi=co(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ai=e,oi=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==$o?{id:Jo,overflow:Qo}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=zc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ai=e,oi=null,!0);default:return!1}}function ci(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ui(e){if(ii){var t=oi;if(t){var n=t;if(!si(e,t)){if(ci(e))throw Error(i(418));t=co(n.nextSibling);var a=ai;t&&si(e,t)?li(a,n):(e.flags=-4097&e.flags|2,ii=!1,ai=e)}}else{if(ci(e))throw Error(i(418));e.flags=-4097&e.flags|2,ii=!1,ai=e}}}function di(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ai=e}function pi(e){if(e!==ai)return!1;if(!ii)return di(e),ii=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!no(e.type,e.memoizedProps)),t&&(t=oi)){if(ci(e))throw mi(),Error(i(418));for(;t;)li(e,t),t=co(t.nextSibling)}if(di(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){oi=co(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}oi=null}}else oi=ai?co(e.stateNode.nextSibling):null;return!0}function mi(){for(var e=oi;e;)e=co(e.nextSibling)}function hi(){oi=ai=null,ii=!1}function fi(e){null===ri?ri=[e]:ri.push(e)}var gi=x.ReactCurrentBatchConfig;function vi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var a=n.stateNode}if(!a)throw Error(i(147,e));var o=a,r=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===r?t.ref:(t=function(e){var t=o.refs;null===e?delete t[r]:t[r]=e},t._stringRef=r,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function bi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function yi(e){return(0,e._init)(e._payload)}function xi(e){function t(t,n){if(e){var a=t.deletions;null===a?(t.deletions=[n],t.flags|=16):a.push(n)}}function n(n,a){if(!e)return null;for(;null!==a;)t(n,a),a=a.sibling;return null}function a(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=Rc(e,t)).index=0,e.sibling=null,e}function r(t,n,a){return t.index=a,e?null!==(a=t.alternate)?(a=a.index)<n?(t.flags|=2,n):a:(t.flags|=2,n):(t.flags|=1048576,n)}function l(t){return e&&null===t.alternate&&(t.flags|=2),t}function s(e,t,n,a){return null===t||6!==t.tag?((t=Oc(n,e.mode,a)).return=e,t):((t=o(t,n)).return=e,t)}function c(e,t,n,a){var i=n.type;return i===w?d(e,t,n.props.children,a,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===_&&yi(i)===t.type)?((a=o(t,n.props)).ref=vi(e,t,n),a.return=e,a):((a=Ac(n.type,n.key,n.props,null,e.mode,a)).ref=vi(e,t,n),a.return=e,a)}function u(e,t,n,a){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,a)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function d(e,t,n,a,i){return null===t||7!==t.tag?((t=Ic(n,e.mode,a,i)).return=e,t):((t=o(t,n)).return=e,t)}function p(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Oc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case C:return(n=Ac(t.type,t.key,t.props,null,e.mode,n)).ref=vi(e,null,t),n.return=e,n;case S:return(t=Fc(t,e.mode,n)).return=e,t;case _:return p(e,(0,t._init)(t._payload),n)}if(te(t)||I(t))return(t=Ic(t,e.mode,n,null)).return=e,t;bi(e,t)}return null}function m(e,t,n,a){var o=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==o?null:s(e,t,""+n,a);if("object"===typeof n&&null!==n){switch(n.$$typeof){case C:return n.key===o?c(e,t,n,a):null;case S:return n.key===o?u(e,t,n,a):null;case _:return m(e,t,(o=n._init)(n._payload),a)}if(te(n)||I(n))return null!==o?null:d(e,t,n,a,null);bi(e,n)}return null}function h(e,t,n,a,o){if("string"===typeof a&&""!==a||"number"===typeof a)return s(t,e=e.get(n)||null,""+a,o);if("object"===typeof a&&null!==a){switch(a.$$typeof){case C:return c(t,e=e.get(null===a.key?n:a.key)||null,a,o);case S:return u(t,e=e.get(null===a.key?n:a.key)||null,a,o);case _:return h(e,t,n,(0,a._init)(a._payload),o)}if(te(a)||I(a))return d(t,e=e.get(n)||null,a,o,null);bi(t,a)}return null}function f(o,i,l,s){for(var c=null,u=null,d=i,f=i=0,g=null;null!==d&&f<l.length;f++){d.index>f?(g=d,d=null):g=d.sibling;var v=m(o,d,l[f],s);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(o,d),i=r(v,i,f),null===u?c=v:u.sibling=v,u=v,d=g}if(f===l.length)return n(o,d),ii&&Zo(o,f),c;if(null===d){for(;f<l.length;f++)null!==(d=p(o,l[f],s))&&(i=r(d,i,f),null===u?c=d:u.sibling=d,u=d);return ii&&Zo(o,f),c}for(d=a(o,d);f<l.length;f++)null!==(g=h(d,o,f,l[f],s))&&(e&&null!==g.alternate&&d.delete(null===g.key?f:g.key),i=r(g,i,f),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(o,e)}),ii&&Zo(o,f),c}function g(o,l,s,c){var u=I(s);if("function"!==typeof u)throw Error(i(150));if(null==(s=u.call(s)))throw Error(i(151));for(var d=u=null,f=l,g=l=0,v=null,b=s.next();null!==f&&!b.done;g++,b=s.next()){f.index>g?(v=f,f=null):v=f.sibling;var y=m(o,f,b.value,c);if(null===y){null===f&&(f=v);break}e&&f&&null===y.alternate&&t(o,f),l=r(y,l,g),null===d?u=y:d.sibling=y,d=y,f=v}if(b.done)return n(o,f),ii&&Zo(o,g),u;if(null===f){for(;!b.done;g++,b=s.next())null!==(b=p(o,b.value,c))&&(l=r(b,l,g),null===d?u=b:d.sibling=b,d=b);return ii&&Zo(o,g),u}for(f=a(o,f);!b.done;g++,b=s.next())null!==(b=h(f,o,g,b.value,c))&&(e&&null!==b.alternate&&f.delete(null===b.key?g:b.key),l=r(b,l,g),null===d?u=b:d.sibling=b,d=b);return e&&f.forEach(function(e){return t(o,e)}),ii&&Zo(o,g),u}return function e(a,i,r,s){if("object"===typeof r&&null!==r&&r.type===w&&null===r.key&&(r=r.props.children),"object"===typeof r&&null!==r){switch(r.$$typeof){case C:e:{for(var c=r.key,u=i;null!==u;){if(u.key===c){if((c=r.type)===w){if(7===u.tag){n(a,u.sibling),(i=o(u,r.props.children)).return=a,a=i;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===_&&yi(c)===u.type){n(a,u.sibling),(i=o(u,r.props)).ref=vi(a,u,r),i.return=a,a=i;break e}n(a,u);break}t(a,u),u=u.sibling}r.type===w?((i=Ic(r.props.children,a.mode,s,r.key)).return=a,a=i):((s=Ac(r.type,r.key,r.props,null,a.mode,s)).ref=vi(a,i,r),s.return=a,a=s)}return l(a);case S:e:{for(u=r.key;null!==i;){if(i.key===u){if(4===i.tag&&i.stateNode.containerInfo===r.containerInfo&&i.stateNode.implementation===r.implementation){n(a,i.sibling),(i=o(i,r.children||[])).return=a,a=i;break e}n(a,i);break}t(a,i),i=i.sibling}(i=Fc(r,a.mode,s)).return=a,a=i}return l(a);case _:return e(a,i,(u=r._init)(r._payload),s)}if(te(r))return f(a,i,r,s);if(I(r))return g(a,i,r,s);bi(a,r)}return"string"===typeof r&&""!==r||"number"===typeof r?(r=""+r,null!==i&&6===i.tag?(n(a,i.sibling),(i=o(i,r)).return=a,a=i):(n(a,i),(i=Oc(r,a.mode,s)).return=a,a=i),l(a)):n(a,i)}}var Ci=xi(!0),Si=xi(!1),wi=No(null),ki=null,Ni=null,ji=null;function Ei(){ji=Ni=ki=null}function Mi(e){var t=wi.current;jo(wi),e._currentValue=t}function Ti(e,t,n){for(;null!==e;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==a&&(a.childLanes|=t)):null!==a&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===n)break;e=e.return}}function Pi(e,t){ki=e,ji=Ni=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(yl=!0),e.firstContext=null)}function zi(e){var t=e._currentValue;if(ji!==e)if(e={context:e,memoizedValue:t,next:null},null===Ni){if(null===ki)throw Error(i(308));Ni=e,ki.dependencies={lanes:0,firstContext:e}}else Ni=Ni.next=e;return t}var _i=null;function Ri(e){null===_i?_i=[e]:_i.push(e)}function Ai(e,t,n,a){var o=t.interleaved;return null===o?(n.next=n,Ri(t)):(n.next=o.next,o.next=n),t.interleaved=n,Ii(e,a)}function Ii(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Di=!1;function Oi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Li(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Bi(e,t,n){var a=e.updateQueue;if(null===a)return null;if(a=a.shared,0!==(2&Ms)){var o=a.pending;return null===o?t.next=t:(t.next=o.next,o.next=t),a.pending=t,Ii(e,n)}return null===(o=a.interleaved)?(t.next=t,Ri(a)):(t.next=o.next,o.next=t),a.interleaved=t,Ii(e,n)}function Ui(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var a=t.lanes;n|=a&=e.pendingLanes,t.lanes=n,bt(e,n)}}function Hi(e,t){var n=e.updateQueue,a=e.alternate;if(null!==a&&n===(a=a.updateQueue)){var o=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var r={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?o=i=r:i=i.next=r,n=n.next}while(null!==n);null===i?o=i=t:i=i.next=t}else o=i=t;return n={baseState:a.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:a.shared,effects:a.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Wi(e,t,n,a){var o=e.updateQueue;Di=!1;var i=o.firstBaseUpdate,r=o.lastBaseUpdate,l=o.shared.pending;if(null!==l){o.shared.pending=null;var s=l,c=s.next;s.next=null,null===r?i=c:r.next=c,r=s;var u=e.alternate;null!==u&&((l=(u=u.updateQueue).lastBaseUpdate)!==r&&(null===l?u.firstBaseUpdate=c:l.next=c,u.lastBaseUpdate=s))}if(null!==i){var d=o.baseState;for(r=0,u=c=s=null,l=i;;){var p=l.lane,m=l.eventTime;if((a&p)===p){null!==u&&(u=u.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var h=e,f=l;switch(p=t,m=n,f.tag){case 1:if("function"===typeof(h=f.payload)){d=h.call(m,d,p);break e}d=h;break e;case 3:h.flags=-65537&h.flags|128;case 0:if(null===(p="function"===typeof(h=f.payload)?h.call(m,d,p):h)||void 0===p)break e;d=O({},d,p);break e;case 2:Di=!0}}null!==l.callback&&0!==l.lane&&(e.flags|=64,null===(p=o.effects)?o.effects=[l]:p.push(l))}else m={eventTime:m,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===u?(c=u=m,s=d):u=u.next=m,r|=p;if(null===(l=l.next)){if(null===(l=o.shared.pending))break;l=(p=l).next,p.next=null,o.lastBaseUpdate=p,o.shared.pending=null}}if(null===u&&(s=d),o.baseState=s,o.firstBaseUpdate=c,o.lastBaseUpdate=u,null!==(t=o.shared.interleaved)){o=t;do{r|=o.lane,o=o.next}while(o!==t)}else null===i&&(o.shared.lanes=0);Ds|=r,e.lanes=r,e.memoizedState=d}}function Vi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var a=e[t],o=a.callback;if(null!==o){if(a.callback=null,a=n,"function"!==typeof o)throw Error(i(191,o));o.call(a)}}}var Gi={},Yi=No(Gi),Xi=No(Gi),Ki=No(Gi);function qi(e){if(e===Gi)throw Error(i(174));return e}function $i(e,t){switch(Eo(Ki,t),Eo(Xi,e),Eo(Yi,Gi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:se(null,"");break;default:t=se(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}jo(Yi),Eo(Yi,t)}function Ji(){jo(Yi),jo(Xi),jo(Ki)}function Qi(e){qi(Ki.current);var t=qi(Yi.current),n=se(t,e.type);t!==n&&(Eo(Xi,e),Eo(Yi,n))}function Zi(e){Xi.current===e&&(jo(Yi),jo(Xi))}var er=No(0);function tr(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var nr=[];function ar(){for(var e=0;e<nr.length;e++)nr[e]._workInProgressVersionPrimary=null;nr.length=0}var or=x.ReactCurrentDispatcher,ir=x.ReactCurrentBatchConfig,rr=0,lr=null,sr=null,cr=null,ur=!1,dr=!1,pr=0,mr=0;function hr(){throw Error(i(321))}function fr(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!la(e[n],t[n]))return!1;return!0}function gr(e,t,n,a,o,r){if(rr=r,lr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,or.current=null===e||null===e.memoizedState?Zr:el,e=n(a,o),dr){r=0;do{if(dr=!1,pr=0,25<=r)throw Error(i(301));r+=1,cr=sr=null,t.updateQueue=null,or.current=tl,e=n(a,o)}while(dr)}if(or.current=Qr,t=null!==sr&&null!==sr.next,rr=0,cr=sr=lr=null,ur=!1,t)throw Error(i(300));return e}function vr(){var e=0!==pr;return pr=0,e}function br(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===cr?lr.memoizedState=cr=e:cr=cr.next=e,cr}function yr(){if(null===sr){var e=lr.alternate;e=null!==e?e.memoizedState:null}else e=sr.next;var t=null===cr?lr.memoizedState:cr.next;if(null!==t)cr=t,sr=e;else{if(null===e)throw Error(i(310));e={memoizedState:(sr=e).memoizedState,baseState:sr.baseState,baseQueue:sr.baseQueue,queue:sr.queue,next:null},null===cr?lr.memoizedState=cr=e:cr=cr.next=e}return cr}function xr(e,t){return"function"===typeof t?t(e):t}function Cr(e){var t=yr(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var a=sr,o=a.baseQueue,r=n.pending;if(null!==r){if(null!==o){var l=o.next;o.next=r.next,r.next=l}a.baseQueue=o=r,n.pending=null}if(null!==o){r=o.next,a=a.baseState;var s=l=null,c=null,u=r;do{var d=u.lane;if((rr&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),a=u.hasEagerState?u.eagerState:e(a,u.action);else{var p={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(s=c=p,l=a):c=c.next=p,lr.lanes|=d,Ds|=d}u=u.next}while(null!==u&&u!==r);null===c?l=a:c.next=s,la(a,t.memoizedState)||(yl=!0),t.memoizedState=a,t.baseState=l,t.baseQueue=c,n.lastRenderedState=a}if(null!==(e=n.interleaved)){o=e;do{r=o.lane,lr.lanes|=r,Ds|=r,o=o.next}while(o!==e)}else null===o&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Sr(e){var t=yr(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var a=n.dispatch,o=n.pending,r=t.memoizedState;if(null!==o){n.pending=null;var l=o=o.next;do{r=e(r,l.action),l=l.next}while(l!==o);la(r,t.memoizedState)||(yl=!0),t.memoizedState=r,null===t.baseQueue&&(t.baseState=r),n.lastRenderedState=r}return[r,a]}function wr(){}function kr(e,t){var n=lr,a=yr(),o=t(),r=!la(a.memoizedState,o);if(r&&(a.memoizedState=o,yl=!0),a=a.queue,Dr(Er.bind(null,n,a,e),[e]),a.getSnapshot!==t||r||null!==cr&&1&cr.memoizedState.tag){if(n.flags|=2048,zr(9,jr.bind(null,n,a,o,t),void 0,null),null===Ts)throw Error(i(349));0!==(30&rr)||Nr(n,t,o)}return o}function Nr(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=lr.updateQueue)?(t={lastEffect:null,stores:null},lr.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function jr(e,t,n,a){t.value=n,t.getSnapshot=a,Mr(t)&&Tr(e)}function Er(e,t,n){return n(function(){Mr(t)&&Tr(e)})}function Mr(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!la(e,n)}catch(a){return!0}}function Tr(e){var t=Ii(e,1);null!==t&&nc(t,e,1,-1)}function Pr(e){var t=br();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xr,lastRenderedState:e},t.queue=e,e=e.dispatch=Kr.bind(null,lr,e),[t.memoizedState,e]}function zr(e,t,n,a){return e={tag:e,create:t,destroy:n,deps:a,next:null},null===(t=lr.updateQueue)?(t={lastEffect:null,stores:null},lr.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(a=n.next,n.next=e,e.next=a,t.lastEffect=e),e}function _r(){return yr().memoizedState}function Rr(e,t,n,a){var o=br();lr.flags|=e,o.memoizedState=zr(1|t,n,void 0,void 0===a?null:a)}function Ar(e,t,n,a){var o=yr();a=void 0===a?null:a;var i=void 0;if(null!==sr){var r=sr.memoizedState;if(i=r.destroy,null!==a&&fr(a,r.deps))return void(o.memoizedState=zr(t,n,i,a))}lr.flags|=e,o.memoizedState=zr(1|t,n,i,a)}function Ir(e,t){return Rr(8390656,8,e,t)}function Dr(e,t){return Ar(2048,8,e,t)}function Or(e,t){return Ar(4,2,e,t)}function Fr(e,t){return Ar(4,4,e,t)}function Lr(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Br(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ar(4,4,Lr.bind(null,t,e),n)}function Ur(){}function Hr(e,t){var n=yr();t=void 0===t?null:t;var a=n.memoizedState;return null!==a&&null!==t&&fr(t,a[1])?a[0]:(n.memoizedState=[e,t],e)}function Wr(e,t){var n=yr();t=void 0===t?null:t;var a=n.memoizedState;return null!==a&&null!==t&&fr(t,a[1])?a[0]:(e=e(),n.memoizedState=[e,t],e)}function Vr(e,t,n){return 0===(21&rr)?(e.baseState&&(e.baseState=!1,yl=!0),e.memoizedState=n):(la(n,t)||(n=ft(),lr.lanes|=n,Ds|=n,e.baseState=!0),t)}function Gr(e,t){var n=yt;yt=0!==n&&4>n?n:4,e(!0);var a=ir.transition;ir.transition={};try{e(!1),t()}finally{yt=n,ir.transition=a}}function Yr(){return yr().memoizedState}function Xr(e,t,n){var a=tc(e);if(n={lane:a,action:n,hasEagerState:!1,eagerState:null,next:null},qr(e))$r(t,n);else if(null!==(n=Ai(e,t,n,a))){nc(n,e,a,ec()),Jr(n,t,a)}}function Kr(e,t,n){var a=tc(e),o={lane:a,action:n,hasEagerState:!1,eagerState:null,next:null};if(qr(e))$r(t,o);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var r=t.lastRenderedState,l=i(r,n);if(o.hasEagerState=!0,o.eagerState=l,la(l,r)){var s=t.interleaved;return null===s?(o.next=o,Ri(t)):(o.next=s.next,s.next=o),void(t.interleaved=o)}}catch(c){}null!==(n=Ai(e,t,o,a))&&(nc(n,e,a,o=ec()),Jr(n,t,a))}}function qr(e){var t=e.alternate;return e===lr||null!==t&&t===lr}function $r(e,t){dr=ur=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Jr(e,t,n){if(0!==(4194240&n)){var a=t.lanes;n|=a&=e.pendingLanes,t.lanes=n,bt(e,n)}}var Qr={readContext:zi,useCallback:hr,useContext:hr,useEffect:hr,useImperativeHandle:hr,useInsertionEffect:hr,useLayoutEffect:hr,useMemo:hr,useReducer:hr,useRef:hr,useState:hr,useDebugValue:hr,useDeferredValue:hr,useTransition:hr,useMutableSource:hr,useSyncExternalStore:hr,useId:hr,unstable_isNewReconciler:!1},Zr={readContext:zi,useCallback:function(e,t){return br().memoizedState=[e,void 0===t?null:t],e},useContext:zi,useEffect:Ir,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Rr(4194308,4,Lr.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Rr(4194308,4,e,t)},useInsertionEffect:function(e,t){return Rr(4,2,e,t)},useMemo:function(e,t){var n=br();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var a=br();return t=void 0!==n?n(t):t,a.memoizedState=a.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},a.queue=e,e=e.dispatch=Xr.bind(null,lr,e),[a.memoizedState,e]},useRef:function(e){return e={current:e},br().memoizedState=e},useState:Pr,useDebugValue:Ur,useDeferredValue:function(e){return br().memoizedState=e},useTransition:function(){var e=Pr(!1),t=e[0];return e=Gr.bind(null,e[1]),br().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var a=lr,o=br();if(ii){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Ts)throw Error(i(349));0!==(30&rr)||Nr(a,t,n)}o.memoizedState=n;var r={value:n,getSnapshot:t};return o.queue=r,Ir(Er.bind(null,a,r,e),[e]),a.flags|=2048,zr(9,jr.bind(null,a,r,n,t),void 0,null),n},useId:function(){var e=br(),t=Ts.identifierPrefix;if(ii){var n=Qo;t=":"+t+"R"+(n=(Jo&~(1<<32-rt(Jo)-1)).toString(32)+n),0<(n=pr++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=mr++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},el={readContext:zi,useCallback:Hr,useContext:zi,useEffect:Dr,useImperativeHandle:Br,useInsertionEffect:Or,useLayoutEffect:Fr,useMemo:Wr,useReducer:Cr,useRef:_r,useState:function(){return Cr(xr)},useDebugValue:Ur,useDeferredValue:function(e){return Vr(yr(),sr.memoizedState,e)},useTransition:function(){return[Cr(xr)[0],yr().memoizedState]},useMutableSource:wr,useSyncExternalStore:kr,useId:Yr,unstable_isNewReconciler:!1},tl={readContext:zi,useCallback:Hr,useContext:zi,useEffect:Dr,useImperativeHandle:Br,useInsertionEffect:Or,useLayoutEffect:Fr,useMemo:Wr,useReducer:Sr,useRef:_r,useState:function(){return Sr(xr)},useDebugValue:Ur,useDeferredValue:function(e){var t=yr();return null===sr?t.memoizedState=e:Vr(t,sr.memoizedState,e)},useTransition:function(){return[Sr(xr)[0],yr().memoizedState]},useMutableSource:wr,useSyncExternalStore:kr,useId:Yr,unstable_isNewReconciler:!1};function nl(e,t){if(e&&e.defaultProps){for(var n in t=O({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function al(e,t,n,a){n=null===(n=n(a,t=e.memoizedState))||void 0===n?t:O({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ol={isMounted:function(e){return!!(e=e._reactInternals)&&He(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var a=ec(),o=tc(e),i=Li(a,o);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Bi(e,i,o))&&(nc(t,e,o,a),Ui(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var a=ec(),o=tc(e),i=Li(a,o);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Bi(e,i,o))&&(nc(t,e,o,a),Ui(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),a=tc(e),o=Li(n,a);o.tag=2,void 0!==t&&null!==t&&(o.callback=t),null!==(t=Bi(e,o,a))&&(nc(t,e,a,n),Ui(t,e,a))}};function il(e,t,n,a,o,i,r){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(a,i,r):!t.prototype||!t.prototype.isPureReactComponent||(!sa(n,a)||!sa(o,i))}function rl(e,t,n){var a=!1,o=Mo,i=t.contextType;return"object"===typeof i&&null!==i?i=zi(i):(o=Ro(t)?zo:To.current,i=(a=null!==(a=t.contextTypes)&&void 0!==a)?_o(e,o):Mo),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ol,e.stateNode=t,t._reactInternals=e,a&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=i),t}function ll(e,t,n,a){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,a),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,a),t.state!==e&&ol.enqueueReplaceState(t,t.state,null)}function sl(e,t,n,a){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},Oi(e);var i=t.contextType;"object"===typeof i&&null!==i?o.context=zi(i):(i=Ro(t)?zo:To.current,o.context=_o(e,i)),o.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(al(e,t,i,n),o.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof o.getSnapshotBeforeUpdate||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||(t=o.state,"function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&ol.enqueueReplaceState(o,o.state,null),Wi(e,n,o,a),o.state=e.memoizedState),"function"===typeof o.componentDidMount&&(e.flags|=4194308)}function cl(e,t){try{var n="",a=t;do{n+=U(a),a=a.return}while(a);var o=n}catch(i){o="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:o,digest:null}}function ul(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function dl(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var pl="function"===typeof WeakMap?WeakMap:Map;function ml(e,t,n){(n=Li(-1,n)).tag=3,n.payload={element:null};var a=t.value;return n.callback=function(){Vs||(Vs=!0,Gs=a),dl(0,t)},n}function hl(e,t,n){(n=Li(-1,n)).tag=3;var a=e.type.getDerivedStateFromError;if("function"===typeof a){var o=t.value;n.payload=function(){return a(o)},n.callback=function(){dl(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){dl(0,t),"function"!==typeof a&&(null===Ys?Ys=new Set([this]):Ys.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function fl(e,t,n){var a=e.pingCache;if(null===a){a=e.pingCache=new pl;var o=new Set;a.set(t,o)}else void 0===(o=a.get(t))&&(o=new Set,a.set(t,o));o.has(n)||(o.add(n),e=Nc.bind(null,e,t,n),t.then(e,e))}function gl(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vl(e,t,n,a,o){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Li(-1,1)).tag=2,Bi(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=o,e)}var bl=x.ReactCurrentOwner,yl=!1;function xl(e,t,n,a){t.child=null===e?Si(t,null,n,a):Ci(t,e.child,n,a)}function Cl(e,t,n,a,o){n=n.render;var i=t.ref;return Pi(t,o),a=gr(e,t,n,a,i,o),n=vr(),null===e||yl?(ii&&n&&ti(t),t.flags|=1,xl(e,t,a,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Vl(e,t,o))}function Sl(e,t,n,a,o){if(null===e){var i=n.type;return"function"!==typeof i||_c(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Ac(n.type,null,a,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,wl(e,t,i,a,o))}if(i=e.child,0===(e.lanes&o)){var r=i.memoizedProps;if((n=null!==(n=n.compare)?n:sa)(r,a)&&e.ref===t.ref)return Vl(e,t,o)}return t.flags|=1,(e=Rc(i,a)).ref=t.ref,e.return=t,t.child=e}function wl(e,t,n,a,o){if(null!==e){var i=e.memoizedProps;if(sa(i,a)&&e.ref===t.ref){if(yl=!1,t.pendingProps=a=i,0===(e.lanes&o))return t.lanes=e.lanes,Vl(e,t,o);0!==(131072&e.flags)&&(yl=!0)}}return jl(e,t,n,a,o)}function kl(e,t,n){var a=t.pendingProps,o=a.children,i=null!==e?e.memoizedState:null;if("hidden"===a.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Eo(Rs,_s),_s|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Eo(Rs,_s),_s|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=null!==i?i.baseLanes:n,Eo(Rs,_s),_s|=a}else null!==i?(a=i.baseLanes|n,t.memoizedState=null):a=n,Eo(Rs,_s),_s|=a;return xl(e,t,o,n),t.child}function Nl(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function jl(e,t,n,a,o){var i=Ro(n)?zo:To.current;return i=_o(t,i),Pi(t,o),n=gr(e,t,n,a,i,o),a=vr(),null===e||yl?(ii&&a&&ti(t),t.flags|=1,xl(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Vl(e,t,o))}function El(e,t,n,a,o){if(Ro(n)){var i=!0;Oo(t)}else i=!1;if(Pi(t,o),null===t.stateNode)Wl(e,t),rl(t,n,a),sl(t,n,a,o),a=!0;else if(null===e){var r=t.stateNode,l=t.memoizedProps;r.props=l;var s=r.context,c=n.contextType;"object"===typeof c&&null!==c?c=zi(c):c=_o(t,c=Ro(n)?zo:To.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof r.getSnapshotBeforeUpdate;d||"function"!==typeof r.UNSAFE_componentWillReceiveProps&&"function"!==typeof r.componentWillReceiveProps||(l!==a||s!==c)&&ll(t,r,a,c),Di=!1;var p=t.memoizedState;r.state=p,Wi(t,a,r,o),s=t.memoizedState,l!==a||p!==s||Po.current||Di?("function"===typeof u&&(al(t,n,u,a),s=t.memoizedState),(l=Di||il(t,n,l,a,p,s,c))?(d||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||("function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount()),"function"===typeof r.componentDidMount&&(t.flags|=4194308)):("function"===typeof r.componentDidMount&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=s),r.props=a,r.state=s,r.context=c,a=l):("function"===typeof r.componentDidMount&&(t.flags|=4194308),a=!1)}else{r=t.stateNode,Fi(e,t),l=t.memoizedProps,c=t.type===t.elementType?l:nl(t.type,l),r.props=c,d=t.pendingProps,p=r.context,"object"===typeof(s=n.contextType)&&null!==s?s=zi(s):s=_o(t,s=Ro(n)?zo:To.current);var m=n.getDerivedStateFromProps;(u="function"===typeof m||"function"===typeof r.getSnapshotBeforeUpdate)||"function"!==typeof r.UNSAFE_componentWillReceiveProps&&"function"!==typeof r.componentWillReceiveProps||(l!==d||p!==s)&&ll(t,r,a,s),Di=!1,p=t.memoizedState,r.state=p,Wi(t,a,r,o);var h=t.memoizedState;l!==d||p!==h||Po.current||Di?("function"===typeof m&&(al(t,n,m,a),h=t.memoizedState),(c=Di||il(t,n,c,a,p,h,s)||!1)?(u||"function"!==typeof r.UNSAFE_componentWillUpdate&&"function"!==typeof r.componentWillUpdate||("function"===typeof r.componentWillUpdate&&r.componentWillUpdate(a,h,s),"function"===typeof r.UNSAFE_componentWillUpdate&&r.UNSAFE_componentWillUpdate(a,h,s)),"function"===typeof r.componentDidUpdate&&(t.flags|=4),"function"===typeof r.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof r.componentDidUpdate||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof r.getSnapshotBeforeUpdate||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=h),r.props=a,r.state=h,r.context=s,a=c):("function"!==typeof r.componentDidUpdate||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof r.getSnapshotBeforeUpdate||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),a=!1)}return Ml(e,t,n,a,i,o)}function Ml(e,t,n,a,o,i){Nl(e,t);var r=0!==(128&t.flags);if(!a&&!r)return o&&Fo(t,n,!1),Vl(e,t,i);a=t.stateNode,bl.current=t;var l=r&&"function"!==typeof n.getDerivedStateFromError?null:a.render();return t.flags|=1,null!==e&&r?(t.child=Ci(t,e.child,null,i),t.child=Ci(t,null,l,i)):xl(e,t,l,i),t.memoizedState=a.state,o&&Fo(t,n,!0),t.child}function Tl(e){var t=e.stateNode;t.pendingContext?Io(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Io(0,t.context,!1),$i(e,t.containerInfo)}function Pl(e,t,n,a,o){return hi(),fi(o),t.flags|=256,xl(e,t,n,a),t.child}var zl,_l,Rl,Al,Il={dehydrated:null,treeContext:null,retryLane:0};function Dl(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ol(e,t,n){var a,o=t.pendingProps,r=er.current,l=!1,s=0!==(128&t.flags);if((a=s)||(a=(null===e||null!==e.memoizedState)&&0!==(2&r)),a?(l=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(r|=1),Eo(er,1&r),null===e)return ui(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(s=o.children,e=o.fallback,l?(o=t.mode,l=t.child,s={mode:"hidden",children:s},0===(1&o)&&null!==l?(l.childLanes=0,l.pendingProps=s):l=Dc(s,o,0,null),e=Ic(e,o,n,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=Dl(n),t.memoizedState=Il,e):Fl(t,s));if(null!==(r=e.memoizedState)&&null!==(a=r.dehydrated))return function(e,t,n,a,o,r,l){if(n)return 256&t.flags?(t.flags&=-257,Ll(e,t,l,a=ul(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(r=a.fallback,o=t.mode,a=Dc({mode:"visible",children:a.children},o,0,null),(r=Ic(r,o,l,null)).flags|=2,a.return=t,r.return=t,a.sibling=r,t.child=a,0!==(1&t.mode)&&Ci(t,e.child,null,l),t.child.memoizedState=Dl(l),t.memoizedState=Il,r);if(0===(1&t.mode))return Ll(e,t,l,null);if("$!"===o.data){if(a=o.nextSibling&&o.nextSibling.dataset)var s=a.dgst;return a=s,Ll(e,t,l,a=ul(r=Error(i(419)),a,void 0))}if(s=0!==(l&e.childLanes),yl||s){if(null!==(a=Ts)){switch(l&-l){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}0!==(o=0!==(o&(a.suspendedLanes|l))?0:o)&&o!==r.retryLane&&(r.retryLane=o,Ii(e,o),nc(a,e,o,-1))}return fc(),Ll(e,t,l,a=ul(Error(i(421))))}return"$?"===o.data?(t.flags|=128,t.child=e.child,t=Ec.bind(null,e),o._reactRetry=t,null):(e=r.treeContext,oi=co(o.nextSibling),ai=t,ii=!0,ri=null,null!==e&&(Ko[qo++]=Jo,Ko[qo++]=Qo,Ko[qo++]=$o,Jo=e.id,Qo=e.overflow,$o=t),t=Fl(t,a.children),t.flags|=4096,t)}(e,t,s,o,a,r,n);if(l){l=o.fallback,s=t.mode,a=(r=e.child).sibling;var c={mode:"hidden",children:o.children};return 0===(1&s)&&t.child!==r?((o=t.child).childLanes=0,o.pendingProps=c,t.deletions=null):(o=Rc(r,c)).subtreeFlags=14680064&r.subtreeFlags,null!==a?l=Rc(a,l):(l=Ic(l,s,n,null)).flags|=2,l.return=t,o.return=t,o.sibling=l,t.child=o,o=l,l=t.child,s=null===(s=e.child.memoizedState)?Dl(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},l.memoizedState=s,l.childLanes=e.childLanes&~n,t.memoizedState=Il,o}return e=(l=e.child).sibling,o=Rc(l,{mode:"visible",children:o.children}),0===(1&t.mode)&&(o.lanes=n),o.return=t,o.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=o,t.memoizedState=null,o}function Fl(e,t){return(t=Dc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ll(e,t,n,a){return null!==a&&fi(a),Ci(t,e.child,null,n),(e=Fl(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Bl(e,t,n){e.lanes|=t;var a=e.alternate;null!==a&&(a.lanes|=t),Ti(e.return,t,n)}function Ul(e,t,n,a,o){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:n,tailMode:o}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=a,i.tail=n,i.tailMode=o)}function Hl(e,t,n){var a=t.pendingProps,o=a.revealOrder,i=a.tail;if(xl(e,t,a.children,n),0!==(2&(a=er.current)))a=1&a|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Bl(e,n,t);else if(19===e.tag)Bl(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(Eo(er,a),0===(1&t.mode))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;null!==n;)null!==(e=n.alternate)&&null===tr(e)&&(o=n),n=n.sibling;null===(n=o)?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),Ul(t,!1,o,n,i);break;case"backwards":for(n=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===tr(e)){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}Ul(t,!0,n,null,i);break;case"together":Ul(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wl(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Vl(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ds|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Rc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Rc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Gl(e,t){if(!ii)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var a=null;null!==n;)null!==n.alternate&&(a=n),n=n.sibling;null===a?t||null===e.tail?e.tail=null:e.tail.sibling=null:a.sibling=null}}function Yl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,a=0;if(t)for(var o=e.child;null!==o;)n|=o.lanes|o.childLanes,a|=14680064&o.subtreeFlags,a|=14680064&o.flags,o.return=e,o=o.sibling;else for(o=e.child;null!==o;)n|=o.lanes|o.childLanes,a|=o.subtreeFlags,a|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=a,e.childLanes=n,t}function Xl(e,t,n){var a=t.pendingProps;switch(ni(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yl(t),null;case 1:case 17:return Ro(t.type)&&Ao(),Yl(t),null;case 3:return a=t.stateNode,Ji(),jo(Po),jo(To),ar(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),null!==e&&null!==e.child||(pi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ri&&(rc(ri),ri=null))),_l(e,t),Yl(t),null;case 5:Zi(t);var o=qi(Ki.current);if(n=t.type,null!==e&&null!=t.stateNode)Rl(e,t,n,a,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!a){if(null===t.stateNode)throw Error(i(166));return Yl(t),null}if(e=qi(Yi.current),pi(t)){a=t.stateNode,n=t.type;var r=t.memoizedProps;switch(a[mo]=t,a[ho]=r,e=0!==(1&t.mode),n){case"dialog":La("cancel",a),La("close",a);break;case"iframe":case"object":case"embed":La("load",a);break;case"video":case"audio":for(o=0;o<Ia.length;o++)La(Ia[o],a);break;case"source":La("error",a);break;case"img":case"image":case"link":La("error",a),La("load",a);break;case"details":La("toggle",a);break;case"input":$(a,r),La("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!r.multiple},La("invalid",a);break;case"textarea":oe(a,r),La("invalid",a)}for(var s in be(n,r),o=null,r)if(r.hasOwnProperty(s)){var c=r[s];"children"===s?"string"===typeof c?a.textContent!==c&&(!0!==r.suppressHydrationWarning&&Qa(a.textContent,c,e),o=["children",c]):"number"===typeof c&&a.textContent!==""+c&&(!0!==r.suppressHydrationWarning&&Qa(a.textContent,c,e),o=["children",""+c]):l.hasOwnProperty(s)&&null!=c&&"onScroll"===s&&La("scroll",a)}switch(n){case"input":Y(a),Z(a,r,!0);break;case"textarea":Y(a),re(a);break;case"select":case"option":break;default:"function"===typeof r.onClick&&(a.onclick=Za)}a=o,t.updateQueue=a,null!==a&&(t.flags|=4)}else{s=9===o.nodeType?o:o.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=le(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=s.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof a.is?e=s.createElement(n,{is:a.is}):(e=s.createElement(n),"select"===n&&(s=e,a.multiple?s.multiple=!0:a.size&&(s.size=a.size))):e=s.createElementNS(e,n),e[mo]=t,e[ho]=a,zl(e,t,!1,!1),t.stateNode=e;e:{switch(s=ye(n,a),n){case"dialog":La("cancel",e),La("close",e),o=a;break;case"iframe":case"object":case"embed":La("load",e),o=a;break;case"video":case"audio":for(o=0;o<Ia.length;o++)La(Ia[o],e);o=a;break;case"source":La("error",e),o=a;break;case"img":case"image":case"link":La("error",e),La("load",e),o=a;break;case"details":La("toggle",e),o=a;break;case"input":$(e,a),o=q(e,a),La("invalid",e);break;case"option":default:o=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},o=O({},a,{value:void 0}),La("invalid",e);break;case"textarea":oe(e,a),o=ae(e,a),La("invalid",e)}for(r in be(n,o),c=o)if(c.hasOwnProperty(r)){var u=c[r];"style"===r?ge(e,u):"dangerouslySetInnerHTML"===r?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===r?"string"===typeof u?("textarea"!==n||""!==u)&&pe(e,u):"number"===typeof u&&pe(e,""+u):"suppressContentEditableWarning"!==r&&"suppressHydrationWarning"!==r&&"autoFocus"!==r&&(l.hasOwnProperty(r)?null!=u&&"onScroll"===r&&La("scroll",e):null!=u&&y(e,r,u,s))}switch(n){case"input":Y(e),Z(e,a,!1);break;case"textarea":Y(e),re(e);break;case"option":null!=a.value&&e.setAttribute("value",""+V(a.value));break;case"select":e.multiple=!!a.multiple,null!=(r=a.value)?ne(e,!!a.multiple,r,!1):null!=a.defaultValue&&ne(e,!!a.multiple,a.defaultValue,!0);break;default:"function"===typeof o.onClick&&(e.onclick=Za)}switch(n){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Yl(t),null;case 6:if(e&&null!=t.stateNode)Al(e,t,e.memoizedProps,a);else{if("string"!==typeof a&&null===t.stateNode)throw Error(i(166));if(n=qi(Ki.current),qi(Yi.current),pi(t)){if(a=t.stateNode,n=t.memoizedProps,a[mo]=t,(r=a.nodeValue!==n)&&null!==(e=ai))switch(e.tag){case 3:Qa(a.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Qa(a.nodeValue,n,0!==(1&e.mode))}r&&(t.flags|=4)}else(a=(9===n.nodeType?n:n.ownerDocument).createTextNode(a))[mo]=t,t.stateNode=a}return Yl(t),null;case 13:if(jo(er),a=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ii&&null!==oi&&0!==(1&t.mode)&&0===(128&t.flags))mi(),hi(),t.flags|=98560,r=!1;else if(r=pi(t),null!==a&&null!==a.dehydrated){if(null===e){if(!r)throw Error(i(318));if(!(r=null!==(r=t.memoizedState)?r.dehydrated:null))throw Error(i(317));r[mo]=t}else hi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Yl(t),r=!1}else null!==ri&&(rc(ri),ri=null),r=!0;if(!r)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((a=null!==a)!==(null!==e&&null!==e.memoizedState)&&a&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&er.current)?0===As&&(As=3):fc())),null!==t.updateQueue&&(t.flags|=4),Yl(t),null);case 4:return Ji(),_l(e,t),null===e&&Ha(t.stateNode.containerInfo),Yl(t),null;case 10:return Mi(t.type._context),Yl(t),null;case 19:if(jo(er),null===(r=t.memoizedState))return Yl(t),null;if(a=0!==(128&t.flags),null===(s=r.rendering))if(a)Gl(r,!1);else{if(0!==As||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=tr(e))){for(t.flags|=128,Gl(r,!1),null!==(a=s.updateQueue)&&(t.updateQueue=a,t.flags|=4),t.subtreeFlags=0,a=n,n=t.child;null!==n;)e=a,(r=n).flags&=14680066,null===(s=r.alternate)?(r.childLanes=0,r.lanes=e,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=s.childLanes,r.lanes=s.lanes,r.child=s.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=s.memoizedProps,r.memoizedState=s.memoizedState,r.updateQueue=s.updateQueue,r.type=s.type,e=s.dependencies,r.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Eo(er,1&er.current|2),t.child}e=e.sibling}null!==r.tail&&Je()>Hs&&(t.flags|=128,a=!0,Gl(r,!1),t.lanes=4194304)}else{if(!a)if(null!==(e=tr(s))){if(t.flags|=128,a=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Gl(r,!0),null===r.tail&&"hidden"===r.tailMode&&!s.alternate&&!ii)return Yl(t),null}else 2*Je()-r.renderingStartTime>Hs&&1073741824!==n&&(t.flags|=128,a=!0,Gl(r,!1),t.lanes=4194304);r.isBackwards?(s.sibling=t.child,t.child=s):(null!==(n=r.last)?n.sibling=s:t.child=s,r.last=s)}return null!==r.tail?(t=r.tail,r.rendering=t,r.tail=t.sibling,r.renderingStartTime=Je(),t.sibling=null,n=er.current,Eo(er,a?1&n|2:1&n),t):(Yl(t),null);case 22:case 23:return dc(),a=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==a&&(t.flags|=8192),a&&0!==(1&t.mode)?0!==(1073741824&_s)&&(Yl(t),6&t.subtreeFlags&&(t.flags|=8192)):Yl(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Kl(e,t){switch(ni(t),t.tag){case 1:return Ro(t.type)&&Ao(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ji(),jo(Po),jo(To),ar(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Zi(t),null;case 13:if(jo(er),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));hi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return jo(er),null;case 4:return Ji(),null;case 10:return Mi(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}zl=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},_l=function(){},Rl=function(e,t,n,a){var o=e.memoizedProps;if(o!==a){e=t.stateNode,qi(Yi.current);var i,r=null;switch(n){case"input":o=q(e,o),a=q(e,a),r=[];break;case"select":o=O({},o,{value:void 0}),a=O({},a,{value:void 0}),r=[];break;case"textarea":o=ae(e,o),a=ae(e,a),r=[];break;default:"function"!==typeof o.onClick&&"function"===typeof a.onClick&&(e.onclick=Za)}for(u in be(n,a),n=null,o)if(!a.hasOwnProperty(u)&&o.hasOwnProperty(u)&&null!=o[u])if("style"===u){var s=o[u];for(i in s)s.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(l.hasOwnProperty(u)?r||(r=[]):(r=r||[]).push(u,null));for(u in a){var c=a[u];if(s=null!=o?o[u]:void 0,a.hasOwnProperty(u)&&c!==s&&(null!=c||null!=s))if("style"===u)if(s){for(i in s)!s.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&s[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(r||(r=[]),r.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,s=s?s.__html:void 0,null!=c&&s!==c&&(r=r||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(r=r||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(l.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&La("scroll",e),r||s===c||(r=[])):(r=r||[]).push(u,c))}n&&(r=r||[]).push("style",n);var u=r;(t.updateQueue=u)&&(t.flags|=4)}},Al=function(e,t,n,a){n!==a&&(t.flags|=4)};var ql=!1,$l=!1,Jl="function"===typeof WeakSet?WeakSet:Set,Ql=null;function Zl(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(a){kc(e,t,a)}else n.current=null}function es(e,t,n){try{n()}catch(a){kc(e,t,a)}}var ts=!1;function ns(e,t,n){var a=t.updateQueue;if(null!==(a=null!==a?a.lastEffect:null)){var o=a=a.next;do{if((o.tag&e)===e){var i=o.destroy;o.destroy=void 0,void 0!==i&&es(t,n,i)}o=o.next}while(o!==a)}}function as(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var a=n.create;n.destroy=a()}n=n.next}while(n!==t)}}function os(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function is(e){var t=e.alternate;null!==t&&(e.alternate=null,is(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[mo],delete t[ho],delete t[go],delete t[vo],delete t[bo])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function rs(e){return 5===e.tag||3===e.tag||4===e.tag}function ls(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||rs(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ss(e,t,n){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Za));else if(4!==a&&null!==(e=e.child))for(ss(e,t,n),e=e.sibling;null!==e;)ss(e,t,n),e=e.sibling}function cs(e,t,n){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==a&&null!==(e=e.child))for(cs(e,t,n),e=e.sibling;null!==e;)cs(e,t,n),e=e.sibling}var us=null,ds=!1;function ps(e,t,n){for(n=n.child;null!==n;)ms(e,t,n),n=n.sibling}function ms(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(ot,n)}catch(l){}switch(n.tag){case 5:$l||Zl(n,t);case 6:var a=us,o=ds;us=null,ps(e,t,n),ds=o,null!==(us=a)&&(ds?(e=us,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):us.removeChild(n.stateNode));break;case 18:null!==us&&(ds?(e=us,n=n.stateNode,8===e.nodeType?so(e.parentNode,n):1===e.nodeType&&so(e,n),Ht(e)):so(us,n.stateNode));break;case 4:a=us,o=ds,us=n.stateNode.containerInfo,ds=!0,ps(e,t,n),us=a,ds=o;break;case 0:case 11:case 14:case 15:if(!$l&&(null!==(a=n.updateQueue)&&null!==(a=a.lastEffect))){o=a=a.next;do{var i=o,r=i.destroy;i=i.tag,void 0!==r&&(0!==(2&i)||0!==(4&i))&&es(n,t,r),o=o.next}while(o!==a)}ps(e,t,n);break;case 1:if(!$l&&(Zl(n,t),"function"===typeof(a=n.stateNode).componentWillUnmount))try{a.props=n.memoizedProps,a.state=n.memoizedState,a.componentWillUnmount()}catch(l){kc(n,t,l)}ps(e,t,n);break;case 21:ps(e,t,n);break;case 22:1&n.mode?($l=(a=$l)||null!==n.memoizedState,ps(e,t,n),$l=a):ps(e,t,n);break;default:ps(e,t,n)}}function hs(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Jl),t.forEach(function(t){var a=Mc.bind(null,e,t);n.has(t)||(n.add(t),t.then(a,a))})}}function fs(e,t){var n=t.deletions;if(null!==n)for(var a=0;a<n.length;a++){var o=n[a];try{var r=e,l=t,s=l;e:for(;null!==s;){switch(s.tag){case 5:us=s.stateNode,ds=!1;break e;case 3:case 4:us=s.stateNode.containerInfo,ds=!0;break e}s=s.return}if(null===us)throw Error(i(160));ms(r,l,o),us=null,ds=!1;var c=o.alternate;null!==c&&(c.return=null),o.return=null}catch(u){kc(o,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gs(t,e),t=t.sibling}function gs(e,t){var n=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fs(t,e),vs(e),4&a){try{ns(3,e,e.return),as(3,e)}catch(g){kc(e,e.return,g)}try{ns(5,e,e.return)}catch(g){kc(e,e.return,g)}}break;case 1:fs(t,e),vs(e),512&a&&null!==n&&Zl(n,n.return);break;case 5:if(fs(t,e),vs(e),512&a&&null!==n&&Zl(n,n.return),32&e.flags){var o=e.stateNode;try{pe(o,"")}catch(g){kc(e,e.return,g)}}if(4&a&&null!=(o=e.stateNode)){var r=e.memoizedProps,l=null!==n?n.memoizedProps:r,s=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===s&&"radio"===r.type&&null!=r.name&&J(o,r),ye(s,l);var u=ye(s,r);for(l=0;l<c.length;l+=2){var d=c[l],p=c[l+1];"style"===d?ge(o,p):"dangerouslySetInnerHTML"===d?de(o,p):"children"===d?pe(o,p):y(o,d,p,u)}switch(s){case"input":Q(o,r);break;case"textarea":ie(o,r);break;case"select":var m=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!r.multiple;var h=r.value;null!=h?ne(o,!!r.multiple,h,!1):m!==!!r.multiple&&(null!=r.defaultValue?ne(o,!!r.multiple,r.defaultValue,!0):ne(o,!!r.multiple,r.multiple?[]:"",!1))}o[ho]=r}catch(g){kc(e,e.return,g)}}break;case 6:if(fs(t,e),vs(e),4&a){if(null===e.stateNode)throw Error(i(162));o=e.stateNode,r=e.memoizedProps;try{o.nodeValue=r}catch(g){kc(e,e.return,g)}}break;case 3:if(fs(t,e),vs(e),4&a&&null!==n&&n.memoizedState.isDehydrated)try{Ht(t.containerInfo)}catch(g){kc(e,e.return,g)}break;case 4:default:fs(t,e),vs(e);break;case 13:fs(t,e),vs(e),8192&(o=e.child).flags&&(r=null!==o.memoizedState,o.stateNode.isHidden=r,!r||null!==o.alternate&&null!==o.alternate.memoizedState||(Us=Je())),4&a&&hs(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?($l=(u=$l)||d,fs(t,e),$l=u):fs(t,e),vs(e),8192&a){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Ql=e,d=e.child;null!==d;){for(p=Ql=d;null!==Ql;){switch(h=(m=Ql).child,m.tag){case 0:case 11:case 14:case 15:ns(4,m,m.return);break;case 1:Zl(m,m.return);var f=m.stateNode;if("function"===typeof f.componentWillUnmount){a=m,n=m.return;try{t=a,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(g){kc(a,n,g)}}break;case 5:Zl(m,m.return);break;case 22:if(null!==m.memoizedState){Cs(p);continue}}null!==h?(h.return=m,Ql=h):Cs(p)}d=d.sibling}e:for(d=null,p=e;;){if(5===p.tag){if(null===d){d=p;try{o=p.stateNode,u?"function"===typeof(r=o.style).setProperty?r.setProperty("display","none","important"):r.display="none":(s=p.stateNode,l=void 0!==(c=p.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,s.style.display=fe("display",l))}catch(g){kc(e,e.return,g)}}}else if(6===p.tag){if(null===d)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(g){kc(e,e.return,g)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===e)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;null===p.sibling;){if(null===p.return||p.return===e)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:fs(t,e),vs(e),4&a&&hs(e);case 21:}}function vs(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(rs(n)){var a=n;break e}n=n.return}throw Error(i(160))}switch(a.tag){case 5:var o=a.stateNode;32&a.flags&&(pe(o,""),a.flags&=-33),cs(e,ls(e),o);break;case 3:case 4:var r=a.stateNode.containerInfo;ss(e,ls(e),r);break;default:throw Error(i(161))}}catch(l){kc(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bs(e,t,n){Ql=e,ys(e,t,n)}function ys(e,t,n){for(var a=0!==(1&e.mode);null!==Ql;){var o=Ql,i=o.child;if(22===o.tag&&a){var r=null!==o.memoizedState||ql;if(!r){var l=o.alternate,s=null!==l&&null!==l.memoizedState||$l;l=ql;var c=$l;if(ql=r,($l=s)&&!c)for(Ql=o;null!==Ql;)s=(r=Ql).child,22===r.tag&&null!==r.memoizedState?Ss(o):null!==s?(s.return=r,Ql=s):Ss(o);for(;null!==i;)Ql=i,ys(i,t,n),i=i.sibling;Ql=o,ql=l,$l=c}xs(e)}else 0!==(8772&o.subtreeFlags)&&null!==i?(i.return=o,Ql=i):xs(e)}}function xs(e){for(;null!==Ql;){var t=Ql;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:$l||as(5,t);break;case 1:var a=t.stateNode;if(4&t.flags&&!$l)if(null===n)a.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:nl(t.type,n.memoizedProps);a.componentDidUpdate(o,n.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var r=t.updateQueue;null!==r&&Vi(t,r,a);break;case 3:var l=t.updateQueue;if(null!==l){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Vi(t,l,n)}break;case 5:var s=t.stateNode;if(null===n&&4&t.flags){n=s;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var p=d.dehydrated;null!==p&&Ht(p)}}}break;default:throw Error(i(163))}$l||512&t.flags&&os(t)}catch(m){kc(t,t.return,m)}}if(t===e){Ql=null;break}if(null!==(n=t.sibling)){n.return=t.return,Ql=n;break}Ql=t.return}}function Cs(e){for(;null!==Ql;){var t=Ql;if(t===e){Ql=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Ql=n;break}Ql=t.return}}function Ss(e){for(;null!==Ql;){var t=Ql;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{as(4,t)}catch(s){kc(t,n,s)}break;case 1:var a=t.stateNode;if("function"===typeof a.componentDidMount){var o=t.return;try{a.componentDidMount()}catch(s){kc(t,o,s)}}var i=t.return;try{os(t)}catch(s){kc(t,i,s)}break;case 5:var r=t.return;try{os(t)}catch(s){kc(t,r,s)}}}catch(s){kc(t,t.return,s)}if(t===e){Ql=null;break}var l=t.sibling;if(null!==l){l.return=t.return,Ql=l;break}Ql=t.return}}var ws,ks=Math.ceil,Ns=x.ReactCurrentDispatcher,js=x.ReactCurrentOwner,Es=x.ReactCurrentBatchConfig,Ms=0,Ts=null,Ps=null,zs=0,_s=0,Rs=No(0),As=0,Is=null,Ds=0,Os=0,Fs=0,Ls=null,Bs=null,Us=0,Hs=1/0,Ws=null,Vs=!1,Gs=null,Ys=null,Xs=!1,Ks=null,qs=0,$s=0,Js=null,Qs=-1,Zs=0;function ec(){return 0!==(6&Ms)?Je():-1!==Qs?Qs:Qs=Je()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Ms)&&0!==zs?zs&-zs:null!==gi.transition?(0===Zs&&(Zs=ft()),Zs):0!==(e=yt)?e:e=void 0===(e=window.event)?16:$t(e.type)}function nc(e,t,n,a){if(50<$s)throw $s=0,Js=null,Error(i(185));vt(e,n,a),0!==(2&Ms)&&e===Ts||(e===Ts&&(0===(2&Ms)&&(Os|=n),4===As&&lc(e,zs)),ac(e,a),1===n&&0===Ms&&0===(1&t.mode)&&(Hs=Je()+500,Bo&&Wo()))}function ac(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,a=e.pingedLanes,o=e.expirationTimes,i=e.pendingLanes;0<i;){var r=31-rt(i),l=1<<r,s=o[r];-1===s?0!==(l&n)&&0===(l&a)||(o[r]=mt(l,t)):s<=t&&(e.expiredLanes|=l),i&=~l}}(e,t);var a=pt(e,e===Ts?zs:0);if(0===a)null!==n&&Ke(n),e.callbackNode=null,e.callbackPriority=0;else if(t=a&-a,e.callbackPriority!==t){if(null!=n&&Ke(n),1===t)0===e.tag?function(e){Bo=!0,Ho(e)}(sc.bind(null,e)):Ho(sc.bind(null,e)),ro(function(){0===(6&Ms)&&Wo()}),n=null;else{switch(xt(a)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=at}n=Tc(n,oc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function oc(e,t){if(Qs=-1,Zs=0,0!==(6&Ms))throw Error(i(327));var n=e.callbackNode;if(Sc()&&e.callbackNode!==n)return null;var a=pt(e,e===Ts?zs:0);if(0===a)return null;if(0!==(30&a)||0!==(a&e.expiredLanes)||t)t=gc(e,a);else{t=a;var o=Ms;Ms|=2;var r=hc();for(Ts===e&&zs===t||(Ws=null,Hs=Je()+500,pc(e,t));;)try{bc();break}catch(s){mc(e,s)}Ei(),Ns.current=r,Ms=o,null!==Ps?t=0:(Ts=null,zs=0,t=As)}if(0!==t){if(2===t&&(0!==(o=ht(e))&&(a=o,t=ic(e,o))),1===t)throw n=Is,pc(e,0),lc(e,a),ac(e,Je()),n;if(6===t)lc(e,a);else{if(o=e.current.alternate,0===(30&a)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var a=0;a<n.length;a++){var o=n[a],i=o.getSnapshot;o=o.value;try{if(!la(i(),o))return!1}catch(l){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(o)&&(2===(t=gc(e,a))&&(0!==(r=ht(e))&&(a=r,t=ic(e,r))),1===t))throw n=Is,pc(e,0),lc(e,a),ac(e,Je()),n;switch(e.finishedWork=o,e.finishedLanes=a,t){case 0:case 1:throw Error(i(345));case 2:case 5:Cc(e,Bs,Ws);break;case 3:if(lc(e,a),(130023424&a)===a&&10<(t=Us+500-Je())){if(0!==pt(e,0))break;if(((o=e.suspendedLanes)&a)!==a){ec(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=ao(Cc.bind(null,e,Bs,Ws),t);break}Cc(e,Bs,Ws);break;case 4:if(lc(e,a),(4194240&a)===a)break;for(t=e.eventTimes,o=-1;0<a;){var l=31-rt(a);r=1<<l,(l=t[l])>o&&(o=l),a&=~r}if(a=o,10<(a=(120>(a=Je()-a)?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*ks(a/1960))-a)){e.timeoutHandle=ao(Cc.bind(null,e,Bs,Ws),a);break}Cc(e,Bs,Ws);break;default:throw Error(i(329))}}}return ac(e,Je()),e.callbackNode===n?oc.bind(null,e):null}function ic(e,t){var n=Ls;return e.current.memoizedState.isDehydrated&&(pc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Bs,Bs=n,null!==t&&rc(t)),e}function rc(e){null===Bs?Bs=e:Bs.push.apply(Bs,e)}function lc(e,t){for(t&=~Fs,t&=~Os,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-rt(t),a=1<<n;e[n]=-1,t&=~a}}function sc(e){if(0!==(6&Ms))throw Error(i(327));Sc();var t=pt(e,0);if(0===(1&t))return ac(e,Je()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var a=ht(e);0!==a&&(t=a,n=ic(e,a))}if(1===n)throw n=Is,pc(e,0),lc(e,t),ac(e,Je()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Cc(e,Bs,Ws),ac(e,Je()),null}function cc(e,t){var n=Ms;Ms|=1;try{return e(t)}finally{0===(Ms=n)&&(Hs=Je()+500,Bo&&Wo())}}function uc(e){null!==Ks&&0===Ks.tag&&0===(6&Ms)&&Sc();var t=Ms;Ms|=1;var n=Es.transition,a=yt;try{if(Es.transition=null,yt=1,e)return e()}finally{yt=a,Es.transition=n,0===(6&(Ms=t))&&Wo()}}function dc(){_s=Rs.current,jo(Rs)}function pc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,oo(n)),null!==Ps)for(n=Ps.return;null!==n;){var a=n;switch(ni(a),a.tag){case 1:null!==(a=a.type.childContextTypes)&&void 0!==a&&Ao();break;case 3:Ji(),jo(Po),jo(To),ar();break;case 5:Zi(a);break;case 4:Ji();break;case 13:case 19:jo(er);break;case 10:Mi(a.type._context);break;case 22:case 23:dc()}n=n.return}if(Ts=e,Ps=e=Rc(e.current,null),zs=_s=t,As=0,Is=null,Fs=Os=Ds=0,Bs=Ls=null,null!==_i){for(t=0;t<_i.length;t++)if(null!==(a=(n=_i[t]).interleaved)){n.interleaved=null;var o=a.next,i=n.pending;if(null!==i){var r=i.next;i.next=o,a.next=r}n.pending=a}_i=null}return e}function mc(e,t){for(;;){var n=Ps;try{if(Ei(),or.current=Qr,ur){for(var a=lr.memoizedState;null!==a;){var o=a.queue;null!==o&&(o.pending=null),a=a.next}ur=!1}if(rr=0,cr=sr=lr=null,dr=!1,pr=0,js.current=null,null===n||null===n.return){As=1,Is=t,Ps=null;break}e:{var r=e,l=n.return,s=n,c=t;if(t=zs,s.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=s,p=d.tag;if(0===(1&d.mode)&&(0===p||11===p||15===p)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=gl(l);if(null!==h){h.flags&=-257,vl(h,l,s,0,t),1&h.mode&&fl(r,u,t),c=u;var f=(t=h).updateQueue;if(null===f){var g=new Set;g.add(c),t.updateQueue=g}else f.add(c);break e}if(0===(1&t)){fl(r,u,t),fc();break e}c=Error(i(426))}else if(ii&&1&s.mode){var v=gl(l);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vl(v,l,s,0,t),fi(cl(c,s));break e}}r=c=cl(c,s),4!==As&&(As=2),null===Ls?Ls=[r]:Ls.push(r),r=l;do{switch(r.tag){case 3:r.flags|=65536,t&=-t,r.lanes|=t,Hi(r,ml(0,c,t));break e;case 1:s=c;var b=r.type,y=r.stateNode;if(0===(128&r.flags)&&("function"===typeof b.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===Ys||!Ys.has(y)))){r.flags|=65536,t&=-t,r.lanes|=t,Hi(r,hl(r,s,t));break e}}r=r.return}while(null!==r)}xc(n)}catch(x){t=x,Ps===n&&null!==n&&(Ps=n=n.return);continue}break}}function hc(){var e=Ns.current;return Ns.current=Qr,null===e?Qr:e}function fc(){0!==As&&3!==As&&2!==As||(As=4),null===Ts||0===(268435455&Ds)&&0===(268435455&Os)||lc(Ts,zs)}function gc(e,t){var n=Ms;Ms|=2;var a=hc();for(Ts===e&&zs===t||(Ws=null,pc(e,t));;)try{vc();break}catch(o){mc(e,o)}if(Ei(),Ms=n,Ns.current=a,null!==Ps)throw Error(i(261));return Ts=null,zs=0,As}function vc(){for(;null!==Ps;)yc(Ps)}function bc(){for(;null!==Ps&&!qe();)yc(Ps)}function yc(e){var t=ws(e.alternate,e,_s);e.memoizedProps=e.pendingProps,null===t?xc(e):Ps=t,js.current=null}function xc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Xl(n,t,_s)))return void(Ps=n)}else{if(null!==(n=Kl(n,t)))return n.flags&=32767,void(Ps=n);if(null===e)return As=6,void(Ps=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ps=t);Ps=t=e}while(null!==t);0===As&&(As=5)}function Cc(e,t,n){var a=yt,o=Es.transition;try{Es.transition=null,yt=1,function(e,t,n,a){do{Sc()}while(null!==Ks);if(0!==(6&Ms))throw Error(i(327));n=e.finishedWork;var o=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var r=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-rt(n),i=1<<o;t[o]=0,a[o]=-1,e[o]=-1,n&=~i}}(e,r),e===Ts&&(Ps=Ts=null,zs=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Xs||(Xs=!0,Tc(tt,function(){return Sc(),null})),r=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||r){r=Es.transition,Es.transition=null;var l=yt;yt=1;var s=Ms;Ms|=4,js.current=null,function(e,t){if(eo=Vt,ma(e=pa())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var a=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(a&&0!==a.rangeCount){n=a.anchorNode;var o=a.anchorOffset,r=a.focusNode;a=a.focusOffset;try{n.nodeType,r.nodeType}catch(C){n=null;break e}var l=0,s=-1,c=-1,u=0,d=0,p=e,m=null;t:for(;;){for(var h;p!==n||0!==o&&3!==p.nodeType||(s=l+o),p!==r||0!==a&&3!==p.nodeType||(c=l+a),3===p.nodeType&&(l+=p.nodeValue.length),null!==(h=p.firstChild);)m=p,p=h;for(;;){if(p===e)break t;if(m===n&&++u===o&&(s=l),m===r&&++d===a&&(c=l),null!==(h=p.nextSibling))break;m=(p=m).parentNode}p=h}n=-1===s||-1===c?null:{start:s,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(to={focusedElem:e,selectionRange:n},Vt=!1,Ql=t;null!==Ql;)if(e=(t=Ql).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ql=e;else for(;null!==Ql;){t=Ql;try{var f=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var g=f.memoizedProps,v=f.memoizedState,b=t.stateNode,y=b.getSnapshotBeforeUpdate(t.elementType===t.type?g:nl(t.type,g),v);b.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(i(163))}}catch(C){kc(t,t.return,C)}if(null!==(e=t.sibling)){e.return=t.return,Ql=e;break}Ql=t.return}f=ts,ts=!1}(e,n),gs(n,e),ha(to),Vt=!!eo,to=eo=null,e.current=n,bs(n,e,o),$e(),Ms=s,yt=l,Es.transition=r}else e.current=n;if(Xs&&(Xs=!1,Ks=e,qs=o),r=e.pendingLanes,0===r&&(Ys=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(ot,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ac(e,Je()),null!==t)for(a=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],a(o.value,{componentStack:o.stack,digest:o.digest});if(Vs)throw Vs=!1,e=Gs,Gs=null,e;0!==(1&qs)&&0!==e.tag&&Sc(),r=e.pendingLanes,0!==(1&r)?e===Js?$s++:($s=0,Js=e):$s=0,Wo()}(e,t,n,a)}finally{Es.transition=o,yt=a}return null}function Sc(){if(null!==Ks){var e=xt(qs),t=Es.transition,n=yt;try{if(Es.transition=null,yt=16>e?16:e,null===Ks)var a=!1;else{if(e=Ks,Ks=null,qs=0,0!==(6&Ms))throw Error(i(331));var o=Ms;for(Ms|=4,Ql=e.current;null!==Ql;){var r=Ql,l=r.child;if(0!==(16&Ql.flags)){var s=r.deletions;if(null!==s){for(var c=0;c<s.length;c++){var u=s[c];for(Ql=u;null!==Ql;){var d=Ql;switch(d.tag){case 0:case 11:case 15:ns(8,d,r)}var p=d.child;if(null!==p)p.return=d,Ql=p;else for(;null!==Ql;){var m=(d=Ql).sibling,h=d.return;if(is(d),d===u){Ql=null;break}if(null!==m){m.return=h,Ql=m;break}Ql=h}}}var f=r.alternate;if(null!==f){var g=f.child;if(null!==g){f.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Ql=r}}if(0!==(2064&r.subtreeFlags)&&null!==l)l.return=r,Ql=l;else e:for(;null!==Ql;){if(0!==(2048&(r=Ql).flags))switch(r.tag){case 0:case 11:case 15:ns(9,r,r.return)}var b=r.sibling;if(null!==b){b.return=r.return,Ql=b;break e}Ql=r.return}}var y=e.current;for(Ql=y;null!==Ql;){var x=(l=Ql).child;if(0!==(2064&l.subtreeFlags)&&null!==x)x.return=l,Ql=x;else e:for(l=y;null!==Ql;){if(0!==(2048&(s=Ql).flags))try{switch(s.tag){case 0:case 11:case 15:as(9,s)}}catch(S){kc(s,s.return,S)}if(s===l){Ql=null;break e}var C=s.sibling;if(null!==C){C.return=s.return,Ql=C;break e}Ql=s.return}}if(Ms=o,Wo(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(ot,e)}catch(S){}a=!0}return a}finally{yt=n,Es.transition=t}}return!1}function wc(e,t,n){e=Bi(e,t=ml(0,t=cl(n,t),1),1),t=ec(),null!==e&&(vt(e,1,t),ac(e,t))}function kc(e,t,n){if(3===e.tag)wc(e,e,n);else for(;null!==t;){if(3===t.tag){wc(t,e,n);break}if(1===t.tag){var a=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof a.componentDidCatch&&(null===Ys||!Ys.has(a))){t=Bi(t,e=hl(t,e=cl(n,e),1),1),e=ec(),null!==t&&(vt(t,1,e),ac(t,e));break}}t=t.return}}function Nc(e,t,n){var a=e.pingCache;null!==a&&a.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Ts===e&&(zs&n)===n&&(4===As||3===As&&(130023424&zs)===zs&&500>Je()-Us?pc(e,0):Fs|=n),ac(e,t)}function jc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=Ii(e,t))&&(vt(e,t,n),ac(e,n))}function Ec(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),jc(e,n)}function Mc(e,t){var n=0;switch(e.tag){case 13:var a=e.stateNode,o=e.memoizedState;null!==o&&(n=o.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(i(314))}null!==a&&a.delete(t),jc(e,n)}function Tc(e,t){return Xe(e,t)}function Pc(e,t,n,a){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zc(e,t,n,a){return new Pc(e,t,n,a)}function _c(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Rc(e,t){var n=e.alternate;return null===n?((n=zc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ac(e,t,n,a,o,r){var l=2;if(a=e,"function"===typeof e)_c(e)&&(l=1);else if("string"===typeof e)l=5;else e:switch(e){case w:return Ic(n.children,o,r,t);case k:l=8,o|=8;break;case N:return(e=zc(12,n,t,2|o)).elementType=N,e.lanes=r,e;case T:return(e=zc(13,n,t,o)).elementType=T,e.lanes=r,e;case P:return(e=zc(19,n,t,o)).elementType=P,e.lanes=r,e;case R:return Dc(n,o,r,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case j:l=10;break e;case E:l=9;break e;case M:l=11;break e;case z:l=14;break e;case _:l=16,a=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=zc(l,n,t,o)).elementType=e,t.type=a,t.lanes=r,t}function Ic(e,t,n,a){return(e=zc(7,e,a,t)).lanes=n,e}function Dc(e,t,n,a){return(e=zc(22,e,a,t)).elementType=R,e.lanes=n,e.stateNode={isHidden:!1},e}function Oc(e,t,n){return(e=zc(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=zc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Lc(e,t,n,a,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=a,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Bc(e,t,n,a,o,i,r,l,s){return e=new Lc(e,t,n,l,s),1===t?(t=1,!0===i&&(t|=8)):t=0,i=zc(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:a,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Oi(i),e}function Uc(e){if(!e)return Mo;e:{if(He(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ro(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Ro(n))return Do(e,n,t)}return t}function Hc(e,t,n,a,o,i,r,l,s){return(e=Bc(n,a,!0,e,0,i,0,l,s)).context=Uc(null),n=e.current,(i=Li(a=ec(),o=tc(n))).callback=void 0!==t&&null!==t?t:null,Bi(n,i,o),e.current.lanes=o,vt(e,o,a),ac(e,a),e}function Wc(e,t,n,a){var o=t.current,i=ec(),r=tc(o);return n=Uc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Li(i,r)).payload={element:e},null!==(a=void 0===a?null:a)&&(t.callback=a),null!==(e=Bi(o,t,r))&&(nc(e,o,r,i),Ui(e,o,r)),r}function Vc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Yc(e,t){Gc(e,t),(e=e.alternate)&&Gc(e,t)}ws=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Po.current)yl=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return yl=!1,function(e,t,n){switch(t.tag){case 3:Tl(t),hi();break;case 5:Qi(t);break;case 1:Ro(t.type)&&Oo(t);break;case 4:$i(t,t.stateNode.containerInfo);break;case 10:var a=t.type._context,o=t.memoizedProps.value;Eo(wi,a._currentValue),a._currentValue=o;break;case 13:if(null!==(a=t.memoizedState))return null!==a.dehydrated?(Eo(er,1&er.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ol(e,t,n):(Eo(er,1&er.current),null!==(e=Vl(e,t,n))?e.sibling:null);Eo(er,1&er.current);break;case 19:if(a=0!==(n&t.childLanes),0!==(128&e.flags)){if(a)return Hl(e,t,n);t.flags|=128}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),Eo(er,er.current),a)break;return null;case 22:case 23:return t.lanes=0,kl(e,t,n)}return Vl(e,t,n)}(e,t,n);yl=0!==(131072&e.flags)}else yl=!1,ii&&0!==(1048576&t.flags)&&ei(t,Xo,t.index);switch(t.lanes=0,t.tag){case 2:var a=t.type;Wl(e,t),e=t.pendingProps;var o=_o(t,To.current);Pi(t,n),o=gr(null,t,a,e,o,n);var r=vr();return t.flags|=1,"object"===typeof o&&null!==o&&"function"===typeof o.render&&void 0===o.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ro(a)?(r=!0,Oo(t)):r=!1,t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,Oi(t),o.updater=ol,t.stateNode=o,o._reactInternals=t,sl(t,a,e,n),t=Ml(null,t,a,!0,r,n)):(t.tag=0,ii&&r&&ti(t),xl(null,t,o,n),t=t.child),t;case 16:a=t.elementType;e:{switch(Wl(e,t),e=t.pendingProps,a=(o=a._init)(a._payload),t.type=a,o=t.tag=function(e){if("function"===typeof e)return _c(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===M)return 11;if(e===z)return 14}return 2}(a),e=nl(a,e),o){case 0:t=jl(null,t,a,e,n);break e;case 1:t=El(null,t,a,e,n);break e;case 11:t=Cl(null,t,a,e,n);break e;case 14:t=Sl(null,t,a,nl(a.type,e),n);break e}throw Error(i(306,a,""))}return t;case 0:return a=t.type,o=t.pendingProps,jl(e,t,a,o=t.elementType===a?o:nl(a,o),n);case 1:return a=t.type,o=t.pendingProps,El(e,t,a,o=t.elementType===a?o:nl(a,o),n);case 3:e:{if(Tl(t),null===e)throw Error(i(387));a=t.pendingProps,o=(r=t.memoizedState).element,Fi(e,t),Wi(t,a,null,n);var l=t.memoizedState;if(a=l.element,r.isDehydrated){if(r={element:a,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=r,t.memoizedState=r,256&t.flags){t=Pl(e,t,a,n,o=cl(Error(i(423)),t));break e}if(a!==o){t=Pl(e,t,a,n,o=cl(Error(i(424)),t));break e}for(oi=co(t.stateNode.containerInfo.firstChild),ai=t,ii=!0,ri=null,n=Si(t,null,a,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(hi(),a===o){t=Vl(e,t,n);break e}xl(e,t,a,n)}t=t.child}return t;case 5:return Qi(t),null===e&&ui(t),a=t.type,o=t.pendingProps,r=null!==e?e.memoizedProps:null,l=o.children,no(a,o)?l=null:null!==r&&no(a,r)&&(t.flags|=32),Nl(e,t),xl(e,t,l,n),t.child;case 6:return null===e&&ui(t),null;case 13:return Ol(e,t,n);case 4:return $i(t,t.stateNode.containerInfo),a=t.pendingProps,null===e?t.child=Ci(t,null,a,n):xl(e,t,a,n),t.child;case 11:return a=t.type,o=t.pendingProps,Cl(e,t,a,o=t.elementType===a?o:nl(a,o),n);case 7:return xl(e,t,t.pendingProps,n),t.child;case 8:case 12:return xl(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(a=t.type._context,o=t.pendingProps,r=t.memoizedProps,l=o.value,Eo(wi,a._currentValue),a._currentValue=l,null!==r)if(la(r.value,l)){if(r.children===o.children&&!Po.current){t=Vl(e,t,n);break e}}else for(null!==(r=t.child)&&(r.return=t);null!==r;){var s=r.dependencies;if(null!==s){l=r.child;for(var c=s.firstContext;null!==c;){if(c.context===a){if(1===r.tag){(c=Li(-1,n&-n)).tag=2;var u=r.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}r.lanes|=n,null!==(c=r.alternate)&&(c.lanes|=n),Ti(r.return,n,t),s.lanes|=n;break}c=c.next}}else if(10===r.tag)l=r.type===t.type?null:r.child;else if(18===r.tag){if(null===(l=r.return))throw Error(i(341));l.lanes|=n,null!==(s=l.alternate)&&(s.lanes|=n),Ti(l,n,t),l=r.sibling}else l=r.child;if(null!==l)l.return=r;else for(l=r;null!==l;){if(l===t){l=null;break}if(null!==(r=l.sibling)){r.return=l.return,l=r;break}l=l.return}r=l}xl(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,a=t.pendingProps.children,Pi(t,n),a=a(o=zi(o)),t.flags|=1,xl(e,t,a,n),t.child;case 14:return o=nl(a=t.type,t.pendingProps),Sl(e,t,a,o=nl(a.type,o),n);case 15:return wl(e,t,t.type,t.pendingProps,n);case 17:return a=t.type,o=t.pendingProps,o=t.elementType===a?o:nl(a,o),Wl(e,t),t.tag=1,Ro(a)?(e=!0,Oo(t)):e=!1,Pi(t,n),rl(t,a,o),sl(t,a,o,n),Ml(null,t,a,!0,e,n);case 19:return Hl(e,t,n);case 22:return kl(e,t,n)}throw Error(i(156,t.tag))};var Xc="function"===typeof reportError?reportError:function(e){console.error(e)};function Kc(e){this._internalRoot=e}function qc(e){this._internalRoot=e}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Qc(){}function Zc(e,t,n,a,o){var i=n._reactRootContainer;if(i){var r=i;if("function"===typeof o){var l=o;o=function(){var e=Vc(r);l.call(e)}}Wc(t,r,e,o)}else r=function(e,t,n,a,o){if(o){if("function"===typeof a){var i=a;a=function(){var e=Vc(r);i.call(e)}}var r=Hc(t,a,e,0,null,!1,0,"",Qc);return e._reactRootContainer=r,e[fo]=r.current,Ha(8===e.nodeType?e.parentNode:e),uc(),r}for(;o=e.lastChild;)e.removeChild(o);if("function"===typeof a){var l=a;a=function(){var e=Vc(s);l.call(e)}}var s=Bc(e,0,!1,null,0,!1,0,"",Qc);return e._reactRootContainer=s,e[fo]=s.current,Ha(8===e.nodeType?e.parentNode:e),uc(function(){Wc(t,s,n,a)}),s}(n,t,e,o,a);return Vc(r)}qc.prototype.render=Kc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Wc(e,t,null,null)},qc.prototype.unmount=Kc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc(function(){Wc(null,e,null,null)}),t[fo]=null}},qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Rt.length&&0!==t&&t<Rt[n].priority;n++);Rt.splice(n,0,e),0===n&&Ot(e)}},Ct=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(bt(t,1|n),ac(t,Je()),0===(6&Ms)&&(Hs=Je()+500,Wo()))}break;case 13:uc(function(){var t=Ii(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}}),Yc(e,1)}},St=function(e){if(13===e.tag){var t=Ii(e,134217728);if(null!==t)nc(t,e,134217728,ec());Yc(e,134217728)}},wt=function(e){if(13===e.tag){var t=tc(e),n=Ii(e,t);if(null!==n)nc(n,e,t,ec());Yc(e,t)}},kt=function(){return yt},Nt=function(e,t){var n=yt;try{return yt=e,t()}finally{yt=n}},Se=function(e,t,n){switch(t){case"input":if(Q(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var a=n[t];if(a!==e&&a.form===e.form){var o=So(a);if(!o)throw Error(i(90));X(a),Q(a,o)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Me=cc,Te=uc;var eu={usingClientEntryPoint:!1,Events:[xo,Co,So,je,Ee,cc]},tu={findFiberByHostInstance:yo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var au=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!au.isDisabled&&au.supportsFiber)try{ot=au.inject(nu),it=au}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!$c(t))throw Error(i(200));return function(e,t,n){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==a?null:""+a,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!$c(e))throw Error(i(299));var n=!1,a="",o=Xc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(a=t.identifierPrefix),void 0!==t.onRecoverableError&&(o=t.onRecoverableError)),t=Bc(e,1,!1,null,0,n,0,a,o),e[fo]=t.current,Ha(8===e.nodeType?e.parentNode:e),new Kc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(i(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!$c(e))throw Error(i(405));var a=null!=n&&n.hydratedSources||null,o=!1,r="",l=Xc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(o=!0),void 0!==n.identifierPrefix&&(r=n.identifierPrefix),void 0!==n.onRecoverableError&&(l=n.onRecoverableError)),t=Hc(t,null,e,1,null!=n?n:null,o,0,r,l),e[fo]=t.current,Ha(e),a)for(e=0;e<a.length;e++)o=(o=(n=a[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new qc(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(i(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(i(40));return!!e._reactRootContainer&&(uc(function(){Zc(null,null,e,!1,function(){e._reactRootContainer=null,e[fo]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,a){if(!Jc(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return Zc(e,t,n,!1,a)},t.version="18.3.1-next-f1338f8080-20240426"},853:(e,t,n)=>{e.exports=n(234)},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,n),i.exports}n.m=e,n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,a)=>(n.f[a](e,t),t),[])),n.u=e=>"static/js/"+e+".877174a8.chunk.js",n.miniCssF=e=>{},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="dynamic-fault-tree-editor:";n.l=(a,o,i,r)=>{if(e[a])e[a].push(o);else{var l,s;if(void 0!==i)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==a||d.getAttribute("data-webpack")==t+i){l=d;break}}l||(s=!0,(l=document.createElement("script")).charset="utf-8",l.timeout=120,n.nc&&l.setAttribute("nonce",n.nc),l.setAttribute("data-webpack",t+i),l.src=a),e[a]=[o];var p=(t,n)=>{l.onerror=l.onload=null,clearTimeout(m);var o=e[a];if(delete e[a],l.parentNode&&l.parentNode.removeChild(l),o&&o.forEach(e=>e(n)),t)return t(n)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=p.bind(null,l.onerror),l.onload=p.bind(null,l.onload),s&&document.head.appendChild(l)}}})(),n.p="/",(()=>{var e={792:0};n.f.j=(t,a)=>{var o=n.o(e,t)?e[t]:void 0;if(0!==o)if(o)a.push(o[2]);else{var i=new Promise((n,a)=>o=e[t]=[n,a]);a.push(o[2]=i);var r=n.p+n.u(t),l=new Error;n.l(r,a=>{if(n.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var i=a&&("load"===a.type?"missing":a.type),r=a&&a.target&&a.target.src;l.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",l.name="ChunkLoadError",l.type=i,l.request=r,o[1](l)}},"chunk-"+t,t)}};var t=(t,a)=>{var o,i,r=a[0],l=a[1],s=a[2],c=0;if(r.some(t=>0!==e[t])){for(o in l)n.o(l,o)&&(n.m[o]=l[o]);if(s)s(n)}for(t&&t(a);c<r.length;c++)i=r[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0},a=self.webpackChunkdynamic_fault_tree_editor=self.webpackChunkdynamic_fault_tree_editor||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var a=n(43),o=n(391);function i(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;n[a]=e[a]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function l(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function s(e,t,n){return(t=l(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach(function(t){s(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const d=["sri"],p=["page"],m=["page","matches"],h=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],f=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],g=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var v="popstate";function b(){return N(function(e,t){let{pathname:n,search:a,hash:o}=e.location;return S("",{pathname:n,search:a,hash:o},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:w(t)},null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function y(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function x(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function C(e,t){return{usr:e.state,key:e.key,idx:t}}function S(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3?arguments[3]:void 0;return u(u({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?k(t):t),{},{state:n,key:t&&t.key||a||Math.random().toString(36).substring(2,10)})}function w(e){let{pathname:t="/",search:n="",hash:a=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),a&&"#"!==a&&(t+="#"===a.charAt(0)?a:"#"+a),t}function k(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let a=e.indexOf("?");a>=0&&(t.search=e.substring(a),e=e.substring(0,a)),e&&(t.pathname=e)}return t}function N(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:o=document.defaultView,v5Compat:i=!1}=a,r=o.history,l="POP",s=null,c=d();function d(){return(r.state||{idx:null}).idx}function p(){l="POP";let e=d(),t=null==e?null:e-c;c=e,s&&s({action:l,location:h.location,delta:t})}function m(e){return j(e)}null==c&&(c=0,r.replaceState(u(u({},r.state),{},{idx:c}),""));let h={get action(){return l},get location(){return e(o,r)},listen(e){if(s)throw new Error("A history only accepts one active listener");return o.addEventListener(v,p),s=e,()=>{o.removeEventListener(v,p),s=null}},createHref:e=>t(o,e),createURL:m,encodeLocation(e){let t=m(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l="PUSH";let a=S(h.location,e,t);n&&n(a,e),c=d()+1;let u=C(a,c),p=h.createHref(a);try{r.pushState(u,"",p)}catch(m){if(m instanceof DOMException&&"DataCloneError"===m.name)throw m;o.location.assign(p)}i&&s&&s({action:l,location:h.location,delta:1})},replace:function(e,t){l="REPLACE";let a=S(h.location,e,t);n&&n(a,e),c=d();let o=C(a,c),u=h.createHref(a);r.replaceState(o,"",u),i&&s&&s({action:l,location:h.location,delta:0})},go:e=>r.go(e)};return h}function j(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="http://localhost";"undefined"!==typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href),y(n,"No window.location.(origin|href) available to create URL");let a="string"===typeof e?e:w(e);return a=a.replace(/ $/,"%20"),!t&&a.startsWith("//")&&(a=n+a),new URL(a,n)}new WeakMap;function E(e,t){return M(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function M(e,t,n,a){let o=W(("string"===typeof t?k(t):t).pathname||"/",n);if(null==o)return null;let i=T(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(i);let r=null;for(let l=0;null==r&&l<i.length;++l){let e=H(o);r=L(i[l],e,a)}return r}function T(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=function(e,i){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o,l=arguments.length>3?arguments[3]:void 0,s={relativePath:void 0===l?e.path||"":l,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};if(s.relativePath.startsWith("/")){if(!s.relativePath.startsWith(a)&&r)return;y(s.relativePath.startsWith(a),'Absolute route path "'.concat(s.relativePath,'" nested under path "').concat(a,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),s.relativePath=s.relativePath.slice(a.length)}let c=K([a,s.relativePath]),u=n.concat(s);e.children&&e.children.length>0&&(y(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(c,'".')),T(e.children,t,u,c,r)),(null!=e.path||e.index)&&t.push({path:c,score:F(c,e.index),routesMeta:u})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!==(n=e.path)&&void 0!==n&&n.includes("?"))for(let a of P(e.path))i(e,t,!0,a);else i(e,t)}),t}function P(e){let t=e.split("/");if(0===t.length)return[];let[n,...a]=t,o=n.endsWith("?"),i=n.replace(/\?$/,"");if(0===a.length)return o?[i,""]:[i];let r=P(a.join("/")),l=[];return l.push(...r.map(e=>""===e?i:[i,e].join("/"))),o&&l.push(...r),l.map(t=>e.startsWith("/")&&""===t?"/":t)}var z=/^:[\w-]+$/,_=3,R=2,A=1,I=10,D=-2,O=e=>"*"===e;function F(e,t){let n=e.split("/"),a=n.length;return n.some(O)&&(a+=D),t&&(a+=R),n.filter(e=>!O(e)).reduce((e,t)=>e+(z.test(t)?_:""===t?A:I),a)}function L(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:a}=e,o={},i="/",r=[];for(let l=0;l<a.length;++l){let e=a[l],s=l===a.length-1,c="/"===i?t:t.slice(i.length)||"/",u=B({path:e.relativePath,caseSensitive:e.caseSensitive,end:s},c),d=e.route;if(!u&&s&&n&&!a[a.length-1].route.index&&(u=B({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(o,u.params),r.push({params:o,pathname:K([i,u.pathname]),pathnameBase:q(K([i,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(i=K([i,u.pathnameBase]))}return r}function B(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,a]=U(e.path,e.caseSensitive,e.end),o=t.match(n);if(!o)return null;let i=o[0],r=i.replace(/(.)\/+$/,"$1"),l=o.slice(1);return{params:a.reduce((e,t,n)=>{let{paramName:a,isOptional:o}=t;if("*"===a){let e=l[n]||"";r=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const s=l[n];return e[a]=o&&!s?void 0:(s||"").replace(/%2F/g,"/"),e},{}),pathname:i,pathnameBase:r,pattern:e}}function U(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];x("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let a=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(a.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(a.push({paramName:"*"}),o+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":""!==e&&"/"!==e&&(o+="(?:(?=\\/|$))"),[new RegExp(o,t?void 0:"i"),a]}function H(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return x(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function W(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,a=e.charAt(n);return a&&"/"!==a?null:e.slice(n)||"/"}function V(e,t,n,a){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(a),"].  Please separate it out to the `to.").concat(n,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function G(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function Y(e){let t=G(e);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function X(e,t,n){let a,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?a=k(e):(a=u({},e),y(!a.pathname||!a.pathname.includes("?"),V("?","pathname","search",a)),y(!a.pathname||!a.pathname.includes("#"),V("#","pathname","hash",a)),y(!a.search||!a.search.includes("#"),V("#","search","hash",a)));let i,r=""===e||""===a.pathname,l=r?"/":a.pathname;if(null==l)i=n;else{let e=t.length-1;if(!o&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}i=e>=0?t[e]:"/"}let s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:n,search:a="",hash:o=""}="string"===typeof e?k(e):e,i=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:i,search:$(a),hash:J(o)}}(a,i),c=l&&"/"!==l&&l.endsWith("/"),d=(r||"."===l)&&n.endsWith("/");return s.pathname.endsWith("/")||!c&&!d||(s.pathname+="/"),s}var K=e=>e.join("/").replace(/\/\/+/g,"/"),q=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),$=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",J=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function Q(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var Z=["POST","PUT","PATCH","DELETE"],ee=(new Set(Z),["GET",...Z]);new Set(ee),Symbol("ResetLoaderData");var te=a.createContext(null);te.displayName="DataRouter";var ne=a.createContext(null);ne.displayName="DataRouterState";var ae=a.createContext(!1);var oe=a.createContext({isTransitioning:!1});oe.displayName="ViewTransition";var ie=a.createContext(new Map);ie.displayName="Fetchers";var re=a.createContext(null);re.displayName="Await";var le=a.createContext(null);le.displayName="Navigation";var se=a.createContext(null);se.displayName="Location";var ce=a.createContext({outlet:null,matches:[],isDataRoute:!1});ce.displayName="Route";var ue=a.createContext(null);ue.displayName="RouteError";function de(){return null!=a.useContext(se)}function pe(){return y(de(),"useLocation() may be used only in the context of a <Router> component."),a.useContext(se).location}var me="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function he(e){a.useContext(le).static||a.useLayoutEffect(e)}function fe(){let{isDataRoute:e}=a.useContext(ce);return e?function(){let{router:e}=ke("useNavigate"),t=je("useNavigate"),n=a.useRef(!1);he(()=>{n.current=!0});let o=a.useCallback(async function(a){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};x(n.current,me),n.current&&("number"===typeof a?e.navigate(a):await e.navigate(a,u({fromRouteId:t},o)))},[e,t]);return o}():function(){y(de(),"useNavigate() may be used only in the context of a <Router> component.");let e=a.useContext(te),{basename:t,navigator:n}=a.useContext(le),{matches:o}=a.useContext(ce),{pathname:i}=pe(),r=JSON.stringify(Y(o)),l=a.useRef(!1);he(()=>{l.current=!0});let s=a.useCallback(function(a){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(x(l.current,me),!l.current)return;if("number"===typeof a)return void n.go(a);let s=X(a,JSON.parse(r),i,"path"===o.relative);null==e&&"/"!==t&&(s.pathname="/"===s.pathname?t:K([t,s.pathname])),(o.replace?n.replace:n.push)(s,o.state,o)},[t,n,r,i,e]);return s}()}a.createContext(null);function ge(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:n}=a.useContext(ce),{pathname:o}=pe(),i=JSON.stringify(Y(n));return a.useMemo(()=>X(e,JSON.parse(i),o,"path"===t),[e,i,o,t])}function ve(e,t,n,o,i){y(de(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:r}=a.useContext(le),{matches:l}=a.useContext(ce),s=l[l.length-1],c=s?s.params:{},d=s?s.pathname:"/",p=s?s.pathnameBase:"/",m=s&&s.route;{let e=m&&m.path||"";Te(d,!m||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(d,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let h,f=pe();if(t){var g;let e="string"===typeof t?k(t):t;y("/"===p||(null===(g=e.pathname)||void 0===g?void 0:g.startsWith(p)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(p,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),h=e}else h=f;let v=h.pathname||"/",b=v;if("/"!==p){let e=p.replace(/^\//,"").split("/");b="/"+v.replace(/^\//,"").split("/").slice(e.length).join("/")}let C=E(e,{pathname:b});x(m||null!=C,'No routes matched location "'.concat(h.pathname).concat(h.search).concat(h.hash,'" ')),x(null==C||void 0!==C[C.length-1].route.element||void 0!==C[C.length-1].route.Component||void 0!==C[C.length-1].route.lazy,'Matched leaf route at location "'.concat(h.pathname).concat(h.search).concat(h.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let S=Se(C&&C.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:K([p,r.encodeLocation?r.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?p:K([p,r.encodeLocation?r.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),l,n,o,i);return t&&S?a.createElement(se.Provider,{value:{location:u({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:"POP"}},S):S}function be(){let e=Ee(),t=Q(e)?"".concat(e.status," ").concat(e.statusText):e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,o="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:o},r={padding:"2px 4px",backgroundColor:o},l=null;return console.error("Error handled by React Router default ErrorBoundary:",e),l=a.createElement(a.Fragment,null,a.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),a.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",a.createElement("code",{style:r},"ErrorBoundary")," or"," ",a.createElement("code",{style:r},"errorElement")," prop on your route.")),a.createElement(a.Fragment,null,a.createElement("h2",null,"Unexpected Application Error!"),a.createElement("h3",{style:{fontStyle:"italic"}},t),n?a.createElement("pre",{style:i},n):null,l)}var ye=a.createElement(be,null),xe=class extends a.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return void 0!==this.state.error?a.createElement(ce.Provider,{value:this.props.routeContext},a.createElement(ue.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Ce(e){let{routeContext:t,match:n,children:o}=e,i=a.useContext(te);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),a.createElement(ce.Provider,{value:t},o)}function Se(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null==e){if(!n)return null;if(n.errors)e=n.matches;else{if(0!==t.length||n.initialized||!(n.matches.length>0))return null;e=n.matches}}let i=e,r=null===n||void 0===n?void 0:n.errors;if(null!=r){let e=i.findIndex(e=>e.route.id&&void 0!==(null===r||void 0===r?void 0:r[e.route.id]));y(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(r).join(","))),i=i.slice(0,Math.min(i.length,e+1))}let l=!1,s=-1;if(n)for(let a=0;a<i.length;a++){let e=i[a];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(s=a),e.route.id){let{loaderData:t,errors:a}=n,o=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!a||void 0===a[e.route.id]);if(e.route.lazy||o){l=!0,i=s>=0?i.slice(0,s+1):[i[0]];break}}}return i.reduceRight((e,c,u)=>{let d,p=!1,m=null,h=null;n&&(d=r&&c.route.id?r[c.route.id]:void 0,m=c.route.errorElement||ye,l&&(s<0&&0===u?(Te("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),p=!0,h=null):s===u&&(p=!0,h=c.route.hydrateFallbackElement||null)));let f=t.concat(i.slice(0,u+1)),g=()=>{let t;return t=d?m:p?h:c.route.Component?a.createElement(c.route.Component,null):c.route.element?c.route.element:e,a.createElement(Ce,{match:c,routeContext:{outlet:e,matches:f,isDataRoute:null!=n},children:t})};return n&&(c.route.ErrorBoundary||c.route.errorElement||0===u)?a.createElement(xe,{location:n.location,revalidation:n.revalidation,component:m,error:d,children:g(),routeContext:{outlet:null,matches:f,isDataRoute:!0},unstable_onError:o}):g()},null)}function we(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function ke(e){let t=a.useContext(te);return y(t,we(e)),t}function Ne(e){let t=a.useContext(ne);return y(t,we(e)),t}function je(e){let t=function(e){let t=a.useContext(ce);return y(t,we(e)),t}(e),n=t.matches[t.matches.length-1];return y(n.route.id,"".concat(e,' can only be used on routes that contain a unique "id"')),n.route.id}function Ee(){var e;let t=a.useContext(ue),n=Ne("useRouteError"),o=je("useRouteError");return void 0!==t?t:null===(e=n.errors)||void 0===e?void 0:e[o]}var Me={};function Te(e,t,n){t||Me[e]||(Me[e]=!0,x(!1,n))}var Pe={};function ze(e,t){e||Pe[t]||(Pe[t]=!0,console.warn(t))}a.memo(function(e){let{routes:t,future:n,state:a,unstable_onError:o}=e;return ve(t,void 0,a,o,n)});function _e(e){y(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Re(e){let{basename:t="/",children:n=null,location:o,navigationType:i="POP",navigator:r,static:l=!1}=e;y(!de(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let s=t.replace(/^\/*/,"/"),c=a.useMemo(()=>({basename:s,navigator:r,static:l,future:{}}),[s,r,l]);"string"===typeof o&&(o=k(o));let{pathname:u="/",search:d="",hash:p="",state:m=null,key:h="default"}=o,f=a.useMemo(()=>{let e=W(u,s);return null==e?null:{location:{pathname:e,search:d,hash:p,state:m,key:h},navigationType:i}},[s,u,d,p,m,h,i]);return x(null!=f,'<Router basename="'.concat(s,'"> is not able to match the URL "').concat(u).concat(d).concat(p,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==f?null:a.createElement(le.Provider,{value:c},a.createElement(se.Provider,{children:n,value:f}))}function Ae(e){let{children:t,location:n}=e;return ve(Ie(t),n)}a.Component;function Ie(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];return a.Children.forEach(e,(e,o)=>{if(!a.isValidElement(e))return;let i=[...t,o];if(e.type===a.Fragment)return void n.push.apply(n,Ie(e.props.children,i));y(e.type===_e,"[".concat("string"===typeof e.type?e.type:e.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),y(!e.props.index||!e.props.children,"An index route cannot have child routes.");let r={id:e.props.id||i.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(r.children=Ie(e.props.children,i)),n.push(r)}),n}var De="get",Oe="application/x-www-form-urlencoded";function Fe(e){return null!=e&&"string"===typeof e.tagName}var Le=null;var Be=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ue(e){return null==e||Be.has(e)?e:(x(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(Oe,'"')),null)}function He(e,t){let n,a,o,i,r;if(Fe(l=e)&&"form"===l.tagName.toLowerCase()){let r=e.getAttribute("action");a=r?W(r,t):null,n=e.getAttribute("method")||De,o=Ue(e.getAttribute("enctype"))||Oe,i=new FormData(e)}else if(function(e){return Fe(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Fe(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let r=e.form;if(null==r)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=e.getAttribute("formaction")||r.getAttribute("action");if(a=l?W(l,t):null,n=e.getAttribute("formmethod")||r.getAttribute("method")||De,o=Ue(e.getAttribute("formenctype"))||Ue(r.getAttribute("enctype"))||Oe,i=new FormData(r,e),!function(){if(null===Le)try{new FormData(document.createElement("form"),0),Le=!1}catch(e){Le=!0}return Le}()){let{name:t,type:n,value:a}=e;if("image"===n){let e=t?"".concat(t,"."):"";i.append("".concat(e,"x"),"0"),i.append("".concat(e,"y"),"0")}else t&&i.append(t,a)}}else{if(Fe(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=De,a=null,o=Oe,r=e}var l;return i&&"text/plain"===o&&(r=i,i=void 0),{action:a,method:n.toLowerCase(),encType:o,formData:i,body:r}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;function We(e){return{__html:e}}function Ve(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}Symbol("SingleFetchRedirect");function Ge(e,t,n){let a="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===a.pathname?a.pathname="_root.".concat(n):t&&"/"===W(a.pathname,t)?a.pathname="".concat(t.replace(/\/$/,""),"/_root.").concat(n):a.pathname="".concat(a.pathname.replace(/\/$/,""),".").concat(n),a}async function Ye(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Xe(e){return null!=e&&"string"===typeof e.page}function Ke(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function qe(e,t,n,a,o,i){let r=(e,t)=>!n[t]||e.route.id!==n[t].route.id,l=(e,t)=>{var a;return n[t].pathname!==e.pathname||(null===(a=n[t].route.path)||void 0===a?void 0:a.endsWith("*"))&&n[t].params["*"]!==e.params["*"]};return"assets"===i?t.filter((e,t)=>r(e,t)||l(e,t)):"data"===i?t.filter((t,i)=>{let s=a.routes[t.route.id];if(!s||!s.hasLoader)return!1;if(r(t,i)||l(t,i))return!0;if(t.route.shouldRevalidate){var c;let a=t.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:(null===(c=n[0])||void 0===c?void 0:c.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof a)return a}return!0}):[]}function $e(e,t){let{includeHydrateFallback:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a=e.map(e=>{let a=t.routes[e.route.id];if(!a)return[];let o=[a.module];return a.clientActionModule&&(o=o.concat(a.clientActionModule)),a.clientLoaderModule&&(o=o.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(o=o.concat(a.hydrateFallbackModule)),a.imports&&(o=o.concat(a.imports)),o}).flat(1),[...new Set(a)];var a}function Je(e,t){let n=new Set,a=new Set(t);return e.reduce((e,o)=>{if(t&&!Xe(o)&&"script"===o.as&&o.href&&a.has(o.href))return e;let i=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let a of n)t[a]=e[a];return t}(o));return n.has(i)||(n.add(i),e.push({key:i,link:o})),e},[])}function Qe(e,t){return"lazy"===e.mode&&!0===t}function Ze(){let e=a.useContext(te);return Ve(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function et(){let e=a.useContext(ne);return Ve(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var tt=a.createContext(void 0);function nt(){let e=a.useContext(tt);return Ve(e,"You must render this element inside a <HydratedRouter> element"),e}function at(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function ot(e,t,n){if(n&&!st)return[e[0]];if(t){let n=e.findIndex(e=>void 0!==t[e.route.id]);return e.slice(0,n+1)}return e}tt.displayName="FrameworkContext";function it(e){let{page:t}=e,n=i(e,p),{router:o}=Ze(),r=a.useMemo(()=>E(o.routes,t,o.basename),[o.routes,t,o.basename]);return r?a.createElement(lt,u({page:t,matches:r},n)):null}function rt(e){let{manifest:t,routeModules:n}=nt(),[o,i]=a.useState([]);return a.useEffect(()=>{let a=!1;return async function(e,t,n){return Je((await Promise.all(e.map(async e=>{let a=t.routes[e.route.id];if(a){let e=await Ye(a,n);return e.links?e.links():[]}return[]}))).flat(1).filter(Ke).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?u(u({},e),{},{rel:"prefetch",as:"style"}):u(u({},e),{},{rel:"prefetch"})))}(e,t,n).then(e=>{a||i(e)}),()=>{a=!0}},[e,t,n]),o}function lt(e){let{page:t,matches:n}=e,o=i(e,m),r=pe(),{manifest:l,routeModules:s}=nt(),{basename:c}=Ze(),{loaderData:d,matches:p}=et(),h=a.useMemo(()=>qe(t,n,p,l,r,"data"),[t,n,p,l,r]),f=a.useMemo(()=>qe(t,n,p,l,r,"assets"),[t,n,p,l,r]),g=a.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let e=new Set,a=!1;if(n.forEach(t=>{var n;let o=l.routes[t.route.id];o&&o.hasLoader&&(!h.some(e=>e.route.id===t.route.id)&&t.route.id in d&&null!==(n=s[t.route.id])&&void 0!==n&&n.shouldRevalidate||o.hasClientLoader?a=!0:e.add(t.route.id))}),0===e.size)return[];let o=Ge(t,c,"data");return a&&e.size>0&&o.searchParams.set("_routes",n.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[o.pathname+o.search]},[c,d,r,l,h,n,t,s]),v=a.useMemo(()=>$e(f,l),[f,l]),b=rt(f);return a.createElement(a.Fragment,null,g.map(e=>a.createElement("link",u({key:e,rel:"prefetch",as:"fetch",href:e},o))),v.map(e=>a.createElement("link",u({key:e,rel:"modulepreload",href:e},o))),b.map(e=>{let{key:t,link:n}=e;return a.createElement("link",u({key:t,nonce:o.nonce},n))}))}var st=!1;function ct(e){let{manifest:t,serverHandoffString:n,isSpaMode:o,renderMeta:r,routeDiscovery:l,ssr:s}=nt(),{router:c,static:p,staticContext:m}=Ze(),{matches:h}=et(),f=a.useContext(ae),g=Qe(l,s);r&&(r.didRenderScripts=!0);let v=ot(h,null,o);a.useEffect(()=>{st=!0},[]);let b=a.useMemo(()=>{var o;if(f)return null;let r=m?"window.__reactRouterContext = ".concat(n,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",l=p?"".concat(null!==(o=t.hmr)&&void 0!==o&&o.runtime?"import ".concat(JSON.stringify(t.hmr.runtime),";"):"").concat(g?"":"import ".concat(JSON.stringify(t.url)),";\n").concat(v.map((e,n)=>{let a="route".concat(n),o=t.routes[e.route.id];Ve(o,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:i,clientLoaderModule:r,clientMiddlewareModule:l,hydrateFallbackModule:s,module:c}=o,u=[...i?[{module:i,varName:"".concat(a,"_clientAction")}]:[],...r?[{module:r,varName:"".concat(a,"_clientLoader")}]:[],...l?[{module:l,varName:"".concat(a,"_clientMiddleware")}]:[],...s?[{module:s,varName:"".concat(a,"_HydrateFallback")}]:[],{module:c,varName:"".concat(a,"_main")}];return 1===u.length?"import * as ".concat(a," from ").concat(JSON.stringify(c),";"):[u.map(e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";')).join("\n"),"const ".concat(a," = {").concat(u.map(e=>"...".concat(e.varName)).join(","),"};")].join("\n")}).join("\n"),"\n  ").concat(g?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:n}=e,a=i(e,d),o=new Set(t.state.matches.map(e=>e.route.id)),r=t.state.location.pathname.split("/").filter(Boolean),l=["/"];for(r.pop();r.length>0;)l.push("/".concat(r.join("/"))),r.pop();l.forEach(e=>{let n=E(t.routes,e,t.basename);n&&n.forEach(e=>o.add(e.route.id))});let s=[...o].reduce((e,t)=>Object.assign(e,{[t]:a.routes[t]}),{});return u(u({},a),{},{routes:s,sri:!!n||void 0})}(t,c),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(v.map((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t)).join(","),"};\n\nimport(").concat(JSON.stringify(t.entry.module),");"):" ";return a.createElement(a.Fragment,null,a.createElement("script",u(u({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:We(r),type:void 0})),a.createElement("script",u(u({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:We(l),type:"module",async:!0})))},[]),y=st||f?[]:function(e){return[...new Set(e)]}(t.entry.imports.concat($e(v,t,{includeHydrateFallback:!0}))),x="object"===typeof t.sri?t.sri:{};return ze(!f,"The <Scripts /> element is a no-op when using RSC and can be safely removed."),st||f?null:a.createElement(a.Fragment,null,"object"===typeof t.sri?a.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:x})}}):null,g?null:a.createElement("link",{rel:"modulepreload",href:t.url,crossOrigin:e.crossOrigin,integrity:x[t.url],suppressHydrationWarning:!0}),a.createElement("link",{rel:"modulepreload",href:t.entry.module,crossOrigin:e.crossOrigin,integrity:x[t.entry.module],suppressHydrationWarning:!0}),y.map(t=>a.createElement("link",{key:t,rel:"modulepreload",href:t,crossOrigin:e.crossOrigin,integrity:x[t],suppressHydrationWarning:!0})),b)}function ut(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach(t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)})}}a.Component;function dt(e){let{error:t,isOutsideRemixApp:n}=e;console.error(t);let o,i=a.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(Q(t))return a.createElement(pt,{title:"Unhandled Thrown Response!"},a.createElement("h1",{style:{fontSize:"24px"}},t.status," ",t.statusText),i);if(t instanceof Error)o=t;else{let e=null==t?"Unknown Error":"object"===typeof t&&"toString"in t?t.toString():JSON.stringify(t);o=new Error(e)}return a.createElement(pt,{title:"Application Error!",isOutsideRemixApp:n},a.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),a.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},o.stack),i)}function pt(e){var t;let{title:n,renderScripts:o,isOutsideRemixApp:i,children:r}=e,{routeModules:l}=nt();return null!==(t=l.root)&&void 0!==t&&t.Layout&&!i?r:a.createElement("html",{lang:"en"},a.createElement("head",null,a.createElement("meta",{charSet:"utf-8"}),a.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),a.createElement("title",null,n)),a.createElement("body",null,a.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},r,o?a.createElement(ct,null):null)))}var mt="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{mt&&(window.__reactRouterVersion="7.8.2")}catch(ad){}function ht(e){let{basename:t,children:n,window:o}=e,i=a.useRef();null==i.current&&(i.current=b({window:o,v5Compat:!0}));let r=i.current,[l,s]=a.useState({action:r.action,location:r.location}),c=a.useCallback(e=>{a.startTransition(()=>s(e))},[s]);return a.useLayoutEffect(()=>r.listen(c),[r,c]),a.createElement(Re,{basename:t,children:n,location:l.location,navigationType:l.action,navigator:r})}var ft=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,gt=a.forwardRef(function(e,t){let n,{onClick:o,discover:r="render",prefetch:l="none",relative:s,reloadDocument:c,replace:d,state:p,target:m,to:f,preventScrollReset:g,viewTransition:v}=e,b=i(e,h),{basename:C}=a.useContext(le),S="string"===typeof f&&ft.test(f),k=!1;if("string"===typeof f&&S&&(n=f,mt))try{let e=new URL(window.location.href),t=f.startsWith("//")?new URL(e.protocol+f):new URL(f),n=W(t.pathname,C);t.origin===e.origin&&null!=n?f=n+t.search+t.hash:k=!0}catch(ad){x(!1,'<Link to="'.concat(f,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let N=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};y(de(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:o}=a.useContext(le),{hash:i,pathname:r,search:l}=ge(e,{relative:t}),s=r;return"/"!==n&&(s="/"===r?n:K([n,r])),o.createHref({pathname:s,search:l,hash:i})}(f,{relative:s}),[j,E,M]=function(e,t){let n=a.useContext(tt),[o,i]=a.useState(!1),[r,l]=a.useState(!1),{onFocus:s,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:p}=t,m=a.useRef(null);a.useEffect(()=>{if("render"===e&&l(!0),"viewport"===e){let e=new IntersectionObserver(e=>{e.forEach(e=>{l(e.isIntersecting)})},{threshold:.5});return m.current&&e.observe(m.current),()=>{e.disconnect()}}},[e]),a.useEffect(()=>{if(o){let e=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(e)}}},[o]);let h=()=>{i(!0)},f=()=>{i(!1),l(!1)};return n?"intent"!==e?[r,m,{}]:[r,m,{onFocus:at(s,h),onBlur:at(c,f),onMouseEnter:at(u,h),onMouseLeave:at(d,f),onTouchStart:at(p,h)}]:[!1,m,{}]}(l,b),T=function(e){let{target:t,replace:n,state:o,preventScrollReset:i,relative:r,viewTransition:l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=fe(),c=pe(),u=ge(e,{relative:r});return a.useCallback(a=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(a,t)){a.preventDefault();let t=void 0!==n?n:w(c)===w(u);s(e,{replace:t,state:o,preventScrollReset:i,relative:r,viewTransition:l})}},[c,s,u,n,o,t,e,i,r,l])}(f,{replace:d,state:p,target:m,preventScrollReset:g,relative:s,viewTransition:v});let P=a.createElement("a",u(u(u({},b),M),{},{href:n||N,onClick:k||c?o:function(e){o&&o(e),e.defaultPrevented||T(e)},ref:ut(t,E),target:m,"data-discover":S||"render"!==r?void 0:"true"}));return j&&!S?a.createElement(a.Fragment,null,P,a.createElement(it,{page:N})):P});gt.displayName="Link";var vt=a.forwardRef(function(e,t){let{"aria-current":n="page",caseSensitive:o=!1,className:r="",end:l=!1,style:s,to:c,viewTransition:d,children:p}=e,m=i(e,f),h=ge(c,{relative:m.relative}),g=pe(),v=a.useContext(ne),{navigator:b,basename:x}=a.useContext(le),C=null!=v&&function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=a.useContext(oe);y(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:o}=xt("useViewTransitionState"),i=ge(e,{relative:t});if(!n.isTransitioning)return!1;let r=W(n.currentLocation.pathname,o)||n.currentLocation.pathname,l=W(n.nextLocation.pathname,o)||n.nextLocation.pathname;return null!=B(i.pathname,l)||null!=B(i.pathname,r)}(h)&&!0===d,S=b.encodeLocation?b.encodeLocation(h).pathname:h.pathname,w=g.pathname,k=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;o||(w=w.toLowerCase(),k=k?k.toLowerCase():null,S=S.toLowerCase()),k&&x&&(k=W(k,x)||k);const N="/"!==S&&S.endsWith("/")?S.length-1:S.length;let j,E=w===S||!l&&w.startsWith(S)&&"/"===w.charAt(N),M=null!=k&&(k===S||!l&&k.startsWith(S)&&"/"===k.charAt(S.length)),T={isActive:E,isPending:M,isTransitioning:C},P=E?n:void 0;j="function"===typeof r?r(T):[r,E?"active":null,M?"pending":null,C?"transitioning":null].filter(Boolean).join(" ");let z="function"===typeof s?s(T):s;return a.createElement(gt,u(u({},m),{},{"aria-current":P,className:j,ref:t,style:z,to:c,viewTransition:d}),"function"===typeof p?p(T):p)});vt.displayName="NavLink";var bt=a.forwardRef((e,t)=>{let{discover:n="render",fetcherKey:o,navigate:r,reloadDocument:l,replace:s,state:c,method:d=De,action:p,onSubmit:m,relative:h,preventScrollReset:f,viewTransition:v}=e,b=i(e,g),x=wt(),C=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:n}=a.useContext(le),o=a.useContext(ce);y(o,"useFormAction must be used inside a RouteContext");let[i]=o.matches.slice(-1),r=u({},ge(e||".",{relative:t})),l=pe();if(null==e){r.search=l.search;let e=new URLSearchParams(r.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let n=e.toString();r.search=n?"?".concat(n):""}}e&&"."!==e||!i.route.index||(r.search=r.search?r.search.replace(/^\?/,"?index&"):"?index");"/"!==n&&(r.pathname="/"===r.pathname?n:K([n,r.pathname]));return w(r)}(p,{relative:h}),S="get"===d.toLowerCase()?"get":"post",k="string"===typeof p&&ft.test(p);return a.createElement("form",u(u({ref:t,method:S,action:C,onSubmit:l?m:e=>{if(m&&m(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,n=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||d;x(t||e.currentTarget,{fetcherKey:o,method:n,navigate:r,replace:s,state:c,relative:h,preventScrollReset:f,viewTransition:v})}},b),{},{"data-discover":k||"render"!==n?void 0:"true"}))});function yt(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function xt(e){let t=a.useContext(te);return y(t,yt(e)),t}bt.displayName="Form";var Ct=0,St=()=>"__".concat(String(++Ct),"__");function wt(){let{router:e}=xt("useSubmit"),{basename:t}=a.useContext(le),n=je("useRouteId");return a.useCallback(async function(a){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:i,method:r,encType:l,formData:s,body:c}=He(a,t);if(!1===o.navigate){let t=o.fetcherKey||St();await e.fetch(t,n,o.action||i,{preventScrollReset:o.preventScrollReset,formData:s,body:c,formMethod:o.method||r,formEncType:o.encType||l,flushSync:o.flushSync})}else await e.navigate(o.action||i,{preventScrollReset:o.preventScrollReset,formData:s,body:c,formMethod:o.method||r,formEncType:o.encType||l,replace:o.replace,state:o.state,fromRouteId:n,flushSync:o.flushSync,viewTransition:o.viewTransition})},[e,t,n])}const kt={openai:{provider:"openai",apiKey:"",model:"gpt-4o-mini",baseUrl:"https://api.openai.com/v1",temperature:.7,maxTokens:1e3,enabled:!1},anthropic:{provider:"anthropic",apiKey:"",model:"claude-3-haiku-20240307",baseUrl:"https://api.anthropic.com",temperature:.7,maxTokens:1e3,enabled:!1},gemini:{provider:"gemini",apiKey:"AIzaSyBAepcPPBOSXVSgf7gVG1J0CADoUYVn1e0",model:"gemini-1.5-flash",baseUrl:"https://generativelanguage.googleapis.com",temperature:.7,maxTokens:1e3,enabled:!1},grok:{provider:"grok",apiKey:"",model:"grok-beta",baseUrl:"https://api.x.ai/v1",temperature:.7,maxTokens:1e3,enabled:!1},local:{provider:"local",apiKey:"",model:"local-model",baseUrl:"http://localhost:11434",temperature:.7,maxTokens:1e3,enabled:!0}},Nt=e=>{try{localStorage.setItem("llm-config",JSON.stringify(e))}catch(t){console.error("Errore nel salvataggio configurazione LLM:",t)}},jt=e=>{const t=[];return e.apiKey||"local"===e.provider||t.push("API Key richiesta per ".concat(e.provider)),e.model||t.push("Modello richiesto per ".concat(e.provider)),e.temperature&&(e.temperature<0||e.temperature>2)&&t.push("Temperatura deve essere tra 0 e 2 per ".concat(e.provider)),e.maxTokens&&e.maxTokens<1&&t.push("Max tokens deve essere maggiore di 0 per ".concat(e.provider)),t};var Et=n(579);const Mt=(0,a.createContext)(void 0),Tt=()=>{const e=(0,a.useContext)(Mt);if(void 0===e)throw new Error("useLLMConfig must be used within a LLMProvider");return e},Pt=e=>{let{children:t}=e;const[n,o]=(0,a.useState)((()=>{try{const e=localStorage.getItem("llm-config");if(e){const t=JSON.parse(e);return u(u({},kt),t)}}catch(e){console.warn("Errore nel caricamento configurazione LLM:",e)}return kt})()),[i,r]=(0,a.useState)(!1),[l,s]=(0,a.useState)(localStorage.getItem("selectedLLMProvider")||"local"),c={llmConfig:n,updateLLMConfig:(0,a.useCallback)(e=>{o(e),Nt(e)},[]),showLLMConfigModal:i,setShowLLMConfigModal:r,currentProvider:l,setCurrentProvider:(0,a.useCallback)(e=>{s(e),localStorage.setItem("selectedLLMProvider",e)},[])};return(0,Et.jsx)(Mt.Provider,{value:c,children:t})},zt=(0,a.createContext)(void 0),_t=e=>{let{children:t}=e;const[n,o]=(0,a.useState)(null),[i,r]=(0,a.useState)(null),[l,s]=(0,a.useState)(null),[c,u]=(0,a.useState)(null),d={faultTreeSnapshot:n,markovChainSnapshot:i,faultTreeOpenedFile:l,markovChainOpenedFile:c,saveFaultTreeSnapshot:e=>{var t,n;e&&((null===(t=e.events)||void 0===t?void 0:t.length)>0||(null===(n=e.gates)||void 0===n?void 0:n.length)>0)&&o(JSON.stringify(e))},saveMarkovChainSnapshot:e=>{var t,n;e&&((null===(t=e.states)||void 0===t?void 0:t.length)>0||(null===(n=e.transitions)||void 0===n?void 0:n.length)>0)&&r(JSON.stringify(e))},getFaultTreeSnapshot:()=>{if(n)try{return JSON.parse(n)}catch(e){return console.error("Error parsing fault tree snapshot:",e),null}return null},getMarkovChainSnapshot:()=>{if(i)try{return JSON.parse(i)}catch(e){return console.error("Error parsing markov chain snapshot:",e),null}return null},saveFaultTreeOpenedFile:e=>{s(e)},saveMarkovChainOpenedFile:e=>{u(e)},getFaultTreeOpenedFile:()=>l,getMarkovChainOpenedFile:()=>c,clearSnapshots:()=>{o(null),r(null),s(null),u(null)}};return(0,Et.jsx)(zt.Provider,{value:d,children:t})},Rt=()=>{const e=(0,a.useContext)(zt);if(void 0===e)throw new Error("useModelPersistence must be used within a ModelPersistenceProvider");return e},At=(0,a.createContext)(void 0),It=e=>{let{children:t}=e;const[n,o]=(0,a.useState)(()=>"dark"===localStorage.getItem("shiftai-theme"));(0,a.useEffect)(()=>{localStorage.setItem("shiftai-theme",n?"dark":"light")},[n]);const i={isDarkMode:n,toggleDarkMode:()=>{o(e=>!e)},setDarkMode:e=>{o(e)}};return(0,Et.jsx)(At.Provider,{value:i,children:t})},Dt=()=>{const e=(0,a.useContext)(At);if(void 0===e)throw new Error("useTheme must be used within a ThemeProvider");return e},Ot=(0,a.createContext)(void 0),Ft=e=>{let{children:t}=e;const[n,o]=(0,a.useState)(()=>"true"===localStorage.getItem("shiftai-right-panel-collapsed"));(0,a.useEffect)(()=>{localStorage.setItem("shiftai-right-panel-collapsed",n?"true":"false")},[n]);const i={isRightPanelCollapsed:n,toggleRightPanel:()=>{o(e=>!e)},setRightPanelCollapsed:e=>{o(e)}};return(0,Et.jsx)(Ot.Provider,{value:i,children:t})},Lt=()=>{const e=(0,a.useContext)(Ot);if(void 0===e)throw new Error("usePanel must be used within a PanelProvider");return e},Bt=()=>{const e=fe(),[t,n]=(0,a.useState)(""),[o,i]=(0,a.useState)("");return(0,Et.jsx)("div",{className:"main-page",children:(0,Et.jsx)("div",{className:"login-container",children:(0,Et.jsxs)("div",{className:"login-form",children:[(0,Et.jsx)("h1",{children:"SHIFTAI"}),(0,Et.jsx)("h2",{children:"Dynamic Fault Tree & Markov Chain Editor"}),(0,Et.jsxs)("form",{onSubmit:t=>{t.preventDefault(),e("/fault-tree-editor")},children:[(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{htmlFor:"username",children:"Username:"}),(0,Et.jsx)("input",{type:"text",id:"username",value:t,onChange:e=>n(e.target.value),placeholder:"Enter your username",required:!0})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{htmlFor:"password",children:"Password:"}),(0,Et.jsx)("input",{type:"password",id:"password",value:o,onChange:e=>i(e.target.value),placeholder:"Enter your password",required:!0})]}),(0,Et.jsx)("button",{type:"submit",className:"login-button",children:"Login"})]}),(0,Et.jsxs)("div",{className:"modeling-options",children:[(0,Et.jsx)("h3",{children:"Available Modeling Tools:"}),(0,Et.jsxs)("div",{className:"tool-cards",children:[(0,Et.jsxs)("div",{className:"tool-card",children:[(0,Et.jsx)("h4",{children:"Fault Tree Editor"}),(0,Et.jsx)("p",{children:"Create and analyze dynamic fault trees with static and dynamic gates"})]}),(0,Et.jsxs)("div",{className:"tool-card",children:[(0,Et.jsx)("h4",{children:"Markov Chain Editor"}),(0,Et.jsx)("p",{children:"Model and analyze Markov chains with states and transitions"})]})]})]})]})})})},Ut=e=>{let{onSave:t,onOpenWithFileSystem:n,onExportCode:o,onShowSaveModal:i,onExportXML:r,onExportCSV:l,onExportMatlab:s,onShowLLMConfig:c,onShowSHyFTA:u,onShowMSolver:d,isDarkMode:p,onToggleDarkMode:m,onNewModel:h,onClearAllModels:f,openedFile:g,currentEditor:v,onNavigateToFaultTree:b,onNavigateToMarkov:y,onLogout:x}=e;const[C,S]=(0,a.useState)(!1);return(0,Et.jsxs)("div",{className:"menu-bar ".concat(p?"dark-mode":""),children:[(0,Et.jsxs)("div",{className:"menu-section",children:[(0,Et.jsxs)("div",{className:"editor-navigation",children:[(0,Et.jsx)("button",{className:"editor-nav-button ".concat("fault-tree"===v?"active":""),onClick:b,children:"\ud83c\udf33 Fault Tree Editor"}),(0,Et.jsx)("button",{className:"editor-nav-button ".concat("markov-chain"===v?"active":""),onClick:y,children:"\ud83d\udd17 Markov Chain Editor"})]}),g&&(0,Et.jsx)("div",{className:"file-info",children:(0,Et.jsxs)("span",{children:["\ud83d\udcc1 File aperto: ",g.filename]})})]}),(0,Et.jsxs)("div",{className:"menu-section",children:[(0,Et.jsxs)("div",{className:"menu-dropdown",children:[(0,Et.jsxs)("button",{className:"menu-button dropdown-toggle",onClick:()=>S(!C),children:["\ud83d\udcc1 File ",C?"\u25bc":"\u25b6"]}),C&&(0,Et.jsxs)("div",{className:"dropdown-menu",children:[(0,Et.jsx)("button",{className:"dropdown-item",onClick:h,children:"\ud83c\udd95 Nuovo"}),f&&(0,Et.jsx)("button",{className:"dropdown-item",onClick:f,children:"\ud83d\uddd1\ufe0f Pulisci tutti i modelli"}),(0,Et.jsx)("button",{className:"dropdown-item",onClick:n,children:"\ud83d\udcc2 Apri File (.json)"}),(0,Et.jsx)("div",{className:"dropdown-divider"}),(0,Et.jsx)("button",{className:"dropdown-item",onClick:()=>{t(),S(!1)},children:"\ud83d\udcbe Salvataggio Rapido (JSON)"}),(0,Et.jsx)("button",{className:"dropdown-item",onClick:()=>{i(),S(!1)},children:"\ud83d\udcbe Salva Come... (Nuovo File)"}),(0,Et.jsx)("div",{className:"dropdown-divider"}),(0,Et.jsx)("button",{className:"dropdown-item",onClick:r,children:"\ud83d\udcc4 Esporta XML"}),(0,Et.jsx)("button",{className:"dropdown-item",onClick:l,children:"\ud83d\udcca Esporta CSV"}),(0,Et.jsx)("button",{className:"dropdown-item",onClick:s,children:"\ud83e\uddee Esporta MATLAB"}),(0,Et.jsx)("div",{className:"dropdown-divider"}),(0,Et.jsx)("button",{className:"dropdown-item",onClick:o,children:"\ud83d\udd27 Esporta Codice"})]})]}),(0,Et.jsx)("button",{className:"menu-button",onClick:n,children:"\ud83d\udd13 Apri"}),(0,Et.jsxs)("button",{className:"menu-button primary",onClick:t,children:["\ud83d\udcbe Salva ",null!==g&&void 0!==g&&g.fileHandle?"(Sovrascrivi)":"(Nuovo File)"]}),(0,Et.jsx)("button",{className:"menu-button config",onClick:c,children:"\u2699\ufe0f LLM"}),(0,Et.jsxs)("button",{className:"menu-button dark-toggle",onClick:m,children:[p?"\u2600\ufe0f":"\ud83c\udf19"," ",p?"Light":"Dark"]}),(0,Et.jsx)("button",{className:"menu-button shyfta ".concat("fault-tree"!==v?"disabled":""),onClick:"fault-tree"===v?u:void 0,disabled:"fault-tree"!==v,children:"\ud83d\udd2c SHyFTA"}),(0,Et.jsx)("button",{className:"menu-button msolver ".concat("markov-chain"!==v?"disabled":""),onClick:"markov-chain"===v?d:void 0,disabled:"markov-chain"!==v,children:"\ud83d\udcca MSolver"}),(0,Et.jsx)("button",{className:"menu-button logout",onClick:x,children:"\ud83d\udeaa Logout"})]})]})},Ht=e=>{let{onAddBaseEvent:t,onAddGate:n,clickToPlaceMode:a,onToggleClickToPlace:o,componentToPlace:i,missionTime:r,onMissionTimeChange:l,isDarkMode:s,isCollapsed:c,onToggleCollapse:u}=e;return(0,Et.jsxs)("div",{className:"left-panel ".concat(s?"dark-mode":""," ").concat(c?"collapsed":""),children:[(0,Et.jsx)("div",{className:"panel-header",children:(0,Et.jsxs)("div",{className:"header-content",children:[(0,Et.jsx)("h3",{children:"\ud83d\udd27 Componenti"}),(0,Et.jsx)("button",{className:"collapse-toggle",onClick:u,title:c?"Mostra pannello":"Nascondi pannello",children:c?"\u25b6":"\u25c0"})]})}),!c&&(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsxs)("div",{className:"component-section",children:[(0,Et.jsx)("h4",{children:"\u23f1\ufe0f Parametri Analisi"}),(0,Et.jsxs)("div",{className:"mission-time-group",children:[(0,Et.jsx)("label",{htmlFor:"mission-time",children:"Tempo di Missione (Tm) [h]:"}),(0,Et.jsx)("input",{id:"mission-time",type:"number",value:r,onChange:e=>l(Number(e.target.value)||0),placeholder:"500",min:"0",step:"0.1",className:"mission-time-input"})]}),(0,Et.jsxs)("div",{className:"placement-mode-toggle",children:[(0,Et.jsxs)("label",{className:"toggle-container",children:[(0,Et.jsx)("span",{className:"toggle-label",children:a?"\ud83d\udccd Click to Place":"\ud83c\udfaf Instant Add"}),(0,Et.jsxs)("div",{className:"toggle-switch",children:[(0,Et.jsx)("input",{type:"checkbox",checked:a,onChange:o}),(0,Et.jsx)("span",{className:"toggle-slider"})]})]}),i&&(0,Et.jsxs)("div",{className:"component-selected",children:[(0,Et.jsx)("span",{children:"\ud83c\udfaf Selezionato: "}),(0,Et.jsx)("strong",{children:"event"===i.type?"Evento Base":"Porta ".concat(i.gateType)}),(0,Et.jsx)("br",{}),(0,Et.jsx)("small",{children:"Clicca sul diagramma per posizionare (rimane selezionato)"})]})]})]}),(0,Et.jsxs)("div",{className:"component-section",children:[(0,Et.jsx)("h4",{children:"Eventi Base"}),(0,Et.jsxs)("button",{className:"component-button event-button ".concat("event"===(null===i||void 0===i?void 0:i.type)?"selected":""),onClick:t,title:a?"Seleziona per posizionamento":"Aggiungi Evento Base",children:[(0,Et.jsx)("div",{className:"component-icon",children:"\u2b1c"}),(0,Et.jsx)("div",{className:"component-label",children:"Evento Base"}),"event"===(null===i||void 0===i?void 0:i.type)&&(0,Et.jsx)("div",{className:"selection-indicator",children:"\u2713"})]})]}),(0,Et.jsxs)("div",{className:"component-section",children:[(0,Et.jsx)("h4",{children:"Porte Logiche"}),(0,Et.jsx)("div",{className:"gates-grid",children:[{type:"AND",label:"AND",description:"Porta AND - Tutti gli input devono verificarsi",icon:"\u2227"},{type:"OR",label:"OR",description:"Porta OR - Almeno un input deve verificarsi",icon:"\u2228"},{type:"PAND",label:"PAND",description:"Porta AND Prioritaria - Input in sequenza specifica",icon:"\u2295"},{type:"SPARE",label:"SPARE",description:"Porta SPARE - Ridondanza con spare",icon:"\u27f2"},{type:"SEQ",label:"SEQ",description:"Porta Sequenziale - Input in ordine temporale",icon:"\u2192"},{type:"FDEP",label:"FDEP",description:"Dipendenza Funzionale",icon:"\u27f9"}].map(e=>(0,Et.jsxs)("button",{className:"component-button gate-button ".concat("gate"===(null===i||void 0===i?void 0:i.type)&&(null===i||void 0===i?void 0:i.gateType)===e.type?"selected":""),onClick:()=>n(e.type),title:a?"Seleziona ".concat(e.label," per posizionamento"):e.description,children:[(0,Et.jsx)("div",{className:"component-icon",children:e.icon}),(0,Et.jsx)("div",{className:"component-label",children:e.label}),"gate"===(null===i||void 0===i?void 0:i.type)&&(null===i||void 0===i?void 0:i.gateType)===e.type&&(0,Et.jsx)("div",{className:"selection-indicator",children:"\u2713"})]},e.type))})]}),(0,Et.jsxs)("div",{className:"component-section",children:[(0,Et.jsx)("h4",{children:"Istruzioni"}),(0,Et.jsxs)("div",{className:"instructions",children:[a?(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsxs)("p",{children:["\ud83d\udccd ",(0,Et.jsx)("strong",{children:"Modalit\xe0 Click-to-Place:"})]}),(0,Et.jsx)("p",{children:"\u2022 Clicca un componente per selezionarlo"}),(0,Et.jsx)("p",{children:"\u2022 Clicca sul diagramma per posizionarlo (centrato)"}),(0,Et.jsx)("p",{children:"\u2022 Il componente rimane selezionato per pi\xf9 posizionamenti"}),(0,Et.jsx)("p",{children:"\u2022 Disattiva la modalit\xe0 per deselezionare"})]}):(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsxs)("p",{children:["\ud83c\udfaf ",(0,Et.jsx)("strong",{children:"Modalit\xe0 Instant Add:"})]}),(0,Et.jsx)("p",{children:"\u2022 Clicca sui componenti per aggiungerli subito"}),(0,Et.jsx)("p",{children:"\u2022 Posizione casuale automatica"}),(0,Et.jsx)("p",{children:"\u2022 Trascina per riposizionare"})]}),(0,Et.jsx)("p",{children:"\u2022 Clicca su un componente per modificarne i parametri"}),(0,Et.jsx)("p",{children:"\u2022 Collega gli elementi alle porte trascinando"})]})]})]})]})};function Wt(e){if("string"===typeof e||"number"===typeof e)return""+e;let t="";if(Array.isArray(e))for(let n,a=0;a<e.length;a++)""!==(n=Wt(e[a]))&&(t+=(t&&" ")+n);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var Vt=n(443);const Gt=e=>{let t;const n=new Set,a=(e,a)=>{const o="function"===typeof e?e(t):e;if(!Object.is(o,t)){const e=t;t=(null!=a?a:"object"!==typeof o||null===o)?o:Object.assign({},t,o),n.forEach(n=>n(t,e))}},o=()=>t,i={setState:a,getState:o,getInitialState:()=>r,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},r=t=e(a,o,i);return i},Yt=e=>e?Gt(e):Gt;const{useDebugValue:Xt}=a,{useSyncExternalStoreWithSelector:Kt}=Vt,qt=e=>e;function $t(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qt,n=arguments.length>2?arguments[2]:void 0;const a=Kt(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Xt(a),a}const Jt=(e,t)=>{const n=Yt(e),a=function(e){return $t(n,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:t)};return Object.assign(a,n),a};function Qt(e,t){if(Object.is(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,a]of e)if(!Object.is(a,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const a of n)if(!Object.prototype.hasOwnProperty.call(t,a)||!Object.is(e[a],t[a]))return!1;return!0}var Zt={value:()=>{}};function en(){for(var e,t=0,n=arguments.length,a={};t<n;++t){if(!(e=arguments[t]+"")||e in a||/[\s.]/.test(e))throw new Error("illegal type: "+e);a[e]=[]}return new tn(a)}function tn(e){this._=e}function nn(e,t){for(var n,a=0,o=e.length;a<o;++a)if((n=e[a]).name===t)return n.value}function an(e,t,n){for(var a=0,o=e.length;a<o;++a)if(e[a].name===t){e[a]=Zt,e=e.slice(0,a).concat(e.slice(a+1));break}return null!=n&&e.push({name:t,value:n}),e}tn.prototype=en.prototype={constructor:tn,on:function(e,t){var n,a,o=this._,i=(a=o,(e+"").trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");if(n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),e&&!a.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}})),r=-1,l=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!==typeof t)throw new Error("invalid callback: "+t);for(;++r<l;)if(n=(e=i[r]).type)o[n]=an(o[n],e.name,t);else if(null==t)for(n in o)o[n]=an(o[n],e.name,null);return this}for(;++r<l;)if((n=(e=i[r]).type)&&(n=nn(o[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new tn(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,a,o=new Array(n),i=0;i<n;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,n=(a=this._[e]).length;i<n;++i)a[i].value.apply(t,o)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var a=this._[e],o=0,i=a.length;o<i;++o)a[o].value.apply(t,n)}};const on=en;function rn(){}function ln(e){return null==e?rn:function(){return this.querySelector(e)}}function sn(){return[]}function cn(e){return null==e?sn:function(){return this.querySelectorAll(e)}}function un(e){return function(){return null==(t=e.apply(this,arguments))?[]:Array.isArray(t)?t:Array.from(t);var t}}function dn(e){return function(){return this.matches(e)}}function pn(e){return function(t){return t.matches(e)}}var mn=Array.prototype.find;function hn(){return this.firstElementChild}var fn=Array.prototype.filter;function gn(){return Array.from(this.children)}function vn(e){return new Array(e.length)}function bn(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function yn(e,t,n,a,o,i){for(var r,l=0,s=t.length,c=i.length;l<c;++l)(r=t[l])?(r.__data__=i[l],a[l]=r):n[l]=new bn(e,i[l]);for(;l<s;++l)(r=t[l])&&(o[l]=r)}function xn(e,t,n,a,o,i,r){var l,s,c,u=new Map,d=t.length,p=i.length,m=new Array(d);for(l=0;l<d;++l)(s=t[l])&&(m[l]=c=r.call(s,s.__data__,l,t)+"",u.has(c)?o[l]=s:u.set(c,s));for(l=0;l<p;++l)c=r.call(e,i[l],l,i)+"",(s=u.get(c))?(a[l]=s,s.__data__=i[l],u.delete(c)):n[l]=new bn(e,i[l]);for(l=0;l<d;++l)(s=t[l])&&u.get(m[l])===s&&(o[l]=s)}function Cn(e){return e.__data__}function Sn(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function wn(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}bn.prototype={constructor:bn,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var kn="http://www.w3.org/1999/xhtml";const Nn={svg:"http://www.w3.org/2000/svg",xhtml:kn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function jn(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),Nn.hasOwnProperty(t)?{space:Nn[t],local:e}:e}function En(e){return function(){this.removeAttribute(e)}}function Mn(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Tn(e,t){return function(){this.setAttribute(e,t)}}function Pn(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function zn(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function _n(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Rn(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function An(e){return function(){this.style.removeProperty(e)}}function In(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Dn(e,t,n){return function(){var a=t.apply(this,arguments);null==a?this.style.removeProperty(e):this.style.setProperty(e,a,n)}}function On(e,t){return e.style.getPropertyValue(t)||Rn(e).getComputedStyle(e,null).getPropertyValue(t)}function Fn(e){return function(){delete this[e]}}function Ln(e,t){return function(){this[e]=t}}function Bn(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function Un(e){return e.trim().split(/^|\s+/)}function Hn(e){return e.classList||new Wn(e)}function Wn(e){this._node=e,this._names=Un(e.getAttribute("class")||"")}function Vn(e,t){for(var n=Hn(e),a=-1,o=t.length;++a<o;)n.add(t[a])}function Gn(e,t){for(var n=Hn(e),a=-1,o=t.length;++a<o;)n.remove(t[a])}function Yn(e){return function(){Vn(this,e)}}function Xn(e){return function(){Gn(this,e)}}function Kn(e,t){return function(){(t.apply(this,arguments)?Vn:Gn)(this,e)}}function qn(){this.textContent=""}function $n(e){return function(){this.textContent=e}}function Jn(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function Qn(){this.innerHTML=""}function Zn(e){return function(){this.innerHTML=e}}function ea(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function ta(){this.nextSibling&&this.parentNode.appendChild(this)}function na(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function aa(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===kn&&t.documentElement.namespaceURI===kn?t.createElement(e):t.createElementNS(n,e)}}function oa(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function ia(e){var t=jn(e);return(t.local?oa:aa)(t)}function ra(){return null}function la(){var e=this.parentNode;e&&e.removeChild(this)}function sa(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function ca(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function ua(e){return function(){var t=this.__on;if(t){for(var n,a=0,o=-1,i=t.length;a<i;++a)n=t[a],e.type&&n.type!==e.type||n.name!==e.name?t[++o]=n:this.removeEventListener(n.type,n.listener,n.options);++o?t.length=o:delete this.__on}}}function da(e,t,n){return function(){var a,o=this.__on,i=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(o)for(var r=0,l=o.length;r<l;++r)if((a=o[r]).type===e.type&&a.name===e.name)return this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=i,a.options=n),void(a.value=t);this.addEventListener(e.type,i,n),a={type:e.type,name:e.name,value:t,listener:i,options:n},o?o.push(a):this.__on=[a]}}function pa(e,t,n){var a=Rn(e),o=a.CustomEvent;"function"===typeof o?o=new o(t,n):(o=a.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function ma(e,t){return function(){return pa(this,e,t)}}function ha(e,t){return function(){return pa(this,e,t.apply(this,arguments))}}Wn.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var fa=[null];function ga(e,t){this._groups=e,this._parents=t}function va(){return new ga([[document.documentElement]],fa)}ga.prototype=va.prototype={constructor:ga,select:function(e){"function"!==typeof e&&(e=ln(e));for(var t=this._groups,n=t.length,a=new Array(n),o=0;o<n;++o)for(var i,r,l=t[o],s=l.length,c=a[o]=new Array(s),u=0;u<s;++u)(i=l[u])&&(r=e.call(i,i.__data__,u,l))&&("__data__"in i&&(r.__data__=i.__data__),c[u]=r);return new ga(a,this._parents)},selectAll:function(e){e="function"===typeof e?un(e):cn(e);for(var t=this._groups,n=t.length,a=[],o=[],i=0;i<n;++i)for(var r,l=t[i],s=l.length,c=0;c<s;++c)(r=l[c])&&(a.push(e.call(r,r.__data__,c,l)),o.push(r));return new ga(a,o)},selectChild:function(e){return this.select(null==e?hn:function(e){return function(){return mn.call(this.children,e)}}("function"===typeof e?e:pn(e)))},selectChildren:function(e){return this.selectAll(null==e?gn:function(e){return function(){return fn.call(this.children,e)}}("function"===typeof e?e:pn(e)))},filter:function(e){"function"!==typeof e&&(e=dn(e));for(var t=this._groups,n=t.length,a=new Array(n),o=0;o<n;++o)for(var i,r=t[o],l=r.length,s=a[o]=[],c=0;c<l;++c)(i=r[c])&&e.call(i,i.__data__,c,r)&&s.push(i);return new ga(a,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,Cn);var n,a=t?xn:yn,o=this._parents,i=this._groups;"function"!==typeof e&&(n=e,e=function(){return n});for(var r=i.length,l=new Array(r),s=new Array(r),c=new Array(r),u=0;u<r;++u){var d=o[u],p=i[u],m=p.length,h=Sn(e.call(d,d&&d.__data__,u,o)),f=h.length,g=s[u]=new Array(f),v=l[u]=new Array(f);a(d,p,g,v,c[u]=new Array(m),h,t);for(var b,y,x=0,C=0;x<f;++x)if(b=g[x]){for(x>=C&&(C=x+1);!(y=v[C])&&++C<f;);b._next=y||null}}return(l=new ga(l,o))._enter=s,l._exit=c,l},enter:function(){return new ga(this._enter||this._groups.map(vn),this._parents)},exit:function(){return new ga(this._exit||this._groups.map(vn),this._parents)},join:function(e,t,n){var a=this.enter(),o=this,i=this.exit();return"function"===typeof e?(a=e(a))&&(a=a.selection()):a=a.append(e+""),null!=t&&(o=t(o))&&(o=o.selection()),null==n?i.remove():n(i),a&&o?a.merge(o).order():o},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,a=t._groups,o=n.length,i=a.length,r=Math.min(o,i),l=new Array(o),s=0;s<r;++s)for(var c,u=n[s],d=a[s],p=u.length,m=l[s]=new Array(p),h=0;h<p;++h)(c=u[h]||d[h])&&(m[h]=c);for(;s<o;++s)l[s]=n[s];return new ga(l,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var a,o=e[t],i=o.length-1,r=o[i];--i>=0;)(a=o[i])&&(r&&4^a.compareDocumentPosition(r)&&r.parentNode.insertBefore(a,r),r=a);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=wn);for(var n=this._groups,a=n.length,o=new Array(a),i=0;i<a;++i){for(var r,l=n[i],s=l.length,c=o[i]=new Array(s),u=0;u<s;++u)(r=l[u])&&(c[u]=r);c.sort(t)}return new ga(o,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var a=e[t],o=0,i=a.length;o<i;++o){var r=a[o];if(r)return r}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,a=t.length;n<a;++n)for(var o,i=t[n],r=0,l=i.length;r<l;++r)(o=i[r])&&e.call(o,o.__data__,r,i);return this},attr:function(e,t){var n=jn(e);if(arguments.length<2){var a=this.node();return n.local?a.getAttributeNS(n.space,n.local):a.getAttribute(n)}return this.each((null==t?n.local?Mn:En:"function"===typeof t?n.local?_n:zn:n.local?Pn:Tn)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?An:"function"===typeof t?Dn:In)(e,t,null==n?"":n)):On(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?Fn:"function"===typeof t?Bn:Ln)(e,t)):this.node()[e]},classed:function(e,t){var n=Un(e+"");if(arguments.length<2){for(var a=Hn(this.node()),o=-1,i=n.length;++o<i;)if(!a.contains(n[o]))return!1;return!0}return this.each(("function"===typeof t?Kn:t?Yn:Xn)(n,t))},text:function(e){return arguments.length?this.each(null==e?qn:("function"===typeof e?Jn:$n)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?Qn:("function"===typeof e?ea:Zn)(e)):this.node().innerHTML},raise:function(){return this.each(ta)},lower:function(){return this.each(na)},append:function(e){var t="function"===typeof e?e:ia(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"===typeof e?e:ia(e),a=null==t?ra:"function"===typeof t?t:ln(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),a.apply(this,arguments)||null)})},remove:function(){return this.each(la)},clone:function(e){return this.select(e?ca:sa)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var a,o,i=function(e){return e.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}(e+""),r=i.length;if(!(arguments.length<2)){for(l=t?da:ua,a=0;a<r;++a)this.each(l(i[a],t,n));return this}var l=this.node().__on;if(l)for(var s,c=0,u=l.length;c<u;++c)for(a=0,s=l[c];a<r;++a)if((o=i[a]).type===s.type&&o.name===s.name)return s.value},dispatch:function(e,t){return this.each(("function"===typeof t?ha:ma)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var a,o=e[t],i=0,r=o.length;i<r;++i)(a=o[i])&&(yield a)}};const ba=va;function ya(e){return"string"===typeof e?new ga([[document.querySelector(e)]],[document.documentElement]):new ga([[e]],fa)}const xa={passive:!1},Ca={capture:!0,passive:!1};function Sa(e){e.stopImmediatePropagation()}function wa(e){e.preventDefault(),e.stopImmediatePropagation()}function ka(e){var t=e.document.documentElement,n=ya(e).on("dragstart.drag",wa,Ca);"onselectstart"in t?n.on("selectstart.drag",wa,Ca):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Na(e,t){var n=e.document.documentElement,a=ya(e).on("dragstart.drag",null);t&&(a.on("click.drag",wa,Ca),setTimeout(function(){a.on("click.drag",null)},0)),"onselectstart"in n?a.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function ja(e){return((e=Math.exp(e))+1/e)/2}const Ea=function e(t,n,a){function o(e,o){var i,r,l=e[0],s=e[1],c=e[2],u=o[0],d=o[1],p=o[2],m=u-l,h=d-s,f=m*m+h*h;if(f<1e-12)r=Math.log(p/c)/t,i=function(e){return[l+e*m,s+e*h,c*Math.exp(t*e*r)]};else{var g=Math.sqrt(f),v=(p*p-c*c+a*f)/(2*c*n*g),b=(p*p-c*c-a*f)/(2*p*n*g),y=Math.log(Math.sqrt(v*v+1)-v),x=Math.log(Math.sqrt(b*b+1)-b);r=(x-y)/t,i=function(e){var a,o=e*r,i=ja(y),u=c/(n*g)*(i*(a=t*o+y,((a=Math.exp(2*a))-1)/(a+1))-function(e){return((e=Math.exp(e))-1/e)/2}(y));return[l+u*m,s+u*h,c*i/ja(t*o+y)]}}return i.duration=1e3*r*t/Math.SQRT2,i}return o.rho=function(t){var n=Math.max(.001,+t),a=n*n;return e(n,a,a*a)},o}(Math.SQRT2,2,4);function Ma(e,t){if(e=function(e){let t;for(;t=e.sourceEvent;)e=t;return e}(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var a=n.createSVGPoint();return a.x=e.clientX,a.y=e.clientY,[(a=a.matrixTransform(t.getScreenCTM().inverse())).x,a.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}var Ta,Pa,za=0,_a=0,Ra=0,Aa=0,Ia=0,Da=0,Oa="object"===typeof performance&&performance.now?performance:Date,Fa="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function La(){return Ia||(Fa(Ba),Ia=Oa.now()+Da)}function Ba(){Ia=0}function Ua(){this._call=this._time=this._next=null}function Ha(e,t,n){var a=new Ua;return a.restart(e,t,n),a}function Wa(){Ia=(Aa=Oa.now())+Da,za=_a=0;try{!function(){La(),++za;for(var e,t=Ta;t;)(e=Ia-t._time)>=0&&t._call.call(void 0,e),t=t._next;--za}()}finally{za=0,function(){var e,t,n=Ta,a=1/0;for(;n;)n._call?(a>n._time&&(a=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:Ta=t);Pa=e,Ga(a)}(),Ia=0}}function Va(){var e=Oa.now(),t=e-Aa;t>1e3&&(Da-=t,Aa=e)}function Ga(e){za||(_a&&(_a=clearTimeout(_a)),e-Ia>24?(e<1/0&&(_a=setTimeout(Wa,e-Oa.now()-Da)),Ra&&(Ra=clearInterval(Ra))):(Ra||(Aa=Oa.now(),Ra=setInterval(Va,1e3)),za=1,Fa(Wa)))}function Ya(e,t,n){var a=new Ua;return t=null==t?0:+t,a.restart(n=>{a.stop(),e(n+t)},t,n),a}Ua.prototype=Ha.prototype={constructor:Ua,restart:function(e,t,n){if("function"!==typeof e)throw new TypeError("callback is not a function");n=(null==n?La():+n)+(null==t?0:+t),this._next||Pa===this||(Pa?Pa._next=this:Ta=this,Pa=this),this._call=e,this._time=n,Ga()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ga())}};var Xa=on("start","end","cancel","interrupt"),Ka=[];function qa(e,t,n,a,o,i){var r=e.__transition;if(r){if(n in r)return}else e.__transition={};!function(e,t,n){var a,o=e.__transition;function i(e){n.state=1,n.timer.restart(r,n.delay,n.time),n.delay<=e&&r(e-n.delay)}function r(i){var c,u,d,p;if(1!==n.state)return s();for(c in o)if((p=o[c]).name===n.name){if(3===p.state)return Ya(r);4===p.state?(p.state=6,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete o[c]):+c<t&&(p.state=6,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete o[c])}if(Ya(function(){3===n.state&&(n.state=4,n.timer.restart(l,n.delay,n.time),l(i))}),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,a=new Array(d=n.tween.length),c=0,u=-1;c<d;++c)(p=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(a[++u]=p);a.length=u+1}}function l(t){for(var o=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(s),n.state=5,1),i=-1,r=a.length;++i<r;)a[i].call(e,o);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),s())}function s(){for(var a in n.state=6,n.timer.stop(),delete o[t],o)return;delete e.__transition}o[t]=n,n.timer=Ha(i,0,n.time)}(e,n,{name:t,index:a,group:o,on:Xa,tween:Ka,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:0})}function $a(e,t){var n=Qa(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function Ja(e,t){var n=Qa(e,t);if(n.state>3)throw new Error("too late; already running");return n}function Qa(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Za(e,t){var n,a,o,i=e.__transition,r=!0;if(i){for(o in t=null==t?null:t+"",i)(n=i[o]).name===t?(a=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(a?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete i[o]):r=!1;r&&delete e.__transition}}function eo(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var to,no=180/Math.PI,ao={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function oo(e,t,n,a,o,i){var r,l,s;return(r=Math.sqrt(e*e+t*t))&&(e/=r,t/=r),(s=e*n+t*a)&&(n-=e*s,a-=t*s),(l=Math.sqrt(n*n+a*a))&&(n/=l,a/=l,s/=l),e*a<t*n&&(e=-e,t=-t,s=-s,r=-r),{translateX:o,translateY:i,rotate:Math.atan2(t,e)*no,skewX:Math.atan(s)*no,scaleX:r,scaleY:l}}function io(e,t,n,a){function o(e){return e.length?e.pop()+" ":""}return function(i,r){var l=[],s=[];return i=e(i),r=e(r),function(e,a,o,i,r,l){if(e!==o||a!==i){var s=r.push("translate(",null,t,null,n);l.push({i:s-4,x:eo(e,o)},{i:s-2,x:eo(a,i)})}else(o||i)&&r.push("translate("+o+t+i+n)}(i.translateX,i.translateY,r.translateX,r.translateY,l,s),function(e,t,n,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),i.push({i:n.push(o(n)+"rotate(",null,a)-2,x:eo(e,t)})):t&&n.push(o(n)+"rotate("+t+a)}(i.rotate,r.rotate,l,s),function(e,t,n,i){e!==t?i.push({i:n.push(o(n)+"skewX(",null,a)-2,x:eo(e,t)}):t&&n.push(o(n)+"skewX("+t+a)}(i.skewX,r.skewX,l,s),function(e,t,n,a,i,r){if(e!==n||t!==a){var l=i.push(o(i)+"scale(",null,",",null,")");r.push({i:l-4,x:eo(e,n)},{i:l-2,x:eo(t,a)})}else 1===n&&1===a||i.push(o(i)+"scale("+n+","+a+")")}(i.scaleX,i.scaleY,r.scaleX,r.scaleY,l,s),i=r=null,function(e){for(var t,n=-1,a=s.length;++n<a;)l[(t=s[n]).i]=t.x(e);return l.join("")}}}var ro=io(function(e){const t=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?ao:oo(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),lo=io(function(e){return null==e?ao:(to||(to=document.createElementNS("http://www.w3.org/2000/svg","g")),to.setAttribute("transform",e),(e=to.transform.baseVal.consolidate())?oo((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):ao)},", ",")",")");function so(e,t){var n,a;return function(){var o=Ja(this,e),i=o.tween;if(i!==n)for(var r=0,l=(a=n=i).length;r<l;++r)if(a[r].name===t){(a=a.slice()).splice(r,1);break}o.tween=a}}function co(e,t,n){var a,o;if("function"!==typeof n)throw new Error;return function(){var i=Ja(this,e),r=i.tween;if(r!==a){o=(a=r).slice();for(var l={name:t,value:n},s=0,c=o.length;s<c;++s)if(o[s].name===t){o[s]=l;break}s===c&&o.push(l)}i.tween=o}}function uo(e,t,n){var a=e._id;return e.each(function(){var e=Ja(this,a);(e.value||(e.value={}))[t]=n.apply(this,arguments)}),function(e){return Qa(e,a).value[t]}}function po(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function mo(e,t){var n=Object.create(e.prototype);for(var a in t)n[a]=t[a];return n}function ho(){}var fo=.7,go=1/fo,vo="\\s*([+-]?\\d+)\\s*",bo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",yo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",xo=/^#([0-9a-f]{3,8})$/,Co=new RegExp("^rgb\\(".concat(vo,",").concat(vo,",").concat(vo,"\\)$")),So=new RegExp("^rgb\\(".concat(yo,",").concat(yo,",").concat(yo,"\\)$")),wo=new RegExp("^rgba\\(".concat(vo,",").concat(vo,",").concat(vo,",").concat(bo,"\\)$")),ko=new RegExp("^rgba\\(".concat(yo,",").concat(yo,",").concat(yo,",").concat(bo,"\\)$")),No=new RegExp("^hsl\\(".concat(bo,",").concat(yo,",").concat(yo,"\\)$")),jo=new RegExp("^hsla\\(".concat(bo,",").concat(yo,",").concat(yo,",").concat(bo,"\\)$")),Eo={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Mo(){return this.rgb().formatHex()}function To(){return this.rgb().formatRgb()}function Po(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=xo.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?zo(t):3===n?new Ao(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?_o(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?_o(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Co.exec(e))?new Ao(t[1],t[2],t[3],1):(t=So.exec(e))?new Ao(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=wo.exec(e))?_o(t[1],t[2],t[3],t[4]):(t=ko.exec(e))?_o(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=No.exec(e))?Bo(t[1],t[2]/100,t[3]/100,1):(t=jo.exec(e))?Bo(t[1],t[2]/100,t[3]/100,t[4]):Eo.hasOwnProperty(e)?zo(Eo[e]):"transparent"===e?new Ao(NaN,NaN,NaN,0):null}function zo(e){return new Ao(e>>16&255,e>>8&255,255&e,1)}function _o(e,t,n,a){return a<=0&&(e=t=n=NaN),new Ao(e,t,n,a)}function Ro(e,t,n,a){return 1===arguments.length?((o=e)instanceof ho||(o=Po(o)),o?new Ao((o=o.rgb()).r,o.g,o.b,o.opacity):new Ao):new Ao(e,t,n,null==a?1:a);var o}function Ao(e,t,n,a){this.r=+e,this.g=+t,this.b=+n,this.opacity=+a}function Io(){return"#".concat(Lo(this.r)).concat(Lo(this.g)).concat(Lo(this.b))}function Do(){const e=Oo(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(Fo(this.r),", ").concat(Fo(this.g),", ").concat(Fo(this.b)).concat(1===e?")":", ".concat(e,")"))}function Oo(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Fo(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Lo(e){return((e=Fo(e))<16?"0":"")+e.toString(16)}function Bo(e,t,n,a){return a<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ho(e,t,n,a)}function Uo(e){if(e instanceof Ho)return new Ho(e.h,e.s,e.l,e.opacity);if(e instanceof ho||(e=Po(e)),!e)return new Ho;if(e instanceof Ho)return e;var t=(e=e.rgb()).r/255,n=e.g/255,a=e.b/255,o=Math.min(t,n,a),i=Math.max(t,n,a),r=NaN,l=i-o,s=(i+o)/2;return l?(r=t===i?(n-a)/l+6*(n<a):n===i?(a-t)/l+2:(t-n)/l+4,l/=s<.5?i+o:2-i-o,r*=60):l=s>0&&s<1?0:r,new Ho(r,l,s,e.opacity)}function Ho(e,t,n,a){this.h=+e,this.s=+t,this.l=+n,this.opacity=+a}function Wo(e){return(e=(e||0)%360)<0?e+360:e}function Vo(e){return Math.max(0,Math.min(1,e||0))}function Go(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function Yo(e,t,n,a,o){var i=e*e,r=i*e;return((1-3*e+3*i-r)*t+(4-6*i+3*r)*n+(1+3*e+3*i-3*r)*a+r*o)/6}po(ho,Po,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Mo,formatHex:Mo,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Uo(this).formatHsl()},formatRgb:To,toString:To}),po(Ao,Ro,mo(ho,{brighter(e){return e=null==e?go:Math.pow(go,e),new Ao(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?fo:Math.pow(fo,e),new Ao(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ao(Fo(this.r),Fo(this.g),Fo(this.b),Oo(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Io,formatHex:Io,formatHex8:function(){return"#".concat(Lo(this.r)).concat(Lo(this.g)).concat(Lo(this.b)).concat(Lo(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:Do,toString:Do})),po(Ho,function(e,t,n,a){return 1===arguments.length?Uo(e):new Ho(e,t,n,null==a?1:a)},mo(ho,{brighter(e){return e=null==e?go:Math.pow(go,e),new Ho(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?fo:Math.pow(fo,e),new Ho(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,a=n+(n<.5?n:1-n)*t,o=2*n-a;return new Ao(Go(e>=240?e-240:e+120,o,a),Go(e,o,a),Go(e<120?e+240:e-120,o,a),this.opacity)},clamp(){return new Ho(Wo(this.h),Vo(this.s),Vo(this.l),Oo(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Oo(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(Wo(this.h),", ").concat(100*Vo(this.s),"%, ").concat(100*Vo(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));const Xo=e=>()=>e;function Ko(e,t){return function(n){return e+n*t}}function qo(e){return 1===(e=+e)?$o:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(a){return Math.pow(e+a*t,n)}}(t,n,e):Xo(isNaN(t)?n:t)}}function $o(e,t){var n=t-e;return n?Ko(e,n):Xo(isNaN(e)?t:e)}const Jo=function e(t){var n=qo(t);function a(e,t){var a=n((e=Ro(e)).r,(t=Ro(t)).r),o=n(e.g,t.g),i=n(e.b,t.b),r=$o(e.opacity,t.opacity);return function(t){return e.r=a(t),e.g=o(t),e.b=i(t),e.opacity=r(t),e+""}}return a.gamma=e,a}(1);function Qo(e){return function(t){var n,a,o=t.length,i=new Array(o),r=new Array(o),l=new Array(o);for(n=0;n<o;++n)a=Ro(t[n]),i[n]=a.r||0,r[n]=a.g||0,l[n]=a.b||0;return i=e(i),r=e(r),l=e(l),a.opacity=1,function(e){return a.r=i(e),a.g=r(e),a.b=l(e),a+""}}}Qo(function(e){var t=e.length-1;return function(n){var a=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),o=e[a],i=e[a+1],r=a>0?e[a-1]:2*o-i,l=a<t-1?e[a+2]:2*i-o;return Yo((n-a/t)*t,r,o,i,l)}}),Qo(function(e){var t=e.length;return function(n){var a=Math.floor(((n%=1)<0?++n:n)*t),o=e[(a+t-1)%t],i=e[a%t],r=e[(a+1)%t],l=e[(a+2)%t];return Yo((n-a/t)*t,o,i,r,l)}});var Zo=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ei=new RegExp(Zo.source,"g");function ti(e,t){var n,a,o,i=Zo.lastIndex=ei.lastIndex=0,r=-1,l=[],s=[];for(e+="",t+="";(n=Zo.exec(e))&&(a=ei.exec(t));)(o=a.index)>i&&(o=t.slice(i,o),l[r]?l[r]+=o:l[++r]=o),(n=n[0])===(a=a[0])?l[r]?l[r]+=a:l[++r]=a:(l[++r]=null,s.push({i:r,x:eo(n,a)})),i=ei.lastIndex;return i<t.length&&(o=t.slice(i),l[r]?l[r]+=o:l[++r]=o),l.length<2?s[0]?function(e){return function(t){return e(t)+""}}(s[0].x):function(e){return function(){return e}}(t):(t=s.length,function(e){for(var n,a=0;a<t;++a)l[(n=s[a]).i]=n.x(e);return l.join("")})}function ni(e,t){var n;return("number"===typeof t?eo:t instanceof Po?Jo:(n=Po(t))?(t=n,Jo):ti)(e,t)}function ai(e){return function(){this.removeAttribute(e)}}function oi(e){return function(){this.removeAttributeNS(e.space,e.local)}}function ii(e,t,n){var a,o,i=n+"";return function(){var r=this.getAttribute(e);return r===i?null:r===a?o:o=t(a=r,n)}}function ri(e,t,n){var a,o,i=n+"";return function(){var r=this.getAttributeNS(e.space,e.local);return r===i?null:r===a?o:o=t(a=r,n)}}function li(e,t,n){var a,o,i;return function(){var r,l,s=n(this);if(null!=s)return(r=this.getAttribute(e))===(l=s+"")?null:r===a&&l===o?i:(o=l,i=t(a=r,s));this.removeAttribute(e)}}function si(e,t,n){var a,o,i;return function(){var r,l,s=n(this);if(null!=s)return(r=this.getAttributeNS(e.space,e.local))===(l=s+"")?null:r===a&&l===o?i:(o=l,i=t(a=r,s));this.removeAttributeNS(e.space,e.local)}}function ci(e,t){var n,a;function o(){var o=t.apply(this,arguments);return o!==a&&(n=(a=o)&&function(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}(e,o)),n}return o._value=t,o}function ui(e,t){var n,a;function o(){var o=t.apply(this,arguments);return o!==a&&(n=(a=o)&&function(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}(e,o)),n}return o._value=t,o}function di(e,t){return function(){$a(this,e).delay=+t.apply(this,arguments)}}function pi(e,t){return t=+t,function(){$a(this,e).delay=t}}function mi(e,t){return function(){Ja(this,e).duration=+t.apply(this,arguments)}}function hi(e,t){return t=+t,function(){Ja(this,e).duration=t}}var fi=ba.prototype.constructor;function gi(e){return function(){this.style.removeProperty(e)}}var vi=0;function bi(e,t,n,a){this._groups=e,this._parents=t,this._name=n,this._id=a}function yi(){return++vi}var xi=ba.prototype;bi.prototype=function(e){return ba().transition(e)}.prototype={constructor:bi,select:function(e){var t=this._name,n=this._id;"function"!==typeof e&&(e=ln(e));for(var a=this._groups,o=a.length,i=new Array(o),r=0;r<o;++r)for(var l,s,c=a[r],u=c.length,d=i[r]=new Array(u),p=0;p<u;++p)(l=c[p])&&(s=e.call(l,l.__data__,p,c))&&("__data__"in l&&(s.__data__=l.__data__),d[p]=s,qa(d[p],t,n,p,d,Qa(l,n)));return new bi(i,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!==typeof e&&(e=cn(e));for(var a=this._groups,o=a.length,i=[],r=[],l=0;l<o;++l)for(var s,c=a[l],u=c.length,d=0;d<u;++d)if(s=c[d]){for(var p,m=e.call(s,s.__data__,d,c),h=Qa(s,n),f=0,g=m.length;f<g;++f)(p=m[f])&&qa(p,t,n,f,m,h);i.push(m),r.push(s)}return new bi(i,r,t,n)},selectChild:xi.selectChild,selectChildren:xi.selectChildren,filter:function(e){"function"!==typeof e&&(e=dn(e));for(var t=this._groups,n=t.length,a=new Array(n),o=0;o<n;++o)for(var i,r=t[o],l=r.length,s=a[o]=[],c=0;c<l;++c)(i=r[c])&&e.call(i,i.__data__,c,r)&&s.push(i);return new bi(a,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,a=t.length,o=n.length,i=Math.min(a,o),r=new Array(a),l=0;l<i;++l)for(var s,c=t[l],u=n[l],d=c.length,p=r[l]=new Array(d),m=0;m<d;++m)(s=c[m]||u[m])&&(p[m]=s);for(;l<a;++l)r[l]=t[l];return new bi(r,this._parents,this._name,this._id)},selection:function(){return new fi(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=yi(),a=this._groups,o=a.length,i=0;i<o;++i)for(var r,l=a[i],s=l.length,c=0;c<s;++c)if(r=l[c]){var u=Qa(r,t);qa(r,e,n,c,l,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new bi(a,this._parents,e,n)},call:xi.call,nodes:xi.nodes,node:xi.node,size:xi.size,empty:xi.empty,each:xi.each,on:function(e,t){var n=this._id;return arguments.length<2?Qa(this.node(),n).on.on(e):this.each(function(e,t,n){var a,o,i=function(e){return(e+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})}(t)?$a:Ja;return function(){var r=i(this,e),l=r.on;l!==a&&(o=(a=l).copy()).on(t,n),r.on=o}}(n,e,t))},attr:function(e,t){var n=jn(e),a="transform"===n?lo:ni;return this.attrTween(e,"function"===typeof t?(n.local?si:li)(n,a,uo(this,"attr."+e,t)):null==t?(n.local?oi:ai)(n):(n.local?ri:ii)(n,a,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!==typeof t)throw new Error;var a=jn(e);return this.tween(n,(a.local?ci:ui)(a,t))},style:function(e,t,n){var a="transform"===(e+="")?ro:ni;return null==t?this.styleTween(e,function(e,t){var n,a,o;return function(){var i=On(this,e),r=(this.style.removeProperty(e),On(this,e));return i===r?null:i===n&&r===a?o:o=t(n=i,a=r)}}(e,a)).on("end.style."+e,gi(e)):"function"===typeof t?this.styleTween(e,function(e,t,n){var a,o,i;return function(){var r=On(this,e),l=n(this),s=l+"";return null==l&&(this.style.removeProperty(e),s=l=On(this,e)),r===s?null:r===a&&s===o?i:(o=s,i=t(a=r,l))}}(e,a,uo(this,"style."+e,t))).each(function(e,t){var n,a,o,i,r="style."+t,l="end."+r;return function(){var s=Ja(this,e),c=s.on,u=null==s.value[r]?i||(i=gi(t)):void 0;c===n&&o===u||(a=(n=c).copy()).on(l,o=u),s.on=a}}(this._id,e)):this.styleTween(e,function(e,t,n){var a,o,i=n+"";return function(){var r=On(this,e);return r===i?null:r===a?o:o=t(a=r,n)}}(e,a,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var a="style."+(e+="");if(arguments.length<2)return(a=this.tween(a))&&a._value;if(null==t)return this.tween(a,null);if("function"!==typeof t)throw new Error;return this.tween(a,function(e,t,n){var a,o;function i(){var i=t.apply(this,arguments);return i!==o&&(a=(o=i)&&function(e,t,n){return function(a){this.style.setProperty(e,t.call(this,a),n)}}(e,i,n)),a}return i._value=t,i}(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"===typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(uo(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!==typeof e)throw new Error;return this.tween(t,function(e){var t,n;function a(){var a=e.apply(this,arguments);return a!==n&&(t=(n=a)&&function(e){return function(t){this.textContent=e.call(this,t)}}(a)),t}return a._value=e,a}(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var a,o=Qa(this.node(),n).tween,i=0,r=o.length;i<r;++i)if((a=o[i]).name===e)return a.value;return null}return this.each((null==t?so:co)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?di:pi)(t,e)):Qa(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?mi:hi)(t,e)):Qa(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!==typeof t)throw new Error;return function(){Ja(this,e).ease=t}}(t,e)):Qa(this.node(),t).ease},easeVarying:function(e){if("function"!==typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!==typeof n)throw new Error;Ja(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,a=n._id,o=n.size();return new Promise(function(i,r){var l={value:r},s={value:function(){0===--o&&i()}};n.each(function(){var n=Ja(this,a),o=n.on;o!==e&&((t=(e=o).copy())._.cancel.push(l),t._.interrupt.push(l),t._.end.push(s)),n.on=t}),0===o&&i()})},[Symbol.iterator]:xi[Symbol.iterator]};var Ci={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function Si(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error("transition ".concat(t," not found"));return n}ba.prototype.interrupt=function(e){return this.each(function(){Za(this,e)})},ba.prototype.transition=function(e){var t,n;e instanceof bi?(t=e._id,e=e._name):(t=yi(),(n=Ci).time=La(),e=null==e?null:e+"");for(var a=this._groups,o=a.length,i=0;i<o;++i)for(var r,l=a[i],s=l.length,c=0;c<s;++c)(r=l[c])&&qa(r,e,t,c,l,n||Si(r,t));return new bi(a,this._parents,e,t)};const wi=e=>()=>e;function ki(e,t){let{sourceEvent:n,target:a,transform:o,dispatch:i}=t;Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:a,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:i}})}function Ni(e,t,n){this.k=e,this.x=t,this.y=n}Ni.prototype={constructor:Ni,scale:function(e){return 1===e?this:new Ni(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new Ni(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var ji=new Ni(1,0,0);function Ei(e){e.stopImmediatePropagation()}function Mi(e){e.preventDefault(),e.stopImmediatePropagation()}function Ti(e){return(!e.ctrlKey||"wheel"===e.type)&&!e.button}function Pi(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e).hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]:[[0,0],[e.clientWidth,e.clientHeight]]}function zi(){return this.__zoom||ji}function _i(e){return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Ri(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ai(e,t,n){var a=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],r=e.invertY(t[1][1])-n[1][1];return e.translate(o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o),r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r))}function Ii(){var e,t,n,a=Ti,o=Pi,i=Ai,r=_i,l=Ri,s=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],u=250,d=Ea,p=on("start","zoom","end"),m=0,h=10;function f(e){e.property("__zoom",zi).on("wheel.zoom",S,{passive:!1}).on("mousedown.zoom",w).on("dblclick.zoom",k).filter(l).on("touchstart.zoom",N).on("touchmove.zoom",j).on("touchend.zoom touchcancel.zoom",E).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(e,t){return(t=Math.max(s[0],Math.min(s[1],t)))===e.k?e:new Ni(t,e.x,e.y)}function v(e,t,n){var a=t[0]-n[0]*e.k,o=t[1]-n[1]*e.k;return a===e.x&&o===e.y?e:new Ni(e.k,a,o)}function b(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function y(e,t,n,a){e.on("start.zoom",function(){x(this,arguments).event(a).start()}).on("interrupt.zoom end.zoom",function(){x(this,arguments).event(a).end()}).tween("zoom",function(){var e=this,i=arguments,r=x(e,i).event(a),l=o.apply(e,i),s=null==n?b(l):"function"===typeof n?n.apply(e,i):n,c=Math.max(l[1][0]-l[0][0],l[1][1]-l[0][1]),u=e.__zoom,p="function"===typeof t?t.apply(e,i):t,m=d(u.invert(s).concat(c/u.k),p.invert(s).concat(c/p.k));return function(e){if(1===e)e=p;else{var t=m(e),n=c/t[2];e=new Ni(n,s[0]-t[0]*n,s[1]-t[1]*n)}r.zoom(null,e)}})}function x(e,t,n){return!n&&e.__zooming||new C(e,t)}function C(e,t){this.that=e,this.args=t,this.active=0,this.sourceEvent=null,this.extent=o.apply(e,t),this.taps=0}function S(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if(a.apply(this,arguments)){var l=x(this,n).event(e),u=this.__zoom,d=Math.max(s[0],Math.min(s[1],u.k*Math.pow(2,r.apply(this,arguments)))),p=Ma(e);if(l.wheel)l.mouse[0][0]===p[0]&&l.mouse[0][1]===p[1]||(l.mouse[1]=u.invert(l.mouse[0]=p)),clearTimeout(l.wheel);else{if(u.k===d)return;l.mouse=[p,u.invert(p)],Za(this),l.start()}Mi(e),l.wheel=setTimeout(function(){l.wheel=null,l.end()},150),l.zoom("mouse",i(v(g(u,d),l.mouse[0],l.mouse[1]),l.extent,c))}}function w(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),r=1;r<t;r++)o[r-1]=arguments[r];if(!n&&a.apply(this,arguments)){var l=e.currentTarget,s=x(this,o,!0).event(e),u=ya(e.view).on("mousemove.zoom",function(e){if(Mi(e),!s.moved){var t=e.clientX-p,n=e.clientY-h;s.moved=t*t+n*n>m}s.event(e).zoom("mouse",i(v(s.that.__zoom,s.mouse[0]=Ma(e,l),s.mouse[1]),s.extent,c))},!0).on("mouseup.zoom",function(e){u.on("mousemove.zoom mouseup.zoom",null),Na(e.view,s.moved),Mi(e),s.event(e).end()},!0),d=Ma(e,l),p=e.clientX,h=e.clientY;ka(e.view),Ei(e),s.mouse=[d,this.__zoom.invert(d)],Za(this),s.start()}}function k(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(a.apply(this,arguments)){var l=this.__zoom,s=Ma(e.changedTouches?e.changedTouches[0]:e,this),d=l.invert(s),p=l.k*(e.shiftKey?.5:2),m=i(v(g(l,p),s,d),o.apply(this,n),c);Mi(e),u>0?ya(this).transition().duration(u).call(y,m,s,e):ya(this).call(f.transform,m,s,e)}}function N(n){for(var o=arguments.length,i=new Array(o>1?o-1:0),r=1;r<o;r++)i[r-1]=arguments[r];if(a.apply(this,arguments)){var l,s,c,u,d=n.touches,p=d.length,m=x(this,i,n.changedTouches.length===p).event(n);for(Ei(n),s=0;s<p;++s)u=[u=Ma(c=d[s],this),this.__zoom.invert(u),c.identifier],m.touch0?m.touch1||m.touch0[2]===u[2]||(m.touch1=u,m.taps=0):(m.touch0=u,l=!0,m.taps=1+!!e);e&&(e=clearTimeout(e)),l&&(m.taps<2&&(t=u[0],e=setTimeout(function(){e=null},500)),Za(this),m.start())}}function j(e){if(this.__zooming){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];var o,r,l,s,u=x(this,n).event(e),d=e.changedTouches,p=d.length;for(Mi(e),o=0;o<p;++o)l=Ma(r=d[o],this),u.touch0&&u.touch0[2]===r.identifier?u.touch0[0]=l:u.touch1&&u.touch1[2]===r.identifier&&(u.touch1[0]=l);if(r=u.that.__zoom,u.touch1){var m=u.touch0[0],h=u.touch0[1],f=u.touch1[0],b=u.touch1[1],y=(y=f[0]-m[0])*y+(y=f[1]-m[1])*y,C=(C=b[0]-h[0])*C+(C=b[1]-h[1])*C;r=g(r,Math.sqrt(y/C)),l=[(m[0]+f[0])/2,(m[1]+f[1])/2],s=[(h[0]+b[0])/2,(h[1]+b[1])/2]}else{if(!u.touch0)return;l=u.touch0[0],s=u.touch0[1]}u.zoom("touch",i(v(r,l,s),u.extent,c))}}function E(e){for(var a=arguments.length,o=new Array(a>1?a-1:0),i=1;i<a;i++)o[i-1]=arguments[i];if(this.__zooming){var r,l,s=x(this,o).event(e),c=e.changedTouches,u=c.length;for(Ei(e),n&&clearTimeout(n),n=setTimeout(function(){n=null},500),r=0;r<u;++r)l=c[r],s.touch0&&s.touch0[2]===l.identifier?delete s.touch0:s.touch1&&s.touch1[2]===l.identifier&&delete s.touch1;if(s.touch1&&!s.touch0&&(s.touch0=s.touch1,delete s.touch1),s.touch0)s.touch0[1]=this.__zoom.invert(s.touch0[0]);else if(s.end(),2===s.taps&&(l=Ma(l,this),Math.hypot(t[0]-l[0],t[1]-l[1])<h)){var d=ya(this).on("dblclick.zoom");d&&d.apply(this,arguments)}}}return f.transform=function(e,t,n,a){var o=e.selection?e.selection():e;o.property("__zoom",zi),e!==o?y(e,t,n,a):o.interrupt().each(function(){x(this,arguments).event(a).start().zoom(null,"function"===typeof t?t.apply(this,arguments):t).end()})},f.scaleBy=function(e,t,n,a){f.scaleTo(e,function(){return this.__zoom.k*("function"===typeof t?t.apply(this,arguments):t)},n,a)},f.scaleTo=function(e,t,n,a){f.transform(e,function(){var e=o.apply(this,arguments),a=this.__zoom,r=null==n?b(e):"function"===typeof n?n.apply(this,arguments):n,l=a.invert(r),s="function"===typeof t?t.apply(this,arguments):t;return i(v(g(a,s),r,l),e,c)},n,a)},f.translateBy=function(e,t,n,a){f.transform(e,function(){return i(this.__zoom.translate("function"===typeof t?t.apply(this,arguments):t,"function"===typeof n?n.apply(this,arguments):n),o.apply(this,arguments),c)},null,a)},f.translateTo=function(e,t,n,a,r){f.transform(e,function(){var e=o.apply(this,arguments),r=this.__zoom,l=null==a?b(e):"function"===typeof a?a.apply(this,arguments):a;return i(ji.translate(l[0],l[1]).scale(r.k).translate("function"===typeof t?-t.apply(this,arguments):-t,"function"===typeof n?-n.apply(this,arguments):-n),e,c)},a,r)},C.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return 1===++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0===--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){var t=ya(this.that).datum();p.call(e,this.that,new ki(e,{sourceEvent:this.sourceEvent,target:f,type:e,transform:this.that.__zoom,dispatch:p}),t)}},f.wheelDelta=function(e){return arguments.length?(r="function"===typeof e?e:wi(+e),f):r},f.filter=function(e){return arguments.length?(a="function"===typeof e?e:wi(!!e),f):a},f.touchable=function(e){return arguments.length?(l="function"===typeof e?e:wi(!!e),f):l},f.extent=function(e){return arguments.length?(o="function"===typeof e?e:wi([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),f):o},f.scaleExtent=function(e){return arguments.length?(s[0]=+e[0],s[1]=+e[1],f):[s[0],s[1]]},f.translateExtent=function(e){return arguments.length?(c[0][0]=+e[0][0],c[1][0]=+e[1][0],c[0][1]=+e[0][1],c[1][1]=+e[1][1],f):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},f.constrain=function(e){return arguments.length?(i=e,f):i},f.duration=function(e){return arguments.length?(u=+e,f):u},f.interpolate=function(e){return arguments.length?(d=e,f):d},f.on=function(){var e=p.on.apply(p,arguments);return e===p?f:e},f.clickDistance=function(e){return arguments.length?(m=(e=+e)*e,f):Math.sqrt(m)},f.tapDistance=function(e){return arguments.length?(h=+e,f):h},f}Ni.prototype;const Di=e=>()=>e;function Oi(e,t){let{sourceEvent:n,subject:a,target:o,identifier:i,active:r,x:l,y:s,dx:c,dy:u,dispatch:d}=t;Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:a,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:r,enumerable:!0,configurable:!0},x:{value:l,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:d}})}function Fi(e){return!e.ctrlKey&&!e.button}function Li(){return this.parentNode}function Bi(e,t){return null==t?{x:e.x,y:e.y}:t}function Ui(){return navigator.maxTouchPoints||"ontouchstart"in this}Oi.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};var Hi=n(950);const Wi=["position","children","className","style"],Vi=["x","y","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","children","className"],Gi=["type","position","isValidConnection","isConnectable","isConnectableStart","isConnectableEnd","id","onConnect","children","className","onMouseDown","onTouchStart"],Yi=["nodes","edges","defaultNodes","defaultEdges","className","nodeTypes","edgeTypes","onNodeClick","onEdgeClick","onInit","onMove","onMoveStart","onMoveEnd","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","onNodeMouseEnter","onNodeMouseMove","onNodeMouseLeave","onNodeContextMenu","onNodeDoubleClick","onNodeDragStart","onNodeDrag","onNodeDragStop","onNodesDelete","onEdgesDelete","onSelectionChange","onSelectionDragStart","onSelectionDrag","onSelectionDragStop","onSelectionContextMenu","onSelectionStart","onSelectionEnd","connectionMode","connectionLineType","connectionLineStyle","connectionLineComponent","connectionLineContainerStyle","deleteKeyCode","selectionKeyCode","selectionOnDrag","selectionMode","panActivationKeyCode","multiSelectionKeyCode","zoomActivationKeyCode","snapToGrid","snapGrid","onlyRenderVisibleElements","selectNodesOnDrag","nodesDraggable","nodesConnectable","nodesFocusable","nodeOrigin","edgesFocusable","edgesUpdatable","elementsSelectable","defaultViewport","minZoom","maxZoom","translateExtent","preventScrolling","nodeExtent","defaultMarkerColor","zoomOnScroll","zoomOnPinch","panOnScroll","panOnScrollSpeed","panOnScrollMode","zoomOnDoubleClick","panOnDrag","onPaneClick","onPaneMouseEnter","onPaneMouseMove","onPaneMouseLeave","onPaneScroll","onPaneContextMenu","children","onEdgeContextMenu","onEdgeDoubleClick","onEdgeMouseEnter","onEdgeMouseMove","onEdgeMouseLeave","onEdgeUpdate","onEdgeUpdateStart","onEdgeUpdateEnd","onReconnect","onReconnectStart","onReconnectEnd","reconnectRadius","edgeUpdaterRadius","onNodesChange","onEdgesChange","noDragClassName","noWheelClassName","noPanClassName","fitView","fitViewOptions","connectOnClick","attributionPosition","proOptions","defaultEdgeOptions","elevateNodesOnSelect","elevateEdgesOnSelect","disableKeyboardA11y","autoPanOnConnect","autoPanOnNodeDrag","connectionRadius","isValidConnection","onError","style","id","nodeDragThreshold"],Xi=(0,a.createContext)(null),Ki=Xi.Provider,qi=e=>'Node type "'.concat(e,'" not found. Using fallback type "default".'),$i=()=>"The React Flow parent container needs a width and a height to render the graph.",Ji=()=>"Only child nodes can use a parent extent.",Qi=()=>"Can't create edge. An edge needs a source and a target.",Zi=e=>'Marker type "'.concat(e,"\" doesn't exist."),er=(e,t)=>"Couldn't create edge for ".concat(e?"target":"source",' handle id: "').concat(e?t.targetHandle:t.sourceHandle,'", edge id: ').concat(t.id,"."),tr=()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",nr=e=>'Edge type "'.concat(e,'" not found. Using fallback type "default".'),ar=e=>'Node with id "'.concat(e,'" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.'),or=(()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001")();function ir(e,t){const n=(0,a.useContext)(Xi);if(null===n)throw new Error(or);return $t(n,e,t)}const rr=()=>{const e=(0,a.useContext)(Xi);if(null===e)throw new Error(or);return(0,a.useMemo)(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},lr=e=>e.userSelectionActive?"none":"all";function sr(e){let{position:t,children:n,className:o,style:r}=e,l=i(e,Wi);const s=ir(lr),c="".concat(t).split("-");return a.createElement("div",u({className:Wt(["react-flow__panel",o,...c]),style:u(u({},r),{},{pointerEvents:s})},l),n)}function cr(e){let{proOptions:t,position:n="bottom-right"}=e;return null!==t&&void 0!==t&&t.hideAttribution?null:a.createElement(sr,{position:n,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},a.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}var ur=(0,a.memo)(e=>{let{x:t,y:n,label:o,labelStyle:r={},labelShowBg:l=!0,labelBgStyle:s={},labelBgPadding:c=[2,4],labelBgBorderRadius:d=2,children:p,className:m}=e,h=i(e,Vi);const f=(0,a.useRef)(null),[g,v]=(0,a.useState)({x:0,y:0,width:0,height:0}),b=Wt(["react-flow__edge-textwrapper",m]);return(0,a.useEffect)(()=>{if(f.current){const e=f.current.getBBox();v({x:e.x,y:e.y,width:e.width,height:e.height})}},[o]),"undefined"!==typeof o&&o?a.createElement("g",u({transform:"translate(".concat(t-g.width/2," ").concat(n-g.height/2,")"),className:b,visibility:g.width?"visible":"hidden"},h),l&&a.createElement("rect",{width:g.width+2*c[0],x:-c[0],y:-c[1],height:g.height+2*c[1],className:"react-flow__edge-textbg",style:s,rx:d,ry:d}),a.createElement("text",{className:"react-flow__edge-text",y:g.height/2,dy:"0.3em",ref:f,style:r},o),p):null});const dr=e=>({width:e.offsetWidth,height:e.offsetHeight}),pr=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(e,t),n)},mr=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},t=arguments.length>1?arguments[1]:void 0;return{x:pr(e.x,t[0][0],t[1][0]),y:pr(e.y,t[0][1],t[1][1])}},hr=(e,t,n)=>e<t?pr(Math.abs(e-t),1,50)/50:e>n?-pr(Math.abs(e-n),1,50)/50:0,fr=(e,t)=>[20*hr(e.x,35,t.width-35),20*hr(e.y,35,t.height-35)],gr=e=>{var t,n;return(null===(t=e.getRootNode)||void 0===t?void 0:t.call(e))||(null===(n=window)||void 0===n?void 0:n.document)},vr=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),br=e=>{let{x:t,y:n,width:a,height:o}=e;return{x:t,y:n,x2:t+a,y2:n+o}},yr=e=>{let{x:t,y:n,x2:a,y2:o}=e;return{x:t,y:n,width:a-t,height:o-n}},xr=e=>u(u({},e.positionAbsolute||{x:0,y:0}),{},{width:e.width||0,height:e.height||0}),Cr=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),a=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*a)},Sr=e=>!isNaN(e)&&isFinite(e),wr=Symbol.for("internals"),kr=["Enter"," ","Escape"],Nr=(e,t)=>{0};function jr(e){var t;const n=(e=>"nativeEvent"in e)(e)?e.nativeEvent:e,a=(null===(t=n.composedPath)||void 0===t||null===(t=t.call(n))||void 0===t?void 0:t[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(null===a||void 0===a?void 0:a.nodeName)||(null===a||void 0===a?void 0:a.hasAttribute("contenteditable"))||!(null===a||void 0===a||!a.closest(".nokey"))}const Er=e=>"clientX"in e,Mr=(e,t)=>{var n,a,o,i;const r=Er(e),l=r?e.clientX:null===(n=e.touches)||void 0===n?void 0:n[0].clientX,s=r?e.clientY:null===(a=e.touches)||void 0===a?void 0:a[0].clientY;return{x:l-(null!==(o=null===t||void 0===t?void 0:t.left)&&void 0!==o?o:0),y:s-(null!==(i=null===t||void 0===t?void 0:t.top)&&void 0!==i?i:0)}},Tr=()=>{var e;return"undefined"!==typeof navigator&&(null===(e=navigator)||void 0===e||null===(e=e.userAgent)||void 0===e?void 0:e.indexOf("Mac"))>=0},Pr=e=>{let{id:t,path:n,labelX:o,labelY:i,label:r,labelStyle:l,labelShowBg:s,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:p,markerEnd:m,markerStart:h,interactionWidth:f=20}=e;return a.createElement(a.Fragment,null,a.createElement("path",{id:t,style:p,d:n,fill:"none",className:"react-flow__edge-path",markerEnd:m,markerStart:h}),f&&a.createElement("path",{d:n,fill:"none",strokeOpacity:0,strokeWidth:f,className:"react-flow__edge-interaction"}),r&&Sr(o)&&Sr(i)?a.createElement(ur,{x:o,y:i,label:r,labelStyle:l,labelShowBg:s,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d}):null)};Pr.displayName="BaseEdge";function zr(e,t,n){return void 0===n?n:a=>{const o=t().edges.find(t=>t.id===e);o&&n(a,u({},o))}}function _r(e){let{sourceX:t,sourceY:n,targetX:a,targetY:o}=e;const i=Math.abs(a-t)/2,r=a<t?a+i:a-i,l=Math.abs(o-n)/2;return[r,o<n?o+l:o-l,i,l]}function Rr(e){let{sourceX:t,sourceY:n,targetX:a,targetY:o,sourceControlX:i,sourceControlY:r,targetControlX:l,targetControlY:s}=e;const c=.125*t+.375*i+.375*l+.125*a,u=.125*n+.375*r+.375*s+.125*o;return[c,u,Math.abs(c-t),Math.abs(u-n)]}var Ar,Ir,Dr,Or,Fr,Lr;function Br(e){let{pos:t,x1:n,y1:a,x2:o,y2:i}=e;return t===Lr.Left||t===Lr.Right?[.5*(n+o),a]:[n,.5*(a+i)]}function Ur(e){let{sourceX:t,sourceY:n,sourcePosition:a=Lr.Bottom,targetX:o,targetY:i,targetPosition:r=Lr.Top}=e;const[l,s]=Br({pos:a,x1:t,y1:n,x2:o,y2:i}),[c,u]=Br({pos:r,x1:o,y1:i,x2:t,y2:n}),[d,p,m,h]=Rr({sourceX:t,sourceY:n,targetX:o,targetY:i,sourceControlX:l,sourceControlY:s,targetControlX:c,targetControlY:u});return["M".concat(t,",").concat(n," C").concat(l,",").concat(s," ").concat(c,",").concat(u," ").concat(o,",").concat(i),d,p,m,h]}!function(e){e.Strict="strict",e.Loose="loose"}(Ar||(Ar={})),function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"}(Ir||(Ir={})),function(e){e.Partial="partial",e.Full="full"}(Dr||(Dr={})),function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"}(Or||(Or={})),function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"}(Fr||(Fr={})),function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"}(Lr||(Lr={}));const Hr=(0,a.memo)(e=>{let{sourceX:t,sourceY:n,targetX:o,targetY:i,sourcePosition:r=Lr.Bottom,targetPosition:l=Lr.Top,label:s,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:m,style:h,markerEnd:f,markerStart:g,interactionWidth:v}=e;const[b,y,x]=Ur({sourceX:t,sourceY:n,sourcePosition:r,targetX:o,targetY:i,targetPosition:l});return a.createElement(Pr,{path:b,labelX:y,labelY:x,label:s,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:m,style:h,markerEnd:f,markerStart:g,interactionWidth:v})});Hr.displayName="SimpleBezierEdge";const Wr={[Lr.Left]:{x:-1,y:0},[Lr.Right]:{x:1,y:0},[Lr.Top]:{x:0,y:-1},[Lr.Bottom]:{x:0,y:1}},Vr=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Gr(e){let{source:t,sourcePosition:n=Lr.Bottom,target:a,targetPosition:o=Lr.Top,center:i,offset:r}=e;const l=Wr[n],s=Wr[o],c={x:t.x+l.x*r,y:t.y+l.y*r},u={x:a.x+s.x*r,y:a.y+s.y*r},d=(e=>{let{source:t,sourcePosition:n=Lr.Bottom,target:a}=e;return n===Lr.Left||n===Lr.Right?t.x<a.x?{x:1,y:0}:{x:-1,y:0}:t.y<a.y?{x:0,y:1}:{x:0,y:-1}})({source:c,sourcePosition:n,target:u}),p=0!==d.x?"x":"y",m=d[p];let h,f,g=[];const v={x:0,y:0},b={x:0,y:0},[y,x,C,S]=_r({sourceX:t.x,sourceY:t.y,targetX:a.x,targetY:a.y});if(l[p]*s[p]===-1){var w,k;h=null!==(w=i.x)&&void 0!==w?w:y,f=null!==(k=i.y)&&void 0!==k?k:x;const e=[{x:h,y:c.y},{x:h,y:u.y}],t=[{x:c.x,y:f},{x:u.x,y:f}];g=l[p]===m?"x"===p?e:t:"x"===p?t:e}else{const e=[{x:c.x,y:u.y}],i=[{x:u.x,y:c.y}];if(g="x"===p?l.x===m?i:e:l.y===m?e:i,n===o){const e=Math.abs(t[p]-a[p]);if(e<=r){const n=Math.min(r-1,r-e);l[p]===m?v[p]=(c[p]>t[p]?-1:1)*n:b[p]=(u[p]>a[p]?-1:1)*n}}if(n!==o){const t="x"===p?"y":"x",n=l[p]===s[t],a=c[t]>u[t],o=c[t]<u[t];(1===l[p]&&(!n&&a||n&&o)||1!==l[p]&&(!n&&o||n&&a))&&(g="x"===p?e:i)}const d={x:c.x+v.x,y:c.y+v.y},y={x:u.x+b.x,y:u.y+b.y};Math.max(Math.abs(d.x-g[0].x),Math.abs(y.x-g[0].x))>=Math.max(Math.abs(d.y-g[0].y),Math.abs(y.y-g[0].y))?(h=(d.x+y.x)/2,f=g[0].y):(h=g[0].x,f=(d.y+y.y)/2)}return[[t,{x:c.x+v.x,y:c.y+v.y},...g,{x:u.x+b.x,y:u.y+b.y},a],h,f,C,S]}function Yr(e){let{sourceX:t,sourceY:n,sourcePosition:a=Lr.Bottom,targetX:o,targetY:i,targetPosition:r=Lr.Top,borderRadius:l=5,centerX:s,centerY:c,offset:u=20}=e;const[d,p,m,h,f]=Gr({source:{x:t,y:n},sourcePosition:a,target:{x:o,y:i},targetPosition:r,center:{x:s,y:c},offset:u}),g=d.reduce((e,t,n)=>{let a="";return a=n>0&&n<d.length-1?function(e,t,n,a){const o=Math.min(Vr(e,t)/2,Vr(t,n)/2,a),{x:i,y:r}=t;if(e.x===i&&i===n.x||e.y===r&&r===n.y)return"L".concat(i," ").concat(r);if(e.y===r){const t=e.x<n.x?-1:1,a=e.y<n.y?1:-1;return"L ".concat(i+o*t,",").concat(r,"Q ").concat(i,",").concat(r," ").concat(i,",").concat(r+o*a)}const l=e.x<n.x?1:-1,s=e.y<n.y?-1:1;return"L ".concat(i,",").concat(r+o*s,"Q ").concat(i,",").concat(r," ").concat(i+o*l,",").concat(r)}(d[n-1],t,d[n+1],l):"".concat(0===n?"M":"L").concat(t.x," ").concat(t.y),e+=a},"");return[g,p,m,h,f]}const Xr=(0,a.memo)(e=>{let{sourceX:t,sourceY:n,targetX:o,targetY:i,label:r,labelStyle:l,labelShowBg:s,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:p,sourcePosition:m=Lr.Bottom,targetPosition:h=Lr.Top,markerEnd:f,markerStart:g,pathOptions:v,interactionWidth:b}=e;const[y,x,C]=Yr({sourceX:t,sourceY:n,sourcePosition:m,targetX:o,targetY:i,targetPosition:h,borderRadius:null===v||void 0===v?void 0:v.borderRadius,offset:null===v||void 0===v?void 0:v.offset});return a.createElement(Pr,{path:y,labelX:x,labelY:C,label:r,labelStyle:l,labelShowBg:s,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:p,markerEnd:f,markerStart:g,interactionWidth:b})});Xr.displayName="SmoothStepEdge";const Kr=(0,a.memo)(e=>{var t;return a.createElement(Xr,u(u({},e),{},{pathOptions:(0,a.useMemo)(()=>{var t;return{borderRadius:0,offset:null===(t=e.pathOptions)||void 0===t?void 0:t.offset}},[null===(t=e.pathOptions)||void 0===t?void 0:t.offset])}))});Kr.displayName="StepEdge";const qr=(0,a.memo)(e=>{let{sourceX:t,sourceY:n,targetX:o,targetY:i,label:r,labelStyle:l,labelShowBg:s,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:p,markerEnd:m,markerStart:h,interactionWidth:f}=e;const[g,v,b]=function(e){let{sourceX:t,sourceY:n,targetX:a,targetY:o}=e;const[i,r,l,s]=_r({sourceX:t,sourceY:n,targetX:a,targetY:o});return["M ".concat(t,",").concat(n,"L ").concat(a,",").concat(o),i,r,l,s]}({sourceX:t,sourceY:n,targetX:o,targetY:i});return a.createElement(Pr,{path:g,labelX:v,labelY:b,label:r,labelStyle:l,labelShowBg:s,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:p,markerEnd:m,markerStart:h,interactionWidth:f})});function $r(e,t){return e>=0?.5*e:25*t*Math.sqrt(-e)}function Jr(e){let{pos:t,x1:n,y1:a,x2:o,y2:i,c:r}=e;switch(t){case Lr.Left:return[n-$r(n-o,r),a];case Lr.Right:return[n+$r(o-n,r),a];case Lr.Top:return[n,a-$r(a-i,r)];case Lr.Bottom:return[n,a+$r(i-a,r)]}}function Qr(e){let{sourceX:t,sourceY:n,sourcePosition:a=Lr.Bottom,targetX:o,targetY:i,targetPosition:r=Lr.Top,curvature:l=.25}=e;const[s,c]=Jr({pos:a,x1:t,y1:n,x2:o,y2:i,c:l}),[u,d]=Jr({pos:r,x1:o,y1:i,x2:t,y2:n,c:l}),[p,m,h,f]=Rr({sourceX:t,sourceY:n,targetX:o,targetY:i,sourceControlX:s,sourceControlY:c,targetControlX:u,targetControlY:d});return["M".concat(t,",").concat(n," C").concat(s,",").concat(c," ").concat(u,",").concat(d," ").concat(o,",").concat(i),p,m,h,f]}qr.displayName="StraightEdge";const Zr=(0,a.memo)(e=>{let{sourceX:t,sourceY:n,targetX:o,targetY:i,sourcePosition:r=Lr.Bottom,targetPosition:l=Lr.Top,label:s,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:m,style:h,markerEnd:f,markerStart:g,pathOptions:v,interactionWidth:b}=e;const[y,x,C]=Qr({sourceX:t,sourceY:n,sourcePosition:r,targetX:o,targetY:i,targetPosition:l,curvature:null===v||void 0===v?void 0:v.curvature});return a.createElement(Pr,{path:y,labelX:x,labelY:C,label:s,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:m,style:h,markerEnd:f,markerStart:g,interactionWidth:b})});Zr.displayName="BezierEdge";const el=(0,a.createContext)(null),tl=el.Provider;el.Consumer;const nl=e=>{let{source:t,sourceHandle:n,target:a,targetHandle:o}=e;return"reactflow__edge-".concat(t).concat(n||"","-").concat(a).concat(o||"")},al=(e,t)=>{if("undefined"===typeof e)return"";if("string"===typeof e)return e;const n=t?"".concat(t,"__"):"";return"".concat(n).concat(Object.keys(e).sort().map(t=>"".concat(t,"=").concat(e[t])).join("&"))},ol=(e,t,n,a)=>{let{x:o,y:i}=e,[r,l,s]=t,[c,u]=a;const d={x:(o-r)/s,y:(i-l)/s};return n?{x:c*Math.round(d.x/c),y:u*Math.round(d.y/u)}:d},il=(e,t)=>{let{x:n,y:a}=e,[o,i,r]=t;return{x:n*r+o,y:a*r+i}},rl=function(e){var t,n;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0];if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const o=(null!==(t=e.width)&&void 0!==t?t:0)*a[0],i=(null!==(n=e.height)&&void 0!==n?n:0)*a[1],r={x:e.position.x-o,y:e.position.y-i};return u(u({},r),{},{positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-o,y:e.positionAbsolute.y-i}:r})},ll=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0];if(0===e.length)return{x:0,y:0,width:0,height:0};const n=e.reduce((e,n)=>{const{x:a,y:o}=rl(n,t).positionAbsolute;return vr(e,br({x:a,y:o,width:n.width||0,height:n.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return yr(n)},sl=function(e,t){let[n,a,o]=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,1],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[0,0];const s={x:(t.x-n)/o,y:(t.y-a)/o,width:t.width/o,height:t.height/o},c=[];return e.forEach(e=>{const{width:t,height:n,selectable:a=!0,hidden:o=!1}=e;if(r&&!a||o)return!1;const{positionAbsolute:u}=rl(e,l),d={x:u.x,y:u.y,width:t||0,height:n||0},p=Cr(s,d);("undefined"===typeof t||"undefined"===typeof n||null===t||null===n||i&&p>0||p>=(t||0)*(n||0)||e.dragging)&&c.push(e)}),c},cl=(e,t)=>{const n=e.map(e=>e.id);return t.filter(e=>n.includes(e.source)||n.includes(e.target))},ul=function(e,t,n,a,o){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.1;const r=t/(e.width*(1+i)),l=n/(e.height*(1+i)),s=Math.min(r,l),c=pr(s,a,o);return{x:t/2-(e.x+e.width/2)*c,y:n/2-(e.y+e.height/2)*c,zoom:c}},dl=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.transition().duration(t)};function pl(e,t,n,a){return(t[n]||[]).reduce((t,o)=>{var i,r,l,s;"".concat(e.id,"-").concat(o.id,"-").concat(n)!==a&&t.push({id:o.id||null,type:n,nodeId:e.id,x:(null!==(i=null===(r=e.positionAbsolute)||void 0===r?void 0:r.x)&&void 0!==i?i:0)+o.x+o.width/2,y:(null!==(l=null===(s=e.positionAbsolute)||void 0===s?void 0:s.y)&&void 0!==l?l:0)+o.y+o.height/2});return t},[])}const ml={source:null,target:null,sourceHandle:null,targetHandle:null},hl=()=>({handleDomNode:null,isValid:!1,connection:ml,endHandle:null});function fl(e,t,n,a,o,i,r){const l="target"===o,s=r.querySelector('.react-flow__handle[data-id="'.concat(null===e||void 0===e?void 0:e.nodeId,"-").concat(null===e||void 0===e?void 0:e.id,"-").concat(null===e||void 0===e?void 0:e.type,'"]')),c=u(u({},hl()),{},{handleDomNode:s});if(s){const e=gl(void 0,s),o=s.getAttribute("data-nodeid"),r=s.getAttribute("data-handleid"),u=s.classList.contains("connectable"),d=s.classList.contains("connectableend"),p={source:l?o:n,sourceHandle:l?r:a,target:l?n:o,targetHandle:l?a:r};c.connection=p;u&&d&&(t===Ar.Strict?l&&"source"===e||!l&&"target"===e:o!==n||r!==a)&&(c.endHandle={nodeId:o,handleId:r,type:e},c.isValid=i(p))}return c}function gl(e,t){return e||(null!==t&&void 0!==t&&t.classList.contains("target")?"target":null!==t&&void 0!==t&&t.classList.contains("source")?"source":null)}function vl(e){null===e||void 0===e||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function bl(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function yl(e){let{event:t,handleId:n,nodeId:a,onConnect:o,isTarget:i,getState:r,setState:l,isValidConnection:s,edgeUpdaterType:c,onReconnectEnd:u}=e;const d=gr(t.target),{connectionMode:p,domNode:m,autoPanOnConnect:h,connectionRadius:f,onConnectStart:g,panBy:v,getNodes:b,cancelConnection:y}=r();let x,C=0;const{x:S,y:w}=Mr(t),k=null===d||void 0===d?void 0:d.elementFromPoint(S,w),N=gl(c,k),j=null===m||void 0===m?void 0:m.getBoundingClientRect();if(!j||!N)return;let E,M=Mr(t,j),T=!1,P=null,z=!1,_=null;const R=function(e){let{nodes:t,nodeId:n,handleId:a,handleType:o}=e;return t.reduce((e,t)=>{if(t[wr]){const{handleBounds:i}=t[wr];let r=[],l=[];i&&(r=pl(t,i,"source","".concat(n,"-").concat(a,"-").concat(o)),l=pl(t,i,"target","".concat(n,"-").concat(a,"-").concat(o))),e.push(...r,...l)}return e},[])}({nodes:b(),nodeId:a,handleId:n,handleType:N}),A=()=>{if(!h)return;const[e,t]=fr(M,j);v({x:e,y:t}),C=requestAnimationFrame(A)};function I(e){const{transform:t}=r();M=Mr(e,j);const{handle:o,validHandleResult:c}=function(e,t,n,a,o,i){const{x:r,y:l}=Mr(e),s=t.elementsFromPoint(r,l).find(e=>e.classList.contains("react-flow__handle"));if(s){const e=s.getAttribute("data-nodeid");if(e){const t=gl(void 0,s),a=s.getAttribute("data-handleid"),r=i({nodeId:e,id:a,type:t});if(r){const i=o.find(n=>n.nodeId===e&&n.type===t&&n.id===a);return{handle:{id:a,type:t,nodeId:e,x:(null===i||void 0===i?void 0:i.x)||n.x,y:(null===i||void 0===i?void 0:i.y)||n.y},validHandleResult:r}}}}let c=[],u=1/0;if(o.forEach(e=>{const t=Math.sqrt((e.x-n.x)**2+(e.y-n.y)**2);if(t<=a){const n=i(e);t<=u&&(t<u?c=[{handle:e,validHandleResult:n}]:t===u&&c.push({handle:e,validHandleResult:n}),u=t)}}),!c.length)return{handle:null,validHandleResult:hl()};if(1===c.length)return c[0];const d=c.some(e=>{let{validHandleResult:t}=e;return t.isValid}),p=c.some(e=>{let{handle:t}=e;return"target"===t.type});return c.find(e=>{let{handle:t,validHandleResult:n}=e;return p?"target"===t.type:!d||n.isValid})||c[0]}(e,d,ol(M,t,!1,[1,1]),f,R,e=>fl(e,p,a,n,i?"target":"source",s,d));if(x=o,T||(A(),T=!0),_=c.handleDomNode,P=c.connection,z=c.isValid,l({connectionPosition:x&&z?il({x:x.x,y:x.y},t):M,connectionStatus:bl(!!x,z),connectionEndHandle:c.endHandle}),!x&&!z&&!_)return vl(E);P.source!==P.target&&_&&(vl(E),E=_,_.classList.add("connecting","react-flow__handle-connecting"),_.classList.toggle("valid",z),_.classList.toggle("react-flow__handle-valid",z))}function D(e){var t,n;(x||_)&&P&&z&&(null===o||void 0===o||o(P)),null===(t=(n=r()).onConnectEnd)||void 0===t||t.call(n,e),c&&(null===u||void 0===u||u(e)),vl(E),y(),cancelAnimationFrame(C),T=!1,z=!1,P=null,_=null,d.removeEventListener("mousemove",I),d.removeEventListener("mouseup",D),d.removeEventListener("touchmove",I),d.removeEventListener("touchend",D)}l({connectionPosition:M,connectionStatus:null,connectionNodeId:a,connectionHandleId:n,connectionHandleType:N,connectionStartHandle:{nodeId:a,handleId:n,type:N},connectionEndHandle:null}),null===g||void 0===g||g(t,{nodeId:a,handleId:n,handleType:N}),d.addEventListener("mousemove",I),d.addEventListener("mouseup",D),d.addEventListener("touchmove",I),d.addEventListener("touchend",D)}const xl=()=>!0,Cl=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),Sl=(0,a.forwardRef)((e,t)=>{let{type:n="source",position:o=Lr.Top,isValidConnection:r,isConnectable:l=!0,isConnectableStart:s=!0,isConnectableEnd:c=!0,id:d,onConnect:p,children:m,className:h,onMouseDown:f,onTouchStart:g}=e,v=i(e,Gi);const b=d||null,y="target"===n,x=rr(),C=(0,a.useContext)(el),{connectOnClick:S,noPanClassName:w}=ir(Cl,Qt),{connecting:k,clickConnecting:N}=ir(((e,t,n)=>a=>{const{connectionStartHandle:o,connectionEndHandle:i,connectionClickStartHandle:r}=a;return{connecting:(null===o||void 0===o?void 0:o.nodeId)===e&&(null===o||void 0===o?void 0:o.handleId)===t&&(null===o||void 0===o?void 0:o.type)===n||(null===i||void 0===i?void 0:i.nodeId)===e&&(null===i||void 0===i?void 0:i.handleId)===t&&(null===i||void 0===i?void 0:i.type)===n,clickConnecting:(null===r||void 0===r?void 0:r.nodeId)===e&&(null===r||void 0===r?void 0:r.handleId)===t&&(null===r||void 0===r?void 0:r.type)===n}})(C,b,n),Qt);var j,E;C||(null===(j=(E=x.getState()).onError)||void 0===j||j.call(E,"010",tr()));const M=e=>{const{defaultEdgeOptions:t,onConnect:n,hasDefaultEdges:a}=x.getState(),o=u(u({},t),e);if(a){const{edges:e,setEdges:t}=x.getState();t(((e,t)=>{if(!e.source||!e.target)return Nr(0,Qi()),t;let n;var a;return n="id"in(a=e)&&"source"in a&&"target"in a?u({},e):u(u({},e),{},{id:nl(e)}),((e,t)=>t.some(t=>t.source===e.source&&t.target===e.target&&(t.sourceHandle===e.sourceHandle||!t.sourceHandle&&!e.sourceHandle)&&(t.targetHandle===e.targetHandle||!t.targetHandle&&!e.targetHandle)))(n,t)?t:t.concat(n)})(o,e))}null===n||void 0===n||n(o),null===p||void 0===p||p(o)},T=e=>{if(!C)return;const t=Er(e);s&&(t&&0===e.button||!t)&&yl({event:e,handleId:b,nodeId:C,onConnect:M,isTarget:y,getState:x.getState,setState:x.setState,isValidConnection:r||x.getState().isValidConnection||xl}),t?null===f||void 0===f||f(e):null===g||void 0===g||g(e)};return a.createElement("div",u({"data-handleid":b,"data-nodeid":C,"data-handlepos":o,"data-id":"".concat(C,"-").concat(b,"-").concat(n),className:Wt(["react-flow__handle","react-flow__handle-".concat(o),"nodrag",w,h,{source:!y,target:y,connectable:l,connectablestart:s,connectableend:c,connecting:N,connectionindicator:l&&(s&&!k||c&&k)}]),onMouseDown:T,onTouchStart:T,onClick:S?e=>{const{onClickConnectStart:t,onClickConnectEnd:a,connectionClickStartHandle:o,connectionMode:i,isValidConnection:l}=x.getState();if(!C||!o&&!s)return;if(!o)return null===t||void 0===t||t(e,{nodeId:C,handleId:b,handleType:n}),void x.setState({connectionClickStartHandle:{nodeId:C,type:n,handleId:b}});const c=gr(e.target),u=r||l||xl,{connection:d,isValid:p}=fl({nodeId:C,id:b,type:n},i,o.nodeId,o.handleId||null,o.type,u,c);p&&M(d),null===a||void 0===a||a(e),x.setState({connectionClickStartHandle:null})}:void 0,ref:t},v),m)});Sl.displayName="Handle";var wl=(0,a.memo)(Sl);const kl=e=>{let{data:t,isConnectable:n,targetPosition:o=Lr.Top,sourcePosition:i=Lr.Bottom}=e;return a.createElement(a.Fragment,null,a.createElement(wl,{type:"target",position:o,isConnectable:n}),null===t||void 0===t?void 0:t.label,a.createElement(wl,{type:"source",position:i,isConnectable:n}))};kl.displayName="DefaultNode";var Nl=(0,a.memo)(kl);const jl=e=>{let{data:t,isConnectable:n,sourcePosition:o=Lr.Bottom}=e;return a.createElement(a.Fragment,null,null===t||void 0===t?void 0:t.label,a.createElement(wl,{type:"source",position:o,isConnectable:n}))};jl.displayName="InputNode";var El=(0,a.memo)(jl);const Ml=e=>{let{data:t,isConnectable:n,targetPosition:o=Lr.Top}=e;return a.createElement(a.Fragment,null,a.createElement(wl,{type:"target",position:o,isConnectable:n}),null===t||void 0===t?void 0:t.label)};Ml.displayName="OutputNode";var Tl=(0,a.memo)(Ml);const Pl=()=>null;Pl.displayName="GroupNode";const zl=e=>({selectedNodes:e.getNodes().filter(e=>e.selected),selectedEdges:e.edges.filter(e=>e.selected).map(e=>u({},e))}),_l=e=>e.id;function Rl(e,t){return Qt(e.selectedNodes.map(_l),t.selectedNodes.map(_l))&&Qt(e.selectedEdges.map(_l),t.selectedEdges.map(_l))}const Al=(0,a.memo)(e=>{let{onSelectionChange:t}=e;const n=rr(),{selectedNodes:o,selectedEdges:i}=ir(zl,Rl);return(0,a.useEffect)(()=>{const e={nodes:o,edges:i};null===t||void 0===t||t(e),n.getState().onSelectionChange.forEach(t=>t(e))},[o,i,t]),null});Al.displayName="SelectionListener";const Il=e=>!!e.onSelectionChange;function Dl(e){let{onSelectionChange:t}=e;const n=ir(Il);return t||n?a.createElement(Al,{onSelectionChange:t}):null}const Ol=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Fl(e,t){(0,a.useEffect)(()=>{"undefined"!==typeof e&&t(e)},[e])}function Ll(e,t,n){(0,a.useEffect)(()=>{"undefined"!==typeof t&&n({[e]:t})},[t])}const Bl=e=>{let{nodes:t,edges:n,defaultNodes:o,defaultEdges:i,onConnect:r,onConnectStart:l,onConnectEnd:s,onClickConnectStart:c,onClickConnectEnd:d,nodesDraggable:p,nodesConnectable:m,nodesFocusable:h,edgesFocusable:f,edgesUpdatable:g,elevateNodesOnSelect:v,minZoom:b,maxZoom:y,nodeExtent:x,onNodesChange:C,onEdgesChange:S,elementsSelectable:w,connectionMode:k,snapGrid:N,snapToGrid:j,translateExtent:E,connectOnClick:M,defaultEdgeOptions:T,fitView:P,fitViewOptions:z,onNodesDelete:_,onEdgesDelete:R,onNodeDrag:A,onNodeDragStart:I,onNodeDragStop:D,onSelectionDrag:O,onSelectionDragStart:F,onSelectionDragStop:L,noPanClassName:B,nodeOrigin:U,rfId:H,autoPanOnConnect:W,autoPanOnNodeDrag:V,onError:G,connectionRadius:Y,isValidConnection:X,nodeDragThreshold:K}=e;const{setNodes:q,setEdges:$,setDefaultNodesAndEdges:J,setMinZoom:Q,setMaxZoom:Z,setTranslateExtent:ee,setNodeExtent:te,reset:ne}=ir(Ol,Qt),ae=rr();return(0,a.useEffect)(()=>{const e=null===i||void 0===i?void 0:i.map(e=>u(u({},e),T));return J(o,e),()=>{ne()}},[]),Ll("defaultEdgeOptions",T,ae.setState),Ll("connectionMode",k,ae.setState),Ll("onConnect",r,ae.setState),Ll("onConnectStart",l,ae.setState),Ll("onConnectEnd",s,ae.setState),Ll("onClickConnectStart",c,ae.setState),Ll("onClickConnectEnd",d,ae.setState),Ll("nodesDraggable",p,ae.setState),Ll("nodesConnectable",m,ae.setState),Ll("nodesFocusable",h,ae.setState),Ll("edgesFocusable",f,ae.setState),Ll("edgesUpdatable",g,ae.setState),Ll("elementsSelectable",w,ae.setState),Ll("elevateNodesOnSelect",v,ae.setState),Ll("snapToGrid",j,ae.setState),Ll("snapGrid",N,ae.setState),Ll("onNodesChange",C,ae.setState),Ll("onEdgesChange",S,ae.setState),Ll("connectOnClick",M,ae.setState),Ll("fitViewOnInit",P,ae.setState),Ll("fitViewOnInitOptions",z,ae.setState),Ll("onNodesDelete",_,ae.setState),Ll("onEdgesDelete",R,ae.setState),Ll("onNodeDrag",A,ae.setState),Ll("onNodeDragStart",I,ae.setState),Ll("onNodeDragStop",D,ae.setState),Ll("onSelectionDrag",O,ae.setState),Ll("onSelectionDragStart",F,ae.setState),Ll("onSelectionDragStop",L,ae.setState),Ll("noPanClassName",B,ae.setState),Ll("nodeOrigin",U,ae.setState),Ll("rfId",H,ae.setState),Ll("autoPanOnConnect",W,ae.setState),Ll("autoPanOnNodeDrag",V,ae.setState),Ll("onError",G,ae.setState),Ll("connectionRadius",Y,ae.setState),Ll("isValidConnection",X,ae.setState),Ll("nodeDragThreshold",K,ae.setState),Fl(t,q),Fl(n,$),Fl(b,Q),Fl(y,Z),Fl(E,ee),Fl(x,te),null},Ul={display:"none"},Hl={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Wl="react-flow__node-desc",Vl="react-flow__edge-desc",Gl=e=>e.ariaLiveMessage;function Yl(e){let{rfId:t}=e;const n=ir(Gl);return a.createElement("div",{id:"".concat("react-flow__aria-live","-").concat(t),"aria-live":"assertive","aria-atomic":"true",style:Hl},n)}function Xl(e){let{rfId:t,disableKeyboardA11y:n}=e;return a.createElement(a.Fragment,null,a.createElement("div",{id:"".concat(Wl,"-").concat(t),style:Ul},"Press enter or space to select a node.",!n&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),a.createElement("div",{id:"".concat(Vl,"-").concat(t),style:Ul},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!n&&a.createElement(Yl,{rfId:t}))}var Kl=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{actInsideInputWithModifier:!0};const[n,o]=(0,a.useState)(!1),i=(0,a.useRef)(!1),r=(0,a.useRef)(new Set([])),[l,s]=(0,a.useMemo)(()=>{if(null!==e){const t=(Array.isArray(e)?e:[e]).filter(e=>"string"===typeof e).map(e=>e.split("+")),n=t.reduce((e,t)=>e.concat(...t),[]);return[t,n]}return[[],[]]},[e]);return(0,a.useEffect)(()=>{const n="undefined"!==typeof document?document:null,a=(null===t||void 0===t?void 0:t.target)||n;if(null!==e){const e=e=>{i.current=e.ctrlKey||e.metaKey||e.shiftKey;if((!i.current||i.current&&!t.actInsideInputWithModifier)&&jr(e))return!1;const n=$l(e.code,s);r.current.add(e[n]),ql(l,r.current,!1)&&(e.preventDefault(),o(!0))},n=e=>{if((!i.current||i.current&&!t.actInsideInputWithModifier)&&jr(e))return!1;const n=$l(e.code,s);ql(l,r.current,!0)?(o(!1),r.current.clear()):r.current.delete(e[n]),"Meta"===e.key&&r.current.clear(),i.current=!1},c=()=>{r.current.clear(),o(!1)};return null===a||void 0===a||a.addEventListener("keydown",e),null===a||void 0===a||a.addEventListener("keyup",n),window.addEventListener("blur",c),()=>{null===a||void 0===a||a.removeEventListener("keydown",e),null===a||void 0===a||a.removeEventListener("keyup",n),window.removeEventListener("blur",c)}}},[e,o]),n};function ql(e,t,n){return e.filter(e=>n||e.length===t.size).some(e=>e.every(e=>t.has(e)))}function $l(e,t){return t.includes(e)?"code":"key"}function Jl(e,t,n,a){var o,i,r,l,s,c,u,d;const p=e.parentNode||e.parentId;if(!p)return n;const m=t.get(p),h=rl(m,a);return Jl(m,t,{x:(null!==(o=n.x)&&void 0!==o?o:0)+h.x,y:(null!==(i=n.y)&&void 0!==i?i:0)+h.y,z:(null!==(r=null===(l=m[wr])||void 0===l?void 0:l.z)&&void 0!==r?r:0)>(null!==(s=n.z)&&void 0!==s?s:0)?null!==(c=null===(u=m[wr])||void 0===u?void 0:u.z)&&void 0!==c?c:0:null!==(d=n.z)&&void 0!==d?d:0},a)}function Ql(e,t,n){e.forEach(a=>{const o=a.parentNode||a.parentId;if(o&&!e.has(o))throw new Error("Parent node ".concat(o," not found"));if(o||null!==n&&void 0!==n&&n[a.id]){var i,r;const{x:o,y:l,z:s}=Jl(a,e,u(u({},a.position),{},{z:null!==(i=null===(r=a[wr])||void 0===r?void 0:r.z)&&void 0!==i?i:0}),t);a.positionAbsolute={x:o,y:l},a[wr].z=s,null!==n&&void 0!==n&&n[a.id]&&(a[wr].isParent=!0)}})}function Zl(e,t,n,a){const o=new Map,i={},r=a?1e3:0;return e.forEach(e=>{var n;const a=(Sr(e.zIndex)?e.zIndex:0)+(e.selected?r:0),l=t.get(e.id),s=u(u({},e),{},{positionAbsolute:{x:e.position.x,y:e.position.y}}),c=e.parentNode||e.parentId;c&&(i[c]=!0);const d=(null===l||void 0===l?void 0:l.type)&&(null===l||void 0===l?void 0:l.type)!==e.type;Object.defineProperty(s,wr,{enumerable:!1,value:{handleBounds:d||null===l||void 0===l||null===(n=l[wr])||void 0===n?void 0:n.handleBounds,z:a}}),o.set(e.id,s)}),Ql(o,n,i),o}function es(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{getNodes:n,width:a,height:o,minZoom:i,maxZoom:r,d3Zoom:l,d3Selection:s,fitViewOnInitDone:c,fitViewOnInit:u,nodeOrigin:d}=e(),p=t.initial&&!c&&u;if(l&&s&&(p||!t.initial)){const e=n().filter(e=>{var n;const a=t.includeHiddenNodes?e.width&&e.height:!e.hidden;return null!==(n=t.nodes)&&void 0!==n&&n.length?a&&t.nodes.some(t=>t.id===e.id):a}),c=e.every(e=>e.width&&e.height);if(e.length>0&&c){var m,h,f;const n=ll(e,d),{x:c,y:u,zoom:p}=ul(n,a,o,null!==(m=t.minZoom)&&void 0!==m?m:i,null!==(h=t.maxZoom)&&void 0!==h?h:r,null!==(f=t.padding)&&void 0!==f?f:.1),g=ji.translate(c,u).scale(p);return"number"===typeof t.duration&&t.duration>0?l.transform(dl(s,t.duration),g):l.transform(s,g),!0}}return!1}function ts(e,t){return e.forEach(e=>{const n=t.get(e.id);n&&t.set(n.id,u(u({},n),{},{[wr]:n[wr],selected:e.selected}))}),new Map(t)}function ns(e,t){return t.map(t=>{const n=e.find(e=>e.id===t.id);return n&&(t.selected=n.selected),t})}function as(e){let{changedNodes:t,changedEdges:n,get:a,set:o}=e;const{nodeInternals:i,edges:r,onNodesChange:l,onEdgesChange:s,hasDefaultNodes:c,hasDefaultEdges:u}=a();null!==t&&void 0!==t&&t.length&&(c&&o({nodeInternals:ts(t,i)}),null===l||void 0===l||l(t)),null!==n&&void 0!==n&&n.length&&(u&&o({edges:ns(n,r)}),null===s||void 0===s||s(n))}const os=()=>{},is={zoomIn:os,zoomOut:os,zoomTo:os,getZoom:()=>1,setViewport:os,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:os,fitBounds:os,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},rs=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection});function ls(){const e=(()=>{const e=rr(),{d3Zoom:t,d3Selection:n}=ir(rs,Qt),o=(0,a.useMemo)(()=>n&&t?{zoomIn:e=>t.scaleBy(dl(n,null===e||void 0===e?void 0:e.duration),1.2),zoomOut:e=>t.scaleBy(dl(n,null===e||void 0===e?void 0:e.duration),1/1.2),zoomTo:(e,a)=>t.scaleTo(dl(n,null===a||void 0===a?void 0:a.duration),e),getZoom:()=>e.getState().transform[2],setViewport:(a,o)=>{var i,r,l;const[s,c,u]=e.getState().transform,d=ji.translate(null!==(i=a.x)&&void 0!==i?i:s,null!==(r=a.y)&&void 0!==r?r:c).scale(null!==(l=a.zoom)&&void 0!==l?l:u);t.transform(dl(n,null===o||void 0===o?void 0:o.duration),d)},getViewport:()=>{const[t,n,a]=e.getState().transform;return{x:t,y:n,zoom:a}},fitView:t=>es(e.getState,t),setCenter:(a,o,i)=>{const{width:r,height:l,maxZoom:s}=e.getState(),c="undefined"!==typeof(null===i||void 0===i?void 0:i.zoom)?i.zoom:s,u=r/2-a*c,d=l/2-o*c,p=ji.translate(u,d).scale(c);t.transform(dl(n,null===i||void 0===i?void 0:i.duration),p)},fitBounds:(a,o)=>{var i;const{width:r,height:l,minZoom:s,maxZoom:c}=e.getState(),{x:u,y:d,zoom:p}=ul(a,r,l,s,c,null!==(i=null===o||void 0===o?void 0:o.padding)&&void 0!==i?i:.1),m=ji.translate(u,d).scale(p);t.transform(dl(n,null===o||void 0===o?void 0:o.duration),m)},project:t=>{const{transform:n,snapToGrid:a,snapGrid:o}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),ol(t,n,a,o)},screenToFlowPosition:t=>{const{transform:n,snapToGrid:a,snapGrid:o,domNode:i}=e.getState();if(!i)return t;const{x:r,y:l}=i.getBoundingClientRect(),s={x:t.x-r,y:t.y-l};return ol(s,n,a,o)},flowToScreenPosition:t=>{const{transform:n,domNode:a}=e.getState();if(!a)return t;const{x:o,y:i}=a.getBoundingClientRect(),r=il(t,n);return{x:r.x+o,y:r.y+i}},viewportInitialized:!0}:is,[t,n]);return o})(),t=rr(),n=(0,a.useCallback)(()=>t.getState().getNodes().map(e=>u({},e)),[]),o=(0,a.useCallback)(e=>t.getState().nodeInternals.get(e),[]),i=(0,a.useCallback)(()=>{const{edges:e=[]}=t.getState();return e.map(e=>u({},e))},[]),r=(0,a.useCallback)(e=>{const{edges:n=[]}=t.getState();return n.find(t=>t.id===e)},[]),l=(0,a.useCallback)(e=>{const{getNodes:n,setNodes:a,hasDefaultNodes:o,onNodesChange:i}=t.getState(),r=n(),l="function"===typeof e?e(r):e;if(o)a(l);else if(i){const e=0===l.length?r.map(e=>({type:"remove",id:e.id})):l.map(e=>({item:e,type:"reset"}));i(e)}},[]),s=(0,a.useCallback)(e=>{const{edges:n=[],setEdges:a,hasDefaultEdges:o,onEdgesChange:i}=t.getState(),r="function"===typeof e?e(n):e;if(o)a(r);else if(i){i(0===r.length?n.map(e=>({type:"remove",id:e.id})):r.map(e=>({item:e,type:"reset"})))}},[]),c=(0,a.useCallback)(e=>{const n=Array.isArray(e)?e:[e],{getNodes:a,setNodes:o,hasDefaultNodes:i,onNodesChange:r}=t.getState();if(i){o([...a(),...n])}else if(r){const e=n.map(e=>({item:e,type:"add"}));r(e)}},[]),d=(0,a.useCallback)(e=>{const n=Array.isArray(e)?e:[e],{edges:a=[],setEdges:o,hasDefaultEdges:i,onEdgesChange:r}=t.getState();if(i)o([...a,...n]);else if(r){r(n.map(e=>({item:e,type:"add"})))}},[]),p=(0,a.useCallback)(()=>{const{getNodes:e,edges:n=[],transform:a}=t.getState(),[o,i,r]=a;return{nodes:e().map(e=>u({},e)),edges:n.map(e=>u({},e)),viewport:{x:o,y:i,zoom:r}}},[]),m=(0,a.useCallback)(e=>{let{nodes:n,edges:a}=e;const{nodeInternals:o,getNodes:i,edges:r,hasDefaultNodes:l,hasDefaultEdges:s,onNodesDelete:c,onEdgesDelete:u,onNodesChange:d,onEdgesChange:p}=t.getState(),m=(n||[]).map(e=>e.id),h=(a||[]).map(e=>e.id),f=i().reduce((e,t)=>{const n=t.parentNode||t.parentId,a=!m.includes(t.id)&&n&&e.find(e=>e.id===n);return("boolean"!==typeof t.deletable||t.deletable)&&(m.includes(t.id)||a)&&e.push(t),e},[]),g=r.filter(e=>"boolean"!==typeof e.deletable||e.deletable),v=g.filter(e=>h.includes(e.id));if(f||v){const e=cl(f,g),n=[...v,...e],a=n.reduce((e,t)=>(e.includes(t.id)||e.push(t.id),e),[]);if((s||l)&&(s&&t.setState({edges:r.filter(e=>!a.includes(e.id))}),l&&(f.forEach(e=>{o.delete(e.id)}),t.setState({nodeInternals:new Map(o)}))),a.length>0&&(null===u||void 0===u||u(n),p&&p(a.map(e=>({id:e,type:"remove"})))),f.length>0&&(null===c||void 0===c||c(f),d)){d(f.map(e=>({id:e.id,type:"remove"})))}}},[]),h=(0,a.useCallback)(e=>{const n=Sr((a=e).width)&&Sr(a.height)&&Sr(a.x)&&Sr(a.y);var a;const o=n?null:t.getState().nodeInternals.get(e.id);if(!n&&!o)return[null,null,n];return[n?e:xr(o),o,n]},[]),f=(0,a.useCallback)(function(e){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=arguments.length>2?arguments[2]:void 0;const[o,i,r]=h(e);return o?(a||t.getState().getNodes()).filter(e=>{if(!r&&(e.id===i.id||!e.positionAbsolute))return!1;const t=xr(e),a=Cr(t,o);return n&&a>0||a>=o.width*o.height}):[]},[]),g=(0,a.useCallback)(function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const[a]=h(e);if(!a)return!1;const o=Cr(a,t);return n&&o>0||o>=a.width*a.height},[]);return(0,a.useMemo)(()=>u(u({},e),{},{getNodes:n,getNode:o,getEdges:i,getEdge:r,setNodes:l,setEdges:s,addNodes:c,addEdges:d,toObject:p,deleteElements:m,getIntersectingNodes:f,isNodeIntersecting:g}),[e,n,o,i,r,l,s,c,d,p,m,f,g])}const ss={actInsideInputWithModifier:!1};const cs={position:"absolute",width:"100%",height:"100%",top:0,left:0},us=e=>({x:e.x,y:e.y,zoom:e.k}),ds=(e,t)=>e.target.closest(".".concat(t)),ps=(e,t)=>2===t&&Array.isArray(e)&&e.includes(2),ms=e=>{const t=e.ctrlKey&&Tr()?10:1;return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*t},hs=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),fs=e=>{let{onMove:t,onMoveStart:n,onMoveEnd:o,onPaneContextMenu:i,zoomOnScroll:r=!0,zoomOnPinch:l=!0,panOnScroll:s=!1,panOnScrollSpeed:c=.5,panOnScrollMode:u=Ir.Free,zoomOnDoubleClick:d=!0,elementsSelectable:p,panOnDrag:m=!0,defaultViewport:h,translateExtent:f,minZoom:g,maxZoom:v,zoomActivationKeyCode:b,preventScrolling:y=!0,children:x,noWheelClassName:C,noPanClassName:S}=e;const w=(0,a.useRef)(),k=rr(),N=(0,a.useRef)(!1),j=(0,a.useRef)(!1),E=(0,a.useRef)(null),M=(0,a.useRef)({x:0,y:0,zoom:0}),{d3Zoom:T,d3Selection:P,d3ZoomHandler:z,userSelectionActive:_}=ir(hs,Qt),R=Kl(b),A=(0,a.useRef)(0),I=(0,a.useRef)(!1),D=(0,a.useRef)();return function(e){const t=rr();(0,a.useEffect)(()=>{let n;const a=()=>{if(!e.current)return;const n=dr(e.current);var a,o;0!==n.height&&0!==n.width||null===(a=(o=t.getState()).onError)||void 0===a||a.call(o,"004",$i()),t.setState({width:n.width||500,height:n.height||500})};return a(),window.addEventListener("resize",a),e.current&&(n=new ResizeObserver(()=>a()),n.observe(e.current)),()=>{window.removeEventListener("resize",a),n&&e.current&&n.unobserve(e.current)}},[])}(E),(0,a.useEffect)(()=>{if(E.current){const e=E.current.getBoundingClientRect(),t=Ii().scaleExtent([g,v]).translateExtent(f),n=ya(E.current).call(t),a=ji.translate(h.x,h.y).scale(pr(h.zoom,g,v)),o=[[0,0],[e.width,e.height]],i=t.constrain()(a,o,f);t.transform(n,i),t.wheelDelta(ms),k.setState({d3Zoom:t,d3Selection:n,d3ZoomHandler:n.on("wheel.zoom"),transform:[i.x,i.y,i.k],domNode:E.current.closest(".react-flow")})}},[]),(0,a.useEffect)(()=>{P&&T&&(!s||R||_?"undefined"!==typeof z&&P.on("wheel.zoom",function(e,t){if(!y&&"wheel"===e.type&&!e.ctrlKey||ds(e,C))return null;e.preventDefault(),z.call(this,e,t)},{passive:!1}):P.on("wheel.zoom",e=>{if(ds(e,C))return!1;e.preventDefault(),e.stopImmediatePropagation();const a=P.property("__zoom").k||1;if(e.ctrlKey&&l){const t=Ma(e),n=ms(e),o=a*Math.pow(2,n);return void T.scaleTo(P,o,t,e)}const i=1===e.deltaMode?20:1;let r=u===Ir.Vertical?0:e.deltaX*i,s=u===Ir.Horizontal?0:e.deltaY*i;!Tr()&&e.shiftKey&&u!==Ir.Vertical&&(r=e.deltaY*i,s=0),T.translateBy(P,-r/a*c,-s/a*c,{internal:!0});const d=us(P.property("__zoom")),{onViewportChangeStart:p,onViewportChange:m,onViewportChangeEnd:h}=k.getState();clearTimeout(D.current),I.current||(I.current=!0,null===n||void 0===n||n(e,d),null===p||void 0===p||p(d)),I.current&&(null===t||void 0===t||t(e,d),null===m||void 0===m||m(d),D.current=setTimeout(()=>{null===o||void 0===o||o(e,d),null===h||void 0===h||h(d),I.current=!1},150))},{passive:!1}))},[_,s,u,P,T,z,R,l,y,C,n,t,o]),(0,a.useEffect)(()=>{T&&T.on("start",e=>{var t,a;if(!e.sourceEvent||e.sourceEvent.internal)return null;A.current=null===(t=e.sourceEvent)||void 0===t?void 0:t.button;const{onViewportChangeStart:o}=k.getState(),i=us(e.transform);N.current=!0,M.current=i,"mousedown"===(null===(a=e.sourceEvent)||void 0===a?void 0:a.type)&&k.setState({paneDragging:!0}),null===o||void 0===o||o(i),null===n||void 0===n||n(e.sourceEvent,i)})},[T,n]),(0,a.useEffect)(()=>{T&&(_&&!N.current?T.on("zoom",null):_||T.on("zoom",e=>{var n,a;const{onViewportChange:o}=k.getState();if(k.setState({transform:[e.transform.x,e.transform.y,e.transform.k]}),j.current=!(!i||!ps(m,null!==(n=A.current)&&void 0!==n?n:0)),(t||o)&&(null===(a=e.sourceEvent)||void 0===a||!a.internal)){const n=us(e.transform);null===o||void 0===o||o(n),null===t||void 0===t||t(e.sourceEvent,n)}}))},[_,T,t,m,i]),(0,a.useEffect)(()=>{T&&T.on("end",e=>{var t;if(!e.sourceEvent||e.sourceEvent.internal)return null;const{onViewportChangeEnd:n}=k.getState();if(N.current=!1,k.setState({paneDragging:!1}),i&&ps(m,null!==(t=A.current)&&void 0!==t?t:0)&&!j.current&&i(e.sourceEvent),j.current=!1,(o||n)&&(a=M.current,r=e.transform,a.x!==r.x||a.y!==r.y||a.zoom!==r.k)){const t=us(e.transform);M.current=t,clearTimeout(w.current),w.current=setTimeout(()=>{null===n||void 0===n||n(t),null===o||void 0===o||o(e.sourceEvent,t)},s?150:0)}var a,r})},[T,s,m,o,i]),(0,a.useEffect)(()=>{T&&T.filter(e=>{const t=R||r,n=l&&e.ctrlKey;if((!0===m||Array.isArray(m)&&m.includes(1))&&1===e.button&&"mousedown"===e.type&&(ds(e,"react-flow__node")||ds(e,"react-flow__edge")))return!0;if(!m&&!t&&!s&&!d&&!l)return!1;if(_)return!1;if(!d&&"dblclick"===e.type)return!1;if(ds(e,C)&&"wheel"===e.type)return!1;if(ds(e,S)&&("wheel"!==e.type||s&&"wheel"===e.type&&!R))return!1;if(!l&&e.ctrlKey&&"wheel"===e.type)return!1;if(!t&&!s&&!n&&"wheel"===e.type)return!1;if(!m&&("mousedown"===e.type||"touchstart"===e.type))return!1;if(Array.isArray(m)&&!m.includes(e.button)&&"mousedown"===e.type)return!1;const a=Array.isArray(m)&&m.includes(e.button)||!e.button||e.button<=1;return(!e.ctrlKey||"wheel"===e.type)&&a})},[_,T,r,l,s,d,m,p,R]),a.createElement("div",{className:"react-flow__renderer",ref:E,style:cs},x)},gs=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function vs(){const{userSelectionActive:e,userSelectionRect:t}=ir(gs,Qt);return e&&t?a.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:"translate(".concat(t.x,"px, ").concat(t.y,"px)")}}):null}function bs(e,t){const n=t.parentNode||t.parentId,a=e.find(e=>e.id===n);if(a){const e=t.position.x+t.width-a.width,n=t.position.y+t.height-a.height;if(e>0||n>0||t.position.x<0||t.position.y<0){var o,i;if(a.style=u({},a.style)||{},a.style.width=null!==(o=a.style.width)&&void 0!==o?o:a.width,a.style.height=null!==(i=a.style.height)&&void 0!==i?i:a.height,e>0&&(a.style.width+=e),n>0&&(a.style.height+=n),t.position.x<0){const e=Math.abs(t.position.x);a.position.x=a.position.x-e,a.style.width+=e,t.position.x=0}if(t.position.y<0){const e=Math.abs(t.position.y);a.position.y=a.position.y-e,a.style.height+=e,t.position.y=0}a.width=a.style.width,a.height=a.style.height}}}function ys(e,t){if(e.some(e=>"reset"===e.type))return e.filter(e=>"reset"===e.type).map(e=>e.item);const n=e.filter(e=>"add"===e.type).map(e=>e.item);return t.reduce((t,n)=>{const a=e.filter(e=>e.id===n.id);if(0===a.length)return t.push(n),t;const o=u({},n);for(const e of a)if(e)switch(e.type){case"select":o.selected=e.selected;break;case"position":"undefined"!==typeof e.position&&(o.position=e.position),"undefined"!==typeof e.positionAbsolute&&(o.positionAbsolute=e.positionAbsolute),"undefined"!==typeof e.dragging&&(o.dragging=e.dragging),o.expandParent&&bs(t,o);break;case"dimensions":"undefined"!==typeof e.dimensions&&(o.width=e.dimensions.width,o.height=e.dimensions.height),"undefined"!==typeof e.updateStyle&&(o.style=u(u({},o.style||{}),e.dimensions)),"boolean"===typeof e.resizing&&(o.resizing=e.resizing),o.expandParent&&bs(t,o);break;case"remove":return t}return t.push(o),t},n)}function xs(e,t){return ys(e,t)}const Cs=(e,t)=>({id:e,type:"select",selected:t});function Ss(e,t){return e.reduce((e,n)=>{const a=t.includes(n.id);return!n.selected&&a?(n.selected=!0,e.push(Cs(n.id,!0))):n.selected&&!a&&(n.selected=!1,e.push(Cs(n.id,!1))),e},[])}const ws=(e,t)=>n=>{n.target===t.current&&(null===e||void 0===e||e(n))},ks=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),Ns=(0,a.memo)(e=>{let{isSelecting:t,selectionMode:n=Dr.Full,panOnDrag:o,onSelectionStart:i,onSelectionEnd:r,onPaneClick:l,onPaneContextMenu:s,onPaneScroll:c,onPaneMouseEnter:d,onPaneMouseMove:p,onPaneMouseLeave:m,children:h}=e;const f=(0,a.useRef)(null),g=rr(),v=(0,a.useRef)(0),b=(0,a.useRef)(0),y=(0,a.useRef)(),{userSelectionActive:x,elementsSelectable:C,dragging:S}=ir(ks,Qt),w=()=>{g.setState({userSelectionActive:!1,userSelectionRect:null}),v.current=0,b.current=0},k=e=>{null===l||void 0===l||l(e),g.getState().resetSelectedElements(),g.setState({nodesSelectionActive:!1})},N=c?e=>c(e):void 0,j=C&&(t||x);return a.createElement("div",{className:Wt(["react-flow__pane",{dragging:S,selection:t}]),onClick:j?void 0:ws(k,f),onContextMenu:ws(e=>{Array.isArray(o)&&null!==o&&void 0!==o&&o.includes(2)?e.preventDefault():null===s||void 0===s||s(e)},f),onWheel:ws(N,f),onMouseEnter:j?void 0:d,onMouseDown:j?e=>{const{resetSelectedElements:n,domNode:a}=g.getState();if(y.current=null===a||void 0===a?void 0:a.getBoundingClientRect(),!C||!t||0!==e.button||e.target!==f.current||!y.current)return;const{x:o,y:r}=Mr(e,y.current);n(),g.setState({userSelectionRect:{width:0,height:0,startX:o,startY:r,x:o,y:r}}),null===i||void 0===i||i(e)}:void 0,onMouseMove:j?e=>{var a,o;const{userSelectionRect:i,nodeInternals:r,edges:l,transform:s,onNodesChange:c,onEdgesChange:d,nodeOrigin:p,getNodes:m}=g.getState();if(!t||!y.current||!i)return;g.setState({userSelectionActive:!0,nodesSelectionActive:!1});const h=Mr(e,y.current),f=null!==(a=i.startX)&&void 0!==a?a:0,x=null!==(o=i.startY)&&void 0!==o?o:0,C=u(u({},i),{},{x:h.x<f?h.x:f,y:h.y<x?h.y:x,width:Math.abs(h.x-f),height:Math.abs(h.y-x)}),S=m(),w=sl(r,C,s,n===Dr.Partial,!0,p),k=cl(w,l).map(e=>e.id),N=w.map(e=>e.id);if(v.current!==N.length){v.current=N.length;const e=Ss(S,N);e.length&&(null===c||void 0===c||c(e))}if(b.current!==k.length){b.current=k.length;const e=Ss(l,k);e.length&&(null===d||void 0===d||d(e))}g.setState({userSelectionRect:C})}:p,onMouseUp:j?e=>{if(0!==e.button)return;const{userSelectionRect:t}=g.getState();!x&&t&&e.target===f.current&&(null===k||void 0===k||k(e)),g.setState({nodesSelectionActive:v.current>0}),w(),null===r||void 0===r||r(e)}:void 0,onMouseLeave:j?e=>{x&&(g.setState({nodesSelectionActive:v.current>0}),null===r||void 0===r||r(e)),w()}:m,ref:f,style:cs},h,a.createElement(vs,null))});function js(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const a=t.get(n);return!!a&&(!!a.selected||js(a,t))}function Es(e,t,n){let a=e;do{var o;if(null!==(o=a)&&void 0!==o&&o.matches(t))return!0;if(a===n.current)return!1;a=a.parentElement}while(a);return!1}function Ms(e,t,n,a){return Array.from(e.values()).filter(n=>(n.selected||n.id===a)&&(!n.parentNode||n.parentId||!js(n,e))&&(n.draggable||t&&"undefined"===typeof n.draggable)).map(e=>{var t,a,o,i;return{id:e.id,position:e.position||{x:0,y:0},positionAbsolute:e.positionAbsolute||{x:0,y:0},distance:{x:n.x-(null!==(t=null===(a=e.positionAbsolute)||void 0===a?void 0:a.x)&&void 0!==t?t:0),y:n.y-(null!==(o=null===(i=e.positionAbsolute)||void 0===i?void 0:i.y)&&void 0!==o?o:0)},delta:{x:0,y:0},extent:e.extent,parentNode:e.parentNode||e.parentId,parentId:e.parentNode||e.parentId,width:e.width,height:e.height,expandParent:e.expandParent}})}function Ts(e,t,n,a){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[0,0],i=arguments.length>5?arguments[5]:void 0;const r=function(e,t){return t&&"parent"!==t?[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]:t}(e,e.extent||a);let l=r;const s=e.parentNode||e.parentId;if("parent"!==e.extent||e.expandParent){if(e.extent&&s&&"parent"!==e.extent){const t=n.get(s),{x:a,y:i}=rl(t,o).positionAbsolute;l=[[e.extent[0][0]+a,e.extent[0][1]+i],[e.extent[1][0]+a,e.extent[1][1]+i]]}}else if(s&&e.width&&e.height){const t=n.get(s),{x:a,y:i}=rl(t,o).positionAbsolute;l=t&&Sr(a)&&Sr(i)&&Sr(t.width)&&Sr(t.height)?[[a+e.width*o[0],i+e.height*o[1]],[a+t.width-e.width+e.width*o[0],i+t.height-e.height+e.height*o[1]]]:l}else null===i||void 0===i||i("005",Ji()),l=r;let c={x:0,y:0};if(s){const e=n.get(s);c=rl(e,o).positionAbsolute}const u=l&&"parent"!==l?mr(t,l):t;return{position:{x:u.x-c.x,y:u.y-c.y},positionAbsolute:u}}function Ps(e){let{nodeId:t,dragItems:n,nodeInternals:a}=e;const o=n.map(e=>u(u({},a.get(e.id)),{},{position:e.position,positionAbsolute:e.positionAbsolute}));return[t?o.find(e=>e.id===t):o[0],o]}Ns.displayName="Pane";const zs=(e,t,n,a)=>{const o=t.querySelectorAll(e);if(!o||!o.length)return null;const i=Array.from(o),r=t.getBoundingClientRect(),l=r.width*a[0],s=r.height*a[1];return i.map(e=>{const t=e.getBoundingClientRect();return u({id:e.getAttribute("data-handleid"),position:e.getAttribute("data-handlepos"),x:(t.left-r.left-l)/n,y:(t.top-r.top-s)/n},dr(e))})};function _s(e,t,n){return void 0===n?n:a=>{const o=t().nodeInternals.get(e);o&&n(a,u({},o))}}function Rs(e){let{id:t,store:n,unselect:a=!1,nodeRef:o}=e;const{addSelectedNodes:i,unselectNodesAndEdges:r,multiSelectionActive:l,nodeInternals:s,onError:c}=n.getState(),u=s.get(t);u?(n.setState({nodesSelectionActive:!1}),u.selected?(a||u.selected&&l)&&(r({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var e;return null===o||void 0===o||null===(e=o.current)||void 0===e?void 0:e.blur()})):i([t])):null===c||void 0===c||c("012",ar(t))}function As(e){return(t,n,a)=>null===e||void 0===e?void 0:e(t,a)}function Is(e){let{nodeRef:t,disabled:n=!1,noDragClassName:o,handleSelector:i,nodeId:r,isSelectable:l,selectNodesOnDrag:s}=e;const c=rr(),[d,p]=(0,a.useState)(!1),m=(0,a.useRef)([]),h=(0,a.useRef)({x:null,y:null}),f=(0,a.useRef)(0),g=(0,a.useRef)(null),v=(0,a.useRef)({x:0,y:0}),b=(0,a.useRef)(null),y=(0,a.useRef)(!1),x=(0,a.useRef)(!1),C=(0,a.useRef)(!1),S=function(){const e=rr(),t=(0,a.useCallback)(t=>{let{sourceEvent:n}=t;const{transform:a,snapGrid:o,snapToGrid:i}=e.getState(),r=n.touches?n.touches[0].clientX:n.clientX,l=n.touches?n.touches[0].clientY:n.clientY,s={x:(r-a[0])/a[2],y:(l-a[1])/a[2]};return u({xSnapped:i?o[0]*Math.round(s.x/o[0]):s.x,ySnapped:i?o[1]*Math.round(s.y/o[1]):s.y},s)},[]);return t}();return(0,a.useEffect)(()=>{if(null!==t&&void 0!==t&&t.current){const e=ya(t.current),a=e=>{let{x:t,y:n}=e;const{nodeInternals:a,onNodeDrag:o,onSelectionDrag:i,updateNodePositions:l,nodeExtent:s,snapGrid:u,snapToGrid:d,nodeOrigin:f,onError:g}=c.getState();h.current={x:t,y:n};let v=!1,y={x:0,y:0,x2:0,y2:0};if(m.current.length>1&&s){const e=ll(m.current,f);y=br(e)}if(m.current=m.current.map(e=>{const o={x:t-e.distance.x,y:n-e.distance.y};d&&(o.x=u[0]*Math.round(o.x/u[0]),o.y=u[1]*Math.round(o.y/u[1]));const i=[[s[0][0],s[0][1]],[s[1][0],s[1][1]]];var r,l;m.current.length>1&&s&&!e.extent&&(i[0][0]=e.positionAbsolute.x-y.x+s[0][0],i[1][0]=e.positionAbsolute.x+(null!==(r=e.width)&&void 0!==r?r:0)-y.x2+s[1][0],i[0][1]=e.positionAbsolute.y-y.y+s[0][1],i[1][1]=e.positionAbsolute.y+(null!==(l=e.height)&&void 0!==l?l:0)-y.y2+s[1][1]);const c=Ts(e,o,a,i,f,g);return v=v||e.position.x!==c.position.x||e.position.y!==c.position.y,e.position=c.position,e.positionAbsolute=c.positionAbsolute,e}),!v)return;l(m.current,!0,!0),p(!0);const x=r?o:As(i);if(x&&b.current){const[e,t]=Ps({nodeId:r,dragItems:m.current,nodeInternals:a});x(b.current,e,t)}},u=()=>{if(!g.current)return;const[e,t]=fr(v.current,g.current);if(0!==e||0!==t){var n,o;const{transform:i,panBy:r}=c.getState();h.current.x=(null!==(n=h.current.x)&&void 0!==n?n:0)-e/i[2],h.current.y=(null!==(o=h.current.y)&&void 0!==o?o:0)-t/i[2],r({x:e,y:t})&&a(h.current)}f.current=requestAnimationFrame(u)},d=e=>{const{nodeInternals:n,multiSelectionActive:a,nodesDraggable:o,unselectNodesAndEdges:i,onNodeDragStart:u,onSelectionDragStart:d}=c.getState();x.current=!0;const p=r?u:As(d);var f;s&&l||a||!r||(null!==(f=n.get(r))&&void 0!==f&&f.selected||i());r&&l&&s&&Rs({id:r,store:c,nodeRef:t});const g=S(e);if(h.current=g,m.current=Ms(n,o,g,r),p&&m.current){const[t,a]=Ps({nodeId:r,dragItems:m.current,nodeInternals:n});p(e.sourceEvent,t,a)}};if(!n){const n=function(){var e,t,n,a,o=Fi,i=Li,r=Bi,l=Ui,s={},c=on("start","drag","end"),u=0,d=0;function p(e){e.on("mousedown.drag",m).filter(l).on("touchstart.drag",g).on("touchmove.drag",v,xa).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(r,l){if(!a&&o.call(this,r,l)){var s=y(this,i.call(this,r,l),r,l,"mouse");s&&(ya(r.view).on("mousemove.drag",h,Ca).on("mouseup.drag",f,Ca),ka(r.view),Sa(r),n=!1,e=r.clientX,t=r.clientY,s("start",r))}}function h(a){if(wa(a),!n){var o=a.clientX-e,i=a.clientY-t;n=o*o+i*i>d}s.mouse("drag",a)}function f(e){ya(e.view).on("mousemove.drag mouseup.drag",null),Na(e.view,n),wa(e),s.mouse("end",e)}function g(e,t){if(o.call(this,e,t)){var n,a,r=e.changedTouches,l=i.call(this,e,t),s=r.length;for(n=0;n<s;++n)(a=y(this,l,e,t,r[n].identifier,r[n]))&&(Sa(e),a("start",e,r[n]))}}function v(e){var t,n,a=e.changedTouches,o=a.length;for(t=0;t<o;++t)(n=s[a[t].identifier])&&(wa(e),n("drag",e,a[t]))}function b(e){var t,n,o=e.changedTouches,i=o.length;for(a&&clearTimeout(a),a=setTimeout(function(){a=null},500),t=0;t<i;++t)(n=s[o[t].identifier])&&(Sa(e),n("end",e,o[t]))}function y(e,t,n,a,o,i){var l,d,m,h=c.copy(),f=Ma(i||n,t);if(null!=(m=r.call(e,new Oi("beforestart",{sourceEvent:n,target:p,identifier:o,active:u,x:f[0],y:f[1],dx:0,dy:0,dispatch:h}),a)))return l=m.x-f[0]||0,d=m.y-f[1]||0,function n(i,r,c){var g,v=f;switch(i){case"start":s[o]=n,g=u++;break;case"end":delete s[o],--u;case"drag":f=Ma(c||r,t),g=u}h.call(i,e,new Oi(i,{sourceEvent:r,subject:m,target:p,identifier:o,active:g,x:f[0]+l,y:f[1]+d,dx:f[0]-v[0],dy:f[1]-v[1],dispatch:h}),a)}}return p.filter=function(e){return arguments.length?(o="function"===typeof e?e:Di(!!e),p):o},p.container=function(e){return arguments.length?(i="function"===typeof e?e:Di(e),p):i},p.subject=function(e){return arguments.length?(r="function"===typeof e?e:Di(e),p):r},p.touchable=function(e){return arguments.length?(l="function"===typeof e?e:Di(!!e),p):l},p.on=function(){var e=c.on.apply(c,arguments);return e===c?p:e},p.clickDistance=function(e){return arguments.length?(d=(e=+e)*e,p):Math.sqrt(d)},p}().on("start",e=>{const{domNode:t,nodeDragThreshold:n}=c.getState();0===n&&d(e),C.current=!1;const a=S(e);h.current=a,g.current=(null===t||void 0===t?void 0:t.getBoundingClientRect())||null,v.current=Mr(e.sourceEvent,g.current)}).on("drag",e=>{const t=S(e),{autoPanOnNodeDrag:n,nodeDragThreshold:o}=c.getState();if("touchmove"===e.sourceEvent.type&&e.sourceEvent.touches.length>1&&(C.current=!0),!C.current){if(!y.current&&x.current&&n&&(y.current=!0,u()),!x.current){var i,r,l,s;const n=t.xSnapped-(null!==(i=null===h||void 0===h||null===(r=h.current)||void 0===r?void 0:r.x)&&void 0!==i?i:0),a=t.ySnapped-(null!==(l=null===h||void 0===h||null===(s=h.current)||void 0===s?void 0:s.y)&&void 0!==l?l:0);Math.sqrt(n*n+a*a)>o&&d(e)}(h.current.x!==t.xSnapped||h.current.y!==t.ySnapped)&&m.current&&x.current&&(b.current=e.sourceEvent,v.current=Mr(e.sourceEvent,g.current),a(t))}}).on("end",e=>{if(x.current&&!C.current&&(p(!1),y.current=!1,x.current=!1,cancelAnimationFrame(f.current),m.current)){const{updateNodePositions:t,nodeInternals:n,onNodeDragStop:a,onSelectionDragStop:o}=c.getState(),i=r?a:As(o);if(t(m.current,!1,!1),i){const[t,a]=Ps({nodeId:r,dragItems:m.current,nodeInternals:n});i(e.sourceEvent,t,a)}}}).filter(e=>{const n=e.target;return!e.button&&(!o||!Es(n,".".concat(o),t))&&(!i||Es(n,i,t))});return e.call(n),()=>{e.on(".drag",null)}}e.on(".drag",null)}},[t,n,o,i,l,c,r,s,S]),d}function Ds(){const e=rr();return(0,a.useCallback)(t=>{const{nodeInternals:n,nodeExtent:a,updateNodePositions:o,getNodes:i,snapToGrid:r,snapGrid:l,onError:s,nodesDraggable:c}=e.getState(),u=i().filter(e=>e.selected&&(e.draggable||c&&"undefined"===typeof e.draggable)),d=r?l[0]:5,p=r?l[1]:5,m=t.isShiftPressed?4:1,h=t.x*d*m,f=t.y*p*m;o(u.map(e=>{if(e.positionAbsolute){const t={x:e.positionAbsolute.x+h,y:e.positionAbsolute.y+f};r&&(t.x=l[0]*Math.round(t.x/l[0]),t.y=l[1]*Math.round(t.y/l[1]));const{positionAbsolute:o,position:i}=Ts(e,t,n,a,void 0,s);e.position=i,e.positionAbsolute=o}return e}),!0,!1)},[])}const Os={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Fs=e=>{const t=t=>{let{id:n,type:o,data:i,xPos:r,yPos:l,xPosOrigin:s,yPosOrigin:c,selected:d,onClick:p,onMouseEnter:m,onMouseMove:h,onMouseLeave:f,onContextMenu:g,onDoubleClick:v,style:b,className:y,isDraggable:x,isSelectable:C,isConnectable:S,isFocusable:w,selectNodesOnDrag:k,sourcePosition:N,targetPosition:j,hidden:E,resizeObserver:M,dragHandle:T,zIndex:P,isParent:z,noDragClassName:_,noPanClassName:R,initialized:A,disableKeyboardA11y:I,ariaLabel:D,rfId:O,hasHandleBounds:F}=t;const L=rr(),B=(0,a.useRef)(null),U=(0,a.useRef)(null),H=(0,a.useRef)(N),W=(0,a.useRef)(j),V=(0,a.useRef)(o),G=C||x||p||m||h||f,Y=Ds(),X=_s(n,L.getState,m),K=_s(n,L.getState,h),q=_s(n,L.getState,f),$=_s(n,L.getState,g),J=_s(n,L.getState,v);(0,a.useEffect)(()=>()=>{U.current&&(null===M||void 0===M||M.unobserve(U.current),U.current=null)},[]),(0,a.useEffect)(()=>{if(B.current&&!E){const e=B.current;A&&F&&U.current===e||(U.current&&(null===M||void 0===M||M.unobserve(U.current)),null===M||void 0===M||M.observe(e),U.current=e)}},[E,A,F]),(0,a.useEffect)(()=>{const e=V.current!==o,t=H.current!==N,a=W.current!==j;B.current&&(e||t||a)&&(e&&(V.current=o),t&&(H.current=N),a&&(W.current=j),L.getState().updateNodeDimensions([{id:n,nodeElement:B.current,forceUpdate:!0}]))},[n,o,N,j]);const Q=Is({nodeRef:B,disabled:E||!x,noDragClassName:_,handleSelector:T,nodeId:n,isSelectable:C,selectNodesOnDrag:k});return E?null:a.createElement("div",{className:Wt(["react-flow__node","react-flow__node-".concat(o),{[R]:x},y,{selected:d,selectable:C,parent:z,dragging:Q}]),ref:B,style:u({zIndex:P,transform:"translate(".concat(s,"px,").concat(c,"px)"),pointerEvents:G?"all":"none",visibility:A?"visible":"hidden"},b),"data-id":n,"data-testid":"rf__node-".concat(n),onMouseEnter:X,onMouseMove:K,onMouseLeave:q,onContextMenu:$,onClick:e=>{const{nodeDragThreshold:t}=L.getState();if(C&&(!k||!x||t>0)&&Rs({id:n,store:L,nodeRef:B}),p){const t=L.getState().nodeInternals.get(n);t&&p(e,u({},t))}},onDoubleClick:J,onKeyDown:w?e=>{if(!jr(e)&&!I)if(kr.includes(e.key)&&C){const t="Escape"===e.key;Rs({id:n,store:L,unselect:t,nodeRef:B})}else x&&d&&Object.prototype.hasOwnProperty.call(Os,e.key)&&(L.setState({ariaLiveMessage:"Moved selected node ".concat(e.key.replace("Arrow","").toLowerCase(),". New position, x: ").concat(~~r,", y: ").concat(~~l)}),Y({x:Os[e.key].x,y:Os[e.key].y,isShiftPressed:e.shiftKey}))}:void 0,tabIndex:w?0:void 0,role:w?"button":void 0,"aria-describedby":I?void 0:"".concat(Wl,"-").concat(O),"aria-label":D},a.createElement(tl,{value:n},a.createElement(e,{id:n,data:i,type:o,xPos:r,yPos:l,selected:d,isConnectable:S,sourcePosition:N,targetPosition:j,dragging:Q,dragHandle:T,zIndex:P})))};return t.displayName="NodeWrapper",(0,a.memo)(t)};const Ls=e=>{const t=e.getNodes().filter(e=>e.selected);return u(u({},ll(t,e.nodeOrigin)),{},{transformString:"translate(".concat(e.transform[0],"px,").concat(e.transform[1],"px) scale(").concat(e.transform[2],")"),userSelectionActive:e.userSelectionActive})};var Bs=(0,a.memo)(function(e){let{onSelectionContextMenu:t,noPanClassName:n,disableKeyboardA11y:o}=e;const i=rr(),{width:r,height:l,x:s,y:c,transformString:u,userSelectionActive:d}=ir(Ls,Qt),p=Ds(),m=(0,a.useRef)(null);if((0,a.useEffect)(()=>{var e;o||(null===(e=m.current)||void 0===e||e.focus({preventScroll:!0}))},[o]),Is({nodeRef:m}),d||!r||!l)return null;const h=t?e=>{const n=i.getState().getNodes().filter(e=>e.selected);t(e,n)}:void 0;return a.createElement("div",{className:Wt(["react-flow__nodesselection","react-flow__container",n]),style:{transform:u}},a.createElement("div",{ref:m,className:"react-flow__nodesselection-rect",onContextMenu:h,tabIndex:o?void 0:-1,onKeyDown:o?void 0:e=>{Object.prototype.hasOwnProperty.call(Os,e.key)&&p({x:Os[e.key].x,y:Os[e.key].y,isShiftPressed:e.shiftKey})},style:{width:r,height:l,top:c,left:s}}))});const Us=e=>e.nodesSelectionActive,Hs=e=>{let{children:t,onPaneClick:n,onPaneMouseEnter:o,onPaneMouseMove:i,onPaneMouseLeave:r,onPaneContextMenu:l,onPaneScroll:s,deleteKeyCode:c,onMove:u,onMoveStart:d,onMoveEnd:p,selectionKeyCode:m,selectionOnDrag:h,selectionMode:f,onSelectionStart:g,onSelectionEnd:v,multiSelectionKeyCode:b,panActivationKeyCode:y,zoomActivationKeyCode:x,elementsSelectable:C,zoomOnScroll:S,zoomOnPinch:w,panOnScroll:k,panOnScrollSpeed:N,panOnScrollMode:j,zoomOnDoubleClick:E,panOnDrag:M,defaultViewport:T,translateExtent:P,minZoom:z,maxZoom:_,preventScrolling:R,onSelectionContextMenu:A,noWheelClassName:I,noPanClassName:D,disableKeyboardA11y:O}=e;const F=ir(Us),L=Kl(m),B=Kl(y),U=B||M,H=B||k,W=L||h&&!0!==U;return(e=>{let{deleteKeyCode:t,multiSelectionKeyCode:n}=e;const o=rr(),{deleteElements:i}=ls(),r=Kl(t,ss),l=Kl(n);(0,a.useEffect)(()=>{if(r){const{edges:e,getNodes:t}=o.getState(),n=t().filter(e=>e.selected),a=e.filter(e=>e.selected);i({nodes:n,edges:a}),o.setState({nodesSelectionActive:!1})}},[r]),(0,a.useEffect)(()=>{o.setState({multiSelectionActive:l})},[l])})({deleteKeyCode:c,multiSelectionKeyCode:b}),a.createElement(fs,{onMove:u,onMoveStart:d,onMoveEnd:p,onPaneContextMenu:l,elementsSelectable:C,zoomOnScroll:S,zoomOnPinch:w,panOnScroll:H,panOnScrollSpeed:N,panOnScrollMode:j,zoomOnDoubleClick:E,panOnDrag:!L&&U,defaultViewport:T,translateExtent:P,minZoom:z,maxZoom:_,zoomActivationKeyCode:x,preventScrolling:R,noWheelClassName:I,noPanClassName:D},a.createElement(Ns,{onSelectionStart:g,onSelectionEnd:v,onPaneClick:n,onPaneMouseEnter:o,onPaneMouseMove:i,onPaneMouseLeave:r,onPaneContextMenu:l,onPaneScroll:s,panOnDrag:U,isSelecting:!!W,selectionMode:f},t,F&&a.createElement(Bs,{onSelectionContextMenu:A,noPanClassName:D,disableKeyboardA11y:O})))};Hs.displayName="FlowRenderer";var Ws=(0,a.memo)(Hs);function Vs(e){const t={input:Fs(e.input||El),default:Fs(e.default||Nl),output:Fs(e.output||Tl),group:Fs(e.group||Pl)},n=Object.keys(e).filter(e=>!["input","default","output","group"].includes(e)).reduce((t,n)=>(t[n]=Fs(e[n]||Nl),t),{});return u(u({},t),n)}const Gs=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),Ys=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:i,updateNodeDimensions:r,onError:l}=ir(Gs,Qt),s=(c=e.onlyRenderVisibleElements,ir((0,a.useCallback)(e=>c?sl(e.nodeInternals,{x:0,y:0,width:e.width,height:e.height},e.transform,!0):e.getNodes(),[c])));var c;const u=(0,a.useRef)(),d=(0,a.useMemo)(()=>{if("undefined"===typeof ResizeObserver)return null;const e=new ResizeObserver(e=>{const t=e.map(e=>({id:e.target.getAttribute("data-id"),nodeElement:e.target,forceUpdate:!0}));r(t)});return u.current=e,e},[]);return(0,a.useEffect)(()=>()=>{var e;null===u||void 0===u||null===(e=u.current)||void 0===e||e.disconnect()},[]),a.createElement("div",{className:"react-flow__nodes",style:cs},s.map(r=>{var s,c,u,p,m,h,f,g;let v=r.type||"default";e.nodeTypes[v]||(null===l||void 0===l||l("003",qi(v)),v="default");const b=e.nodeTypes[v]||e.nodeTypes.default,y=!!(r.draggable||t&&"undefined"===typeof r.draggable),x=!!(r.selectable||i&&"undefined"===typeof r.selectable),C=!!(r.connectable||n&&"undefined"===typeof r.connectable),S=!!(r.focusable||o&&"undefined"===typeof r.focusable),w=e.nodeExtent?mr(r.positionAbsolute,e.nodeExtent):r.positionAbsolute,k=null!==(s=null===w||void 0===w?void 0:w.x)&&void 0!==s?s:0,N=null!==(c=null===w||void 0===w?void 0:w.y)&&void 0!==c?c:0,j=(e=>{let{x:t,y:n,width:a,height:o,origin:i}=e;return a&&o?i[0]<0||i[1]<0||i[0]>1||i[1]>1?{x:t,y:n}:{x:t-a*i[0],y:n-o*i[1]}:{x:t,y:n}})({x:k,y:N,width:null!==(u=r.width)&&void 0!==u?u:0,height:null!==(p=r.height)&&void 0!==p?p:0,origin:e.nodeOrigin});return a.createElement(b,{key:r.id,id:r.id,className:r.className,style:r.style,type:v,data:r.data,sourcePosition:r.sourcePosition||Lr.Bottom,targetPosition:r.targetPosition||Lr.Top,hidden:r.hidden,xPos:k,yPos:N,xPosOrigin:j.x,yPosOrigin:j.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!r.selected,isDraggable:y,isSelectable:x,isConnectable:C,isFocusable:S,resizeObserver:d,dragHandle:r.dragHandle,zIndex:null!==(m=null===(h=r[wr])||void 0===h?void 0:h.z)&&void 0!==m?m:0,isParent:!(null===(f=r[wr])||void 0===f||!f.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!r.width&&!!r.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:r.ariaLabel,hasHandleBounds:!(null===(g=r[wr])||void 0===g||!g.handleBounds)})}))};Ys.displayName="NodeRenderer";var Xs=(0,a.memo)(Ys);const Ks=(e,t,n)=>n===Lr.Left?e-t:n===Lr.Right?e+t:e,qs=(e,t,n)=>n===Lr.Top?e-t:n===Lr.Bottom?e+t:e,$s="react-flow__edgeupdater",Js=e=>{let{position:t,centerX:n,centerY:o,radius:i=10,onMouseDown:r,onMouseEnter:l,onMouseOut:s,type:c}=e;return a.createElement("circle",{onMouseDown:r,onMouseEnter:l,onMouseOut:s,className:Wt([$s,"".concat($s,"-").concat(c)]),cx:Ks(n,i,t),cy:qs(o,i,t),r:i,stroke:"transparent",fill:"transparent"})},Qs=()=>!0;var Zs=e=>{const t=t=>{let{id:n,className:o,type:i,data:r,onClick:l,onEdgeDoubleClick:s,selected:c,animated:u,label:d,labelStyle:p,labelShowBg:m,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:g,style:v,source:b,target:y,sourceX:x,sourceY:C,targetX:S,targetY:w,sourcePosition:k,targetPosition:N,elementsSelectable:j,hidden:E,sourceHandleId:M,targetHandleId:T,onContextMenu:P,onMouseEnter:z,onMouseMove:_,onMouseLeave:R,reconnectRadius:A,onReconnect:I,onReconnectStart:D,onReconnectEnd:O,markerEnd:F,markerStart:L,rfId:B,ariaLabel:U,isFocusable:H,isReconnectable:W,pathOptions:V,interactionWidth:G,disableKeyboardA11y:Y}=t;const X=(0,a.useRef)(null),[K,q]=(0,a.useState)(!1),[$,J]=(0,a.useState)(!1),Q=rr(),Z=(0,a.useMemo)(()=>"url('#".concat(al(L,B),"')"),[L,B]),ee=(0,a.useMemo)(()=>"url('#".concat(al(F,B),"')"),[F,B]);if(E)return null;const te=zr(n,Q.getState,s),ne=zr(n,Q.getState,P),ae=zr(n,Q.getState,z),oe=zr(n,Q.getState,_),ie=zr(n,Q.getState,R),re=(e,t)=>{if(0!==e.button)return;const{edges:a,isValidConnection:o}=Q.getState(),i=t?y:b,r=(t?T:M)||null,l=t?"target":"source",s=o||Qs,c=t,u=a.find(e=>e.id===n);J(!0),null===D||void 0===D||D(e,u,l);yl({event:e,handleId:r,nodeId:i,onConnect:e=>null===I||void 0===I?void 0:I(u,e),isTarget:c,getState:Q.getState,setState:Q.setState,isValidConnection:s,edgeUpdaterType:l,onReconnectEnd:e=>{J(!1),null===O||void 0===O||O(e,u,l)}})},le=()=>q(!0),se=()=>q(!1),ce=!j&&!l;return a.createElement("g",{className:Wt(["react-flow__edge","react-flow__edge-".concat(i),o,{selected:c,animated:u,inactive:ce,updating:K}]),onClick:e=>{const{edges:t,addSelectedEdges:a,unselectNodesAndEdges:o,multiSelectionActive:i}=Q.getState(),r=t.find(e=>e.id===n);if(r){var s;if(j)if(Q.setState({nodesSelectionActive:!1}),r.selected&&i)o({nodes:[],edges:[r]}),null===(s=X.current)||void 0===s||s.blur();else a([n]);l&&l(e,r)}},onDoubleClick:te,onContextMenu:ne,onMouseEnter:ae,onMouseMove:oe,onMouseLeave:ie,onKeyDown:H?e=>{if(!Y&&kr.includes(e.key)&&j){const{unselectNodesAndEdges:a,addSelectedEdges:o,edges:i}=Q.getState();var t;if("Escape"===e.key)null===(t=X.current)||void 0===t||t.blur(),a({edges:[i.find(e=>e.id===n)]});else o([n])}}:void 0,tabIndex:H?0:void 0,role:H?"button":"img","data-testid":"rf__edge-".concat(n),"aria-label":null===U?void 0:U||"Edge from ".concat(b," to ").concat(y),"aria-describedby":H?"".concat(Vl,"-").concat(B):void 0,ref:X},!$&&a.createElement(e,{id:n,source:b,target:y,selected:c,animated:u,label:d,labelStyle:p,labelShowBg:m,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:g,data:r,style:v,sourceX:x,sourceY:C,targetX:S,targetY:w,sourcePosition:k,targetPosition:N,sourceHandleId:M,targetHandleId:T,markerStart:Z,markerEnd:ee,pathOptions:V,interactionWidth:G}),W&&a.createElement(a.Fragment,null,("source"===W||!0===W)&&a.createElement(Js,{position:k,centerX:x,centerY:C,radius:A,onMouseDown:e=>re(e,!0),onMouseEnter:le,onMouseOut:se,type:"source"}),("target"===W||!0===W)&&a.createElement(Js,{position:N,centerX:S,centerY:w,radius:A,onMouseDown:e=>re(e,!1),onMouseEnter:le,onMouseOut:se,type:"target"})))};return t.displayName="EdgeWrapper",(0,a.memo)(t)};function ec(e){const t={default:Zs(e.default||Zr),straight:Zs(e.bezier||qr),step:Zs(e.step||Kr),smoothstep:Zs(e.step||Xr),simplebezier:Zs(e.simplebezier||Hr)},n=Object.keys(e).filter(e=>!["default","bezier"].includes(e)).reduce((t,n)=>(t[n]=Zs(e[n]||Zr),t),{});return u(u({},t),n)}function tc(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a=((null===n||void 0===n?void 0:n.x)||0)+t.x,o=((null===n||void 0===n?void 0:n.y)||0)+t.y,i=(null===n||void 0===n?void 0:n.width)||t.width,r=(null===n||void 0===n?void 0:n.height)||t.height;switch(e){case Lr.Top:return{x:a+i/2,y:o};case Lr.Right:return{x:a+i,y:o+r/2};case Lr.Bottom:return{x:a+i/2,y:o+r};case Lr.Left:return{x:a,y:o+r/2}}}function nc(e,t){return e?1!==e.length&&t?t&&e.find(e=>e.id===t)||null:e[0]:null}function ac(e){var t,n,a,o,i;const r=(null===e||void 0===e||null===(t=e[wr])||void 0===t?void 0:t.handleBounds)||null,l=r&&(null===e||void 0===e?void 0:e.width)&&(null===e||void 0===e?void 0:e.height)&&"undefined"!==typeof(null===e||void 0===e||null===(n=e.positionAbsolute)||void 0===n?void 0:n.x)&&"undefined"!==typeof(null===e||void 0===e||null===(a=e.positionAbsolute)||void 0===a?void 0:a.y);return[{x:(null===e||void 0===e||null===(o=e.positionAbsolute)||void 0===o?void 0:o.x)||0,y:(null===e||void 0===e||null===(i=e.positionAbsolute)||void 0===i?void 0:i.y)||0,width:(null===e||void 0===e?void 0:e.width)||0,height:(null===e||void 0===e?void 0:e.height)||0},r,!!l]}const oc=[{level:0,isMaxLevel:!0,edges:[]}];function ic(e,t,n){const o=ir((0,a.useCallback)(n=>e?n.edges.filter(e=>{const a=t.get(e.source),o=t.get(e.target);return(null===a||void 0===a?void 0:a.width)&&(null===a||void 0===a?void 0:a.height)&&(null===o||void 0===o?void 0:o.width)&&(null===o||void 0===o?void 0:o.height)&&function(e){let{sourcePos:t,targetPos:n,sourceWidth:a,sourceHeight:o,targetWidth:i,targetHeight:r,width:l,height:s,transform:c}=e;const u={x:Math.min(t.x,n.x),y:Math.min(t.y,n.y),x2:Math.max(t.x+a,n.x+i),y2:Math.max(t.y+o,n.y+r)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const d=br({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:l/c[2],height:s/c[2]}),p=Math.max(0,Math.min(d.x2,u.x2)-Math.max(d.x,u.x)),m=Math.max(0,Math.min(d.y2,u.y2)-Math.max(d.y,u.y));return Math.ceil(p*m)>0}({sourcePos:a.positionAbsolute||{x:0,y:0},targetPos:o.positionAbsolute||{x:0,y:0},sourceWidth:a.width,sourceHeight:a.height,targetWidth:o.width,targetHeight:o.height,width:n.width,height:n.height,transform:n.transform})}):n.edges,[e,t]));return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=-1;const o=e.reduce((e,o)=>{const i=Sr(o.zIndex);let r=i?o.zIndex:0;if(n){var l,s;const e=t.get(o.target),n=t.get(o.source),a=o.selected||(null===e||void 0===e?void 0:e.selected)||(null===n||void 0===n?void 0:n.selected),c=Math.max((null===n||void 0===n||null===(l=n[wr])||void 0===l?void 0:l.z)||0,(null===e||void 0===e||null===(s=e[wr])||void 0===s?void 0:s.z)||0,1e3);r=(i?o.zIndex:0)+(a?c:0)}return e[r]?e[r].push(o):e[r]=[o],a=r>a?r:a,e},{}),i=Object.entries(o).map(e=>{let[t,n]=e;const o=+t;return{edges:n,level:o,isMaxLevel:o===a}});return 0===i.length?oc:i}(o,t,n)}const rc={[Fr.Arrow]:e=>{let{color:t="none",strokeWidth:n=1}=e;return a.createElement("polyline",{style:{stroke:t,strokeWidth:n},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"})},[Fr.ArrowClosed]:e=>{let{color:t="none",strokeWidth:n=1}=e;return a.createElement("polyline",{style:{stroke:t,fill:t,strokeWidth:n},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})}};const lc=e=>{let{id:t,type:n,color:o,width:i=12.5,height:r=12.5,markerUnits:l="strokeWidth",strokeWidth:s,orient:c="auto-start-reverse"}=e;const u=function(e){const t=rr();return(0,a.useMemo)(()=>{var n,a;return Object.prototype.hasOwnProperty.call(rc,e)?rc[e]:(null===(n=(a=t.getState()).onError)||void 0===n||n.call(a,"009",Zi(e)),null)},[e])}(n);return u?a.createElement("marker",{className:"react-flow__arrowhead",id:t,markerWidth:"".concat(i),markerHeight:"".concat(r),viewBox:"-10 -10 20 20",markerUnits:l,orient:c,refX:"0",refY:"0"},a.createElement(u,{color:o,strokeWidth:s})):null},sc=e=>{let{defaultColor:t,rfId:n}=e;const o=ir((0,a.useCallback)((e=>{let{defaultColor:t,rfId:n}=e;return e=>{const a=[];return e.edges.reduce((e,o)=>([o.markerStart,o.markerEnd].forEach(o=>{if(o&&"object"===typeof o){const i=al(o,n);a.includes(i)||(e.push(u({id:i,color:o.color||t},o)),a.push(i))}}),e),[]).sort((e,t)=>e.id.localeCompare(t.id))}})({defaultColor:t,rfId:n}),[t,n]),(e,t)=>!(e.length!==t.length||e.some((e,n)=>e.id!==t[n].id)));return a.createElement("defs",null,o.map(e=>a.createElement(lc,{id:e.id,key:e.id,type:e.type,color:e.color,width:e.width,height:e.height,markerUnits:e.markerUnits,strokeWidth:e.strokeWidth,orient:e.orient})))};sc.displayName="MarkerDefinitions";var cc=(0,a.memo)(sc);const uc=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),dc=e=>{let{defaultMarkerColor:t,onlyRenderVisibleElements:n,elevateEdgesOnSelect:o,rfId:i,edgeTypes:r,noPanClassName:l,onEdgeContextMenu:s,onEdgeMouseEnter:c,onEdgeMouseMove:u,onEdgeMouseLeave:d,onEdgeClick:p,onEdgeDoubleClick:m,onReconnect:h,onReconnectStart:f,onReconnectEnd:g,reconnectRadius:v,children:b,disableKeyboardA11y:y}=e;const{edgesFocusable:x,edgesUpdatable:C,elementsSelectable:S,width:w,height:k,connectionMode:N,nodeInternals:j,onError:E}=ir(uc,Qt),M=ic(n,j,o);return w?a.createElement(a.Fragment,null,M.map(e=>{let{level:n,edges:o,isMaxLevel:b}=e;return a.createElement("svg",{key:n,style:{zIndex:n},width:w,height:k,className:"react-flow__edges react-flow__container"},b&&a.createElement(cc,{defaultColor:t,rfId:i}),a.createElement("g",null,o.map(e=>{var t,n;const[o,b,w]=ac(j.get(e.source)),[k,M,T]=ac(j.get(e.target));if(!w||!T)return null;let P=e.type||"default";r[P]||(null===E||void 0===E||E("011",nr(P)),P="default");const z=r[P]||r.default,_=N===Ar.Strict?M.target:(null!==(t=M.target)&&void 0!==t?t:[]).concat(null!==(n=M.source)&&void 0!==n?n:[]),R=nc(b.source,e.sourceHandle),A=nc(_,e.targetHandle),I=(null===R||void 0===R?void 0:R.position)||Lr.Bottom,D=(null===A||void 0===A?void 0:A.position)||Lr.Top,O=!!(e.focusable||x&&"undefined"===typeof e.focusable),F=e.reconnectable||e.updatable,L="undefined"!==typeof h&&(F||C&&"undefined"===typeof F);if(!R||!A)return null===E||void 0===E||E("008",er(R,e)),null;const{sourceX:B,sourceY:U,targetX:H,targetY:W}=((e,t,n,a,o,i)=>{const r=tc(n,e,t),l=tc(i,a,o);return{sourceX:r.x,sourceY:r.y,targetX:l.x,targetY:l.y}})(o,R,I,k,A,D);return a.createElement(z,{key:e.id,id:e.id,className:Wt([e.className,l]),type:P,data:e.data,selected:!!e.selected,animated:!!e.animated,hidden:!!e.hidden,label:e.label,labelStyle:e.labelStyle,labelShowBg:e.labelShowBg,labelBgStyle:e.labelBgStyle,labelBgPadding:e.labelBgPadding,labelBgBorderRadius:e.labelBgBorderRadius,style:e.style,source:e.source,target:e.target,sourceHandleId:e.sourceHandle,targetHandleId:e.targetHandle,markerEnd:e.markerEnd,markerStart:e.markerStart,sourceX:B,sourceY:U,targetX:H,targetY:W,sourcePosition:I,targetPosition:D,elementsSelectable:S,onContextMenu:s,onMouseEnter:c,onMouseMove:u,onMouseLeave:d,onClick:p,onEdgeDoubleClick:m,onReconnect:h,onReconnectStart:f,onReconnectEnd:g,reconnectRadius:v,rfId:i,ariaLabel:e.ariaLabel,isFocusable:O,isReconnectable:L,pathOptions:"pathOptions"in e?e.pathOptions:void 0,interactionWidth:e.interactionWidth,disableKeyboardA11y:y})})))}),b):null};dc.displayName="EdgeRenderer";var pc=(0,a.memo)(dc);const mc=e=>"translate(".concat(e.transform[0],"px,").concat(e.transform[1],"px) scale(").concat(e.transform[2],")");function hc(e){let{children:t}=e;const n=ir(mc);return a.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:n}},t)}const fc={[Lr.Left]:Lr.Right,[Lr.Right]:Lr.Left,[Lr.Top]:Lr.Bottom,[Lr.Bottom]:Lr.Top},gc=e=>{var t,n,o,i,r,l,s;let{nodeId:c,handleType:d,style:p,type:m=Or.Bezier,CustomComponent:h,connectionStatus:f}=e;const{fromNode:g,handleId:v,toX:b,toY:y,connectionMode:x}=ir((0,a.useCallback)(e=>({fromNode:e.nodeInternals.get(c),handleId:e.connectionHandleId,toX:(e.connectionPosition.x-e.transform[0])/e.transform[2],toY:(e.connectionPosition.y-e.transform[1])/e.transform[2],connectionMode:e.connectionMode}),[c]),Qt),C=null===g||void 0===g||null===(t=g[wr])||void 0===t?void 0:t.handleBounds;let S=null===C||void 0===C?void 0:C[d];if(x===Ar.Loose&&(S=S||(null===C||void 0===C?void 0:C["source"===d?"target":"source"])),!g||!S)return null;const w=v?S.find(e=>e.id===v):S[0],k=w?w.x+w.width/2:(null!==(n=g.width)&&void 0!==n?n:0)/2,N=w?w.y+w.height/2:null!==(o=g.height)&&void 0!==o?o:0,j=(null!==(i=null===(r=g.positionAbsolute)||void 0===r?void 0:r.x)&&void 0!==i?i:0)+k,E=(null!==(l=null===(s=g.positionAbsolute)||void 0===s?void 0:s.y)&&void 0!==l?l:0)+N,M=null===w||void 0===w?void 0:w.position,T=M?fc[M]:null;if(!M||!T)return null;if(h)return a.createElement(h,{connectionLineType:m,connectionLineStyle:p,fromNode:g,fromHandle:w,fromX:j,fromY:E,toX:b,toY:y,fromPosition:M,toPosition:T,connectionStatus:f});let P="";const z={sourceX:j,sourceY:E,sourcePosition:M,targetX:b,targetY:y,targetPosition:T};return m===Or.Bezier?[P]=Qr(z):m===Or.Step?[P]=Yr(u(u({},z),{},{borderRadius:0})):m===Or.SmoothStep?[P]=Yr(z):m===Or.SimpleBezier?[P]=Ur(z):P="M".concat(j,",").concat(E," ").concat(b,",").concat(y),a.createElement("path",{d:P,fill:"none",className:"react-flow__connection-path",style:p})};gc.displayName="ConnectionLine";const vc=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function bc(e){let{containerStyle:t,style:n,type:o,component:i}=e;const{nodeId:r,handleType:l,nodesConnectable:s,width:c,height:u,connectionStatus:d}=ir(vc,Qt);return!!(r&&l&&c&&s)?a.createElement("svg",{style:t,width:c,height:u,className:"react-flow__edges react-flow__connectionline react-flow__container"},a.createElement("g",{className:Wt(["react-flow__connection",d])},a.createElement(gc,{nodeId:r,handleType:l,style:n,type:o,CustomComponent:i,connectionStatus:d}))):null}function yc(e,t){(0,a.useRef)(null),rr();return(0,a.useMemo)(()=>t(e),[e])}const xc=e=>{let{nodeTypes:t,edgeTypes:n,onMove:o,onMoveStart:i,onMoveEnd:r,onInit:l,onNodeClick:s,onEdgeClick:c,onNodeDoubleClick:u,onEdgeDoubleClick:d,onNodeMouseEnter:p,onNodeMouseMove:m,onNodeMouseLeave:h,onNodeContextMenu:f,onSelectionContextMenu:g,onSelectionStart:v,onSelectionEnd:b,connectionLineType:y,connectionLineStyle:x,connectionLineComponent:C,connectionLineContainerStyle:S,selectionKeyCode:w,selectionOnDrag:k,selectionMode:N,multiSelectionKeyCode:j,panActivationKeyCode:E,zoomActivationKeyCode:M,deleteKeyCode:T,onlyRenderVisibleElements:P,elementsSelectable:z,selectNodesOnDrag:_,defaultViewport:R,translateExtent:A,minZoom:I,maxZoom:D,preventScrolling:O,defaultMarkerColor:F,zoomOnScroll:L,zoomOnPinch:B,panOnScroll:U,panOnScrollSpeed:H,panOnScrollMode:W,zoomOnDoubleClick:V,panOnDrag:G,onPaneClick:Y,onPaneMouseEnter:X,onPaneMouseMove:K,onPaneMouseLeave:q,onPaneScroll:$,onPaneContextMenu:J,onEdgeContextMenu:Q,onEdgeMouseEnter:Z,onEdgeMouseMove:ee,onEdgeMouseLeave:te,onReconnect:ne,onReconnectStart:ae,onReconnectEnd:oe,reconnectRadius:ie,noDragClassName:re,noWheelClassName:le,noPanClassName:se,elevateEdgesOnSelect:ce,disableKeyboardA11y:ue,nodeOrigin:de,nodeExtent:pe,rfId:me}=e;const he=yc(t,Vs),fe=yc(n,ec);return function(e){const t=ls(),n=(0,a.useRef)(!1);(0,a.useEffect)(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}(l),a.createElement(Ws,{onPaneClick:Y,onPaneMouseEnter:X,onPaneMouseMove:K,onPaneMouseLeave:q,onPaneContextMenu:J,onPaneScroll:$,deleteKeyCode:T,selectionKeyCode:w,selectionOnDrag:k,selectionMode:N,onSelectionStart:v,onSelectionEnd:b,multiSelectionKeyCode:j,panActivationKeyCode:E,zoomActivationKeyCode:M,elementsSelectable:z,onMove:o,onMoveStart:i,onMoveEnd:r,zoomOnScroll:L,zoomOnPinch:B,zoomOnDoubleClick:V,panOnScroll:U,panOnScrollSpeed:H,panOnScrollMode:W,panOnDrag:G,defaultViewport:R,translateExtent:A,minZoom:I,maxZoom:D,onSelectionContextMenu:g,preventScrolling:O,noDragClassName:re,noWheelClassName:le,noPanClassName:se,disableKeyboardA11y:ue},a.createElement(hc,null,a.createElement(pc,{edgeTypes:fe,onEdgeClick:c,onEdgeDoubleClick:d,onlyRenderVisibleElements:P,onEdgeContextMenu:Q,onEdgeMouseEnter:Z,onEdgeMouseMove:ee,onEdgeMouseLeave:te,onReconnect:ne,onReconnectStart:ae,onReconnectEnd:oe,reconnectRadius:ie,defaultMarkerColor:F,noPanClassName:se,elevateEdgesOnSelect:!!ce,disableKeyboardA11y:ue,rfId:me},a.createElement(bc,{style:x,type:y,component:C,containerStyle:S})),a.createElement("div",{className:"react-flow__edgelabel-renderer"}),a.createElement(Xs,{nodeTypes:he,onNodeClick:s,onNodeDoubleClick:u,onNodeMouseEnter:p,onNodeMouseMove:m,onNodeMouseLeave:h,onNodeContextMenu:f,selectNodesOnDrag:_,onlyRenderVisibleElements:P,noPanClassName:se,noDragClassName:re,disableKeyboardA11y:ue,nodeOrigin:de,nodeExtent:pe,rfId:me})))};xc.displayName="GraphView";var Cc=(0,a.memo)(xc);const Sc=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],wc={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Sc,nodeExtent:Sc,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Ar.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:Nr,isValidConnection:void 0},kc=()=>{return e=(e,t)=>u(u({},wc),{},{setNodes:n=>{const{nodeInternals:a,nodeOrigin:o,elevateNodesOnSelect:i}=t();e({nodeInternals:Zl(n,a,o,i)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:a={}}=t();e({edges:n.map(e=>u(u({},a),e))})},setDefaultNodesAndEdges:(n,a)=>{const o="undefined"!==typeof n,i="undefined"!==typeof a,r=o?Zl(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:r,edges:i?a:[],hasDefaultNodes:o,hasDefaultEdges:i})},updateNodeDimensions:n=>{const{onNodesChange:a,nodeInternals:o,fitViewOnInit:i,fitViewOnInitDone:r,fitViewOnInitOptions:l,domNode:s,nodeOrigin:c}=t(),d=null===s||void 0===s?void 0:s.querySelector(".react-flow__viewport");if(!d)return;const p=window.getComputedStyle(d),{m22:m}=new window.DOMMatrixReadOnly(p.transform),h=n.reduce((e,t)=>{const n=o.get(t.id);if(null!==n&&void 0!==n&&n.hidden)o.set(n.id,u(u({},n),{},{[wr]:u(u({},n[wr]),{},{handleBounds:void 0})}));else if(n){const a=dr(t.nodeElement);a.width&&a.height&&(n.width!==a.width||n.height!==a.height||t.forceUpdate)&&(o.set(n.id,u(u({},n),{},{[wr]:u(u({},n[wr]),{},{handleBounds:{source:zs(".source",t.nodeElement,m,c),target:zs(".target",t.nodeElement,m,c)}})},a)),e.push({id:n.id,type:"dimensions",dimensions:a}))}return e},[]);Ql(o,c);const f=r||i&&!r&&es(t,u({initial:!0},l));e({nodeInternals:new Map(o),fitViewOnInitDone:f}),(null===h||void 0===h?void 0:h.length)>0&&(null===a||void 0===a||a(h))},updateNodePositions:function(e){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{triggerNodeChanges:o}=t(),i=e.map(e=>{const t={id:e.id,type:"position",dragging:a};return n&&(t.positionAbsolute=e.positionAbsolute,t.position=e.position),t});o(i)},triggerNodeChanges:n=>{const{onNodesChange:a,nodeInternals:o,hasDefaultNodes:i,nodeOrigin:r,getNodes:l,elevateNodesOnSelect:s}=t();if(null!==n&&void 0!==n&&n.length){if(i){const t=Zl(xs(n,l()),o,r,s);e({nodeInternals:t})}null===a||void 0===a||a(n)}},addSelectedNodes:n=>{const{multiSelectionActive:a,edges:o,getNodes:i}=t();let r,l=null;a?r=n.map(e=>Cs(e,!0)):(r=Ss(i(),n),l=Ss(o,[])),as({changedNodes:r,changedEdges:l,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:a,edges:o,getNodes:i}=t();let r,l=null;a?r=n.map(e=>Cs(e,!0)):(r=Ss(o,n),l=Ss(i(),[])),as({changedNodes:l,changedEdges:r,get:t,set:e})},unselectNodesAndEdges:function(){let{nodes:n,edges:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{edges:o,getNodes:i}=t(),r=a||o;as({changedNodes:(n||i()).map(e=>(e.selected=!1,Cs(e.id,!1))),changedEdges:r.map(e=>Cs(e.id,!1)),get:t,set:e})},setMinZoom:n=>{const{d3Zoom:a,maxZoom:o}=t();null===a||void 0===a||a.scaleExtent([n,o]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:a,minZoom:o}=t();null===a||void 0===a||a.scaleExtent([o,n]),e({maxZoom:n})},setTranslateExtent:n=>{var a;null===(a=t().d3Zoom)||void 0===a||a.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:a}=t();as({changedNodes:a().filter(e=>e.selected).map(e=>Cs(e.id,!1)),changedEdges:n.filter(e=>e.selected).map(e=>Cs(e.id,!1)),get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:a}=t();a.forEach(e=>{e.positionAbsolute=mr(e.position,n)}),e({nodeExtent:n,nodeInternals:new Map(a)})},panBy:e=>{const{transform:n,width:a,height:o,d3Zoom:i,d3Selection:r,translateExtent:l}=t();if(!i||!r||!e.x&&!e.y)return!1;const s=ji.translate(n[0]+e.x,n[1]+e.y).scale(n[2]),c=[[0,0],[a,o]],u=null===i||void 0===i?void 0:i.constrain()(s,c,l);return i.transform(r,u),n[0]!==u.x||n[1]!==u.y||n[2]!==u.k},cancelConnection:()=>e({connectionNodeId:wc.connectionNodeId,connectionHandleId:wc.connectionHandleId,connectionHandleType:wc.connectionHandleType,connectionStatus:wc.connectionStatus,connectionStartHandle:wc.connectionStartHandle,connectionEndHandle:wc.connectionEndHandle}),reset:()=>e(u({},wc))}),t=Object.is,e?Jt(e,t):Jt;var e,t},Nc=e=>{let{children:t}=e;const n=(0,a.useRef)(null);return n.current||(n.current=kc()),a.createElement(Ki,{value:n.current},t)};Nc.displayName="ReactFlowProvider";const jc=e=>{let{children:t}=e;return(0,a.useContext)(Xi)?a.createElement(a.Fragment,null,t):a.createElement(Nc,null,t)};jc.displayName="ReactFlowWrapper";const Ec={input:El,default:Nl,output:Tl,group:Pl},Mc={default:Zr,straight:qr,step:Kr,smoothstep:Xr,simplebezier:Hr},Tc=[0,0],Pc=[15,15],zc={x:0,y:0,zoom:1},_c={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},Rc=(0,a.forwardRef)((e,t)=>{let{nodes:n,edges:o,defaultNodes:r,defaultEdges:l,className:s,nodeTypes:c=Ec,edgeTypes:d=Mc,onNodeClick:p,onEdgeClick:m,onInit:h,onMove:f,onMoveStart:g,onMoveEnd:v,onConnect:b,onConnectStart:y,onConnectEnd:x,onClickConnectStart:C,onClickConnectEnd:S,onNodeMouseEnter:w,onNodeMouseMove:k,onNodeMouseLeave:N,onNodeContextMenu:j,onNodeDoubleClick:E,onNodeDragStart:M,onNodeDrag:T,onNodeDragStop:P,onNodesDelete:z,onEdgesDelete:_,onSelectionChange:R,onSelectionDragStart:A,onSelectionDrag:I,onSelectionDragStop:D,onSelectionContextMenu:O,onSelectionStart:F,onSelectionEnd:L,connectionMode:B=Ar.Strict,connectionLineType:U=Or.Bezier,connectionLineStyle:H,connectionLineComponent:W,connectionLineContainerStyle:V,deleteKeyCode:G="Backspace",selectionKeyCode:Y="Shift",selectionOnDrag:X=!1,selectionMode:K=Dr.Full,panActivationKeyCode:q="Space",multiSelectionKeyCode:$=(Tr()?"Meta":"Control"),zoomActivationKeyCode:J=(Tr()?"Meta":"Control"),snapToGrid:Q=!1,snapGrid:Z=Pc,onlyRenderVisibleElements:ee=!1,selectNodesOnDrag:te=!0,nodesDraggable:ne,nodesConnectable:ae,nodesFocusable:oe,nodeOrigin:ie=Tc,edgesFocusable:re,edgesUpdatable:le,elementsSelectable:se,defaultViewport:ce=zc,minZoom:ue=.5,maxZoom:de=2,translateExtent:pe=Sc,preventScrolling:me=!0,nodeExtent:he,defaultMarkerColor:fe="#b1b1b7",zoomOnScroll:ge=!0,zoomOnPinch:ve=!0,panOnScroll:be=!1,panOnScrollSpeed:ye=.5,panOnScrollMode:xe=Ir.Free,zoomOnDoubleClick:Ce=!0,panOnDrag:Se=!0,onPaneClick:we,onPaneMouseEnter:ke,onPaneMouseMove:Ne,onPaneMouseLeave:je,onPaneScroll:Ee,onPaneContextMenu:Me,children:Te,onEdgeContextMenu:Pe,onEdgeDoubleClick:ze,onEdgeMouseEnter:_e,onEdgeMouseMove:Re,onEdgeMouseLeave:Ae,onEdgeUpdate:Ie,onEdgeUpdateStart:De,onEdgeUpdateEnd:Oe,onReconnect:Fe,onReconnectStart:Le,onReconnectEnd:Be,reconnectRadius:Ue=10,edgeUpdaterRadius:He=10,onNodesChange:We,onEdgesChange:Ve,noDragClassName:Ge="nodrag",noWheelClassName:Ye="nowheel",noPanClassName:Xe="nopan",fitView:Ke=!1,fitViewOptions:qe,connectOnClick:$e=!0,attributionPosition:Je,proOptions:Qe,defaultEdgeOptions:Ze,elevateNodesOnSelect:et=!0,elevateEdgesOnSelect:tt=!1,disableKeyboardA11y:nt=!1,autoPanOnConnect:at=!0,autoPanOnNodeDrag:ot=!0,connectionRadius:it=20,isValidConnection:rt,onError:lt,style:st,id:ct,nodeDragThreshold:ut}=e,dt=i(e,Yi);const pt=ct||"1";return a.createElement("div",u(u({},dt),{},{style:u(u({},st),_c),ref:t,className:Wt(["react-flow",s]),"data-testid":"rf__wrapper",id:ct}),a.createElement(jc,null,a.createElement(Cc,{onInit:h,onMove:f,onMoveStart:g,onMoveEnd:v,onNodeClick:p,onEdgeClick:m,onNodeMouseEnter:w,onNodeMouseMove:k,onNodeMouseLeave:N,onNodeContextMenu:j,onNodeDoubleClick:E,nodeTypes:c,edgeTypes:d,connectionLineType:U,connectionLineStyle:H,connectionLineComponent:W,connectionLineContainerStyle:V,selectionKeyCode:Y,selectionOnDrag:X,selectionMode:K,deleteKeyCode:G,multiSelectionKeyCode:$,panActivationKeyCode:q,zoomActivationKeyCode:J,onlyRenderVisibleElements:ee,selectNodesOnDrag:te,defaultViewport:ce,translateExtent:pe,minZoom:ue,maxZoom:de,preventScrolling:me,zoomOnScroll:ge,zoomOnPinch:ve,zoomOnDoubleClick:Ce,panOnScroll:be,panOnScrollSpeed:ye,panOnScrollMode:xe,panOnDrag:Se,onPaneClick:we,onPaneMouseEnter:ke,onPaneMouseMove:Ne,onPaneMouseLeave:je,onPaneScroll:Ee,onPaneContextMenu:Me,onSelectionContextMenu:O,onSelectionStart:F,onSelectionEnd:L,onEdgeContextMenu:Pe,onEdgeDoubleClick:ze,onEdgeMouseEnter:_e,onEdgeMouseMove:Re,onEdgeMouseLeave:Ae,onReconnect:null!==Fe&&void 0!==Fe?Fe:Ie,onReconnectStart:null!==Le&&void 0!==Le?Le:De,onReconnectEnd:null!==Be&&void 0!==Be?Be:Oe,reconnectRadius:null!==Ue&&void 0!==Ue?Ue:He,defaultMarkerColor:fe,noDragClassName:Ge,noWheelClassName:Ye,noPanClassName:Xe,elevateEdgesOnSelect:tt,rfId:pt,disableKeyboardA11y:nt,nodeOrigin:ie,nodeExtent:he}),a.createElement(Bl,{nodes:n,edges:o,defaultNodes:r,defaultEdges:l,onConnect:b,onConnectStart:y,onConnectEnd:x,onClickConnectStart:C,onClickConnectEnd:S,nodesDraggable:ne,nodesConnectable:ae,nodesFocusable:oe,edgesFocusable:re,edgesUpdatable:le,elementsSelectable:se,elevateNodesOnSelect:et,minZoom:ue,maxZoom:de,nodeExtent:he,onNodesChange:We,onEdgesChange:Ve,snapToGrid:Q,snapGrid:Z,connectionMode:B,translateExtent:pe,connectOnClick:$e,defaultEdgeOptions:Ze,fitView:Ke,fitViewOptions:qe,onNodesDelete:z,onEdgesDelete:_,onNodeDragStart:M,onNodeDrag:T,onNodeDragStop:P,onSelectionDrag:I,onSelectionDragStart:A,onSelectionDragStop:D,noPanClassName:Xe,nodeOrigin:ie,rfId:pt,autoPanOnConnect:at,autoPanOnNodeDrag:ot,onError:lt,connectionRadius:it,isValidConnection:rt,nodeDragThreshold:ut}),a.createElement(Dl,{onSelectionChange:R}),Te,a.createElement(cr,{proOptions:Qe,position:Je}),a.createElement(Xl,{rfId:pt,disableKeyboardA11y:nt})))});Rc.displayName="ReactFlow";const Ac=e=>{var t;return null===(t=e.domNode)||void 0===t?void 0:t.querySelector(".react-flow__edgelabel-renderer")};function Ic(e){let{children:t}=e;const n=ir(Ac);return n?(0,Hi.createPortal)(t,n):null}function Dc(e){return t=>{const[n,o]=(0,a.useState)(t),i=(0,a.useCallback)(t=>o(n=>e(t,n)),[]);return[n,o,i]}}const Oc=Dc(xs),Fc=Dc(function(e,t){return ys(e,t)});const Lc=e=>{let{id:t,x:n,y:o,width:i,height:r,style:l,color:s,strokeColor:c,strokeWidth:u,className:d,borderRadius:p,shapeRendering:m,onClick:h,selected:f}=e;const{background:g,backgroundColor:v}=l||{},b=s||g||v;return a.createElement("rect",{className:Wt(["react-flow__minimap-node",{selected:f},d]),x:n,y:o,rx:p,ry:p,width:i,height:r,fill:b,stroke:c,strokeWidth:u,shapeRendering:m,onClick:h?e=>h(e,t):void 0})};Lc.displayName="MiniMapNode";var Bc=(0,a.memo)(Lc);const Uc=e=>e.nodeOrigin,Hc=e=>e.getNodes().filter(e=>!e.hidden&&e.width&&e.height),Wc=e=>e instanceof Function?e:()=>e;var Vc=(0,a.memo)(function(e){let{nodeStrokeColor:t="transparent",nodeColor:n="#e2e2e2",nodeClassName:o="",nodeBorderRadius:i=5,nodeStrokeWidth:r=2,nodeComponent:l=Bc,onClick:s}=e;const c=ir(Hc,Qt),u=ir(Uc),d=Wc(n),p=Wc(t),m=Wc(o),h="undefined"===typeof window||window.chrome?"crispEdges":"geometricPrecision";return a.createElement(a.Fragment,null,c.map(e=>{const{x:t,y:n}=rl(e,u).positionAbsolute;return a.createElement(l,{key:e.id,x:t,y:n,width:e.width,height:e.height,style:e.style,selected:e.selected,className:m(e),color:d(e),borderRadius:i,strokeColor:p(e),strokeWidth:r,shapeRendering:h,onClick:s,id:e.id})}))});const Gc=e=>{const t=e.getNodes(),n={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:n,boundingRect:t.length>0?(a=ll(t,e.nodeOrigin),o=n,yr(vr(br(a),br(o)))):n,rfId:e.rfId};var a,o};function Yc(e){var t,n;let{style:o,className:i,nodeStrokeColor:r="transparent",nodeColor:l="#e2e2e2",nodeClassName:s="",nodeBorderRadius:c=5,nodeStrokeWidth:u=2,nodeComponent:d,maskColor:p="rgb(240, 240, 240, 0.6)",maskStrokeColor:m="none",maskStrokeWidth:h=1,position:f="bottom-right",onClick:g,onNodeClick:v,pannable:b=!1,zoomable:y=!1,ariaLabel:x="React Flow mini map",inversePan:C=!1,zoomStep:S=10,offsetScale:w=5}=e;const k=rr(),N=(0,a.useRef)(null),{boundingRect:j,viewBB:E,rfId:M}=ir(Gc,Qt),T=null!==(t=null===o||void 0===o?void 0:o.width)&&void 0!==t?t:200,P=null!==(n=null===o||void 0===o?void 0:o.height)&&void 0!==n?n:150,z=j.width/T,_=j.height/P,R=Math.max(z,_),A=R*T,I=R*P,D=w*R,O=j.x-(A-j.width)/2-D,F=j.y-(I-j.height)/2-D,L=A+2*D,B=I+2*D,U="".concat("react-flow__minimap-desc","-").concat(M),H=(0,a.useRef)(0);H.current=R,(0,a.useEffect)(()=>{if(N.current){const e=ya(N.current),t=e=>{const{transform:t,d3Selection:n,d3Zoom:a}=k.getState();if("wheel"!==e.sourceEvent.type||!n||!a)return;const o=-e.sourceEvent.deltaY*(1===e.sourceEvent.deltaMode?.05:e.sourceEvent.deltaMode?1:.002)*S,i=t[2]*Math.pow(2,o);a.scaleTo(n,i)},n=e=>{const{transform:t,d3Selection:n,d3Zoom:a,translateExtent:o,width:i,height:r}=k.getState();if("mousemove"!==e.sourceEvent.type||!n||!a)return;const l=H.current*Math.max(1,t[2])*(C?-1:1),s={x:t[0]-e.sourceEvent.movementX*l,y:t[1]-e.sourceEvent.movementY*l},c=[[0,0],[i,r]],u=ji.translate(s.x,s.y).scale(t[2]),d=a.constrain()(u,c,o);a.transform(n,d)},a=Ii().on("zoom",b?n:null).on("zoom.wheel",y?t:null);return e.call(a),()=>{e.on("zoom",null)}}},[b,y,C,S]);const W=g?e=>{const t=Ma(e);g(e,{x:t[0],y:t[1]})}:void 0,V=v?(e,t)=>{const n=k.getState().nodeInternals.get(t);v(e,n)}:void 0;return a.createElement(sr,{position:f,style:o,className:Wt(["react-flow__minimap",i]),"data-testid":"rf__minimap"},a.createElement("svg",{width:T,height:P,viewBox:"".concat(O," ").concat(F," ").concat(L," ").concat(B),role:"img","aria-labelledby":U,ref:N,onClick:W},x&&a.createElement("title",{id:U},x),a.createElement(Vc,{onClick:V,nodeColor:l,nodeStrokeColor:r,nodeBorderRadius:c,nodeClassName:s,nodeStrokeWidth:u,nodeComponent:d}),a.createElement("path",{className:"react-flow__minimap-mask",d:"M".concat(O-D,",").concat(F-D,"h").concat(L+2*D,"v").concat(B+2*D,"h").concat(-L-2*D,"z\n        M").concat(E.x,",").concat(E.y,"h").concat(E.width,"v").concat(E.height,"h").concat(-E.width,"z"),fill:p,fillRule:"evenodd",stroke:m,strokeWidth:h,pointerEvents:"none"})))}Yc.displayName="MiniMap";var Xc,Kc=(0,a.memo)(Yc);function qc(e){let{color:t,dimensions:n,lineWidth:o}=e;return a.createElement("path",{stroke:t,strokeWidth:o,d:"M".concat(n[0]/2," 0 V").concat(n[1]," M0 ").concat(n[1]/2," H").concat(n[0])})}function $c(e){let{color:t,radius:n}=e;return a.createElement("circle",{cx:n,cy:n,r:n,fill:t})}!function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"}(Xc||(Xc={}));const Jc={[Xc.Dots]:"#91919a",[Xc.Lines]:"#eee",[Xc.Cross]:"#e2e2e2"},Qc={[Xc.Dots]:1,[Xc.Lines]:1,[Xc.Cross]:6},Zc=e=>({transform:e.transform,patternId:"pattern-".concat(e.rfId)});function eu(e){let{id:t,variant:n=Xc.Dots,gap:o=20,size:i,lineWidth:r=1,offset:l=2,color:s,style:c,className:d}=e;const p=(0,a.useRef)(null),{transform:m,patternId:h}=ir(Zc,Qt),f=s||Jc[n],g=i||Qc[n],v=n===Xc.Dots,b=n===Xc.Cross,y=Array.isArray(o)?o:[o,o],x=[y[0]*m[2]||1,y[1]*m[2]||1],C=g*m[2],S=b?[C,C]:x,w=v?[C/l,C/l]:[S[0]/l,S[1]/l];return a.createElement("svg",{className:Wt(["react-flow__background",d]),style:u(u({},c),{},{position:"absolute",width:"100%",height:"100%",top:0,left:0}),ref:p,"data-testid":"rf__background"},a.createElement("pattern",{id:h+t,x:m[0]%x[0],y:m[1]%x[1],width:x[0],height:x[1],patternUnits:"userSpaceOnUse",patternTransform:"translate(-".concat(w[0],",-").concat(w[1],")")},v?a.createElement($c,{color:f,radius:C/l}):a.createElement(qc,{dimensions:S,color:f,lineWidth:r})),a.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#".concat(h+t,")")}))}eu.displayName="Background";var tu=(0,a.memo)(eu);class nu{static hasSimulationResults(){return null!==this.simulationResults&&this.simulationResults.simulationCompleted}static getCurrentResults(){return this.simulationResults}static async loadResultsFromFile(e,t,n,a,o){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{timestep:1};console.log("\ud83d\udcc1 Loading real results from: ".concat(e));try{const u=[...t.map(e=>e.name),...n.map(e=>e.name)].join(",");console.log("\ud83d\udccb Components to parse: ".concat(u));const d=await fetch("http://".concat(window.location.hostname,":3001/api/results/parse?")+new URLSearchParams({resultsPath:e,components:u,iterations:o.toString(),missionTime:a.toString(),timestep:i.timestep.toString()}).toString());if(!d.ok)throw new Error("Backend returned ".concat(d.status,": ").concat(d.statusText));const p=await d.json();if(console.log("\ud83d\udd25 [DEBUG] Backend response received:",p),console.log("\ud83d\udd25 [DEBUG] CI data in response:",p.ciHistory),!p.success)throw new Error("Backend parsing failed: ".concat(p.error));console.log("\u2705 Backend parsing successful for ".concat(Object.keys(p.components).length," components"));const m=[];for(const e of t){const t=p.components[e.name];if(t){var r,l,s,c;console.log("\ud83d\udd0d [DEBUG] Processing event ".concat(e.name,":")),console.log("  \ud83d\udcca Backend CDF data:",t.cdfData),console.log("  \ud83d\udcc8 Backend PDF data:",t.pdfData);const n={componentId:e.id,componentName:e.name,componentType:"event",timeOfFailureArray:t.timeOfFailureArray||[],reliability:t.reliability||0,unreliability:t.unreliability||0,nFailures:t.nFailures||0,totalIterations:t.totalIterations||o,cdfData:this.convertBackendCdfData(t.cdfData),pdfData:this.convertBackendPdfData(t.pdfData)};console.log("  \ud83d\udcca Converted CDF data (".concat((null===(r=n.cdfData)||void 0===r?void 0:r.length)||0," points):"),null===(l=n.cdfData)||void 0===l?void 0:l.slice(0,3)),console.log("  \ud83d\udcc8 Converted PDF data (".concat((null===(s=n.pdfData)||void 0===s?void 0:s.length)||0," points):"),null===(c=n.pdfData)||void 0===c?void 0:c.slice(0,3)),m.push(n),console.log("\u2705 Processed event ".concat(e.name,": R=").concat((100*n.reliability).toFixed(1),"%, failures=").concat(n.nFailures))}else console.log("\u26a0\ufe0f Event ".concat(e.name," not found in results.mat"))}for(const e of n){const t=p.components[e.name];if(t){const n={componentId:e.id,componentName:e.name,componentType:"gate",timeOfFailureArray:t.timeOfFailureArray||[],reliability:t.reliability||0,unreliability:t.unreliability||0,nFailures:t.nFailures||0,totalIterations:t.totalIterations||o,cdfData:this.convertBackendCdfData(t.cdfData),pdfData:this.convertBackendPdfData(t.pdfData)};m.push(n),console.log("\u2705 Processed gate ".concat(e.name,": R=").concat((100*n.reliability).toFixed(1),"%, failures=").concat(n.nFailures))}else console.log("\u26a0\ufe0f Gate ".concat(e.name," not found in results.mat"))}const h={simulationCompleted:!0,missionTime:a,totalIterations:o,timestep:i.timestep,components:m,resultsFilePath:e,ciHistory:this.convertBackendCIHistory(p.ciHistory)};return this.simulationResults=h,h}catch(u){throw console.error("\u274c Error loading real results from backend:",u),u}}static convertBackendCdfData(e){if(!e||!e.time||!Array.isArray(e.time))return[];const t=e.time,n=e.probability;if(!n||!Array.isArray(n)||t.length!==n.length)return[];const a=[];for(let o=0;o<t.length;o++)a.push({time:t[o],probability:n[o]});return a}static convertBackendPdfData(e){if(!e||!e.time||!Array.isArray(e.time))return[];const t=e.time,n=e.density;if(!n||!Array.isArray(n)||t.length!==n.length)return[];const a=[];for(let o=0;o<t.length;o++)a.push({time:t[o],density:n[o]});return a}static convertBackendCIHistory(e){if(console.log("\ud83d\udd25 [CI] convertBackendCIHistory called with:",e),console.log("\ud83d\udd25 [CI] Type:",typeof e),console.log("\ud83d\udd25 [CI] Is array:",Array.isArray(e)),!e)return void console.log("\ud83d\udd0d [CI] No CI history data found in backend results - returning undefined");let t;if(Array.isArray(e))t=e;else{if("object"!==typeof e)return void console.log("\ud83d\udd0d [CI] Invalid CI data type - returning undefined");console.log("\ud83d\udd27 [CI] Converting single CI object to array"),t=[e]}console.log("\ud83d\udd0d [CI] Converting ".concat(t.length," CI history points"));const n=[];for(let a=0;a<t.length;a++){const e=t[a];if(console.log("\ud83d\udd25 [CI] Processing point ".concat(a,":"),e),e&&"object"===typeof e){const t={iteration:e.iteration||0,p_failure:e.p_failure||0,mean_estimate:e.mean_estimate||0,CI_lower:e.CI_lower||0,CI_upper:e.CI_upper||0,CI_width:e.CI_width||0,accepted_error:e.accepted_error||0,std_error:e.std_error||0};console.log("\ud83d\udd25 [CI] Converted point ".concat(a,":"),t),n.push(t)}}return console.log("\u2705 [CI] Final converted result:",n),console.log("\u2705 [CI] Converted ".concat(n.length," CI history points")),n.length>0?n:void 0}static getComponentResults(e){return this.simulationResults&&this.simulationResults.components.find(t=>t.componentId===e)||null}static clearResults(){this.simulationResults=null}static async loadResultsAfterSimulation(e,t,n,a,o){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{timestep:1};try{var r;const l="".concat(e,"/output/results.mat");return console.log("\ud83d\udd0d [MatlabResultsService] Loading results after simulation..."),console.log("   \ud83d\udcc1 Results path: ".concat(l)),console.log("   \ud83d\udcca Components: ".concat(t.length," events, ").concat(n.length," gates")),console.log("   \u2699\ufe0f Config: timestep=".concat(i.timestep,"h")),await this.loadResultsFromFile(l,t,n,a,o,i),console.log("\u2705 [MatlabResultsService] Results loaded and processed successfully!"),console.log("   \ud83d\udcc8 Components with results: ".concat(null===(r=this.simulationResults)||void 0===r?void 0:r.components.length)),window.dispatchEvent(new CustomEvent("simulationResultsLoaded")),!0}catch(l){return console.error("\u274c [MatlabResultsService] Failed to load simulation results:",l),!1}}static validateProcessingConfig(e){return e.timestep<=0?"Timestep deve essere maggiore di 0":e.maxTime&&e.maxTime<=0?"Tempo massimo deve essere maggiore di 0":null}static getOverallStatistics(){if(!this.simulationResults)return null;const e=this.simulationResults.components;if(0===e.length)return null;const t=e.length,n=e.reduce((e,t)=>e+t.reliability,0)/t,a=[...e].sort((e,t)=>t.reliability-e.reliability);return{totalComponents:t,averageReliability:n,mostReliableComponent:{name:a[0].componentName,reliability:a[0].reliability},leastReliableComponent:{name:a[a.length-1].componentName,reliability:a[a.length-1].reliability}}}}nu.simulationResults=null;const au=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return e.length<=t?e:e.substring(0,t-3)+"..."},ou=e=>{let{data:t}=e;const{event:n,onClick:o,onDelete:i}=t,r=e=>{if(!e||!e.type)return null;switch(e.type){case"exponential":return"exp";case"weibull":return"wei";case"normal":return"gauss";case"constant":return"const";default:return e.type}},l=e=>null==e||Number.isNaN(e)?"":parseFloat(e.toFixed(3)).toString(),[,s]=(0,a.useState)({});(0,a.useEffect)(()=>{const e=()=>{console.log("\ud83d\udd04 [EventNode] Results loaded event received for ".concat(n.name)),s({})};return window.addEventListener("simulationResultsLoaded",e),()=>window.removeEventListener("simulationResultsLoaded",e)},[n.name]);const c=nu.getComponentResults(n.id),u=nu.hasSimulationResults();u&&console.log("\ud83d\udccb [EventNode] ".concat(n.name," has results:"),c);const d=e=>{if(!e||!e.type)return null;switch(e.type){case"exponential":return null!=e.lambda?"(\u03bb=".concat(l(e.lambda),")"):null;case"weibull":return"(".concat("undefined"!==typeof e.k?"k=".concat(l(e.k),", "):"").concat("undefined"!==typeof e.lambda?"\u03bb=".concat(l(e.lambda)):"").concat("undefined"!==typeof e.mu?", \u03bc=".concat(l(e.mu)):"",")");case"normal":return"(".concat("undefined"!==typeof e.mu?"\u03bc=".concat(l(e.mu)):"").concat("undefined"!==typeof e.sigma?", \u03c3=".concat(l(e.sigma)):"",")");case"constant":return null!=e.probability?"(p=".concat(l(e.probability),")"):null;default:return null}};return(0,Et.jsxs)("div",{className:"event-node",onClick:o,children:[(0,Et.jsx)(wl,{type:"source",position:Lr.Top,className:"event-handle"}),i&&(0,Et.jsx)("button",{className:"delete-button",onClick:e=>{e.stopPropagation(),i&&i(n.id)},title:"Elimina evento",children:"\xd7"}),(0,Et.jsx)("div",{className:"event-content",children:(0,Et.jsxs)("div",{className:"event-info",children:[(0,Et.jsxs)("div",{className:"event-name",title:n.name,children:[(0,Et.jsx)("span",{className:"inline-dot"}),au(n.name)]}),n.description&&(0,Et.jsx)("div",{className:"event-description",title:n.description,children:au(n.description,25)}),n.failureProbabilityDistribution&&(0,Et.jsxs)("div",{className:"event-distribution",children:[(0,Et.jsx)("span",{className:"dist-icon",children:"\u26a0\ufe0f"}),(0,Et.jsxs)("span",{className:"dist-label",children:[r(n.failureProbabilityDistribution),(()=>{const e=d(n.failureProbabilityDistribution);return e?(0,Et.jsx)("span",{className:"dist-param",children:" ".concat(e)}):null})()]})]}),n.repairProbabilityDistribution&&(0,Et.jsxs)("div",{className:"event-repair",children:[(0,Et.jsx)("span",{className:"repair-icon",children:"\ud83d\udd27"}),(0,Et.jsxs)("span",{className:"dist-label",children:[r(n.repairProbabilityDistribution),(()=>{const e=d(n.repairProbabilityDistribution);return e?(0,Et.jsx)("span",{className:"dist-param",children:" ".concat(e)}):null})()]})]}),u&&c&&(0,Et.jsxs)("div",{className:"event-reliability",children:[(0,Et.jsx)("span",{className:"reliability-icon",children:"\ud83d\udcca"}),(0,Et.jsxs)("span",{className:"reliability-value",children:["R = ",(100*c.reliability).toFixed(1),"%"]})]})]})})]})},iu=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;return e.length<=t?e:e.substring(0,t-3)+"..."},ru=e=>{let{data:t}=e;const{gate:n,onClick:o,onDelete:i}=t,r=e=>({AND:"#3498db",OR:"#2ecc71",PAND:"#f39c12",SPARE:"#9b59b6",SEQ:"#e67e22",FDEP:"#1abc9c"}[e]),[,l]=(0,a.useState)({});(0,a.useEffect)(()=>{const e=()=>{console.log("\ud83d\udd04 [GateNode] Results loaded event received for ".concat(n.name)),l({})};return window.addEventListener("simulationResultsLoaded",e),()=>window.removeEventListener("simulationResultsLoaded",e)},[n.name]);const s=nu.getComponentResults(n.id),c=nu.hasSimulationResults();return c&&console.log("\ud83d\udccb [GateNode] ".concat(n.name," has results:"),s),(0,Et.jsxs)("div",{className:"gate-node",onClick:o,style:{borderColor:r(n.gateType)},children:[(0,Et.jsx)(wl,{type:"target",position:Lr.Bottom,className:"gate-handle gate-handle-input",style:{backgroundColor:r(n.gateType)}}),(0,Et.jsx)(wl,{type:"source",position:Lr.Top,className:"gate-handle gate-handle-output",style:{backgroundColor:r(n.gateType)}}),i&&(0,Et.jsx)("button",{className:"delete-button",onClick:e=>{e.stopPropagation(),i&&i(n.id)},title:"Elimina porta (e tutti gli elementi collegati)",children:"\xd7"}),(0,Et.jsxs)("div",{className:"gate-content",children:[(0,Et.jsx)("div",{className:"gate-icon",style:{color:r(n.gateType)},children:(u=n.gateType,{AND:"\u2227",OR:"\u2228",PAND:"\u2295",SPARE:"\u27f2",SEQ:"\u2192",FDEP:"\u27f9"}[u])}),n.isTopEvent&&(0,Et.jsx)("div",{className:"top-event-badge",title:"TOP EVENT",children:"TE"}),n.isFailureGate&&(0,Et.jsx)("div",{className:"failure-badge",title:"Failure Gate",children:"F"}),(0,Et.jsxs)("div",{className:"gate-info",children:[(0,Et.jsx)("div",{className:"gate-type",children:n.gateType}),(0,Et.jsx)("div",{className:"gate-name",title:n.name,children:iu(n.name)}),n.description&&(0,Et.jsx)("div",{className:"gate-description",title:n.description,children:iu(n.description,25)}),(0,Et.jsxs)("div",{className:"gate-inputs",children:["Inputs: ",n.inputs.length]}),c&&s&&(0,Et.jsxs)("div",{className:"gate-reliability",children:[(0,Et.jsx)("span",{className:"reliability-icon",children:"\ud83d\udcca"}),(0,Et.jsxs)("span",{className:"reliability-value",children:["R = ",(100*s.reliability).toFixed(1),"%"]})]})]})]})]});var u},lu=e=>{let{id:t,sourceX:n,sourceY:a,targetX:o,targetY:i,sourcePosition:r,targetPosition:l,style:s={},markerEnd:c,data:u}=e;const[d,p,m]=Qr({sourceX:n,sourceY:a,sourcePosition:r,targetX:o,targetY:i,targetPosition:l});return(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)("path",{id:t,style:s,className:"react-flow__edge-path",d:d,markerEnd:c}),(0,Et.jsx)(Ic,{children:(0,Et.jsx)("div",{style:{position:"absolute",transform:"translate(-50%, -50%) translate(".concat(p,"px,").concat(m,"px)"),fontSize:12,pointerEvents:"all"},className:"edge-delete-container",children:(0,Et.jsx)("button",{className:"edge-delete-button",onClick:()=>{null!==u&&void 0!==u&&u.onDelete&&u.onDelete(t)},title:"Elimina collegamento",children:"\xd7"})})})]})},su={eventNode:ou,gateNode:ru},cu={deleteButtonEdge:lu},uu=e=>{let{nodes:t,edges:n,onNodesChange:o,onEdgesChange:i,onConnect:r,nodeTypes:l,edgeTypes:s,onPanelClick:c,componentToPlace:u,isDarkMode:d,onReorganizeComponents:p}=e;const m=ls(),[h,f]=(0,a.useState)(!1),g=(0,a.useCallback)(e=>{if(!u)return;const t=m.screenToFlowPosition({x:e.clientX,y:e.clientY}),n={event:{width:135,height:45},gate:{width:155,height:45}}[u.type],a={x:t.x-n.width/2,y:t.y-n.height/2};c(a)},[u,c,m]);return(0,Et.jsxs)(Rc,{nodes:t,edges:n,onNodesChange:o,onEdgesChange:i,onConnect:r,nodeTypes:l,edgeTypes:s,attributionPosition:"bottom-left",deleteKeyCode:null,selectionOnDrag:!u&&!h,panOnDrag:!u&&!h&&[1,2],selectionMode:Dr.Partial,multiSelectionKeyCode:"Control",onPaneClick:u?g:void 0,children:[(0,Et.jsxs)("div",{className:"react-flow__panel react-flow__controls bottom left",children:[(0,Et.jsx)("button",{className:"react-flow__controls-button",onClick:()=>m.zoomIn(),title:"Zoom In (+)",children:"+"}),(0,Et.jsx)("button",{className:"react-flow__controls-button",onClick:()=>m.zoomOut(),title:"Zoom Out (-)",children:"-"}),(0,Et.jsx)("button",{className:"react-flow__controls-button",onClick:()=>m.fitView(),title:"Fit View",children:"\u229e"}),(0,Et.jsx)("button",{className:"react-flow__controls-button",onClick:()=>f(!h),title:h?"Sblocca Vista":"Blocca Vista",children:h?"\ud83d\udd13":"\ud83d\udd12"}),(0,Et.jsx)("button",{className:"react-flow__controls-button",onClick:()=>{p()},title:"Riorganizza tutti i componenti al centro",children:"\ud83d\udd27"})]}),(0,Et.jsx)(Kc,{nodeColor:"#3498db",maskColor:"rgba(0, 0, 0, 0.1)",position:"top-right"}),(0,Et.jsx)(tu,{variant:Xc.Dots,gap:20,size:1,color:d?"#404040":"#e0e0e0"})]})},du=e=>{let{faultTreeModel:t,onElementClick:n,onModelChange:o,onDeleteElement:i,onDeleteConnection:r,onPanelClick:l,componentToPlace:s,isDarkMode:c,disableDeletion:d=!1,onReorganizeComponents:p,getCurrentPositionsRef:m}=e;const h=(0,a.useMemo)(()=>{const e=[];return t.events.forEach(t=>{e.push({id:t.id,type:"eventNode",position:t.position,data:{event:t,onClick:()=>n(t),onDelete:i},draggable:!0})}),t.gates.forEach(t=>{e.push({id:t.id,type:"gateNode",position:t.position,data:{gate:t,onClick:()=>n(t),onDelete:i},draggable:!0})}),e},[t,n,i]),f=(0,a.useMemo)(()=>t.connections.map(e=>({id:e.id,source:e.source,target:e.target,type:"deleteButtonEdge",animated:!0,style:{stroke:c?"#e0e0e0":"#2c3e50",strokeWidth:2},markerEnd:{type:Fr.ArrowClosed,color:c?"#e0e0e0":"#2c3e50"},data:{onDelete:r}})),[t.connections,r,c]),[g,v,b]=Oc(h),[y,x,C]=Fc(f);a.useEffect(()=>{m&&(m.current=()=>{const e=u({},t);return e.events=t.events.map(e=>{const t=g.find(t=>t.id===e.id);return t?u(u({},e),{},{position:t.position}):e}),e.gates=t.gates.map(e=>{const t=g.find(t=>t.id===e.id);return t?u(u({},e),{},{position:t.position}):e}),e})},[m,g,t]);const S=(0,a.useRef)(!1),w=(0,a.useRef)(null),k=(0,a.useRef)(t),[N,j]=a.useState({x:0,y:0,show:!1});a.useEffect(()=>{if(S.current)return;const e=g.length,n=t.events.length+t.gates.length;v(e!==n?h:e=>e.map(e=>{const n=t.events.find(t=>t.id===e.id),a=t.gates.find(t=>t.id===e.id);return n||a?u(u({},e),{},{data:u(u({},e.data),{},{event:n,gate:a})}):e})),k.current=t},[h,v,t,g.length]),a.useEffect(()=>{if(!S.current){const e=y.map(e=>e.id).sort(),n=t.connections.map(e=>e.id).sort();JSON.stringify(e)!==JSON.stringify(n)&&x(f)}},[f,x,y,t.connections]);const E=(0,a.useCallback)(e=>{if(!e.source||!e.target)return;const n={id:"conn-".concat(Date.now()),source:e.source,target:e.target,type:"connection"},a=u(u({},t),{},{connections:[...t.connections,n]}),i=t.gates.find(t=>t.id===e.target);i&&e.source&&!i.inputs.includes(e.source)&&(a.gates=t.gates.map(t=>t.id===e.target&&e.source?u(u({},t),{},{inputs:[...t.inputs,e.source]}):t)),o(a)},[t,o,r,c]),M=(0,a.useCallback)(e=>{b(e);const n=e.filter(e=>"position"===e.type&&!0===e.dragging),a=e.filter(e=>"position"===e.type&&!1===e.dragging);n.length>0&&(S.current=!0),a.length>0&&(S.current=!1);const i=e.filter(e=>"position"===e.type&&e.position&&"number"===typeof e.position.x&&"number"===typeof e.position.y&&Number.isFinite(e.position.x)&&Number.isFinite(e.position.y));if(0===i.length)return;const r=t.events.length+t.gates.length;if(0===r)return void console.warn("\u26a0\ufe0f Skipping position update: no elements in model");w.current&&clearTimeout(w.current);const l=()=>{const e=u(u({},t),{},{events:[...t.events],gates:[...t.gates],connections:[...t.connections]});let n=!1;i.forEach(t=>{if("position"!==t.type||!t.position)return;const a=t.position,o=e.events.findIndex(e=>e.id===t.id);if(-1!==o)return e.events[o]=u(u({},e.events[o]),{},{position:a}),void(n=!0);const i=e.gates.findIndex(e=>e.id===t.id);-1!==i&&(e.gates[i]=u(u({},e.gates[i]),{},{position:a}),n=!0)});const a=e.events.length+e.gates.length;a===r?n&&o(e):console.error("\u26a0\ufe0f Element count mismatch! Skipping update",{original:r,updated:a,changes:i})};a.length>0?l():S.current?w.current=setTimeout(()=>{l()},50):l()},[b,t,o]),T=(0,a.useCallback)(e=>{C(e),e.forEach(e=>{"remove"===e.type&&r(e.id)})},[C,r]),P=(0,a.useCallback)(e=>{e.filter(e=>"remove"===e.type).forEach(e=>{"remove"===e.type&&i(e.id)});const t=e.filter(e=>"remove"!==e.type);t.length>0&&M(t)},[M,i]),z=(0,a.useCallback)(e=>{if(!d)if("Delete"===e.key){const t=g.filter(e=>e.selected),n=y.filter(e=>e.selected);t.forEach(e=>{i(e.id)}),n.forEach(e=>{r(e.id)}),e.preventDefault()}else e.ctrlKey&&"a"===e.key&&(e.preventDefault(),v(e=>e.map(e=>u(u({},e),{},{selected:!0}))),x(e=>e.map(e=>u(u({},e),{},{selected:!0}))))},[g,y,i,r,v,x,d]),_=(0,a.useCallback)(e=>{e.preventDefault(),j({x:e.clientX,y:e.clientY,show:!0})},[]),R=(0,a.useCallback)(()=>{j(e=>u(u({},e),{},{show:!1}))},[]),A=(0,a.useCallback)(()=>{v(e=>e.map(e=>u(u({},e),{},{selected:!0}))),x(e=>e.map(e=>u(u({},e),{},{selected:!0}))),R()},[v,x,R]),I=(0,a.useCallback)(()=>{v(e=>e.map(e=>u(u({},e),{},{selected:!1}))),x(e=>e.map(e=>u(u({},e),{},{selected:!1}))),R()},[v,x,R]),D=(0,a.useCallback)(()=>{const e=g.filter(e=>e.selected),t=y.filter(e=>e.selected);e.forEach(e=>i(e.id)),t.forEach(e=>r(e.id)),R()},[g,y,i,r,R]);return a.useEffect(()=>(document.addEventListener("keydown",z),document.addEventListener("click",R),()=>{document.removeEventListener("keydown",z),document.removeEventListener("click",R),w.current&&clearTimeout(w.current)}),[z,R]),(0,Et.jsxs)("div",{className:"central-panel ".concat(c?"dark-mode":""),children:[(0,Et.jsxs)("div",{className:"panel-header",children:[(0,Et.jsx)("h3",{children:"Fault Tree Diagram"}),(0,Et.jsxs)("div",{className:"diagram-info",children:[(0,Et.jsxs)("span",{children:["Eventi: ",t.events.length]}),(0,Et.jsxs)("span",{children:["Porte: ",t.gates.length]}),(0,Et.jsxs)("span",{children:["Connessioni: ",t.connections.length]})]}),(0,Et.jsx)("div",{className:"diagram-help",children:(0,Et.jsx)("span",{children:"\ud83d\udca1 Tasto destro per menu \u2022 Trascina per selezione multipla \u2022 Ctrl+Click per selezione \u2022 Ctrl+A seleziona tutto \u2022 DEL/Backspace elimina"})})]}),(0,Et.jsxs)("div",{className:"react-flow-container ".concat(s?"placement-mode":""),onContextMenu:_,children:[(0,Et.jsx)(Nc,{children:(0,Et.jsx)(uu,{nodes:g,edges:y,onNodesChange:P,onEdgesChange:T,onConnect:E,nodeTypes:su,edgeTypes:cu,onPanelClick:l,componentToPlace:s,isDarkMode:c,onReorganizeComponents:p})}),N.show&&(0,Et.jsxs)("div",{className:"context-menu",style:{position:"fixed",top:N.y,left:N.x,zIndex:1e3},children:[(0,Et.jsx)("button",{onClick:A,children:"\ud83d\udd32 Seleziona tutto (Ctrl+A)"}),(0,Et.jsx)("button",{onClick:I,children:"\u2b1c Deseleziona tutto"}),(0,Et.jsx)("hr",{}),(0,Et.jsx)("button",{onClick:D,disabled:!g.some(e=>e.selected)&&!y.some(e=>e.selected),children:"\ud83d\uddd1\ufe0f Elimina selezionati (Del)"})]})]})]})};class pu{static parseLLMResponse(e){try{console.log("Parsing LLM response:",e.substring(0,500)+"...");const t=e.match(/```json\s*([\s\S]*?)\s*```/i);if(t)try{const e=t[1].trim();return this.tryParseJSON(e,"JSON fence with tag")}catch(ad){console.log("Failed to parse JSON fence with tag, trying repair...");const n=this.repairJSON(t[1].trim());if(n)return this.tryParseJSON(n,"Repaired JSON fence")}const n=e.match(/```([\s\S]*?)```/);if(n)try{const e=n[1].trim();if(e.startsWith("{")&&e.endsWith("}"))return this.tryParseJSON(e,"Generic fence as JSON")}catch(ad){console.log("Failed to parse generic fence as JSON")}const a=this.extractFirstJsonObject(e);if(a){const e=this.tryParseJSON(a,"Extracted balanced JSON");if(e)return e;const t=this.repairJSON(a);if(t)return this.tryParseJSON(t,"Repaired extracted JSON")}const o=e.trim();try{if(o.startsWith("{")&&o.endsWith("}"))return this.tryParseJSON(o,"Full response as JSON")}catch(ad){console.log("Failed to parse full response as JSON")}const i=this.extractAllJsonObjects(e);for(const e of i){const t=this.tryParseJSON(e,"Multiple JSON objects");if(t&&this.validateFaultTreeResult(t))return t}return console.log("Falling back to structured text parsing"),this.parseStructuredResponse(e)}catch(t){return console.error("Errore nel parsing della risposta LLM:",t),null}}static tryParseJSON(e,t){try{const n=JSON.parse(e);return console.log("Successfully parsed JSON from ".concat(t)),this.validateFaultTreeResult(n)?n:(console.log("Parsed JSON from ".concat(t," failed validation")),null)}catch(ad){return console.log("Failed to parse JSON from ".concat(t,":"),ad),null}}static validateFaultTreeResult(e){return e&&"object"===typeof e&&Array.isArray(e.elements)&&Array.isArray(e.connections)&&e.elements.length>0}static extractFirstJsonObject(e){const t=e.indexOf("{");if(-1===t)return null;let n=0,a=!1,o=!1;for(let i=t;i<e.length;i++){const r=e[i];if(o)o=!1;else if("\\"!==r)if('"'!==r){if(!a)if("{"===r)n++;else if("}"===r&&(n--,0===n))return e.substring(t,i+1)}else a=!a;else o=!0}return null}static extractAllJsonObjects(e){const t=[];let n=0;for(;n<e.length;){const a=e.indexOf("{",n);if(-1===a)break;let o=0,i=!1,r=!1,l=!1;for(let s=a;s<e.length;s++){const c=e[s];if(r)r=!1;else if("\\"!==c)if('"'!==c){if(!i)if("{"===c)o++;else if("}"===c&&(o--,0===o)){t.push(e.substring(a,s+1)),n=s+1,l=!0;break}}else i=!i;else r=!0}l||(n=a+1)}return t}static repairJSON(e){try{let t=e.trim();return t=t.replace(/\/\/.*$/gm,""),t=t.replace(/\/\*[\s\S]*?\*\//g,""),t=t.replace(/,(\s*[}\]])/g,"$1"),t=t.replace(/([}\]])(\s*)([{"])/g,"$1,$2$3"),t=t.replace(/([{,]\s*)([a-zA-Z_][a-zA-Z0-9_]*)\s*:/g,'$1"$2":'),JSON.parse(t),t}catch(ad){return console.log("Failed to repair JSON:",ad),null}}static prettifyLLMResult(e){const t={value:0},n={},a=new Map,o=e.elements.map(e=>{if("event"===e.type){t.value+=1;const n="BE_".concat(t.value),o=e.name+(e.description?": ".concat(e.description):""),i=e.id&&e.id.length>0?e.id:n;return a.set(e.name,i),a.set(n,i),u(u({},e),{},{id:i,name:n,description:o})}{const t=e.gateType||"GATE";n[t]=(n[t]||0)+1;const o="".concat(t,"_").concat(n[t]),i=e.name+(e.description?": ".concat(e.description):""),r=e.id&&e.id.length>0?e.id:o;return a.set(e.name,r),a.set(o,r),u(u({},e),{},{id:r,name:o,description:i})}}),i=e.connections.map(e=>({source:a.get(e.source)||e.source,target:a.get(e.target)||e.target})).filter(e=>e.source&&e.target);let r;var l;e.topEvent&&(r=a.get(e.topEvent)||a.get((null===(l=e.topEvent)||void 0===l?void 0:l.toString().toLowerCase())||"")||e.topEvent);if(!r){const e=o.filter(e=>"gate"===e.type),t=new Set(i.map(e=>e.target)),n=e.find(e=>e.id&&!t.has(e.id));if(n)r=n.id;else{const t=e.find(e=>e.id);t&&(r=t.id)}}if(r){const e=o.find(e=>e.id===r);if(e&&"event"===e.type){const e=o.filter(e=>"gate"===e.type),t=new Set(i.map(e=>e.target)),n=e.find(e=>e.id&&!t.has(e.id));if(n)r=n.id;else{const t=e.find(e=>e.id);t&&(r=t.id)}}}return u(u({},e),{},{elements:o,connections:i,topEvent:r})}static parseStructuredResponse(e){try{console.log("Attempting structured text parsing...");const t=[],n=[];let a,o="Fault tree generato automaticamente";const i=e.split("\n").map(e=>e.trim()).filter(e=>e);let r="";for(const e of i){if(this.matchesPattern(e,["top event","evento principale","root cause"])){a=this.extractValue(e);continue}if(this.matchesPattern(e,["description","descrizione","sistema"])){const t=this.extractValue(e);t&&(o=t);continue}if(this.matchesPattern(e,["eventi base","basic events","eventi","events"])){r="events";continue}if(this.matchesPattern(e,["porte","gates","porte logiche","logic gates"])){r="gates";continue}if(this.matchesPattern(e,["connessioni","connections","collegamenti","links"])){r="connections";continue}if("events"===r){const n=this.parseEventLine(e);n&&t.push(n)}if("gates"===r){const n=this.parseGateLine(e);n&&t.push(n)}if("connections"===r){const t=this.parseConnectionLine(e);t&&n.push(t)}const i=this.parseInlineElements(e);t.push(...i);const l=this.parseInlineConnections(e);n.push(...l)}if(0===t.length)return this.parseAlternativeFormats(e);const l=this.deduplicateElements(t);return{elements:l,connections:this.deduplicateConnections(n),topEvent:a,description:o}}catch(t){return console.error("Error in structured text parsing:",t),null}}static matchesPattern(e,t){const n=e.toLowerCase();return t.some(e=>n.includes(e.toLowerCase()))}static extractValue(e){var t,n;const a=null===(t=e.split(":")[1])||void 0===t?void 0:t.trim();if(a)return a;const o=null===(n=e.split("=")[1])||void 0===n?void 0:n.trim();return o||void 0}static parseEventLine(e){const t=e.match(/^[-*\u2022]\s*(.+?)\s*\(rate:\s*([\d.]+)\)/i);if(t)return{type:"event",name:t[1].trim(),failureRate:parseFloat(t[2])};const n=e.match(/^[-*\u2022]\s*(.+)/);return n?{type:"event",name:n[1].trim(),failureRate:.001}:null}static parseGateLine(e){const t=e.match(/^[-*\u2022]\s*(.+?)\s*\((AND|OR|PAND|SPARE|SEQ|FDEP)\)/i);if(t)return{type:"gate",name:t[1].trim(),gateType:t[2].toUpperCase()};const n=e.match(/^(AND|OR|PAND|SPARE|SEQ|FDEP)\s+gate:\s*(.+)/i);return n?{type:"gate",name:n[2].trim(),gateType:n[1].toUpperCase()}:null}static parseConnectionLine(e){const t=e.match(/^[-*\u2022]?\s*(.+?)\s*->\s*(.+)/);if(t)return{source:t[1].trim(),target:t[2].trim()};const n=e.match(/(.+?)\s+connects?\s+to\s+(.+)/i);return n?{source:n[1].trim(),target:n[2].trim()}:null}static parseInlineElements(e){const t=[],n=e.match(/Event:\s*([^,\n]+)/gi);n&&n.forEach(e=>{const n=e.replace(/Event:\s*/i,"").trim();n&&t.push({type:"event",name:n,failureRate:.001})});const a=e.match(/Gate:\s*([^,\n]+?)(?:\s*\(([^)]+)\))?/gi);return a&&a.forEach(e=>{const n=e.replace(/Gate:\s*/i,"").trim().match(/^(.+?)\s*\(([^)]+)\)/);if(n){const e=n[2].toUpperCase();["AND","OR","PAND","SPARE","SEQ","FDEP"].includes(e)&&t.push({type:"gate",name:n[1].trim(),gateType:e})}}),t}static parseInlineConnections(e){const t=[],n=e.match(/([^->\n]+)\s*->\s*([^->\n]+)/g);return n&&n.forEach(e=>{const[n,a]=e.split("->").map(e=>e.trim());n&&a&&t.push({source:n,target:a})}),t}static parseAlternativeFormats(e){console.log("Trying alternative parsing formats...");const t=[],n=e.match(/[A-Za-z][A-Za-z0-9\s_-]*(?=\s*(fail|fault|error|guasto))/gi);return n&&n.forEach(e=>{t.push({type:"event",name:e.trim()+" Failure",failureRate:.001})}),t.length<2?{elements:[{type:"event",name:"Component A Failure",failureRate:.001},{type:"event",name:"Component B Failure",failureRate:.001},{type:"gate",name:"System Failure",gateType:"OR"}],connections:[{source:"Component A Failure",target:"System Failure"},{source:"Component B Failure",target:"System Failure"}],topEvent:"System Failure",description:"Fault tree generato da parsing testuale"}:{elements:t,connections:[],description:"Fault tree generato da parsing alternativo"}}static deduplicateElements(e){const t=new Set;return e.filter(e=>{const n="".concat(e.type,"-").concat(e.name);return!t.has(n)&&(t.add(n),!0)})}static deduplicateConnections(e){const t=new Set;return e.filter(e=>{const n="".concat(e.source,"->").concat(e.target);return!t.has(n)&&(t.add(n),!0)})}static generateFaultTreeModel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:100,y:100};e=this.prettifyLLMResult(e);const n=[],a=[],o=[],i=new Map,r=e=>e.trim().toLowerCase(),l=new Map,s=this.calculateHierarchicalLayout(e,t);let c;if(e.elements.filter(e=>"event"===e.type).forEach((e,a)=>{const o=e.id&&e.id.length>0?e.id:"event-".concat(Date.now(),"-").concat(a);i.set(e.name,o),i.set(r(e.name),o),e.id&&e.id.length>0&&(i.set(e.id,o),i.set(r(e.id),o));const c=s.events[e.name]||{x:t.x+a%4*180,y:t.y+400},u={id:o,type:"basic-event",name:e.name,description:e.description,failureRate:e.failureRate||.001,position:c,parameters:e.parameters||{}};e.failureProbabilityDistribution&&(u.failureProbabilityDistribution=e.failureProbabilityDistribution),e.repairProbabilityDistribution&&(u.repairProbabilityDistribution=e.repairProbabilityDistribution),n.push(u),l.set(e.name,c)}),e.elements.filter(e=>"gate"===e.type).forEach((e,n)=>{const o=e.id&&e.id.length>0?e.id:"gate-".concat(Date.now(),"-").concat(n);i.set(e.name,o),i.set(r(e.name),o),e.id&&e.id.length>0&&(i.set(e.id,o),i.set(r(e.id),o));const c=s.gates[e.name]||{x:t.x+n%3*250,y:t.y+200};a.push({id:o,type:"gate",gateType:e.gateType||"OR",name:e.name,description:e.description,position:c,inputs:[],parameters:e.parameters||{}}),l.set(e.name,c)}),e.connections.forEach((e,t)=>{if(!e||!e.source||!e.target)return;const l=i.get(e.source)||i.get(r(e.source)),s=i.get(e.target)||i.get(r(e.target)),c=l||e.source,u=s||e.target,d=n.some(e=>e.id===c)||a.some(e=>e.id===c),p=n.some(e=>e.id===u)||a.some(e=>e.id===u);if(!d||!p)return;o.push({id:"connection-".concat(Date.now(),"-").concat(t),source:c,target:u,type:"connection"});const m=a.find(e=>e.id===u);m&&!m.inputs.includes(c)&&m.inputs.push(c)}),e.topEvent&&(c=i.get(e.topEvent)||i.get(r(e.topEvent))||e.topEvent),!c){const e=a.find(e=>!o.some(t=>t.target===e.id));if(e)c=e.id;else{const e=a.find(e=>e.id);e&&(c=e.id)}}return c&&a.forEach(e=>{e.isTopEvent=e.id===c}),{events:n,gates:a,connections:o,topEvent:c}}static calculateHierarchicalLayout(e,t){const n={events:{},gates:{}},a=e.elements.filter(e=>"event"===e.type),o=e.elements.filter(e=>"gate"===e.type),i=this.calculateSimpleLayout(a,o,t);return n.events=i.events,n.gates=i.gates,n}static calculateSimpleLayout(e,t,n){const a={events:{},gates:{}};return t.forEach((e,t)=>{const o=n.x+t%3*250,i=n.y+100;a.gates[e.name]={x:o,y:i}}),e.forEach((e,t)=>{const o=n.x+t%4*180,i=n.y+300;a.events[e.name]={x:o,y:i}}),a}static createFaultTreePrompt(e){let t="Come esperto in Dynamic Fault Tree Analysis, genera un fault tree per il seguente sistema:\n\n**SISTEMA**: ".concat(e.description);return e.topEvent&&(t+="\n**TOP EVENT**: ".concat(e.topEvent)),e.systemType&&(t+="\n**TIPO SISTEMA**: ".concat(e.systemType)),e.components&&e.components.length>0&&(t+="\n**COMPONENTI**: ".concat(e.components.join(", "))),t+='\n\nIMPORTANTE: Fornisci la risposta esclusivamente nel formato JSON richiesto. Non aggiungere testo prima o dopo il JSON.\n\n```json\n{\n  "description": "Descrizione del fault tree",\n  "topEvent": "gate-1",\n  "elements": [\n    {\n      "type": "event",\n      "id": "event-1",\n      "name": "Guasto Componente A",\n      "description": "Descrizione dettagliata del guasto",\n      "failureRate": 0.001,\n      "failureProbabilityDistribution": {\n        "type": "exponential",\n        "lambda": 0.001\n      }\n    },\n    {\n      "type": "event",\n      "id": "event-2",\n      "name": "Guasto Componente B",\n      "description": "Descrizione dettagliata del guasto",\n      "failureRate": 0.002\n    },\n    {\n      "type": "gate",\n      "id": "gate-1",\n      "name": "Guasto Sistema Principale",\n      "gateType": "OR",\n      "description": "Guasto del sistema quando uno dei componenti fallisce"\n    }\n  ],\n  "connections": [\n    {\n      "source": "event-1",\n      "target": "gate-1"\n    },\n    {\n      "source": "event-2", \n      "target": "gate-1"\n    }\n  ]\n}\n```\n\n**REGOLE OBBLIGATORIE PER IL JSON**:\n1. **FORMATO RIGOROSO**: Usa esattamente il formato JSON mostrato sopra\n2. **ID UNICI**: Ogni elemento deve avere un ID unico (event-1, event-2, gate-1, etc.)\n3. **TOP EVENT**: Deve sempre essere l\'ID di una GATE, mai di un event\n4. **GATE TYPES**: Usa solo questi tipi: "AND", "OR", "PAND", "SPARE", "SEQ", "FDEP"\n5. **CONNESSIONI**: Usa sempre gli ID degli elementi, mai i nomi\n6. **SINTASSI**: Assicurati che il JSON sia valido (virgole, virgolette, parentesi bilanciate)\n7. **NO COMMENTI**: Non includere commenti nel JSON\n8. **NO TESTO EXTRA**: Non aggiungere spiegazioni prima o dopo il JSON\n\n**STRUTTURA DEL FAULT TREE**:\n- Inizia dal top event (gate principale) e procedi verso il basso\n- Gli eventi base rappresentano i guasti fondamentali\n- Le gates rappresentano le logiche di combinazione\n- Usa AND per guasti simultanei, OR per guasti alternativi\n- Considera ridondanze e dipendenze temporali appropriate al sistema',t}static getExampleFaultTrees(){return[{name:"Sistema di Alimentazione Elettrica",request:{description:"Sistema di alimentazione elettrica con doppia ridondanza",topEvent:"Perdita Alimentazione Sistema",systemType:"Elettrico",components:["Alimentatore Principale","Alimentatore Backup","UPS","Batteria"]}},{name:"Sistema Frenante Automotive",request:{description:"Sistema frenante automotive con ABS",topEvent:"Perdita Capacit\xe0 Frenante",systemType:"Meccanico",components:["Freni Anteriori","Freni Posteriori","Sistema ABS","Pompa Freno"]}},{name:"Sistema di Controllo Industriale",request:{description:"Sistema di controllo di processo industriale con PLC",topEvent:"Arresto Processo Produttivo",systemType:"Controllo",components:["PLC Principale","PLC Backup","Sensori","Attuatori","HMI"]}}]}}class mu{constructor(e){this.config=void 0,this.config=e}async generateFaultTree(e){try{const t=pu.createFaultTreePrompt(e),n=u(u({},this.config),{},{maxTokens:Math.max(this.config.maxTokens||1e3,2e3),temperature:.3}),a=new mu(n),o=await a.generateResponse(t);if(o.error){console.error("Errore nella generazione LLM:",o.error),console.log("Retrying with standard configuration...");const n=await this.generateResponse(t);return n.error?null:this.processFaultTreeResponse(n,e)}return this.processFaultTreeResponse(o,e)}catch(t){return console.error("Errore nella generazione del fault tree:",t),null}}async processFaultTreeResponse(e,t){console.log("Processing LLM response for fault tree generation..."),console.log("Response length:",e.content.length),console.log("Response preview:",e.content.substring(0,200)+"...");const n=pu.parseLLMResponse(e.content);return n?(console.log("Successfully parsed fault tree result:"),console.log("- Elements:",n.elements.length),console.log("- Connections:",n.connections.length),console.log("- Top Event:",n.topEvent),n.elements&&0!==n.elements.length||n.connections&&0!==n.connections.length?pu.generateFaultTreeModel(n):(console.log("LLM returned empty fault tree, creating minimal fallback..."),this.createMinimalFaultTree(t))):(console.error("Failed to parse LLM response."),console.log("Full response for debugging:",e.content),t.components&&t.components.length>0?(console.log("Attempting to create minimal fault tree from request components..."),this.createMinimalFaultTree(t)):null)}createMinimalFaultTree(e){try{const t=[],n=[];e.components&&e.components.length>0?e.components.forEach((e,n)=>{t.push({type:"event",id:"event-".concat(n+1),name:"Guasto ".concat(e),description:"Guasto del componente ".concat(e),failureRate:.001})}):t.push({type:"event",id:"event-1",name:"Guasto Componente A",description:"Guasto del componente principale A",failureRate:.001},{type:"event",id:"event-2",name:"Guasto Componente B",description:"Guasto del componente principale B",failureRate:.001});const a=e.topEvent||"Guasto Sistema";t.push({type:"gate",id:"gate-1",name:a,gateType:"OR",description:"Gate principale: ".concat(a)}),t.filter(e=>"event"===e.type).forEach(e=>{n.push({source:e.id,target:"gate-1"})});const o={elements:t,connections:n,topEvent:"gate-1",description:e.description||"Fault tree generato automaticamente"};return console.log("Created minimal fault tree as fallback"),pu.generateFaultTreeModel(o)}catch(t){return console.error("Failed to create minimal fault tree:",t),null}}static isGenerationRequest(e){const t=e.toLowerCase();return["genera fault tree","crea fault tree","costruisci fault tree","modella il sistema","analisi del sistema","fault tree per","create fault tree","generate fault tree","build fault tree"].some(e=>t.includes(e))}static extractGenerationRequest(e){const t={description:e},n=e.match(/top event[:\s]+([^.!?\n]+)/i);n&&(t.topEvent=n[1].trim());const a=e.match(/sistema\s+([\w\s]+?)(?:\s+con|\s+per|\.|$)/i);a&&(t.systemType=a[1].trim());const o=e.match(/componenti[:\s]+([^.!?\n]+)/i);return o&&(t.components=o[1].split(/[,;]/).map(e=>e.trim()).filter(e=>e.length>0)),t}async generateResponse(e,t){try{switch(this.config.provider){case"openai":return await this.callOpenAI(e,t);case"anthropic":return await this.callAnthropic(e,t);case"gemini":return await this.callGemini(e,t);case"grok":return await this.callGrok(e,t);case"local":return await this.callLocal(e,t);default:throw new Error("Provider non supportato: ".concat(this.config.provider))}}catch(n){return{content:"",provider:this.config.provider,model:this.config.model,error:n instanceof Error?n.message:"Errore sconosciuto"}}}async callOpenAI(e,t){const n=t?"".concat(t,"\n\nDomanda: ").concat(e):e,a=await fetch("".concat(this.config.baseUrl,"/chat/completions"),{method:"POST",headers:{Authorization:"Bearer ".concat(this.config.apiKey),"Content-Type":"application/json"},body:JSON.stringify({model:this.config.model,messages:[{role:"system",content:"Sei un esperto assistente specializzato in Dynamic Fault Tree Analysis. Fornisci risposte tecniche accurate e utili per la modellazione di fault tree."},{role:"user",content:n}],temperature:this.config.temperature||.7,max_tokens:this.config.maxTokens||1e3})});if(!a.ok)throw new Error("OpenAI API error: ".concat(a.status," ").concat(a.statusText));const o=await a.json();return{content:o.choices[0].message.content,provider:"openai",model:this.config.model,usage:o.usage}}async callAnthropic(e,t){const n=t?"".concat(t,"\n\nDomanda: ").concat(e):e,a=await fetch("".concat(this.config.baseUrl,"/v1/messages"),{method:"POST",headers:{"x-api-key":this.config.apiKey,"Content-Type":"application/json","anthropic-version":"2023-06-01"},body:JSON.stringify({model:this.config.model,max_tokens:this.config.maxTokens||1e3,messages:[{role:"user",content:"Sei un esperto assistente specializzato in Dynamic Fault Tree Analysis. Fornisci risposte tecniche accurate e utili per la modellazione di fault tree.\n\n".concat(n)}]})});if(!a.ok)throw new Error("Anthropic API error: ".concat(a.status," ").concat(a.statusText));const o=await a.json();return{content:o.content[0].text,provider:"anthropic",model:this.config.model,usage:o.usage}}async callGemini(e,t){const n=t?"".concat(t,"\n\nDomanda: ").concat(e):e,a=await fetch("".concat(this.config.baseUrl,"/v1beta/models/").concat(this.config.model,":generateContent?key=").concat(this.config.apiKey),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:"Sei un esperto assistente specializzato in Dynamic Fault Tree Analysis. Fornisci risposte tecniche accurate e utili per la modellazione di fault tree.\n\n".concat(n)}]}],generationConfig:{temperature:this.config.temperature||.7,maxOutputTokens:this.config.maxTokens||1e3}})});if(!a.ok)throw new Error("Gemini API error: ".concat(a.status," ").concat(a.statusText));return{content:(await a.json()).candidates[0].content.parts[0].text,provider:"gemini",model:this.config.model}}async callGrok(e,t){const n=t?"".concat(t,"\n\nDomanda: ").concat(e):e,a=await fetch("".concat(this.config.baseUrl,"/chat/completions"),{method:"POST",headers:{Authorization:"Bearer ".concat(this.config.apiKey),"Content-Type":"application/json"},body:JSON.stringify({model:this.config.model,messages:[{role:"system",content:"Sei un esperto assistente specializzato in Dynamic Fault Tree Analysis. Fornisci risposte tecniche accurate e utili per la modellazione di fault tree."},{role:"user",content:n}],temperature:this.config.temperature||.7,max_tokens:this.config.maxTokens||1e3})});if(!a.ok)throw new Error("Grok API error: ".concat(a.status," ").concat(a.statusText));const o=await a.json();return{content:o.choices[0].message.content,provider:"grok",model:this.config.model,usage:o.usage}}async callLocal(e,t){const n=t?"".concat(t,"\n\nDomanda: ").concat(e):e;try{const e=await fetch("".concat(this.config.baseUrl,"/api/generate"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:this.config.model,prompt:"Sei un esperto assistente specializzato in Dynamic Fault Tree Analysis. Fornisci risposte tecniche accurate e utili per la modellazione di fault tree.\n\n".concat(n),stream:!1,options:{temperature:this.config.temperature||.7,num_predict:this.config.maxTokens||1e3}})});if(!e.ok)throw new Error("Local API error: ".concat(e.status," ").concat(e.statusText));return{content:(await e.json()).response,provider:"local",model:this.config.model}}catch(a){return this.generateLocalFallback(e)}}generateLocalFallback(e){const t=e.toLowerCase();if(t.includes("and")||t.includes("porta and"))return{content:"La porta AND richiede che tutti gli eventi di input si verifichino per causare l'output. \xc8 utilizzata quando tutti i componenti devono fallire simultaneamente per causare il guasto del sistema.",provider:"local",model:"fallback"};if(t.includes("or")||t.includes("porta or"))return{content:"La porta OR si attiva quando almeno uno degli eventi di input si verifica. \xc8 la porta pi\xf9 comune nei fault tree e rappresenta ridondanza alternativa.",provider:"local",model:"fallback"};if(t.includes("pand")||t.includes("priority and"))return{content:"La porta PAND (Priority AND) richiede che gli eventi si verifichino in una sequenza specifica. \xc8 utile per modellare guasti che dipendono dall'ordine temporale.",provider:"local",model:"fallback"};if(t.includes("spare"))return{content:"La porta SPARE modella sistemi con componenti di riserva. Il sistema fallisce solo quando il componente principale E il componente spare falliscono.",provider:"local",model:"fallback"};if(t.includes("seq")||t.includes("sequenziale"))return{content:"La porta SEQ (Sequenziale) modella eventi che devono verificarsi in un ordine temporale specifico per causare il guasto.",provider:"local",model:"fallback"};if(t.includes("fdep")||t.includes("dipendenza"))return{content:"La porta FDEP (Functional Dependency) modella dipendenze funzionali dove il guasto di un componente causa automaticamente il guasto di altri componenti dipendenti.",provider:"local",model:"fallback"};if(t.includes("come")||t.includes("aiuto")||t.includes("help"))return{content:"Posso aiutarti con:\n\u2022 Spiegazioni sui tipi di porte logiche\n\u2022 Consigli sulla struttura del fault tree\n\u2022 Best practices per la modellazione\n\u2022 Interpretazione dei risultati\n\nCosa ti interessa sapere?",provider:"local",model:"fallback"};if(t.includes("evento base")||t.includes("basic event"))return{content:"Gli eventi base rappresentano i guasti fondamentali del sistema. Dovrebbero essere:\n\u2022 Indipendenti tra loro\n\u2022 Non ulteriormente sviluppabili\n\u2022 Associati a tassi di guasto specifici\n\u2022 Chiaramente definiti e misurabili",provider:"local",model:"fallback"};if(t.includes("top event")||t.includes("evento top"))return{content:"Il top event \xe8 il guasto principale che stai analizzando. Dovrebbe essere:\n\u2022 Chiaramente definito\n\u2022 Indesiderabile per il sistema\n\u2022 Il punto di partenza per l'analisi\n\u2022 Collegato logicamente agli eventi sottostanti",provider:"local",model:"fallback"};const n=["Interessante domanda! Nei fault tree dinamici, \xe8 importante considerare le dipendenze temporali tra gli eventi. Puoi fornire pi\xf9 dettagli?","Per una modellazione efficace, ti consiglio di iniziare dal top event e procedere verso il basso, identificando le cause immediate di ogni evento.","Ricorda che un buon fault tree dovrebbe essere completo, accurato e verificabile. Hai considerato tutti i modi di guasto possibili?","Le porte dinamiche come PAND, SPARE e SEQ sono particolarmente utili per sistemi con ridondanza e riparazioni. Stai modellando un sistema di questo tipo?"];return{content:n[Math.floor(Math.random()*n.length)],provider:"local",model:"fallback"}}}const hu=e=>{let{isOpen:t,onClose:n,onConfigChange:o}=e;const[i,r]=(0,a.useState)(kt),[l,s]=(0,a.useState)({}),[c,d]=(0,a.useState)("openai"),[p,m]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(t){const t=localStorage.getItem("llm-config");if(t)try{const e=JSON.parse(t);r(u(u({},kt),e))}catch(e){console.warn("Errore nel caricamento configurazione LLM:",e)}s({}),m(!1)}},[t]);const h=(e,t,n)=>{const a=u(u({},i),{},{[e]:u(u({},i[e]),{},{[t]:n})});r(a);const o=jt(a[e]);s(t=>u(u({},t),{},{[e]:o}))},f=e=>({openai:"OpenAI (GPT)",anthropic:"Anthropic (Claude)",gemini:"Google Gemini",grok:"Grok (xAI)",local:"Modello Locale"}[e]||e);return t?(0,Et.jsx)("div",{className:"modal-overlay",onClick:n,children:(0,Et.jsxs)("div",{className:"llm-config-modal",onClick:e=>e.stopPropagation(),children:[(0,Et.jsxs)("div",{className:"modal-header",children:[(0,Et.jsx)("h2",{children:"\ud83e\udd16 Configurazione LLM"}),(0,Et.jsx)("button",{className:"close-button",onClick:n,children:"\xd7"})]}),(0,Et.jsxs)("div",{className:"modal-content",children:[(0,Et.jsx)("div",{className:"tabs",children:Object.keys(i).map(e=>(0,Et.jsx)("button",{className:"tab ".concat(c===e?"active":""),onClick:()=>d(e),children:f(e)},e))}),(0,Et.jsx)("div",{className:"tab-content",children:(e=>{const t=i[e],n=l[e]||[];return(0,Et.jsxs)("div",{className:"provider-config",children:[(0,Et.jsxs)("div",{className:"provider-header",children:[(0,Et.jsx)("h3",{children:f(e)}),(0,Et.jsxs)("label",{className:"enabled-toggle",children:[(0,Et.jsx)("input",{type:"checkbox",checked:t.enabled,onChange:t=>h(e,"enabled",t.target.checked)}),"Abilitato"]})]}),(0,Et.jsxs)("div",{className:"config-fields",children:[(0,Et.jsxs)("div",{className:"field-group",children:[(0,Et.jsx)("label",{children:"API Key:"}),(0,Et.jsx)("input",{type:"password",value:t.apiKey,onChange:t=>h(e,"apiKey",t.target.value),placeholder:"Inserisci API Key per ".concat(f(e)),disabled:"local"===e}),"local"===e&&(0,Et.jsx)("span",{className:"field-help",children:"Non richiesto per il modello locale"})]}),(0,Et.jsxs)("div",{className:"field-group",children:[(0,Et.jsx)("label",{children:"Modello:"}),(0,Et.jsx)("input",{type:"text",value:t.model,onChange:t=>h(e,"model",t.target.value),placeholder:"Nome del modello"})]}),(0,Et.jsxs)("div",{className:"field-group",children:[(0,Et.jsx)("label",{children:"Base URL:"}),(0,Et.jsx)("input",{type:"text",value:t.baseUrl||"",onChange:t=>h(e,"baseUrl",t.target.value),placeholder:"URL base dell'API"})]}),(0,Et.jsxs)("div",{className:"field-row",children:[(0,Et.jsxs)("div",{className:"field-group",children:[(0,Et.jsx)("label",{children:"Temperatura:"}),(0,Et.jsx)("input",{type:"number",min:"0",max:"2",step:"0.1",value:t.temperature||.7,onChange:t=>h(e,"temperature",parseFloat(t.target.value))}),(0,Et.jsx)("span",{className:"field-help",children:"0.0 - 2.0"})]}),(0,Et.jsxs)("div",{className:"field-group",children:[(0,Et.jsx)("label",{children:"Max Tokens:"}),(0,Et.jsx)("input",{type:"number",min:"1",value:t.maxTokens||1e3,onChange:t=>h(e,"maxTokens",parseInt(t.target.value))})]})]}),n.length>0&&(0,Et.jsx)("div",{className:"error-list",children:n.map((e,t)=>(0,Et.jsxs)("div",{className:"error-item",children:["\u26a0\ufe0f ",e]},t))})]})]})})(c)}),(0,Et.jsxs)("div",{className:"config-info",children:[(0,Et.jsx)("h4",{children:"\ud83d\udca1 Informazioni sui Provider"}),(0,Et.jsxs)("div",{className:"info-grid",children:[(0,Et.jsxs)("div",{className:"info-item",children:[(0,Et.jsx)("strong",{children:"OpenAI:"})," GPT-4, GPT-3.5-turbo"]}),(0,Et.jsxs)("div",{className:"info-item",children:[(0,Et.jsx)("strong",{children:"Anthropic:"})," Claude-3 Haiku, Sonnet, Opus"]}),(0,Et.jsxs)("div",{className:"info-item",children:[(0,Et.jsx)("strong",{children:"Gemini:"})," Gemini 1.5 Flash, Pro"]}),(0,Et.jsxs)("div",{className:"info-item",children:[(0,Et.jsx)("strong",{children:"Grok:"})," Grok-beta (xAI)"]}),(0,Et.jsxs)("div",{className:"info-item",children:[(0,Et.jsx)("strong",{children:"Locale:"})," Ollama, LM Studio, etc."]})]})]})]}),(0,Et.jsxs)("div",{className:"modal-footer",children:[(0,Et.jsx)("button",{className:"reset-button",onClick:()=>{r(kt),s({})},children:"\ud83d\udd04 Reset"}),(0,Et.jsxs)("div",{className:"footer-buttons",children:[p&&(0,Et.jsx)("div",{className:"save-success",children:"\u2705 Configurazione salvata!"}),(0,Et.jsx)("button",{className:"cancel-button",onClick:n,children:"Annulla"}),(0,Et.jsx)("button",{className:"save-button",onClick:()=>{console.log("Saving config:",i);const e={};let t=!1;Object.entries(i).forEach(n=>{let[a,o]=n;if(o.enabled){const n=jt(o);console.log("Provider ".concat(a," errors:"),n),n.length>0&&(e[a]=n,"local"!==a&&(t=!0))}});const a=Object.values(i).some(e=>!!e.enabled&&("local"===e.provider||e.apiKey&&""!==e.apiKey.trim()));if(t&&!a)return console.log("Validation errors prevent saving:",e),void s(e);console.log("Saving configuration..."),Nt(i),o(i),m(!0),setTimeout(()=>{m(!1),n()},1e3)},disabled:p,children:p?"\u2705 Salvato!":"\ud83d\udcbe Salva Configurazione"})]})]})]})}):null};function fu(e){return[{key:"openai",name:"OpenAI",enabled:e.openai.enabled&&!!e.openai.apiKey},{key:"anthropic",name:"Anthropic",enabled:e.anthropic.enabled&&!!e.anthropic.apiKey},{key:"gemini",name:"Gemini",enabled:e.gemini.enabled&&!!e.gemini.apiKey},{key:"grok",name:"Grok",enabled:e.grok.enabled&&!!e.grok.apiKey},{key:"local",name:"Local",enabled:e.local.enabled}].filter(e=>e.enabled)}function gu(e){return{openai:"\ud83e\udd16",anthropic:"\ud83e\udde0",gemini:"\ud83d\udc8e",grok:"\u26a1",local:"\ud83c\udfe0"}[e]||"\ud83d\udd27"}const vu=e=>{let{onGenerateFaultTree:t,onModifyFaultTree:n,currentFaultTree:o,isDarkMode:i,isCollapsed:r,onToggleCollapse:l,editorType:s="fault-tree",onGenerateMarkovChain:c}=e;const{llmConfig:u,showLLMConfigModal:d,setShowLLMConfigModal:p,updateLLMConfig:m,currentProvider:h,setCurrentProvider:f}=Tt(),[g,v]=(0,a.useState)([{id:"1",text:"markov-chain"===s?'Ciao! Sono Harmony, il tuo assistente per l\'analisi delle Markov Chain. Posso aiutarti a:\n\n\u2022 Generare catene di Markov automaticamente\n\u2022 Spiegare concetti di processi stocastici\n\u2022 Analizzare il tuo modello corrente\n\nProva a scrivere: "Crea una markov chain per un sistema a 3 stati" o "Spiega le propriet\xe0 di una catena di Markov"':'Ciao! Sono Harmony, il tuo assistente per Dynamic Fault Tree Analysis. Posso aiutarti a:\n\n\u2022 Generare fault tree automaticamente\n\u2022 Spiegare concetti e best practices\n\u2022 Analizzare il tuo modello corrente\n\nProva a scrivere: "Genera un fault tree per un sistema di alimentazione elettrica"',sender:"bot",timestamp:new Date}]),[b,y]=(0,a.useState)(""),[x,C]=(0,a.useState)(!1),[S,w]=(0,a.useState)(!1),[k,N]=(0,a.useState)({isGenerating:!1}),j=(0,a.useRef)(null);(0,a.useEffect)(()=>{(()=>{var e;null===(e=j.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})})()},[g]),(0,a.useEffect)(()=>{v([{id:"1",text:"markov-chain"===s?'Ciao! Sono Harmony, il tuo assistente per l\'analisi delle Markov Chain. Posso aiutarti a:\n\n\u2022 Generare catene di Markov automaticamente\n\u2022 Spiegare concetti di processi stocastici\n\u2022 Analizzare il tuo modello corrente\n\nProva a scrivere: "Crea una markov chain per un sistema a 3 stati" o "Spiega le propriet\xe0 di una catena di Markov"':'Ciao! Sono Harmony, il tuo assistente per Dynamic Fault Tree Analysis. Posso aiutarti a:\n\n\u2022 Generare fault tree automaticamente\n\u2022 Spiegare concetti e best practices\n\u2022 Analizzare il tuo modello corrente\n\nProva a scrivere: "Genera un fault tree per un sistema di alimentazione elettrica"',sender:"bot",timestamp:new Date}])},[s]),(0,a.useEffect)(()=>{const e=fu(u);e.length>0&&!e.some(e=>e.key===h)&&(f(e[0].key),console.log("Initial provider set to:",e[0].key))},[u,h,f]),(0,a.useEffect)(()=>{const e=e=>{e.target.closest(".provider-selector")||w(!1)};if(S)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[S]);const E=async()=>{if(!b.trim())return;const e={id:Date.now().toString(),text:b,sender:"user",timestamp:new Date};v(t=>[...t,e]);const t=b;y(""),C(!0);try{if(mu.isGenerationRequest(t)&&"fault-tree"===s)return void await P(t);if(M(t)&&"markov-chain"===s)return void await T(t);console.log("LLM Config:",u),console.log("Current Provider:",h);const e=u[h];if(console.log("Selected Provider Config:",e),e&&"local"!==e.provider&&e.enabled&&e.apiKey){console.log("Using external LLM:",e.provider);const n=new mu(e),a=o?"Fault tree corrente: ".concat(o.events.length," eventi, ").concat(o.gates.length," porte"):void 0,i=await n.generateResponse(t,a);if(i.error)throw new Error(i.error);const r={id:(Date.now()+1).toString(),text:i.content,sender:"bot",timestamp:new Date};v(e=>[...e,r])}else{console.log("Using local fallback");const e=z(t),n={id:(Date.now()+1).toString(),text:e,sender:"bot",timestamp:new Date};v(e=>[...e,n])}}catch(n){console.error("LLM Error:",n);const e=z(t),a={id:(Date.now()+1).toString(),text:e,sender:"bot",timestamp:new Date};v(e=>[...e,a])}finally{C(!1)}},M=e=>{const t=e.toLowerCase();return["crea.*markov","genera.*markov","crea.*catena","genera.*catena","markov.*chain","catena.*markov","modello.*markov"].some(e=>new RegExp(e,"i").test(t))},T=async e=>{if(!c){const e={id:(Date.now()+1).toString(),text:"Funzionalit\xe0 di generazione Markov Chain non disponibile.",sender:"bot",timestamp:new Date};return v(t=>[...t,e]),void C(!1)}N({isGenerating:!0,message:"Generazione Markov Chain in corso..."});try{const n=u[h];if(n&&n.enabled&&n.apiKey){const a=new mu(n),o="Crea una Markov Chain per: ".concat(e,'. Rispondi SOLO con un JSON valido nel formato:\n{\n  "states": [\n    {"id": "S1", "name": "State 1", "position": {"x": 100, "y": 100}, "type": "state"},\n    {"id": "S2", "name": "State 2", "position": {"x": 300, "y": 100}, "type": "state"}\n  ],\n  "transitions": [\n    {"id": "T1", "sourceId": "S1", "targetId": "S2", "rate": 0.1, "label": "Transition 1"}\n  ]\n}'),i=(await a.generateResponse(o)).content;try{const e=i.match(/\{[\s\S]*\}/);if(e){const t=JSON.parse(e[0]);if(!t.states||!t.transitions)throw new Error("Formato JSON non valido per Markov Chain");{c(t);const e={id:(Date.now()+1).toString(),text:"\u2705 Ho generato una Markov Chain con:\n\u2022 ".concat(t.states.length," stati\n\u2022 ").concat(t.transitions.length," transizioni\n\nIl modello \xe8 stato aggiunto all'editor grafico!"),sender:"bot",timestamp:new Date};v(t=>[...t,e])}}else{const e={id:(Date.now()+1).toString(),text:i,sender:"bot",timestamp:new Date};v(t=>[...t,e])}}catch(t){const e={id:(Date.now()+1).toString(),text:i,sender:"bot",timestamp:new Date};v(t=>[...t,e])}}else{const e={id:(Date.now()+1).toString(),text:"Per generare Markov Chain automaticamente, configura un provider LLM nelle impostazioni. Al momento posso solo fornire consigli teorici sui modelli di Markov.",sender:"bot",timestamp:new Date};v(t=>[...t,e])}}catch(n){const e={id:(Date.now()+1).toString(),text:"Errore durante la generazione: ".concat(n instanceof Error?n.message:"Errore sconosciuto"),sender:"bot",timestamp:new Date};v(t=>[...t,e])}finally{N({isGenerating:!1}),C(!1)}},P=async e=>{if(!t){const e={id:(Date.now()+1).toString(),text:"Funzionalit\xe0 di generazione non disponibile in questa modalit\xe0.",sender:"bot",timestamp:new Date};return v(t=>[...t,e]),void C(!1)}N({isGenerating:!0,message:"Generazione fault tree in corso..."});try{const n=u[h];if(!(n&&n.enabled&&n.apiKey))throw new Error("Provider LLM non configurato");{const a=new mu(n),o=mu.extractGenerationRequest(e),i=await a.generateFaultTree(o);if(!i)throw new Error("Impossibile generare il fault tree");{t(i);const e={id:(Date.now()+1).toString(),text:"\u2705 Ho generato un fault tree con:\n\u2022 ".concat(i.events.length," eventi base\n\u2022 ").concat(i.gates.length," porte logiche\n\u2022 ").concat(i.connections.length," connessioni\n\nIl modello \xe8 stato aggiunto all'editor grafico!"),sender:"bot",timestamp:new Date};v(t=>[...t,e])}}}catch(n){console.error("Errore generazione fault tree:",n);const e={id:(Date.now()+1).toString(),text:"\u274c Errore nella generazione: ".concat(n instanceof Error?n.message:"Errore sconosciuto","\n\nVerifica la configurazione LLM o prova con una descrizione pi\xf9 dettagliata."),sender:"bot",timestamp:new Date};v(t=>[...t,e])}finally{N({isGenerating:!1}),C(!1)}},z=e=>{const t=e.toLowerCase();if(t.includes("and")||t.includes("porta and"))return"La porta AND richiede che tutti gli eventi di input si verifichino per causare l'output. \xc8 utilizzata quando tutti i componenti devono fallire simultaneamente per causare il guasto del sistema.";if(t.includes("or")||t.includes("porta or"))return"La porta OR si attiva quando almeno uno degli eventi di input si verifica. \xc8 la porta pi\xf9 comune nei fault tree e rappresenta ridondanza alternativa.";if(t.includes("pand")||t.includes("priority and"))return"La porta PAND (Priority AND) richiede che gli eventi si verifichino in una sequenza specifica. \xc8 utile per modellare guasti che dipendono dall'ordine temporale.";if(t.includes("spare"))return"La porta SPARE modella sistemi con componenti di riserva. Il sistema fallisce solo quando il componente principale E il componente spare falliscono.";if(t.includes("seq")||t.includes("sequenziale"))return"La porta SEQ (Sequenziale) modella eventi che devono verificarsi in un ordine temporale specifico per causare il guasto.";if(t.includes("fdep")||t.includes("dipendenza"))return"La porta FDEP (Functional Dependency) modella dipendenze funzionali dove il guasto di un componente causa automaticamente il guasto di altri componenti dipendenti.";if(t.includes("come")||t.includes("aiuto")||t.includes("help"))return'Posso aiutarti con:\n\u2022 Generare fault tree automaticamente\n\u2022 Spiegazioni sui tipi di porte logiche\n\u2022 Consigli sulla struttura del fault tree\n\u2022 Best practices per la modellazione\n\u2022 Interpretazione dei risultati\n\nProva a scrivere: "Genera fault tree per [descrizione sistema]"';if(t.includes("evento base")||t.includes("basic event"))return"Gli eventi base rappresentano i guasti fondamentali del sistema. Dovrebbero essere:\n\u2022 Indipendenti tra loro\n\u2022 Non ulteriormente sviluppabili\n\u2022 Associati a tassi di guasto specifici\n\u2022 Chiaramente definiti e misurabili";if(t.includes("top event")||t.includes("evento top"))return"Il top event \xe8 il guasto principale che stai analizzando. Dovrebbe essere:\n\u2022 Chiaramente definito\n\u2022 Indesiderabile per il sistema\n\u2022 Il punto di partenza per l'analisi\n\u2022 Collegato logicamente agli eventi sottostanti";const n=["Interessante domanda! Nei fault tree dinamici, \xe8 importante considerare le dipendenze temporali tra gli eventi. Puoi fornire pi\xf9 dettagli?","Per una modellazione efficace, ti consiglio di iniziare dal top event e procedere verso il basso, identificando le cause immediate di ogni evento.","Ricorda che un buon fault tree dovrebbe essere completo, accurato e verificabile. Hai considerato tutti i modi di guasto possibili?","Le porte dinamiche come PAND, SPARE e SEQ sono particolarmente utili per sistemi con ridondanza e riparazioni. Stai modellando un sistema di questo tipo?"];return n[Math.floor(Math.random()*n.length)]},_=e=>{y(e)};return(0,Et.jsxs)("div",{className:"right-panel ".concat(i?"dark-mode":""," ").concat(r?"collapsed":""),children:[(0,Et.jsxs)("div",{className:"panel-header",children:[(0,Et.jsxs)("div",{className:"header-content",children:[(0,Et.jsx)("h3",{children:"\ud83e\udd16 Harmony AI"}),(0,Et.jsx)("button",{className:"collapse-toggle",onClick:l,title:r?"Mostra pannello":"Nascondi pannello",children:r?"\u25c0":"\u25b6"})]}),(0,Et.jsxs)("div",{className:"header-controls",children:[(0,Et.jsxs)("div",{className:"provider-info",children:[(0,Et.jsx)("span",{className:"provider-label",children:"Provider:"}),(0,Et.jsxs)("div",{className:"provider-selector",children:[(0,Et.jsxs)("button",{className:"provider-badge ".concat(h),onClick:()=>w(!S),title:"Provider attuale: ".concat(h.toUpperCase()," - Clicca per cambiare"),children:["\ud83d\udee1\ufe0f ",h.toUpperCase()," ",S?"\u25b2":"\u25bc"]}),S&&(0,Et.jsx)("div",{className:"provider-dropdown",children:fu(u).map(e=>(0,Et.jsxs)("button",{className:"provider-option ".concat(h===e.key?"active":""),onClick:()=>{f(e.key),w(!1)},children:[gu(e.key)," ",e.name,h===e.key&&" \u2713"]},e.key))})]})]}),(0,Et.jsx)("button",{className:"config-button",onClick:()=>p(!0),title:"Configura LLM",children:"\u2699\ufe0f"})]})]}),!r&&(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsxs)("div",{className:"chat-container",children:[(0,Et.jsxs)("div",{className:"messages",children:[g.map(e=>(0,Et.jsxs)("div",{className:"message ".concat(e.sender),children:[(0,Et.jsxs)("div",{className:"message-content",children:[(0,Et.jsx)("strong",{className:"message-prefix",children:"user"===e.sender?"Tu: ":"Harmony AI: "}),e.text.split("\n").map((t,n)=>(0,Et.jsxs)(a.Fragment,{children:[t,n<e.text.split("\n").length-1&&(0,Et.jsx)("br",{})]},n))]}),(0,Et.jsx)("div",{className:"message-time",children:e.timestamp.toLocaleTimeString()})]},e.id)),x&&(0,Et.jsx)("div",{className:"message bot typing",children:(0,Et.jsx)("div",{className:"message-content",children:(0,Et.jsxs)("div",{className:"typing-indicator",children:[(0,Et.jsx)("span",{}),(0,Et.jsx)("span",{}),(0,Et.jsx)("span",{})]})})}),(0,Et.jsx)("div",{ref:j})]}),(0,Et.jsxs)("div",{className:"quick-examples",children:[(0,Et.jsx)("div",{className:"quick-examples-title",children:"\ud83d\ude80 Esempi di Generazione:"}),(0,Et.jsx)("div",{className:"quick-buttons",children:"markov-chain"===s?(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)("button",{className:"quick-button",onClick:()=>_("Crea una markov chain per un sistema a 3 stati: funzionante, degradato, guasto"),children:"\u26a1 Sistema 3 Stati"}),(0,Et.jsx)("button",{className:"quick-button",onClick:()=>_("Genera una catena di Markov per modellare la disponibilit\xe0 di un server con riparazione"),children:"\ud83d\udda5\ufe0f Server Riparabile"}),(0,Et.jsx)("button",{className:"quick-button",onClick:()=>_("Modella una markov chain per un sistema ridondante con 2 componenti identici"),children:"\ud83d\udd04 Sistema Ridondato"})]}):(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)("button",{className:"quick-button",onClick:()=>_("Genera un fault tree per un sistema di alimentazione elettrica con ridondanza"),children:"\ud83d\udd0c Sistema Elettrico"}),(0,Et.jsx)("button",{className:"quick-button",onClick:()=>_("Crea fault tree per sistema frenante automotive con ABS"),children:"\ud83d\ude97 Sistema Frenante"}),(0,Et.jsx)("button",{className:"quick-button",onClick:()=>_("Modella fault tree per sistema di controllo industriale PLC"),children:"\ud83c\udfed Sistema Controllo"})]})})]}),(0,Et.jsxs)("div",{className:"input-area",children:[(0,Et.jsx)("textarea",{value:b,onChange:e=>y(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),E())},onKeyDown:e=>{e.stopPropagation()},placeholder:"Scrivi 'genera fault tree per...' o usa gli esempi sopra!",className:"message-input",rows:3,autoFocus:!1,spellCheck:!1}),(0,Et.jsx)("button",{onClick:E,disabled:!b.trim()||x,className:"send-button",children:"\ud83d\udce4"})]}),k.isGenerating&&(0,Et.jsxs)("div",{className:"generation-status",children:[(0,Et.jsx)("div",{className:"generation-spinner",children:"\u2699\ufe0f"}),(0,Et.jsx)("span",{children:k.message||"Generazione in corso..."})]})]}),(0,Et.jsxs)("div",{className:"help-section",children:[(0,Et.jsx)("h4",{children:"\ud83d\udca1 Suggerimenti"}),(0,Et.jsx)("div",{className:"help-items",children:"markov-chain"===s?(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)("div",{className:"help-item",children:"\ud83d\udd17 Genera catene di Markov automaticamente"}),(0,Et.jsx)("div",{className:"help-item",children:"\u2753 Chiedi informazioni sui processi stocastici"}),(0,Et.jsx)("div",{className:"help-item",children:"\ud83d\udcca Richiedi consigli sulla modellazione probabilistica"}),(0,Et.jsx)("div",{className:"help-item",children:"\ud83c\udfaf Analizza propriet\xe0 della tua catena"})]}):(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)("div",{className:"help-item",children:"\ud83d\udd27 Genera fault tree automaticamente"}),(0,Et.jsx)("div",{className:"help-item",children:"\u2753 Chiedi informazioni sui tipi di porte"}),(0,Et.jsx)("div",{className:"help-item",children:"\ud83d\udcca Richiedi consigli sulla modellazione"}),(0,Et.jsx)("div",{className:"help-item",children:"\ud83c\udfaf Analizza il tuo modello corrente"})]})})]})]}),d&&(0,Et.jsx)(hu,{isOpen:d,onClose:()=>p(!1),onConfigChange:m})]})},bu=e=>{let{element:t,onSave:n,onClose:o,faultTreeModel:i,onShowResults:r}=e;const[l,s]=(0,a.useState)(u({name:t.name,description:t.description||""},t.parameters)),[c,d]=(0,a.useState)({failureRate:"basic-event"===t.type&&t.failureRate||"",repairRate:"",dormancyFactor:"",testInterval:""}),[p,m]=(0,a.useState)("exponential"),[h,f]=(0,a.useState)({}),[g,v]=(0,a.useState)("exponential"),[b,y]=(0,a.useState)({}),[x,C]=(0,a.useState)(!1),[S,w]=(0,a.useState)({priority:"",delay:"",spareType:"",switchingTime:""}),[k,N]=(0,a.useState)(!1),[j,E]=(0,a.useState)(!1),M=nu.hasSimulationResults(),T=nu.getComponentResults(t.id),[P,z]=(0,a.useState)(null),[_,R]=(0,a.useState)([]),[A,I]=(0,a.useState)([]);(0,a.useEffect)(()=>{if(t.parameters&&("basic-event"===t.type?d(e=>u(u({},e),t.parameters)):w(e=>u(u({},e),t.parameters))),"gate"===t.type){const e=t;N(e.isFailureGate||!1),E(e.isTopEvent||!1),z(e.gateType||null),R(e.inputs||[]),I(e.secondaryInputs||[])}if("basic-event"===t.type){const e=t;if(e.failureProbabilityDistribution)switch(m(e.failureProbabilityDistribution.type),e.failureProbabilityDistribution.type){case"exponential":f({lambda:e.failureProbabilityDistribution.lambda.toString()});break;case"weibull":f({k:e.failureProbabilityDistribution.k.toString(),lambda:e.failureProbabilityDistribution.lambda.toString(),mu:e.failureProbabilityDistribution.mu.toString()});break;case"normal":f({mu:e.failureProbabilityDistribution.mu.toString(),sigma:e.failureProbabilityDistribution.sigma.toString()});break;case"constant":f({probability:e.failureProbabilityDistribution.probability.toString()})}if(e.repairProbabilityDistribution)switch(C(!0),v(e.repairProbabilityDistribution.type),e.repairProbabilityDistribution.type){case"exponential":y({lambda:e.repairProbabilityDistribution.lambda.toString()});break;case"weibull":y({k:e.repairProbabilityDistribution.k.toString(),lambda:e.repairProbabilityDistribution.lambda.toString(),mu:e.repairProbabilityDistribution.mu.toString()});break;case"normal":y({mu:e.repairProbabilityDistribution.mu.toString(),sigma:e.repairProbabilityDistribution.sigma.toString()});break;case"constant":y({probability:e.repairProbabilityDistribution.probability.toString()})}}},[t]);const D=(e,t)=>{s(n=>u(u({},n),{},{[e]:t}))},O=(e,t)=>{d(n=>u(u({},n),{},{[e]:t}))},F=(e,t)=>{w(n=>u(u({},n),{},{[e]:t}))},L=(e,t)=>{f(n=>u(u({},n),{},{[e]:t}))},B=(e,t)=>{y(n=>u(u({},n),{},{[e]:t}))},U=e=>{R(t=>{const n=t.indexOf(e);if(n<=0)return t;const a=[...t];return[a[n-1],a[n]]=[a[n],a[n-1]],a})},H=e=>{R(t=>{const n=t.indexOf(e);if(-1===n||n>=t.length-1)return t;const a=[...t];return[a[n],a[n+1]]=[a[n+1],a[n]],a})},W=e=>{if(!i)return e;const t=i.events.find(t=>t.id===e);if(t)return t.name;const n=i.gates.find(t=>t.id===e);return n?n.name:e},V=e=>{switch(e){case"exponential":default:return"Distribuzione Esponenziale";case"weibull":return"Distribuzione di Weibull (3 parametri)";case"normal":return"Distribuzione Normale (2 parametri)";case"constant":return"Probabilit\xe0 Costante"}};return(0,Et.jsx)("div",{className:"modal-overlay",onClick:o,children:(0,Et.jsxs)("div",{className:"parameter-modal",onClick:e=>e.stopPropagation(),children:[(0,Et.jsxs)("div",{className:"modal-header",children:[(0,Et.jsx)("h3",{children:"basic-event"===t.type?"\u2b1c Parametri Evento Base":"".concat("AND"===t.gateType?"\u2227":"OR"===t.gateType?"\u2228":"PAND"===t.gateType?"\u2295":"SPARE"===t.gateType?"\u27f2":"SEQ"===t.gateType?"\u2192":"\u27f9"," Parametri Porta ").concat(t.gateType)}),(0,Et.jsx)("button",{className:"close-button",onClick:o,children:"\xd7"})]}),(0,Et.jsxs)("div",{className:"modal-content",children:[(0,Et.jsxs)("div",{className:"form-section",children:[(0,Et.jsx)("h4",{children:"Informazioni Generali"}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"Nome:"}),(0,Et.jsx)("input",{type:"text",value:l.name,onChange:e=>D("name",e.target.value),className:"form-input"})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"Descrizione:"}),(0,Et.jsx)("textarea",{value:l.description,onChange:e=>D("description",e.target.value),className:"form-textarea",rows:3})]})]}),"basic-event"===t.type&&(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsxs)("div",{className:"form-section",children:[(0,Et.jsx)("h4",{children:"Probabilit\xe0 di Guasto"}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"Tipo di Distribuzione:"}),(0,Et.jsxs)("select",{value:p,onChange:e=>{return t=e.target.value,m(t),void f({});var t},className:"form-select",children:[(0,Et.jsx)("option",{value:"exponential",children:"Distribuzione Esponenziale"}),(0,Et.jsx)("option",{value:"weibull",children:"Distribuzione di Weibull (3 parametri)"}),(0,Et.jsx)("option",{value:"normal",children:"Distribuzione Normale (2 parametri)"}),(0,Et.jsx)("option",{value:"constant",children:"Probabilit\xe0 Costante"})]}),(0,Et.jsx)("span",{className:"form-help",children:V(p)})]}),"exponential"===p&&(0,Et.jsx)("div",{className:"distribution-params",children:(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"Tasso di Guasto (\u03bb):"}),(0,Et.jsx)("input",{type:"text",value:h.lambda||"",onChange:e=>L("lambda",e.target.value),className:"form-input",placeholder:"es. 0.001"}),(0,Et.jsx)("span",{className:"form-help",children:"Unit\xe0: h\u207b\xb9 (ore alla meno 1)"})]})}),"weibull"===p&&(0,Et.jsxs)("div",{className:"distribution-params",children:[(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"Parametro di Forma (k):"}),(0,Et.jsx)("input",{type:"text",value:h.k||"",onChange:e=>L("k",e.target.value),className:"form-input",placeholder:"es. 2.0"}),(0,Et.jsx)("span",{className:"form-help",children:"Adimensionale"})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"Parametro di Scala (\u03bb):"}),(0,Et.jsx)("input",{type:"text",value:h.lambda||"",onChange:e=>L("lambda",e.target.value),className:"form-input",placeholder:"es. 1000"}),(0,Et.jsx)("span",{className:"form-help",children:"Unit\xe0: h (ore)"})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"Parametro di Posizione (\u03bc):"}),(0,Et.jsx)("input",{type:"text",value:h.mu||"",onChange:e=>L("mu",e.target.value),className:"form-input",placeholder:"es. 0"}),(0,Et.jsx)("span",{className:"form-help",children:"Unit\xe0: h (ore)"})]})]}),"normal"===p&&(0,Et.jsxs)("div",{className:"distribution-params",children:[(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"Media (\u03bc):"}),(0,Et.jsx)("input",{type:"text",value:h.mu||"",onChange:e=>L("mu",e.target.value),className:"form-input",placeholder:"es. 8760"}),(0,Et.jsx)("span",{className:"form-help",children:"Unit\xe0: h (ore)"})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"Deviazione Standard (\u03c3):"}),(0,Et.jsx)("input",{type:"text",value:h.sigma||"",onChange:e=>L("sigma",e.target.value),className:"form-input",placeholder:"es. 1000"}),(0,Et.jsx)("span",{className:"form-help",children:"Unit\xe0: h (ore)"})]})]}),"constant"===p&&(0,Et.jsx)("div",{className:"distribution-params",children:(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"Probabilit\xe0 Costante:"}),(0,Et.jsx)("input",{type:"text",value:h.probability||"",onChange:e=>L("probability",e.target.value),className:"form-input",placeholder:"es. 0.001"}),(0,Et.jsx)("span",{className:"form-help",children:"Adimensionale (0-1)"})]})})]}),(0,Et.jsxs)("div",{className:"form-section",children:[(0,Et.jsx)("h4",{children:(0,Et.jsxs)("label",{className:"section-checkbox",children:[(0,Et.jsx)("input",{type:"checkbox",checked:x,onChange:e=>{return t=e.target.checked,C(t),void(t||y({}));var t}}),"Probabilit\xe0 di Riparazione"]})}),x&&(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"Tipo di Distribuzione:"}),(0,Et.jsxs)("select",{value:g,onChange:e=>{return t=e.target.value,v(t),void y({});var t},className:"form-select",children:[(0,Et.jsx)("option",{value:"exponential",children:"Distribuzione Esponenziale"}),(0,Et.jsx)("option",{value:"weibull",children:"Distribuzione di Weibull (3 parametri)"}),(0,Et.jsx)("option",{value:"normal",children:"Distribuzione Normale (2 parametri)"}),(0,Et.jsx)("option",{value:"constant",children:"Probabilit\xe0 Costante"})]}),(0,Et.jsx)("span",{className:"form-help",children:V(g)})]}),"exponential"===g&&(0,Et.jsx)("div",{className:"distribution-params",children:(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"Tasso di Riparazione (\u03bc):"}),(0,Et.jsx)("input",{type:"text",value:b.lambda||"",onChange:e=>B("lambda",e.target.value),className:"form-input",placeholder:"es. 0.1"}),(0,Et.jsx)("span",{className:"form-help",children:"Unit\xe0: h\u207b\xb9 (ore alla meno 1)"})]})}),"weibull"===g&&(0,Et.jsxs)("div",{className:"distribution-params",children:[(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"Parametro di Forma (k):"}),(0,Et.jsx)("input",{type:"text",value:b.k||"",onChange:e=>B("k",e.target.value),className:"form-input",placeholder:"es. 2.0"}),(0,Et.jsx)("span",{className:"form-help",children:"Adimensionale"})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"Parametro di Scala (\u03bb):"}),(0,Et.jsx)("input",{type:"text",value:b.lambda||"",onChange:e=>B("lambda",e.target.value),className:"form-input",placeholder:"es. 100"}),(0,Et.jsx)("span",{className:"form-help",children:"Unit\xe0: h (ore)"})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"Parametro di Posizione (\u03bc):"}),(0,Et.jsx)("input",{type:"text",value:b.mu||"",onChange:e=>B("mu",e.target.value),className:"form-input",placeholder:"es. 0"}),(0,Et.jsx)("span",{className:"form-help",children:"Unit\xe0: h (ore)"})]})]}),"normal"===g&&(0,Et.jsxs)("div",{className:"distribution-params",children:[(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"Media (\u03bc):"}),(0,Et.jsx)("input",{type:"text",value:b.mu||"",onChange:e=>B("mu",e.target.value),className:"form-input",placeholder:"es. 24"}),(0,Et.jsx)("span",{className:"form-help",children:"Unit\xe0: h (ore)"})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"Deviazione Standard (\u03c3):"}),(0,Et.jsx)("input",{type:"text",value:b.sigma||"",onChange:e=>B("sigma",e.target.value),className:"form-input",placeholder:"es. 4"}),(0,Et.jsx)("span",{className:"form-help",children:"Unit\xe0: h (ore)"})]})]}),"constant"===g&&(0,Et.jsx)("div",{className:"distribution-params",children:(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"Probabilit\xe0 Costante:"}),(0,Et.jsx)("input",{type:"text",value:b.probability||"",onChange:e=>B("probability",e.target.value),className:"form-input",placeholder:"es. 0.8"}),(0,Et.jsx)("span",{className:"form-help",children:"Adimensionale (0-1)"})]})})]})]}),(0,Et.jsxs)("div",{className:"form-section",children:[(0,Et.jsx)("h4",{children:"Altri Parametri"}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"Fattore di Dormancy:"}),(0,Et.jsx)("input",{type:"text",value:c.dormancyFactor,onChange:e=>O("dormancyFactor",e.target.value),className:"form-input",placeholder:"es. 0.5"}),(0,Et.jsx)("span",{className:"form-help",children:"Valore tra 0 e 1"})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"Intervallo di Test:"}),(0,Et.jsx)("input",{type:"text",value:c.testInterval,onChange:e=>O("testInterval",e.target.value),className:"form-input",placeholder:"es. 720"}),(0,Et.jsx)("span",{className:"form-help",children:"Ore tra i test"})]})]})]}),"gate"===t.type&&(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsxs)("div",{className:"form-section",children:[(0,Et.jsxs)("h4",{children:["Configurazione Porta ",t.gateType]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsxs)("label",{className:"checkbox-label",children:[(0,Et.jsx)("input",{type:"checkbox",checked:k,onChange:e=>N(e.target.checked),className:"form-checkbox"}),(0,Et.jsx)("span",{className:"checkbox-text",children:"Failure Gate"})]}),(0,Et.jsx)("span",{className:"form-help",children:"Indica se questa porta rappresenta un guasto (default: false)"})]})]}),(0,Et.jsxs)("div",{className:"form-section",children:[(0,Et.jsx)("h4",{children:"TOP Event"}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsxs)("label",{className:"checkbox-label",children:[(0,Et.jsx)("input",{type:"checkbox",checked:j,onChange:e=>E(e.target.checked),className:"form-checkbox"}),(0,Et.jsx)("span",{className:"checkbox-text",children:"Imposta come TOP Event"})]}),(0,Et.jsx)("span",{className:"form-help",children:"Solo una porta pu\xf2 essere TOP EVENT; se impostata verr\xe0 rimossa l'etichetta da altre porte."})]})]}),(0,Et.jsxs)("div",{className:"form-section",children:[(0,Et.jsx)("h4",{children:"Cambia Tipo Porta"}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"Tipo:"}),(0,Et.jsxs)("select",{value:P||t.gateType,onChange:e=>z(e.target.value),className:"form-select",children:[(0,Et.jsx)("option",{value:"AND",children:"AND"}),(0,Et.jsx)("option",{value:"OR",children:"OR"}),(0,Et.jsx)("option",{value:"PAND",children:"PAND"}),(0,Et.jsx)("option",{value:"SPARE",children:"SPARE"}),(0,Et.jsx)("option",{value:"SEQ",children:"SEQ"}),(0,Et.jsx)("option",{value:"FDEP",children:"FDEP"})]}),(0,Et.jsx)("span",{className:"form-help",children:"Modifica il tipo di porta. Confermando la modale, la vista verr\xe0 aggiornata."})]})]}),"SPARE"!==t.gateType&&"FDEP"!==t.gateType&&(0,Et.jsxs)("div",{className:"form-section",children:[(0,Et.jsx)("h4",{children:"Ordina Input"}),(0,Et.jsx)("p",{className:"section-description",children:"Ordina gli input nell'ordine desiderato (verr\xe0 usato nell'export MATLAB)"}),(0,Et.jsxs)("div",{className:"input-list",children:[(0,Et.jsxs)("h5",{children:["Inputs (",_.length,")"]}),(0,Et.jsxs)("div",{className:"input-items",children:[_.map(e=>(0,Et.jsx)("div",{className:"input-item",children:(0,Et.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,Et.jsx)("button",{type:"button",className:"move-button",onClick:()=>U(e),title:"Sposta su",children:"\u25b2"}),(0,Et.jsx)("button",{type:"button",className:"move-button",onClick:()=>H(e),title:"Sposta gi\xf9",children:"\u25bc"}),(0,Et.jsx)("span",{className:"input-name",children:W(e)})]})},e)),0===_.length&&(0,Et.jsx)("div",{className:"empty-list",children:"Nessun input"})]})]})]}),("SPARE"===t.gateType||"FDEP"===t.gateType)&&(0,Et.jsxs)("div",{className:"form-section",children:[(0,Et.jsxs)("h4",{children:["Gestione Input - ",t.gateType]}),(0,Et.jsxs)("p",{className:"section-description",children:["Per le porte ",t.gateType,", \xe8 possibile distinguere tra input primari e secondari. Trascina gli elementi tra le due liste per configurarli."]}),(0,Et.jsxs)("div",{className:"input-management",children:[(0,Et.jsxs)("div",{className:"input-list",children:[(0,Et.jsxs)("h5",{children:["\ud83d\udd35 Input Primari (",_.length,")"]}),(0,Et.jsxs)("div",{className:"input-items",children:[_.map((e,t)=>(0,Et.jsxs)("div",{className:"input-item primary",children:[(0,Et.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,Et.jsx)("button",{type:"button",className:"move-button",onClick:()=>U(e),title:"Sposta su",children:"\u25b2"}),(0,Et.jsx)("button",{type:"button",className:"move-button",onClick:()=>H(e),title:"Sposta gi\xf9",children:"\u25bc"}),(0,Et.jsx)("span",{className:"input-name",children:W(e)})]}),(0,Et.jsx)("div",{children:(0,Et.jsx)("button",{type:"button",className:"move-button",onClick:()=>(e=>{R(t=>t.filter(t=>t!==e)),I(t=>[...t,e])})(e),title:"Sposta a secondari",children:"\u27a1\ufe0f"})})]},e)),0===_.length&&(0,Et.jsx)("div",{className:"empty-list",children:"Nessun input primario"})]})]}),(0,Et.jsxs)("div",{className:"input-list",children:[(0,Et.jsxs)("h5",{children:["\ud83d\udfe1 Input Secondari (",A.length,")"]}),(0,Et.jsxs)("div",{className:"input-items",children:[A.map(e=>(0,Et.jsxs)("div",{className:"input-item secondary",children:[(0,Et.jsx)("div",{children:(0,Et.jsx)("button",{type:"button",className:"move-button",onClick:()=>(e=>{I(t=>t.filter(t=>t!==e)),R(t=>[...t,e])})(e),title:"Sposta a primari",children:"\u2b05\ufe0f"})}),(0,Et.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,Et.jsx)("span",{className:"input-name",children:W(e)}),(0,Et.jsx)("button",{type:"button",className:"move-button",onClick:()=>(e=>{I(t=>{const n=t.indexOf(e);if(n<=0)return t;const a=[...t];return[a[n-1],a[n]]=[a[n],a[n-1]],a})})(e),title:"Sposta su",children:"\u25b2"}),(0,Et.jsx)("button",{type:"button",className:"move-button",onClick:()=>(e=>{I(t=>{const n=t.indexOf(e);if(-1===n||n>=t.length-1)return t;const a=[...t];return[a[n],a[n+1]]=[a[n+1],a[n]],a})})(e),title:"Sposta gi\xf9",children:"\u25bc"})]})]},e)),0===A.length&&(0,Et.jsx)("div",{className:"empty-list",children:"Nessun input secondario"})]})]})]})]}),(0,Et.jsxs)("div",{className:"form-section",children:["SPARE"===t.gateType&&(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"Tipo di Spare:"}),(0,Et.jsxs)("select",{value:S.spareType,onChange:e=>F("spareType",e.target.value),className:"form-select",children:[(0,Et.jsx)("option",{value:"",children:"Seleziona tipo"}),(0,Et.jsx)("option",{value:"cold",children:"Cold Spare"}),(0,Et.jsx)("option",{value:"warm",children:"Warm Spare"}),(0,Et.jsx)("option",{value:"hot",children:"Hot Spare"})]})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"Tempo di Commutazione:"}),(0,Et.jsx)("input",{type:"number",step:"any",value:S.switchingTime,onChange:e=>F("switchingTime",e.target.value),className:"form-input",placeholder:"es. 0.1"}),(0,Et.jsx)("span",{className:"form-help",children:"Tempo per attivare lo spare (ore)"})]})]}),"FDEP"===t.gateType&&(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"Ritardo di Propagazione:"}),(0,Et.jsx)("input",{type:"number",step:"any",value:S.delay,onChange:e=>F("delay",e.target.value),className:"form-input",placeholder:"es. 0.01"}),(0,Et.jsx)("span",{className:"form-help",children:"Ritardo nella propagazione del guasto"})]})]})]})]}),(0,Et.jsxs)("div",{className:"modal-footer",children:[(0,Et.jsx)("button",{className:"cancel-button",onClick:o,children:"Annulla"}),M&&T&&r&&(0,Et.jsx)("button",{onClick:()=>r(t.id),style:{display:"inline-block",backgroundColor:"#007bff",color:"white",border:"none",padding:"8px 12px",borderRadius:"4px",cursor:"pointer",margin:"0 5px"},title:"Visualizza risultati simulazione (PDF/CDF)",children:"\ud83d\udcca Risultati Simulazione"}),(0,Et.jsx)("button",{className:"save-button",onClick:()=>{const e=u(u({},t),{},{name:l.name,description:l.description,parameters:"basic-event"===t.type?c:S});if("basic-event"===t.type){let t;switch(e.failureRate=c.failureRate?parseFloat(c.failureRate.toString()):void 0,p){case"exponential":default:t={type:"exponential",lambda:parseFloat(h.lambda)||0};break;case"weibull":t={type:"weibull",k:parseFloat(h.k)||1,lambda:parseFloat(h.lambda)||1,mu:parseFloat(h.mu)||0};break;case"normal":t={type:"normal",mu:parseFloat(h.mu)||0,sigma:parseFloat(h.sigma)||1};break;case"constant":t={type:"constant",probability:parseFloat(h.probability)||0}}if(e.failureProbabilityDistribution=t,x){let t;switch(g){case"exponential":default:t={type:"exponential",lambda:parseFloat(b.lambda)||0};break;case"weibull":t={type:"weibull",k:parseFloat(b.k)||1,lambda:parseFloat(b.lambda)||1,mu:parseFloat(b.mu)||0};break;case"normal":t={type:"normal",mu:parseFloat(b.mu)||0,sigma:parseFloat(b.sigma)||1};break;case"constant":t={type:"constant",probability:parseFloat(b.probability)||0}}e.repairProbabilityDistribution=t}else e.repairProbabilityDistribution=void 0}else"gate"===t.type&&(e.isFailureGate=k,e.inputs=_,e.secondaryInputs=A,e.isTopEvent=j,P&&(e.gateType=P));n(e)},children:"Salva"})]})]})})},yu=e=>{let{isOpen:t,onClose:n,elementId:o}=e;const[i,r]=(0,a.useState)(null),[l,s]=(0,a.useState)("summary"),[c,d]=(0,a.useState)({visible:!1,x:0,y:0,content:""});if((0,a.useEffect)(()=>{if(t&&o){const e=nu.getComponentResults(o);r(e)}},[t,o]),!t||!i)return null;const p=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return parseFloat(e.toFixed(t)).toString()},m=()=>{d({visible:!1,x:0,y:0,content:""})},h=e=>{c.visible&&d(t=>u(u({},t),{},{x:e.clientX+10,y:e.clientY-10}))},f=e=>{const t="cdf"===e?i.cdfData:i.pdfData,n="cdf"===e?"Funzione di Distribuzione Cumulativa (CDF)":"Funzione di Densit\xe0 di Probabilit\xe0 (PDF)",a="cdf"===e?"Probabilit\xe0 Cumulativa":"Densit\xe0";if(console.log("\ud83d\udd0d [DEBUG] Rendering ".concat(e.toUpperCase()," chart for ").concat(i.componentName)),console.log("  \ud83d\udcca Data available:",!!t),console.log("  \ud83d\udcc8 Data length:",null===t||void 0===t?void 0:t.length),console.log("  \ud83d\udccb First 3 data points:",null===t||void 0===t?void 0:t.slice(0,3)),!t||0===t.length)return console.log("\u274c [DEBUG] No data available for ".concat(e.toUpperCase()," chart")),(0,Et.jsx)("div",{className:"chart-placeholder",children:(0,Et.jsxs)("div",{className:"chart-error",children:[(0,Et.jsx)("h3",{children:n}),(0,Et.jsx)("p",{children:"\u274c Dati non disponibili per la visualizzazione"}),(0,Et.jsxs)("p",{children:["I dati per il grafico ",e.toUpperCase()," non sono stati generati correttamente."]})]})});const o=Math.max(...t.map(e=>e.time)),r=Math.max(...t.map(t=>"cdf"===e?t.probability:t.density)),l=300,s=20,c=60,u=600-c-30,f=l-s-50,g=t.map((t,n)=>{const a=c+t.time/o*u,i=s+f-("cdf"===e?t.probability:t.density)/r*f;return"".concat(0===n?"M":"L"," ").concat(a," ").concat(i)}).join(" ");return(0,Et.jsxs)("div",{className:"chart-container",children:[(0,Et.jsx)("h3",{children:n}),(0,Et.jsx)("div",{className:"chart-wrapper",children:(0,Et.jsxs)("svg",{width:600,height:l,className:"reliability-chart",children:[(0,Et.jsx)("defs",{children:(0,Et.jsx)("pattern",{id:"grid",width:"40",height:"30",patternUnits:"userSpaceOnUse",children:(0,Et.jsx)("path",{d:"M 40 0 L 0 0 0 30",fill:"none",stroke:"#e0e0e0",strokeWidth:"1"})})}),(0,Et.jsx)("rect",{width:u,height:f,x:c,y:s,fill:"url(#grid)"}),(0,Et.jsx)("line",{x1:c,y1:s+f,x2:c+u,y2:s+f,stroke:"#333",strokeWidth:"2"}),(0,Et.jsx)("line",{x1:c,y1:s,x2:c,y2:s+f,stroke:"#333",strokeWidth:"2"}),(0,Et.jsx)("path",{d:g,fill:"none",stroke:"cdf"===e?"#007bff":"#e74c3c",strokeWidth:"1.5"}),t.map((t,n)=>{const a=c+t.time/o*u,i=s+f-("cdf"===e?t.probability:t.density)/r*f,l="cdf"===e?t.probability:t.density,g="cdf"===e?"Probabilit\xe0":"Densit\xe0";return(0,Et.jsx)("circle",{cx:a,cy:i,r:1.5,fill:"cdf"===e?"#007bff":"#e74c3c",style:{cursor:"pointer",filter:"drop-shadow(0 1px 2px rgba(0,0,0,0.2))"},onMouseEnter:n=>{return a=n,o="Tempo: ".concat(p(t.time,1)," ore\n").concat(g,": ").concat(p(l,"cdf"===e?4:6)),void d({visible:!0,x:a.clientX+10,y:a.clientY-10,content:o});var a,o},onMouseLeave:m,onMouseMove:h},n)}),(0,Et.jsx)("text",{x:c+u/2,y:290,textAnchor:"middle",className:"axis-label",children:"Tempo (ore)"}),(0,Et.jsx)("text",{x:15,y:s+f/2,textAnchor:"middle",transform:"rotate(-90, 15, ".concat(s+f/2,")"),className:"axis-label",children:a}),[0,.25,.5,.75,1].map(e=>(0,Et.jsx)("text",{x:c+e*u,y:275,textAnchor:"middle",className:"axis-tick",children:p(e*o,0)},e)),[0,.25,.5,.75,1].map(t=>(0,Et.jsx)("text",{x:c-10,y:s+f-t*f+5,textAnchor:"end",className:"axis-tick",children:p(t*r,"cdf"===e?2:4)},t))]})}),(0,Et.jsxs)("div",{className:"chart-description",children:[(0,Et.jsxs)("p",{children:[(0,Et.jsxs)("strong",{children:["cdf"===e?"CDF":"PDF",":"]})," ","cdf"===e?"Mostra la probabilit\xe0 che il componente si guasti entro un tempo t.":"Mostra la densit\xe0 di probabilit\xe0 di guasto in funzione del tempo."]}),(0,Et.jsxs)("p",{className:"chart-stats",children:["\ud83d\udcca ",(0,Et.jsx)("strong",{children:"Punti dati:"})," ",t.length," |",(0,Et.jsx)("strong",{children:" Max X:"})," ",p(o)," ore |",(0,Et.jsx)("strong",{children:" Max Y:"})," ",p(r,"cdf"===e?3:6)]})]})]})};return(0,Et.jsx)("div",{className:"modal-overlay",onClick:n,children:(0,Et.jsxs)("div",{className:"component-results-modal",onClick:e=>e.stopPropagation(),children:[(0,Et.jsxs)("div",{className:"modal-header",children:[(0,Et.jsxs)("h2",{children:["\ud83d\udcc8 Risultati Simulazione - ",i.componentName]}),(0,Et.jsx)("button",{className:"close-button",onClick:n,children:"\xd7"})]}),(0,Et.jsxs)("div",{className:"modal-tabs",children:[(0,Et.jsx)("button",{className:"tab-button ".concat("summary"===l?"active":""),onClick:()=>s("summary"),children:"\ud83d\udcca Sommario"}),(0,Et.jsx)("button",{className:"tab-button ".concat("cdf"===l?"active":""),onClick:()=>s("cdf"),children:"\ud83d\udcc8 CDF"}),(0,Et.jsx)("button",{className:"tab-button ".concat("pdf"===l?"active":""),onClick:()=>s("pdf"),children:"\ud83d\udcca PDF"})]}),(0,Et.jsxs)("div",{className:"modal-content",children:["summary"===l&&(0,Et.jsxs)("div",{className:"results-summary",children:[(0,Et.jsx)("h3",{children:"\ud83d\udcca Sommario Risultati"}),(0,Et.jsxs)("div",{className:"results-grid",children:[(0,Et.jsxs)("div",{className:"result-card",children:[(0,Et.jsx)("div",{className:"result-label",children:"Componente"}),(0,Et.jsx)("div",{className:"result-value",children:i.componentName})]}),(0,Et.jsxs)("div",{className:"result-card",children:[(0,Et.jsx)("div",{className:"result-label",children:"Tipo"}),(0,Et.jsx)("div",{className:"result-value",children:"event"===i.componentType?"\u2b1c Evento Base":"\ud83d\udd17 Porta"})]}),(0,Et.jsxs)("div",{className:"result-card reliability-card",children:[(0,Et.jsx)("div",{className:"result-label",children:"Affidabilit\xe0"}),(0,Et.jsxs)("div",{className:"result-value reliability-value",children:[(100*i.reliability).toFixed(2),"%"]})]}),(0,Et.jsxs)("div",{className:"result-card unreliability-card",children:[(0,Et.jsx)("div",{className:"result-label",children:"Inaffidabilit\xe0"}),(0,Et.jsxs)("div",{className:"result-value unreliability-value",children:[(100*i.unreliability).toFixed(2),"%"]})]}),(0,Et.jsxs)("div",{className:"result-card",children:[(0,Et.jsx)("div",{className:"result-label",children:"Iterazioni Guastate"}),(0,Et.jsx)("div",{className:"result-value",children:i.nFailures})]}),(0,Et.jsxs)("div",{className:"result-card",children:[(0,Et.jsx)("div",{className:"result-label",children:"Iterazioni Totali"}),(0,Et.jsx)("div",{className:"result-value",children:i.totalIterations})]})]}),(0,Et.jsxs)("div",{className:"detailed-info",children:[(0,Et.jsx)("h4",{children:"\ud83d\udccb Informazioni Dettagliate"}),(0,Et.jsxs)("div",{className:"info-grid",children:[(0,Et.jsxs)("div",{className:"info-item",children:[(0,Et.jsx)("strong",{children:"Affidabilit\xe0 R(t):"})," La probabilit\xe0 che il componente funzioni correttamente per tutto il tempo di missione."]}),(0,Et.jsxs)("div",{className:"info-item",children:[(0,Et.jsx)("strong",{children:"Calcolo:"})," R = (Iterazioni senza guasto) / (Iterazioni totali) = ",i.totalIterations-i.nFailures,"/",i.totalIterations]}),(0,Et.jsxs)("div",{className:"info-item",children:[(0,Et.jsx)("strong",{children:"Tempo di Guasto:"})," Per ogni iterazione viene registrato il tempo di primo guasto (\u221e se mai guastato)."]})]})]})]}),"cdf"===l&&f("cdf"),"pdf"===l&&f("pdf")]}),(0,Et.jsx)("div",{className:"modal-footer",children:(0,Et.jsx)("button",{className:"close-modal-button",onClick:n,children:"Chiudi"})}),c.visible&&(0,Et.jsx)("div",{style:{position:"fixed",left:c.x,top:c.y,backgroundColor:"rgba(0, 0, 0, 0.8)",color:"white",padding:"8px 12px",borderRadius:"4px",fontSize:"12px",pointerEvents:"none",zIndex:1e4,whiteSpace:"pre-line",maxWidth:"300px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},children:c.content})]})})},xu=e=>{let{isOpen:t,onClose:n}=e;const[o,i]=(0,a.useState)(null),[r,l]=(0,a.useState)("evolution"),[s,c]=(0,a.useState)({visible:!1,x:0,y:0,content:""});(0,a.useEffect)(()=>{if(t){const e=nu.getCurrentResults();let t=(null===e||void 0===e?void 0:e.ciHistory)||null;t||(console.log("\ud83e\uddea [CIResultsModal] No real CI data, using mock data for testing"),t=d()),i(t)}},[t]);const d=()=>{const e=[];for(let t=1;t<=100;t++){const n=100*t,a=1e-4*(Math.random()-.5),o=Math.exp(-t/30),i=.001234+a*o,r=1e-4*o+1e-5,l=2*1.96*r,s=2e-4*Math.exp(-t/50)+5e-5;e.push({iteration:n,p_failure:i+2*a,mean_estimate:i,CI_lower:i-l/2,CI_upper:i+l/2,CI_width:l,accepted_error:s,std_error:r})}return e};if(!t)return null;if(!o||0===o.length)return(0,Et.jsx)("div",{className:"modal-overlay",onClick:n,children:(0,Et.jsxs)("div",{className:"modal-content ci-results-modal",onClick:e=>e.stopPropagation(),children:[(0,Et.jsxs)("div",{className:"modal-header",children:[(0,Et.jsx)("h2",{children:"\ud83d\udcc8 Simulation Confidence Interval Analysis"}),(0,Et.jsx)("button",{className:"modal-close",onClick:n,children:"\xd7"})]}),(0,Et.jsx)("div",{className:"modal-body",children:(0,Et.jsxs)("div",{className:"ci-no-data",children:[(0,Et.jsx)("h3",{children:"\u26a0\ufe0f Nessun dato CI disponibile"}),(0,Et.jsx)("p",{children:"I dati di Confidence Interval non sono disponibili per questa simulazione."}),(0,Et.jsx)("p",{children:"Possibili cause:"}),(0,Et.jsxs)("ul",{children:[(0,Et.jsx)("li",{children:"La simulazione non \xe8 stata eseguita con CI abilitati"}),(0,Et.jsx)("li",{children:"La simulazione non \xe8 ancora completata"}),(0,Et.jsx)("li",{children:"I dati CI non sono stati salvati nel file results.mat"})]})]})})]})});const p=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;return parseFloat(e.toFixed(t)).toString()},m=(e,t)=>{e.currentTarget.getBoundingClientRect();c({visible:!0,x:e.clientX+10,y:e.clientY-10,content:t})},h=()=>{c({visible:!1,x:0,y:0,content:""})},f=e=>{s.visible&&c(t=>u(u({},t),{},{x:e.clientX+10,y:e.clientY-10}))};return(0,Et.jsx)("div",{className:"modal-overlay",onClick:n,children:(0,Et.jsxs)("div",{className:"modal-content ci-results-modal",onClick:e=>e.stopPropagation(),children:[(0,Et.jsxs)("div",{className:"modal-header",children:[(0,Et.jsx)("h2",{children:"\ud83d\udcc8 Simulation Confidence Interval Analysis"}),(0,Et.jsx)("button",{className:"modal-close",onClick:n,children:"\xd7"})]}),(0,Et.jsxs)("div",{className:"modal-body",children:[(0,Et.jsxs)("div",{className:"tabs",children:[(0,Et.jsx)("button",{className:"tab ".concat("evolution"===r?"active":""),onClick:()=>l("evolution"),children:"\ud83d\udcca Evoluzione CI"}),(0,Et.jsx)("button",{className:"tab ".concat("convergence"===r?"active":""),onClick:()=>l("convergence"),children:"\ud83d\udcc8 Analisi Convergenza"})]}),(0,Et.jsxs)("div",{className:"tab-content",children:["evolution"===r&&(()=>{const e=500,t=300,n=20,a=60,i=e-a-20,r=t-n-40,l=o.map(e=>e.iteration),s=o.map(e=>e.p_failure),c=o.map(e=>e.mean_estimate),u=o.map(e=>e.CI_lower),d=o.map(e=>e.CI_upper),g=o.map(e=>e.CI_width),v=o.map(e=>e.accepted_error),b=o.map(e=>e.std_error),y=Math.min(...l),x=Math.max(...l),C=Math.min(...s,...u),S=Math.max(...s,...d),w=Math.max(...g,...v),k=Math.max(...b),N=x-y||1,j=S-C||1e-10,E=w||1e-10,M=k||1e-10,T=e=>{const t=(e-y)/N*i;return isFinite(t)?t:0},P=e=>{const t=r-(e-C)/j*r;return isFinite(t)?t:r/2},z=e=>{const t=Math.log10(Math.max(1e-10,Math.min(...g,...v))),n=Math.log10(E),a=Math.log10(Math.max(1e-10,e)),o=r-(a-t)/(n-t||1)*r;return isFinite(o)?o:r/2},_=e=>{const t=r-e/M*r;return isFinite(t)?t:r/2},R=(0,Et.jsxs)("div",{className:"ci-chart",children:[(0,Et.jsx)("h4",{children:"Evoluzione Probabilit\xe0 di Failure"}),(0,Et.jsx)("svg",{width:e,height:t,children:(0,Et.jsxs)("g",{transform:"translate(".concat(a,", ").concat(n,")"),children:[[0,.25,.5,.75,1].map(e=>(0,Et.jsx)("line",{x1:0,y1:e*r,x2:i,y2:e*r,stroke:"#e0e0e0",strokeWidth:.5},e)),(0,Et.jsx)("path",{d:"M ".concat(T(l[0])," ").concat(P(u[0])," ").concat(l.map((e,t)=>"L ".concat(T(e)," ").concat(P(u[t]))).join(" ")," ").concat(l.slice().reverse().map((e,t)=>"L ".concat(T(e)," ").concat(P(d[d.length-1-t]))).join(" ")," Z"),fill:"rgba(255, 0, 0, 0.2)",stroke:"none"}),(0,Et.jsx)("path",{d:"M ".concat(T(l[0])," ").concat(P(c[0])," ").concat(l.slice(1).map((e,t)=>"L ".concat(T(e)," ").concat(P(c[t+1]))).join(" ")),stroke:"red",strokeWidth:2,fill:"none"}),l.map((e,t)=>(0,Et.jsx)("circle",{cx:T(e),cy:P(s[t]),r:3,fill:"blue",stroke:"white",strokeWidth:1,style:{cursor:"pointer"},onMouseEnter:n=>m(n,"Iterazione: ".concat(e,"\nProbabilit\xe0: ").concat(p(s[t]),"\nCI: [").concat(p(u[t]),", ").concat(p(d[t]),"]")),onMouseLeave:h,onMouseMove:f},t)),(0,Et.jsx)("line",{x1:0,y1:r,x2:i,y2:r,stroke:"black",strokeWidth:1}),(0,Et.jsx)("line",{x1:0,y1:0,x2:0,y2:r,stroke:"black",strokeWidth:1}),[0,.25,.5,.75,1].map(e=>{const t=e*i,n=Math.round(y+e*(x-y));return(0,Et.jsxs)("g",{children:[(0,Et.jsx)("line",{x1:t,y1:r,x2:t,y2:r+5,stroke:"black",strokeWidth:1}),(0,Et.jsx)("text",{x:t,y:r+18,textAnchor:"middle",fontSize:"10",fill:"black",children:n})]},"x-tick-".concat(e))}),[0,.25,.5,.75,1].map(e=>{const t=e*r,n=C+(1-e)*j;return(0,Et.jsxs)("g",{children:[(0,Et.jsx)("line",{x1:-5,y1:t,x2:0,y2:t,stroke:"black",strokeWidth:1}),(0,Et.jsx)("text",{x:-8,y:t+3,textAnchor:"end",fontSize:"10",fill:"black",children:p(n,4)})]},"y-tick-".concat(e))}),(0,Et.jsx)("text",{x:i/2,y:r+35,textAnchor:"middle",fontSize:"12",children:"Iterazione"}),(0,Et.jsx)("text",{x:-45,y:r/2,textAnchor:"middle",fontSize:"12",transform:"rotate(-90, -45, ".concat(r/2,")"),children:"Probabilit\xe0"})]})})]}),A=(0,Et.jsxs)("div",{className:"ci-chart",children:[(0,Et.jsx)("h4",{children:"Larghezza CI vs Errore Accettabile"}),(0,Et.jsx)("svg",{width:e,height:t,children:(0,Et.jsxs)("g",{transform:"translate(".concat(a,", ").concat(n,")"),children:[[0,.25,.5,.75,1].map(e=>(0,Et.jsx)("line",{x1:0,y1:e*r,x2:i,y2:e*r,stroke:"#e0e0e0",strokeWidth:.5},e)),(0,Et.jsx)("path",{d:"M ".concat(T(l[0])," ").concat(z(g[0])," ").concat(l.slice(1).map((e,t)=>"L ".concat(T(e)," ").concat(z(g[t+1]))).join(" ")),stroke:"green",strokeWidth:2,fill:"none"}),l.map((e,t)=>(0,Et.jsx)("circle",{cx:T(e),cy:z(g[t]),r:2,fill:"green",stroke:"white",strokeWidth:1,style:{cursor:"pointer"},onMouseEnter:n=>m(n,"Iterazione: ".concat(e,"\nLarghezza CI: ").concat(p(g[t],6),"\nErrore Accettabile: ").concat(p(v[t],6))),onMouseLeave:h,onMouseMove:f},"ci-width-".concat(t))),(0,Et.jsx)("path",{d:"M ".concat(T(l[0])," ").concat(z(v[0])," ").concat(l.slice(1).map((e,t)=>"L ".concat(T(e)," ").concat(z(v[t+1]))).join(" ")),stroke:"red",strokeWidth:2,strokeDasharray:"5,5",fill:"none"}),l.map((e,t)=>(0,Et.jsx)("circle",{cx:T(e),cy:z(v[t]),r:2,fill:"red",stroke:"white",strokeWidth:1,style:{cursor:"pointer"},onMouseEnter:n=>m(n,"Iterazione: ".concat(e,"\nErrore Accettabile: ").concat(p(v[t],6))),onMouseLeave:h,onMouseMove:f},"accepted-error-".concat(t))),(0,Et.jsx)("line",{x1:0,y1:r,x2:i,y2:r,stroke:"black",strokeWidth:1}),(0,Et.jsx)("line",{x1:0,y1:0,x2:0,y2:r,stroke:"black",strokeWidth:1}),[0,.25,.5,.75,1].map(e=>{const t=e*i,n=Math.round(y+e*(x-y));return(0,Et.jsxs)("g",{children:[(0,Et.jsx)("line",{x1:t,y1:r,x2:t,y2:r+5,stroke:"black",strokeWidth:1}),(0,Et.jsx)("text",{x:t,y:r+18,textAnchor:"middle",fontSize:"10",fill:"black",children:n})]},"x-tick-width-".concat(e))}),[0,.25,.5,.75,1].map(e=>{const t=e*r,n=Math.log10(Math.max(1e-10,Math.min(...g,...v))),a=n+(1-e)*(Math.log10(E)-n),o=Math.pow(10,a);return(0,Et.jsxs)("g",{children:[(0,Et.jsx)("line",{x1:-5,y1:t,x2:0,y2:t,stroke:"black",strokeWidth:1}),(0,Et.jsx)("text",{x:-8,y:t+3,textAnchor:"end",fontSize:"10",fill:"black",children:p(o,6)})]},"y-tick-width-".concat(e))}),(0,Et.jsx)("text",{x:i/2,y:r+35,textAnchor:"middle",fontSize:"12",children:"Iterazione"}),(0,Et.jsx)("text",{x:-45,y:r/2,textAnchor:"middle",fontSize:"12",transform:"rotate(-90, -45, ".concat(r/2,")"),children:"Larghezza (log)"})]})})]}),I=(0,Et.jsxs)("div",{className:"ci-chart",children:[(0,Et.jsx)("h4",{children:"Evoluzione Errore Standard"}),(0,Et.jsx)("svg",{width:e,height:t,children:(0,Et.jsxs)("g",{transform:"translate(".concat(a,", ").concat(n,")"),children:[[0,.25,.5,.75,1].map(e=>(0,Et.jsx)("line",{x1:0,y1:e*r,x2:i,y2:e*r,stroke:"#e0e0e0",strokeWidth:.5},e)),(0,Et.jsx)("path",{d:"M ".concat(T(l[0])," ").concat(_(b[0])," ").concat(l.slice(1).map((e,t)=>"L ".concat(T(e)," ").concat(_(b[t+1]))).join(" ")),stroke:"black",strokeWidth:1.5,fill:"none"}),l.map((e,t)=>(0,Et.jsx)("circle",{cx:T(e),cy:_(b[t]),r:2,fill:"black",stroke:"white",strokeWidth:1,style:{cursor:"pointer"},onMouseEnter:n=>m(n,"Iterazione: ".concat(e,"\nErrore Standard: ").concat(p(b[t],6))),onMouseLeave:h,onMouseMove:f},"std-error-".concat(t))),(0,Et.jsx)("line",{x1:0,y1:r,x2:i,y2:r,stroke:"black",strokeWidth:1}),(0,Et.jsx)("line",{x1:0,y1:0,x2:0,y2:r,stroke:"black",strokeWidth:1}),[0,.25,.5,.75,1].map(e=>{const t=e*i,n=Math.round(y+e*(x-y));return(0,Et.jsxs)("g",{children:[(0,Et.jsx)("line",{x1:t,y1:r,x2:t,y2:r+5,stroke:"black",strokeWidth:1}),(0,Et.jsx)("text",{x:t,y:r+18,textAnchor:"middle",fontSize:"10",fill:"black",children:n})]},"x-tick-std-".concat(e))}),[0,.25,.5,.75,1].map(e=>{const t=e*r,n=(1-e)*M;return(0,Et.jsxs)("g",{children:[(0,Et.jsx)("line",{x1:-5,y1:t,x2:0,y2:t,stroke:"black",strokeWidth:1}),(0,Et.jsx)("text",{x:-8,y:t+3,textAnchor:"end",fontSize:"10",fill:"black",children:p(n,6)})]},"y-tick-std-".concat(e))}),(0,Et.jsx)("text",{x:i/2,y:r+35,textAnchor:"middle",fontSize:"12",children:"Iterazione"}),(0,Et.jsx)("text",{x:-55,y:r/2,textAnchor:"middle",fontSize:"12",transform:"rotate(-90, -55, ".concat(r/2,")"),children:"Errore Standard"})]})})]}),D=g.map((e,t)=>{const n=0!==v[t]?e/v[t]:0;return isFinite(n)?n:0}),O=D.filter(e=>isFinite(e)&&e>0),F=(O.length>0?Math.max(...O.slice(0,10)):1)||1,L=e=>{const t=r-Math.min(e/(1.1*F),1)*r;return isFinite(t)?t:r/2},B=(0,Et.jsxs)("div",{className:"ci-chart",children:[(0,Et.jsx)("h4",{children:"Rapporto Larghezza CI / Errore Accettabile"}),(0,Et.jsx)("svg",{width:e,height:t,children:(0,Et.jsxs)("g",{transform:"translate(".concat(a,", ").concat(n,")"),children:[[0,.25,.5,.75,1].map(e=>(0,Et.jsx)("line",{x1:0,y1:e*r,x2:i,y2:e*r,stroke:"#e0e0e0",strokeWidth:.5},e)),(0,Et.jsx)("line",{x1:0,y1:L(1),x2:i,y2:L(1),stroke:"red",strokeWidth:1,strokeDasharray:"3,3"}),(0,Et.jsx)("path",{d:"M ".concat(T(l[0])," ").concat(L(D[0])," ").concat(l.slice(1).map((e,t)=>"L ".concat(T(e)," ").concat(L(D[t+1]))).join(" ")),stroke:"magenta",strokeWidth:2,fill:"none"}),l.map((e,t)=>(0,Et.jsx)("circle",{cx:T(e),cy:L(D[t]),r:2,fill:"magenta",stroke:"white",strokeWidth:1,style:{cursor:"pointer"},onMouseEnter:n=>m(n,"Iterazione: ".concat(e,"\nRapporto CI/Errore: ").concat(p(D[t],3),"\n").concat(D[t]<=1?"CONVERGED \u2713":"NON CONVERGED \u2717")),onMouseLeave:h,onMouseMove:f},"ratio-".concat(t))),(0,Et.jsx)("line",{x1:0,y1:r,x2:i,y2:r,stroke:"black",strokeWidth:1}),(0,Et.jsx)("line",{x1:0,y1:0,x2:0,y2:r,stroke:"black",strokeWidth:1}),[0,.25,.5,.75,1].map(e=>{const t=e*i,n=Math.round(y+e*(x-y));return(0,Et.jsxs)("g",{children:[(0,Et.jsx)("line",{x1:t,y1:r,x2:t,y2:r+5,stroke:"black",strokeWidth:1}),(0,Et.jsx)("text",{x:t,y:r+18,textAnchor:"middle",fontSize:"10",fill:"black",children:n})]},"x-tick-ratio-".concat(e))}),[0,.25,.5,.75,1].map(e=>{const t=e*r,n=(1-e)*F*1.1;return(0,Et.jsxs)("g",{children:[(0,Et.jsx)("line",{x1:-5,y1:t,x2:0,y2:t,stroke:"black",strokeWidth:1}),(0,Et.jsx)("text",{x:-8,y:t+3,textAnchor:"end",fontSize:"10",fill:"black",children:p(n,2)})]},"y-tick-ratio-".concat(e))}),(0,Et.jsx)("text",{x:i/2,y:r+35,textAnchor:"middle",fontSize:"12",children:"Iterazione"}),(0,Et.jsx)("text",{x:-35,y:r/2,textAnchor:"middle",fontSize:"12",transform:"rotate(-90, -35, ".concat(r/2,")"),children:"Rapporto"})]})})]});return(0,Et.jsxs)("div",{className:"ci-charts-grid",children:[R,A,I,B]})})(),"convergence"===r&&(()=>{const e=20,t=60,n=500-t-20,a=300-e-40,i=o.map(e=>e.iteration),r=o.map(e=>e.mean_estimate),l=[];for(let o=1;o<r.length;o++){const e=r[o-1];if(0!==e){const t=100*Math.abs((r[o]-e)/e);l.push(isFinite(t)?t:0)}else l.push(0)}const s=Math.min(...i),c=Math.max(...i),u=Math.min(...r),d=Math.max(...r),g=Math.max(...l),v=c-s||1,b=d-u||1e-10,y=g||1,x=e=>{const t=(e-s)/v*n;return isFinite(t)?t:0},C=e=>{const t=a-(e-u)/b*a;return isFinite(t)?t:a/2},S=e=>{const t=Math.log10(e+1)/Math.log10(y+1),n=a-Math.min(t,1)*a;return isFinite(n)?n:a/2};return(0,Et.jsxs)("div",{className:"ci-convergence-charts",children:[(0,Et.jsxs)("div",{className:"ci-chart",children:[(0,Et.jsx)("h4",{children:"Convergenza della Stima Media"}),(0,Et.jsx)("svg",{width:500,height:300,children:(0,Et.jsxs)("g",{transform:"translate(".concat(t,", ").concat(e,")"),children:[[0,.25,.5,.75,1].map(e=>(0,Et.jsx)("line",{x1:0,y1:e*a,x2:n,y2:e*a,stroke:"#e0e0e0",strokeWidth:.5},e)),(0,Et.jsx)("path",{d:"M ".concat(x(i[0])," ").concat(C(r[0])," ").concat(i.slice(1).map((e,t)=>"L ".concat(x(e)," ").concat(C(r[t+1]))).join(" ")),stroke:"blue",strokeWidth:2,fill:"none"}),i.map((e,t)=>(0,Et.jsx)("circle",{cx:x(e),cy:C(r[t]),r:2,fill:"blue",stroke:"white",strokeWidth:1,style:{cursor:"pointer"},onMouseEnter:n=>m(n,"Iterazione: ".concat(e,"\nStima Media: ").concat(p(r[t],6))),onMouseLeave:h,onMouseMove:f},"conv-mean-".concat(t))),(0,Et.jsx)("line",{x1:0,y1:a,x2:n,y2:a,stroke:"black",strokeWidth:1}),(0,Et.jsx)("line",{x1:0,y1:0,x2:0,y2:a,stroke:"black",strokeWidth:1}),[0,.25,.5,.75,1].map(e=>{const t=e*n,o=Math.round(s+e*(c-s));return(0,Et.jsxs)("g",{children:[(0,Et.jsx)("line",{x1:t,y1:a,x2:t,y2:a+5,stroke:"black",strokeWidth:1}),(0,Et.jsx)("text",{x:t,y:a+18,textAnchor:"middle",fontSize:"10",fill:"black",children:o})]},"x-tick-conv-mean-".concat(e))}),[0,.25,.5,.75,1].map(e=>{const t=e*a,n=u+(1-e)*b;return(0,Et.jsxs)("g",{children:[(0,Et.jsx)("line",{x1:-5,y1:t,x2:0,y2:t,stroke:"black",strokeWidth:1}),(0,Et.jsx)("text",{x:-8,y:t+3,textAnchor:"end",fontSize:"10",fill:"black",children:p(n,6)})]},"y-tick-conv-mean-".concat(e))}),(0,Et.jsx)("text",{x:n/2,y:a+35,textAnchor:"middle",fontSize:"12",children:"Iterazione"}),(0,Et.jsx)("text",{x:-50,y:a/2,textAnchor:"middle",fontSize:"12",transform:"rotate(-90, -50, ".concat(a/2,")"),children:"Stima Media"})]})})]}),l.length>0&&(0,Et.jsxs)("div",{className:"ci-chart",children:[(0,Et.jsx)("h4",{children:"Variazione Percentuale della Stima Media"}),(0,Et.jsx)("svg",{width:500,height:300,children:(0,Et.jsxs)("g",{transform:"translate(".concat(t,", ").concat(e,")"),children:[[0,.25,.5,.75,1].map(e=>(0,Et.jsx)("line",{x1:0,y1:e*a,x2:n,y2:e*a,stroke:"#e0e0e0",strokeWidth:.5},e)),(0,Et.jsx)("path",{d:"M ".concat(x(i[1])," ").concat(S(l[0])," ").concat(i.slice(2).map((e,t)=>"L ".concat(x(e)," ").concat(S(l[t+1]))).join(" ")),stroke:"red",strokeWidth:1.5,fill:"none"}),l.map((e,t)=>(0,Et.jsx)("circle",{cx:x(i[t+1]),cy:S(e),r:2,fill:"red",stroke:"white",strokeWidth:1,style:{cursor:"pointer"},onMouseEnter:n=>m(n,"Iterazione: ".concat(i[t+1],"\nVariazione %: ").concat(p(e,2),"%")),onMouseLeave:h,onMouseMove:f},"pct-change-".concat(t))),(0,Et.jsx)("line",{x1:0,y1:a,x2:n,y2:a,stroke:"black",strokeWidth:1}),(0,Et.jsx)("line",{x1:0,y1:0,x2:0,y2:a,stroke:"black",strokeWidth:1}),[0,.25,.5,.75,1].map(e=>{const t=e*n,o=Math.round(s+e*(c-s));return(0,Et.jsxs)("g",{children:[(0,Et.jsx)("line",{x1:t,y1:a,x2:t,y2:a+5,stroke:"black",strokeWidth:1}),(0,Et.jsx)("text",{x:t,y:a+18,textAnchor:"middle",fontSize:"10",fill:"black",children:o})]},"x-tick-pct-".concat(e))}),[0,.25,.5,.75,1].map(e=>{const t=e*a,n=1-e,o=Math.pow(y+1,n)-1;return(0,Et.jsxs)("g",{children:[(0,Et.jsx)("line",{x1:-5,y1:t,x2:0,y2:t,stroke:"black",strokeWidth:1}),(0,Et.jsxs)("text",{x:-8,y:t+3,textAnchor:"end",fontSize:"10",fill:"black",children:[p(o,2),"%"]})]},"y-tick-pct-".concat(e))}),(0,Et.jsx)("text",{x:n/2,y:a+35,textAnchor:"middle",fontSize:"12",children:"Iterazione"}),(0,Et.jsx)("text",{x:-55,y:a/2,textAnchor:"middle",fontSize:"12",transform:"rotate(-90, -55, ".concat(a/2,")"),children:"Variazione % (log)"})]})})]})]})})()]}),(()=>{const e=o[o.length-1],t=e.accepted_error>0&&e.CI_width<=e.accepted_error,n=e.mean_estimate>1e-6?e.CI_width/e.mean_estimate:e.CI_width/1e-5,a=e.mean_estimate>1e-6?n<=.25:e.CI_width<=1e-5,i=e.iteration*e.mean_estimate*(1-e.mean_estimate),r=i>=10;let l=!1;if(o.length>=10){const e=o.slice(-10).map(e=>e.mean_estimate),t=e.reduce((e,t)=>e+t,0)/e.length;if(t>0){const n=e.reduce((e,n)=>e+Math.pow(n-t,2),0)/(e.length-1);l=Math.sqrt(n)/t<.1}}const s=e.iteration>=5e4,c=t;return(0,Et.jsxs)("div",{className:"ci-statistics",children:[(0,Et.jsx)("h3",{children:"\ud83d\udcca Statistiche Riassuntive"}),(0,Et.jsxs)("div",{className:"stats-grid",children:[(0,Et.jsxs)("div",{className:"stat-card",children:[(0,Et.jsx)("div",{className:"stat-label",children:"Iterazioni Analizzate"}),(0,Et.jsx)("div",{className:"stat-value",children:o.length})]}),(0,Et.jsxs)("div",{className:"stat-card",children:[(0,Et.jsx)("div",{className:"stat-label",children:"Iterazione Finale"}),(0,Et.jsx)("div",{className:"stat-value",children:e.iteration})]}),(0,Et.jsxs)("div",{className:"stat-card",children:[(0,Et.jsx)("div",{className:"stat-label",children:"Stima Finale Probabilit\xe0"}),(0,Et.jsx)("div",{className:"stat-value",children:p(e.mean_estimate)})]}),(0,Et.jsxs)("div",{className:"stat-card",children:[(0,Et.jsx)("div",{className:"stat-label",children:"Intervallo Confidenza Finale"}),(0,Et.jsxs)("div",{className:"stat-value",children:["[",p(e.CI_lower),", ",p(e.CI_upper),"]"]})]}),(0,Et.jsxs)("div",{className:"stat-card",children:[(0,Et.jsx)("div",{className:"stat-label",children:"Larghezza CI Finale"}),(0,Et.jsx)("div",{className:"stat-value",children:p(e.CI_width)})]}),(0,Et.jsxs)("div",{className:"stat-card",children:[(0,Et.jsx)("div",{className:"stat-label",children:"Errore Accettabile Finale"}),(0,Et.jsx)("div",{className:"stat-value",children:p(e.accepted_error)})]}),(0,Et.jsxs)("div",{className:"stat-card",children:[(0,Et.jsx)("div",{className:"stat-label",children:"Rapporto Finale (CI/Errore)"}),(0,Et.jsx)("div",{className:"stat-value",children:0!==e.accepted_error?p(e.CI_width/e.accepted_error,3):"N/A"})]}),(0,Et.jsxs)("div",{className:"stat-card convergence-status ".concat(s?"max-iterations":c?"converged":"not-converged"),children:[(0,Et.jsx)("div",{className:"stat-label",children:"Criterio di Stop"}),(0,Et.jsx)("div",{className:"stat-value",title:s?"Raggiunto limite massimo iterazioni":c?"Convergenza raggiunta tramite criteri CI":"Convergenza non ancora raggiunta",children:s?"\ud83d\udd04 Iterazioni Completate":c?"\u2713 Convergenza Raggiunta":"\u23f3 IN CORSO"})]}),(0,Et.jsxs)("div",{className:"stat-card criterion-badge ".concat(t?"met":"not-met"),children:[(0,Et.jsx)("div",{className:"stat-label",children:"1\ufe0f\u20e3 Precisione CI"}),(0,Et.jsx)("div",{className:"stat-value",title:"Larghezza CI (".concat(p(e.CI_width,6),") ").concat(t?"\u2264":">"," Errore Accettabile (").concat(p(e.accepted_error,6),")\n\nQuesto criterio verifica se l'intervallo di confidenza \xe8 sufficientemente stretto rispetto alla tolleranza di errore impostata."),children:t?"\u2713 SODDISFATTO":"\u2717 NON soddisfatto"})]}),(0,Et.jsxs)("div",{className:"stat-card criterion-badge ".concat(a?"met":"not-met"),children:[(0,Et.jsx)("div",{className:"stat-label",children:"2\ufe0f\u20e3 Precisione Relativa"}),(0,Et.jsx)("div",{className:"stat-value",title:"Precisione relativa: ".concat(p(100*n,1),"% ").concat(a?"\u2264":">"," 25%\n\nQuesto criterio verifica che l'errore relativo sia inferiore al 25% della stima media, garantendo una precisione ragionevole."),children:a?"\u2713 SODDISFATTO":"\u2717 NON soddisfatto"})]}),(0,Et.jsxs)("div",{className:"stat-card criterion-badge ".concat(r?"met":"not-met"),children:[(0,Et.jsx)("div",{className:"stat-label",children:"3\ufe0f\u20e3 Robustezza Statistica"}),(0,Et.jsx)("div",{className:"stat-value",title:"Effective Sample Size: ".concat(p(i,1)," ").concat(r?"\u2265":"<",' 10\n\nQuesto criterio verifica che ci siano abbastanza "successi ponderati" (n\xd7p\xd7(1-p)) per garantire stime statisticamente robuste.'),children:r?"\u2713 SODDISFATTO":"\u2717 NON soddisfatto"})]}),(0,Et.jsxs)("div",{className:"stat-card criterion-badge ".concat(l?"met":"not-met"),children:[(0,Et.jsx)("div",{className:"stat-label",children:"4\ufe0f\u20e3 Stabilit\xe0 Temporale"}),(0,Et.jsx)("div",{className:"stat-value",title:"Coefficiente di Variazione: ".concat(o.length>=10?p(Math.sqrt(o.slice(-10).map(e=>e.mean_estimate).reduce((e,t,n,a)=>e+Math.pow(t-a.reduce((e,t)=>e+t,0)/a.length,2),0)/9)/(o.slice(-10).map(e=>e.mean_estimate).reduce((e,t)=>e+t,0)/10)*100,1)+"%":"N/A"," ").concat(l?"<":"\u2265"," 10%\n\nQuesto criterio verifica che le stime recenti siano stabili nel tempo, con bassa variabilit\xe0 negli ultimi 10 punti."),children:o.length>=10?l?"\u2713 SODDISFATTO":"\u2717 NON soddisfatto":"N/A (dati insufficienti)"})]})]})]})})()]}),s.visible&&(0,Et.jsx)("div",{style:{position:"fixed",left:s.x,top:s.y,backgroundColor:"rgba(0, 0, 0, 0.8)",color:"white",padding:"8px 12px",borderRadius:"4px",fontSize:"12px",pointerEvents:"none",zIndex:1e4,whiteSpace:"pre-line",maxWidth:"300px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},children:s.content})]})})};function Cu(e){const t=(new Date).toISOString();return{modelType:e,version:"1.0.0",createdAt:t,lastModified:t}}const Su=["_metadata"];class wu{static async saveModelWithOverwrite(e,t,n,a){if(n&&a){if(window.confirm('Vuoi sovrascrivere il file esistente "'.concat(a,'"?\n\nClicca OK per sovrascrivere o Annulla per salvare come nuovo file.'))){const i=u({_metadata:Cu(t)},e),r=JSON.stringify(i,null,2),l=new Blob([r],{type:"application/json"});try{const e=await n.createWritable();return await e.write(l),await e.close(),{url:"",filename:a,fileHandle:n}}catch(o){console.error("Errore durante la sovrascrittura:",o)}}}return this.saveModelWithMetadata(e,t)}static async saveModelWithMetadata(e,t,n){const a=u({_metadata:Cu(t)},e),o=JSON.stringify(a,null,2),i=new Blob([o],{type:"application/json"}),r=n||"".concat("fault-tree"===t?"fault-tree":"markov-chain","-").concat((new Date).toISOString().split("T")[0],".json");if("undefined"!==typeof window&&"showSaveFilePicker"in window)try{const e=await window.showSaveFilePicker({suggestedName:r,types:[{description:"JSON Files",accept:{"application/json":[".json"]}}]}),t=await e.createWritable();return await t.write(i),await t.close(),{url:"",filename:r,fileHandle:e}}catch(c){if("AbortError"===c.name)throw new Error("Salvataggio annullato dall'utente");throw console.error("Errore durante il salvataggio:",c),c}const l=URL.createObjectURL(i),s=document.createElement("a");return s.href=l,s.download=r,document.body.appendChild(s),s.click(),document.body.removeChild(s),{url:l,filename:r}}static async saveFaultTree(e,t){const n=JSON.stringify(e,null,2),a=new Blob([n],{type:"application/json"});if("undefined"!==typeof window&&"showSaveFilePicker"in window)try{const e=t||"fault-tree-".concat((new Date).toISOString().split("T")[0],".json"),n=await window.showSaveFilePicker({suggestedName:e,types:[{description:"JSON Files",accept:{"application/json":[".json"]}}]});if("createWritable"in n){const e=await n.createWritable();await e.write(a),await e.close()}else{if(!("createSyncAccessHandle"in n))throw new Error("API File System Access non supportata");{const e=await n.createSyncAccessHandle(),t=await a.arrayBuffer();e.write(t,{at:0}),e.close()}}return}catch(r){console.log("File System Access non disponibile o annullato, uso fallback:",r)}const o=URL.createObjectURL(a),i=document.createElement("a");i.href=o,i.download=t||"fault-tree-".concat((new Date).toISOString().split("T")[0],".json"),i.click(),URL.revokeObjectURL(o)}static async overwriteExistingFile(e,t){const n=JSON.stringify(e,null,2),a=new Blob([n],{type:"application/json"});try{if("createWritable"in t){const e=await t.createWritable();await e.write(a),await e.close()}else if("createSyncAccessHandle"in t){const e=await t.createSyncAccessHandle(),n=await a.arrayBuffer();e.write(n,{at:0}),e.close()}else{const e=await t.createWritable();await e.write(a),await e.close()}}catch(o){console.log("File System Access fallito, uso fallback:",o);const e=URL.createObjectURL(a),t=document.createElement("a");throw t.href=e,t.download="fault-tree-".concat((new Date).toISOString().split("T")[0],".json"),t.click(),URL.revokeObjectURL(e),new Error("Errore durante la sovrascrittura del file: ".concat(o instanceof Error?o.message:"Errore sconosciuto"))}}static async openModelWithValidation(e,t){return new Promise((n,a)=>{const o=new FileReader;o.onload=e=>{try{var o;const r=null===(o=e.target)||void 0===o?void 0:o.result,l=JSON.parse(r),s=function(e){if(e&&"object"===typeof e){if(e._metadata&&e._metadata.modelType)return e._metadata.modelType;if(void 0!==e.events&&void 0!==e.gates&&void 0!==e.connections)return"fault-tree";if(void 0!==e.states&&void 0!==e.transitions)return"markov-chain"}return"unknown"}(l);if("unknown"===s)return void a(new Error("Formato file non riconosciuto. Il file deve contenere un modello Fault Tree o Markov Chain valido."));if(s!==t){const e={"fault-tree":"Fault Tree","markov-chain":"Markov Chain"};return void a(new Error("Tipo di modello errato. Hai caricato un modello ".concat(e[s],", ma ti trovi nell'editor ").concat(e[t],".")))}const{_metadata:c}=l,u=i(l,Su);if("fault-tree"===s){if(!u.events||!u.gates||!u.connections)throw new Error("Formato Fault Tree non valido: mancano eventi, porte o connessioni")}else if("markov-chain"===s&&(!u.states||!u.transitions))throw new Error("Formato Markov Chain non valido: mancano stati o transizioni");n({model:u,actualType:s})}catch(r){r instanceof Error?a(r):a(new Error("Errore nel parsing del file: ".concat(r instanceof Error?r.message:"Errore sconosciuto")))}},o.onerror=()=>{a(new Error("Errore nella lettura del file"))},o.readAsText(e)})}static async openFaultTree(e){return new Promise((t,n)=>{const a=new FileReader;a.onload=e=>{try{var a;const n=null===(a=e.target)||void 0===a?void 0:a.result,o=JSON.parse(n);if(!o.events||!o.gates||!o.connections)throw new Error("Formato file non valido: mancano eventi, porte o connessioni");t(o)}catch(o){n(new Error("Errore nel parsing del file: ".concat(o instanceof Error?o.message:"Errore sconosciuto")))}},a.onerror=()=>{n(new Error("Errore nella lettura del file"))},a.readAsText(e)})}static async exportToXML(e,t){const n=this.generateXML(e),a=new Blob([n],{type:"application/xml"});if("undefined"!==typeof window&&"showSaveFilePicker"in window)try{const e=t||"fault-tree-".concat((new Date).toISOString().split("T")[0],".xml"),n=await window.showSaveFilePicker({suggestedName:e,types:[{description:"XML Files",accept:{"application/xml":[".xml"]}}]});if("createWritable"in n){const e=await n.createWritable();await e.write(a),await e.close()}else{if(!("createSyncAccessHandle"in n))throw new Error("API File System Access non supportata");{const e=await n.createSyncAccessHandle(),t=await a.arrayBuffer();e.write(t,{at:0}),e.close()}}return}catch(r){console.log("File System Access non disponibile o annullato, uso fallback:",r)}const o=URL.createObjectURL(a),i=document.createElement("a");i.href=o,i.download=t||"fault-tree-".concat((new Date).toISOString().split("T")[0],".xml"),i.click(),URL.revokeObjectURL(o)}static async exportToCSV(e,t){const n=this.generateCSV(e),a=new Blob([n],{type:"text/csv"});if("undefined"!==typeof window&&"showSaveFilePicker"in window)try{const e=t||"fault-tree-".concat((new Date).toISOString().split("T")[0],".csv"),n=await window.showSaveFilePicker({suggestedName:e,types:[{description:"CSV Files",accept:{"text/csv":[".csv"]}}]});if("createWritable"in n){const e=await n.createWritable();await e.write(a),await e.close()}else{if(!("createSyncAccessHandle"in n))throw new Error("API File System Access non supportata");{const e=await n.createSyncAccessHandle(),t=await a.arrayBuffer();e.write(t,{at:0}),e.close()}}return}catch(r){console.log("File System Access non disponibile o annullato, uso fallback:",r)}const o=URL.createObjectURL(a),i=document.createElement("a");i.href=o,i.download=t||"fault-tree-".concat((new Date).toISOString().split("T")[0],".csv"),i.click(),URL.revokeObjectURL(o)}static async exportCode(e,t){const n=new Blob([e],{type:"text/plain"});if("undefined"!==typeof window&&"showSaveFilePicker"in window)try{const e=t||"fault-tree-code-".concat((new Date).toISOString().split("T")[0],".txt"),a=await window.showSaveFilePicker({suggestedName:e,types:[{description:"Text Files",accept:{"text/plain":[".txt"]}}]});if("createWritable"in a){const e=await a.createWritable();await e.write(n),await e.close()}else{if(!("createSyncAccessHandle"in a))throw new Error("API File System Access non supportata");{const e=await a.createSyncAccessHandle(),t=await n.arrayBuffer();e.write(t,{at:0}),e.close()}}return}catch(i){console.log("File System Access non disponibile o annullato, uso fallback:",i)}const a=URL.createObjectURL(n),o=document.createElement("a");o.href=a,o.download=t||"fault-tree-code-".concat((new Date).toISOString().split("T")[0],".txt"),o.click(),URL.revokeObjectURL(a)}static generateXML(e){let t='<?xml version="1.0" encoding="UTF-8"?>\n';return t+="<faultTree>\n",t+="  <events>\n",e.events.forEach(e=>{if(t+='    <event id="'.concat(e.id,'" type="').concat(e.type,'">\n'),t+="      <name>".concat(this.escapeXML(e.name),"</name>\n"),e.description&&(t+="      <description>".concat(this.escapeXML(e.description),"</description>\n")),e.failureRate&&(t+="      <failureRate>".concat(e.failureRate,"</failureRate>\n")),e.failureProbabilityDistribution){switch(t+='      <failureProbabilityDistribution type="'.concat(e.failureProbabilityDistribution.type,'">\n'),e.failureProbabilityDistribution.type){case"exponential":t+="        <lambda>".concat(e.failureProbabilityDistribution.lambda,"</lambda>\n");break;case"weibull":t+="        <k>".concat(e.failureProbabilityDistribution.k,"</k>\n"),t+="        <lambda>".concat(e.failureProbabilityDistribution.lambda,"</lambda>\n"),t+="        <mu>".concat(e.failureProbabilityDistribution.mu,"</mu>\n");break;case"normal":t+="        <mu>".concat(e.failureProbabilityDistribution.mu,"</mu>\n"),t+="        <sigma>".concat(e.failureProbabilityDistribution.sigma,"</sigma>\n");break;case"constant":t+="        <probability>".concat(e.failureProbabilityDistribution.probability,"</probability>\n")}t+="      </failureProbabilityDistribution>\n"}if(e.repairProbabilityDistribution){switch(t+='      <repairProbabilityDistribution type="'.concat(e.repairProbabilityDistribution.type,'">\n'),e.repairProbabilityDistribution.type){case"exponential":t+="        <lambda>".concat(e.repairProbabilityDistribution.lambda,"</lambda>\n");break;case"weibull":t+="        <k>".concat(e.repairProbabilityDistribution.k,"</k>\n"),t+="        <lambda>".concat(e.repairProbabilityDistribution.lambda,"</lambda>\n"),t+="        <mu>".concat(e.repairProbabilityDistribution.mu,"</mu>\n");break;case"normal":t+="        <mu>".concat(e.repairProbabilityDistribution.mu,"</mu>\n"),t+="        <sigma>".concat(e.repairProbabilityDistribution.sigma,"</sigma>\n");break;case"constant":t+="        <probability>".concat(e.repairProbabilityDistribution.probability,"</probability>\n")}t+="      </repairProbabilityDistribution>\n"}t+='      <position x="'.concat(e.position.x,'" y="').concat(e.position.y,'" />\n'),t+="    </event>\n"}),t+="  </events>\n",t+="  <gates>\n",e.gates.forEach(e=>{t+='    <gate id="'.concat(e.id,'" type="').concat(e.type,'" gateType="').concat(e.gateType,'">\n'),t+="      <name>".concat(this.escapeXML(e.name),"</name>\n"),e.description&&(t+="      <description>".concat(this.escapeXML(e.description),"</description>\n")),t+='      <position x="'.concat(e.position.x,'" y="').concat(e.position.y,'" />\n'),t+="      <inputs>\n",e.inputs.forEach(e=>{t+="        <input>".concat(e,"</input>\n")}),t+="      </inputs>\n",t+="    </gate>\n"}),t+="  </gates>\n",t+="  <connections>\n",e.connections.forEach(e=>{t+='    <connection id="'.concat(e.id,'" source="').concat(e.source,'" target="').concat(e.target,'" type="').concat(e.type,'" />\n')}),t+="  </connections>\n",e.topEvent&&(t+="  <topEvent>".concat(e.topEvent,"</topEvent>\n")),t+="</faultTree>",t}static generateCSV(e){let t="Element Type,ID,Name,Description,Position X,Position Y,Failure Distribution,Repair Distribution,Additional Info\n";return e.events.forEach(e=>{let n="",a="",o="";if(e.failureProbabilityDistribution){const t=[];switch(e.failureProbabilityDistribution.type){case"exponential":t.push("lambda: ".concat(e.failureProbabilityDistribution.lambda," h\u207b\xb9"));break;case"weibull":t.push("k: ".concat(e.failureProbabilityDistribution.k)),t.push("lambda: ".concat(e.failureProbabilityDistribution.lambda," h")),t.push("mu: ".concat(e.failureProbabilityDistribution.mu," h"));break;case"normal":t.push("mu: ".concat(e.failureProbabilityDistribution.mu," h")),t.push("sigma: ".concat(e.failureProbabilityDistribution.sigma," h"));break;case"constant":t.push("probability: ".concat(e.failureProbabilityDistribution.probability))}n="".concat(e.failureProbabilityDistribution.type,": ").concat(t.join("; "))}if(e.repairProbabilityDistribution){const t=[];switch(e.repairProbabilityDistribution.type){case"exponential":t.push("lambda: ".concat(e.repairProbabilityDistribution.lambda," h\u207b\xb9"));break;case"weibull":t.push("k: ".concat(e.repairProbabilityDistribution.k)),t.push("lambda: ".concat(e.repairProbabilityDistribution.lambda," h")),t.push("mu: ".concat(e.repairProbabilityDistribution.mu," h"));break;case"normal":t.push("mu: ".concat(e.repairProbabilityDistribution.mu," h")),t.push("sigma: ".concat(e.repairProbabilityDistribution.sigma," h"));break;case"constant":t.push("probability: ".concat(e.repairProbabilityDistribution.probability))}a="".concat(e.repairProbabilityDistribution.type,": ").concat(t.join("; "))}e.failureRate&&(o="Failure Rate: ".concat(e.failureRate)),t+="Event,".concat(e.id,',"').concat(e.name,'","').concat(e.description||"",'",').concat(e.position.x,",").concat(e.position.y,',"').concat(n,'","').concat(a,'","').concat(o,'"\n')}),e.gates.forEach(e=>{t+="Gate,".concat(e.id,',"').concat(e.name,'","').concat(e.description||"",'",').concat(e.position.x,",").concat(e.position.y,',"","","Type: ').concat(e.gateType,", Inputs: ").concat(e.inputs.length,'"\n')}),t+="\nConnections\n",t+="Source,Target,Type\n",e.connections.forEach(e=>{t+="".concat(e.source,",").concat(e.target,",").concat(e.type,"\n")}),t}static escapeXML(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}static validateModel(e){const t=[];e.events&&0!==e.events.length||t.push("Il modello deve contenere almeno un evento base"),e.gates&&0!==e.gates.length||t.push("Il modello deve contenere almeno una porta"),e.connections&&0!==e.connections.length||t.push("Il modello deve contenere almeno una connessione");const n=new Set([...e.events.map(e=>e.id),...e.gates.map(e=>e.id)]);return e.connections.forEach(e=>{n.has(e.source)||t.push("Connessione con source ID '".concat(e.source,"' non trovato")),n.has(e.target)||t.push("Connessione con target ID '".concat(e.target,"' non trovato"))}),{isValid:0===t.length,errors:t}}static generateDefaultFilename(){const e=new Date,t=e.toISOString().split("T")[0],n=e.toTimeString().split(" ")[0].replace(/:/g,"-");return"fault-tree-".concat(t,"-").concat(n)}}const ku=e=>{let{isOpen:t,onClose:n,faultTreeModel:o}=e;const[i,r]=(0,a.useState)(wu.generateDefaultFilename()),[l,s]=(0,a.useState)("json"),[c,u]=(0,a.useState)(!0),[d,p]=(0,a.useState)(!1);if(!t)return null;const m=()=>{r(wu.generateDefaultFilename()),s("json"),u(!0),p(!1),n()};return(0,Et.jsx)("div",{className:"save-modal-overlay",onClick:m,children:(0,Et.jsxs)("div",{className:"save-modal",onClick:e=>e.stopPropagation(),children:[(0,Et.jsxs)("div",{className:"save-modal-header",children:[(0,Et.jsx)("h2",{children:"\ud83d\udcbe Salva Fault Tree"}),(0,Et.jsx)("button",{className:"close-button",onClick:m,children:"\xd7"})]}),(0,Et.jsxs)("div",{className:"save-modal-content",children:[(0,Et.jsx)("div",{className:"info-message",children:(0,Et.jsxs)("p",{children:["\ud83d\udca1 ",(0,Et.jsx)("strong",{children:"Nuovo!"})," Ora puoi scegliere la cartella di destinazione e modificare il nome file per tutti i tipi di salvataggio."]})}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{htmlFor:"filename",children:"Nome File:"}),(0,Et.jsx)("input",{id:"filename",type:"text",value:i,onChange:e=>r(e.target.value),placeholder:"Inserisci nome file",className:"filename-input"})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{htmlFor:"format",children:"Formato:"}),(0,Et.jsxs)("select",{id:"format",value:l,onChange:e=>s(e.target.value),className:"format-select",children:[(0,Et.jsx)("option",{value:"json",children:"JSON (.json)"}),(0,Et.jsx)("option",{value:"xml",children:"XML (.xml)"}),(0,Et.jsx)("option",{value:"csv",children:"CSV (.csv)"})]})]}),(0,Et.jsx)("div",{className:"form-group",children:(0,Et.jsxs)("label",{className:"checkbox-label",children:[(0,Et.jsx)("input",{type:"checkbox",checked:c,onChange:e=>u(e.target.checked)}),"Includi metadati (data, versione, ecc.)"]})}),(0,Et.jsxs)("div",{className:"file-info",children:[(0,Et.jsx)("h4",{children:"Informazioni File:"}),(0,Et.jsxs)("ul",{children:[(0,Et.jsxs)("li",{children:["\ud83d\udcca Eventi: ",o.events.length]}),(0,Et.jsxs)("li",{children:["\ud83d\udd0c Porte: ",o.gates.length]}),(0,Et.jsxs)("li",{children:["\ud83d\udd17 Connessioni: ",o.connections.length]}),(0,Et.jsxs)("li",{children:["\ud83d\udcc1 Formato: ",l.toUpperCase()]})]})]})]}),(0,Et.jsxs)("div",{className:"save-modal-actions",children:[(0,Et.jsx)("button",{className:"save-button primary",onClick:async()=>{if(i.trim()){p(!0);try{const e=wu.validateModel(o);if(!e.isValid)return void alert("Errore di validazione:\n".concat(e.errors.join("\n")));switch(l){case"json":await wu.saveFaultTree(o,"".concat(i,".json"));break;case"xml":await wu.exportToXML(o,"".concat(i,".xml"));break;case"csv":await wu.exportToCSV(o,"".concat(i,".csv"))}alert("File salvato con successo!"),n()}catch(e){alert("Errore durante il salvataggio: ".concat(e instanceof Error?e.message:"Errore sconosciuto"))}finally{p(!1)}}else alert("Inserisci un nome file valido")},disabled:d||!i.trim(),children:d?"\u23f3 Salvando...":"\ud83d\udcbe Salva"}),(0,Et.jsx)("button",{className:"save-button secondary",onClick:async()=>{try{await wu.saveFaultTree(o),n()}catch(e){alert("Errore durante il salvataggio rapido: ".concat(e instanceof Error?e.message:"Errore sconosciuto"))}},disabled:d,children:"\ud83d\ude80 Salvataggio Rapido (JSON)"}),(0,Et.jsx)("button",{className:"cancel-button",onClick:m,disabled:d,children:"\u274c Annulla"})]})]})})};class Nu{static async exportToMatlab(e,t){const n=this.generateMatlabCode(e,t),a=new Blob([n],{type:"text/plain"});if("undefined"!==typeof window&&"showSaveFilePicker"in window)try{const e=t.filename||"fault-tree-".concat((new Date).toISOString().split("T")[0],".m"),n=await window.showSaveFilePicker({suggestedName:e,types:[{description:"MATLAB Files",accept:{"text/plain":[".m"]}}]}),o=await n.createWritable();return await o.write(a),void await o.close()}catch(r){console.log("File System Access non disponibile o annullato, uso fallback:",r)}const o=URL.createObjectURL(a),i=document.createElement("a");i.href=o,i.download=t.filename||"fault-tree-".concat((new Date).toISOString().split("T")[0],".m"),i.click(),URL.revokeObjectURL(o)}static generateMatlabCode(e,t){let n="%% Define the Fault Tree Structure %%\n";n+="Tm = ".concat(t.missionTime,"; %[h]\n\n"),n+="%% Define BEs %%\n\n",e.events.forEach(e=>{n+=this.generateBasicEventCode(e)}),n+="\n%% Define Gates %%\n";this.getBottomUpOrdering(e).forEach(t=>{n+=this.generateGateCode(t,e)});const a=this.findTopEvent(e);return a&&(n+="TOP = ".concat(a.name,";\n")),n+="%% Recall Matlab Script %%\n",n+="%verify if the FT Structure is valid (it will modify the value of the variable UNVALID_FT)\n",n+="createFTStructure\n",n}static generateBasicEventCode(e){const t=this.sanitizeMatlabName(e.name);let n="''",a="''",o="[]",i="[]";if(e.failureProbabilityDistribution){const t=e.failureProbabilityDistribution;switch(t.type){case"exponential":n="'exp'",o="[".concat(t.lambda,"]");break;case"weibull":n="'weibull'",o="[".concat(t.k,", ").concat(t.lambda,", ").concat(t.mu,"]");break;case"normal":n="'normal'",o="[".concat(t.mu,", ").concat(t.sigma,"]");break;case"constant":n="'constant'",o="[".concat(t.probability,"]")}}else e.failureRate&&(n="'exp'",o="[".concat(e.failureRate,"]"));if(e.repairProbabilityDistribution){const t=e.repairProbabilityDistribution;switch(t.type){case"exponential":a="'exp'",i="[".concat(t.lambda,"]");break;case"weibull":a="'weibull'",i="[".concat(t.k,", ").concat(t.lambda,", ").concat(t.mu,"]");break;case"normal":a="'normal'",i="[".concat(t.mu,", ").concat(t.sigma,"]");break;case"constant":a="'constant'",i="[".concat(t.probability,"]")}}return"".concat(t," = BasicEvent('").concat(t,"',").concat(n,",").concat(a,",").concat(o,",").concat(i,");\n")}static generateGateCode(e,t){const n=this.sanitizeMatlabName(e.name),a=e.gateType,o=e.isFailureGate||!1,i=e.inputs.map(e=>{const n=this.findElementById(t,e);return n?this.sanitizeMatlabName(n.name):e});if("SPARE"===a||"FDEP"===a){const r="[".concat(i.join(", "),"]");let l="[]";if(e.secondaryInputs&&e.secondaryInputs.length>0){const n=e.secondaryInputs.map(e=>{const n=this.findElementById(t,e);return n?this.sanitizeMatlabName(n.name):e});l="[".concat(n.join(", "),"]")}return"".concat(n," = Gate('").concat(n,"', '").concat(a,"', ").concat(o?"true":"false",", ").concat(r,", ").concat(l,");\n")}{const e="[".concat(i.join(", "),"]");return"".concat(n," = Gate('").concat(n,"', '").concat(a,"', ").concat(o?"true":"false",", ").concat(e,");\n")}}static getBottomUpOrdering(e){const t=new Set,n=new Set,a=[],o=i=>{if(t.has(i))return;if(n.has(i))return void console.warn("Circular dependency detected involving gate ".concat(i));const r=e.gates.find(e=>e.id===i);r&&(n.add(i),r.inputs.forEach(n=>{e.gates.find(e=>e.id===n)&&!t.has(n)&&o(n)}),n.delete(i),t.add(i),a.push(r))};return e.gates.forEach(e=>{t.has(e.id)||o(e.id)}),a}static findTopEvent(e){if(e.topEvent)return e.gates.find(t=>t.id===e.topEvent)||null;const t=new Set;e.gates.forEach(n=>{n.inputs.forEach(n=>{e.gates.some(e=>e.id===n)&&t.add(n)})});const n=e.gates.filter(e=>!t.has(e.id));return n.length>0?n[0]:null}static findElementById(e,t){const n=e.events.find(e=>e.id===t);if(n)return n;const a=e.gates.find(e=>e.id===t);return a||null}static sanitizeMatlabName(e){let t=e.replace(/[^a-zA-Z0-9_]/g,"_");return/^[a-zA-Z]/.test(t)||(t="E_"+t),t=t.replace(/_+/g,"_"),t=t.replace(/_+$/,""),t}}const ju=e=>{let{isOpen:t,onClose:n,faultTreeModel:o,missionTime:i=500}=e;const[r,l]=(0,a.useState)("fault-tree-".concat((new Date).toISOString().split("T")[0],".m")),[s,c]=(0,a.useState)(i),[u,d]=(0,a.useState)(!1);if(!t)return null;return(0,Et.jsx)("div",{className:"matlab-export-modal-overlay",onClick:n,children:(0,Et.jsxs)("div",{className:"matlab-export-modal",onClick:e=>e.stopPropagation(),children:[(0,Et.jsxs)("div",{className:"matlab-export-modal-header",children:[(0,Et.jsx)("h2",{children:"\ud83e\uddee Esporta MATLAB"}),(0,Et.jsx)("button",{className:"close-button",onClick:n,children:"\xd7"})]}),(0,Et.jsxs)("div",{className:"matlab-export-modal-content",children:[(0,Et.jsxs)("div",{className:"export-info",children:[(0,Et.jsx)("h3",{children:"\ud83d\udcca Informazioni Modello"}),(0,Et.jsxs)("div",{className:"model-stats",children:[(0,Et.jsxs)("div",{className:"stat-item",children:[(0,Et.jsx)("span",{className:"stat-label",children:"Eventi Base:"}),(0,Et.jsx)("span",{className:"stat-value",children:o.events.length})]}),(0,Et.jsxs)("div",{className:"stat-item",children:[(0,Et.jsx)("span",{className:"stat-label",children:"Porte:"}),(0,Et.jsx)("span",{className:"stat-value",children:o.gates.length})]}),(0,Et.jsxs)("div",{className:"stat-item",children:[(0,Et.jsx)("span",{className:"stat-label",children:"Connessioni:"}),(0,Et.jsx)("span",{className:"stat-value",children:o.connections.length})]})]})]}),(0,Et.jsxs)("div",{className:"export-options",children:[(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{htmlFor:"filename",children:"\ud83d\udcc1 Nome File:"}),(0,Et.jsx)("input",{id:"filename",type:"text",value:r,onChange:e=>l(e.target.value),placeholder:"fault-tree.m"})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{htmlFor:"missionTime",children:"\u23f1\ufe0f Tempo di Missione (Tm) [h]:"}),(0,Et.jsx)("input",{id:"missionTime",type:"number",value:s,onChange:e=>c(Number(e.target.value)),placeholder:"500",min:"0",step:"0.1"}),(0,Et.jsx)("small",{className:"form-help",children:"Tempo di missione in ore per l'analisi del fault tree"})]})]}),(0,Et.jsxs)("div",{className:"export-preview",children:[(0,Et.jsx)("h4",{children:"\ud83d\udccb Anteprima Struttura"}),(0,Et.jsxs)("div",{className:"preview-content",children:[(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Formato MATLAB:"})," Bottom-up ordering"]}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Eventi Base:"})," BasicEvent('nome', 'failure_prob', 'repair_prob', [params_failure], [params_repair])"]}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Porte:"})," Gate('nome', 'tipo', false, [inputs])"]}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Porte SPARE/FDEP:"})," Gate('nome', 'tipo', false, [primary_inputs], [secondary_inputs])"]})]})]})]}),(0,Et.jsxs)("div",{className:"matlab-export-modal-actions",children:[(0,Et.jsx)("button",{className:"cancel-button",onClick:n,disabled:u,children:"Annulla"}),(0,Et.jsx)("button",{className:"export-button primary",onClick:async()=>{if(r.trim())if(s<=0)alert("Il tempo di missione deve essere maggiore di 0");else{d(!0);try{if(0===o.events.length&&0===o.gates.length)return void alert("Il modello di fault tree \xe8 vuoto. Aggiungi almeno un evento base o una porta.");await Nu.exportToMatlab(o,{missionTime:s,filename:r.endsWith(".m")?r:"".concat(r,".m")}),alert("File MATLAB esportato con successo!"),n()}catch(e){alert("Errore durante l'esportazione: ".concat(e instanceof Error?e.message:"Errore sconosciuto"))}finally{d(!1)}}else alert("Inserisci un nome file valido")},disabled:u,children:u?"Esportazione...":"\ud83e\uddee Esporta MATLAB"})]})]})})};class Eu{static setProgressCallback(e){this.progressCallback&&console.log("\ud83e\uddf9 [SHyFTAService] Replacing existing progress callback"),this.progressCallback=e}static updateProgress(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.progressCallback&&this.progressCallback({progress:e,currentStep:t,logOutput:n,isRunning:e<100,isCompleted:e>=100})}static async generateZFTAMainContent(e){try{const t=await fetch("/assets/ZFTAMain.m");let n;n=t.ok?await t.text():"clear all; %to modify to clear only PROGRAMS variables\naddpath(genpath(pwd));\ntic\nUNVALID_FT = 0; % 0, FT is valid (1 otherwise) This check is performed inside the \"initFaultTree\" script.\n\ninputFullFileNameRound = fullfile(pwd, '\\src\\func\\zround.m');\noutputFullFileNameRound = fullfile(pwd, '\\src\\func\\rround.m');\ncopyfile (inputFullFileNameRound, outputFullFileNameRound);\nclear inputFullFileNameRound outputFullFileNameRound;\n\n%% SIMULATION PARAMETERS\ndebugMode = false;\niter = <ITER>;\n%% STOP CRITERIA PARAMETERS\nconfidenceLevel = <CONFIDENCE>;\nstopCriteriaOn = <TRUEFALSE>;\npercentageErrorTollerance = <PERCENTAGE_ERROR_TOLLERANCE>;\n\n%% ADVANCED SIMULATION PARAMETERS (OPTIMIZED FOR LOW RATES)\nmin_iterations_for_CI = <MIN_ITERATIONS_FOR_CI>;              % Iterazioni minime prima controlli CI\nmax_iterations_for_robustness = <MAX_ITERATIONS_FOR_ROBUSTNESS>;   % Limite massimo iterazioni\n\n%% STABILITY AND CONVERGENCE PARAMETERS\nstability_check_window = <STABILITY_CHECK_WINDOW>;               % Finestra stabilit\xe0 stime\nstability_threshold = <STABILITY_THRESHOLD>;                     % Soglia stabilit\xe0\nconvergence_check_window = <CONVERGENCE_CHECK_WINDOW>;           % Finestra convergenza CI\nconvergence_threshold = <CONVERGENCE_THRESHOLD>;                 % Soglia convergenza CI\n\nzvalue = norminv(1-((1-confidenceLevel)/2));\nerr_iter = 0;\nmuX =  0;\nerr_i = 0;\nerr_vect = 0;\nTOP_i = 0;\nstopCriteriaMet = false;\n\ncounter_error = 1;\nmu_i = 0;\nS_i = 0;\n%%\nrng('shuffle')\nfailureTime = zeros(1,iter);\n\nTimeStep = Constants.TIMESTEP;\ncurrentTime = 0;\ncounter_i = 1;\n\n%% Debug Mode\nif debugMode\n   debugLogFile = createDebugMode; %return the ID to the debug file\nend\n%%\n\n<MODEL_NAME>\n\nif (UNVALID_FT)\n    return\nend\n\nsetStopCriteria;\n\nttfComponents = zeros(counterComponents-1,iter);\nwhile(nextEventTime<Tm) \n    ZFTAevaluateFT;\nend\ncomputeUpTime;\nupdateNFailure;\n\nfor counter_i=2:iter\n    pct = counter_i/iter*100;               % percentuale completata\n    fprintf('\\rAvanzamento: %6.2f%%%%', pct);  % \\r torna a inizio riga e sovrascrive\n    drawnow;                        % obbliga l'aggiornamento della Console\n    if(~stopCriteriaMet)\n        reinit;\n        while(nextEventTime<Tm) \n            ZFTAevaluateFT;\n        end\n        computeUpTime;\n        updateNFailure;\n        if(stopCriteriaOn)\n            verifyStopCriteria; \n        end\n       % disp(counter_i);\n    else\n        toc\n        return;\n    end\n    if(mod(counter_i,100000)==0)\n        save('workspace_great');\n    end\nend\ntoc";const a=e.modelName.replace(/\.m$/,"");return n.replace(/<MODEL_NAME>/g,a).replace(/<ITER>/g,e.iterations.toString()).replace(/<CONFIDENCE>/g,e.confidence.toString()).replace(/<TRUEFALSE>/g,e.confidenceToggle.toString()).replace(/<PERC_ERR_TOLERANCE>/g,((e.percentageErrorTollerance||5)/100).toString()).replace(/<PERCENTAGE_ERROR_TOLLERANCE>/g,((e.percentageErrorTollerance||5)/100).toString()).replace(/<MIN_ITERATIONS_FOR_CI>/g,(e.minIterationsForCI||1e3).toString()).replace(/<min_iterations_for_CI>/g,(e.minIterationsForCI||1e3).toString()).replace(/<MAX_ITERATIONS_FOR_ROBUSTNESS>/g,(e.maxIterationsForRobustness||1e6).toString()).replace(/<max_iterations_for_robustness>/g,(e.maxIterationsForRobustness||1e6).toString()).replace(/<STABILITY_CHECK_WINDOW>/g,(e.stabilityCheckWindow||50).toString()).replace(/<stability_check_window>/g,(e.stabilityCheckWindow||50).toString()).replace(/<STABILITY_THRESHOLD>/g,(e.stabilityThreshold||.1).toString()).replace(/<stability_threshold>/g,(e.stabilityThreshold||.1).toString()).replace(/<CONVERGENCE_CHECK_WINDOW>/g,(e.convergenceCheckWindow||20).toString()).replace(/<convergence_check_window>/g,(e.convergenceCheckWindow||20).toString()).replace(/<CONVERGENCE_THRESHOLD>/g,(e.convergenceThreshold||.15).toString()).replace(/<convergence_threshold>/g,(e.convergenceThreshold||.15).toString())}catch(t){throw new Error("Failed to generate ZFTAMain.m content: ".concat(t instanceof Error?t.message:"Unknown error"))}}static async prepareFilesForBackend(e,t){try{console.log("Preparing files for backend processing: ".concat(t.shyftaLibFolder));const n=await this.generateModelCode(e,t),a=await fetch("/assets/ZFTAMain.m");let o=await a.text();const i=t.modelName.replace(/\.m$/,"");return o=o.replace(/<MODEL_NAME>/g,i).replace(/<ITER>/g,t.iterations.toString()).replace(/<CONFIDENCE>/g,t.confidence.toString()).replace(/<TRUEFALSE>/g,t.confidenceToggle.toString()).replace(/<PERC_ERR_TOLERANCE>/g,((t.percentageErrorTollerance||5)/100).toString()).replace(/<PERCENTAGE_ERROR_TOLLERANCE>/g,((t.percentageErrorTollerance||5)/100).toString()).replace(/<MIN_ITERATIONS_FOR_CI>/g,(t.minIterationsForCI||1e3).toString()).replace(/<min_iterations_for_CI>/g,(t.minIterationsForCI||1e3).toString()).replace(/<MAX_ITERATIONS_FOR_ROBUSTNESS>/g,(t.maxIterationsForRobustness||1e6).toString()).replace(/<max_iterations_for_robustness>/g,(t.maxIterationsForRobustness||1e6).toString()).replace(/<STABILITY_CHECK_WINDOW>/g,(t.stabilityCheckWindow||50).toString()).replace(/<stability_check_window>/g,(t.stabilityCheckWindow||50).toString()).replace(/<STABILITY_THRESHOLD>/g,(t.stabilityThreshold||.1).toString()).replace(/<stability_threshold>/g,(t.stabilityThreshold||.1).toString()).replace(/<CONVERGENCE_CHECK_WINDOW>/g,(t.convergenceCheckWindow||20).toString()).replace(/<convergence_check_window>/g,(t.convergenceCheckWindow||20).toString()).replace(/<CONVERGENCE_THRESHOLD>/g,(t.convergenceThreshold||.15).toString()).replace(/<convergence_threshold>/g,(t.convergenceThreshold||.15).toString()),console.log("Files prepared for backend - Model: ".concat(n.length," chars, ZFTA: ").concat(o.length," chars")),{modelContent:n,zftaContent:o}}catch(n){throw new Error("Failed to prepare files for backend: ".concat(n instanceof Error?n.message:"Unknown error"))}}static async generateModelCode(e,t){return Nu.generateMatlabCode(e,{missionTime:t.missionTime,filename:t.modelName})}static validateConfig(e,t){if(!e.shyftaLibFolder.trim())return"Seleziona una cartella SHyFTALib valida";if(!e.modelName.trim())return"Inserisci un nome modello valido";if(e.iterations<=0)return"Il numero di iterazioni deve essere maggiore di 0";if(e.confidenceToggle){if(e.confidence<=0||e.confidence>=1)return"L'intervallo di confidenza deve essere tra 0 e 1";if(void 0!==e.percentageErrorTollerance&&(e.percentageErrorTollerance<.1||e.percentageErrorTollerance>99.9))return"La tolleranza errore percentuale deve essere tra 0.1% e 99.9%";if(void 0!==e.minIterationsForCI&&e.minIterationsForCI<100)return"Le iterazioni minime per CI devono essere almeno 100";if(void 0!==e.maxIterationsForRobustness&&e.maxIterationsForRobustness<1e4)return"Le iterazioni massime per robustezza devono essere almeno 10000";if(void 0!==e.stabilityCheckWindow&&e.stabilityCheckWindow<10)return"La finestra di controllo stabilit\xe0 deve essere almeno 10";if(void 0!==e.stabilityThreshold&&(e.stabilityThreshold<.01||e.stabilityThreshold>1))return"La soglia di stabilit\xe0 deve essere tra 0.01 e 1.0";if(void 0!==e.convergenceCheckWindow&&e.convergenceCheckWindow<5)return"La finestra di convergenza CI deve essere almeno 5";if(void 0!==e.convergenceThreshold&&(e.convergenceThreshold<.01||e.convergenceThreshold>1))return"La soglia di convergenza deve essere tra 0.01 e 1.0"}return 0===t.events.length&&0===t.gates.length?"Il modello di fault tree \xe8 vuoto":null}static async clearOutputFolder(e){return console.log("Clearing output folder at: ".concat(e,"/output")),Promise.resolve()}static async executeMatlabCommand(e,t,n,a){return new Promise(async(o,i)=>{this.abortController=new AbortController,this.isRunning=!0;try{this.startSimulationMonitoring(e,t,n,a,o,i)}catch(r){this.isRunning=!1,this.abortController=null,i(r)}})}static async startSimulationMonitoring(e,t,a,o,i,r){this.updateProgress(0,"\ud83d\udd27 Controllo backend e avvio MATLAB...","Verifico backend e preparo simulazione...");try{const{MatlabExecutionService:t}=await n.e(699).then(n.bind(n,699));if(await t.checkBackendAvailability())this.updateProgress(0,"\ud83d\ude80 Lancio MATLAB via backend...","Backend API disponibile - avvio simulazione automatica..."),console.log("\ud83d\udce6 Using prepared files for backend execution:"),console.log("   Model file: ".concat(a.modelName," (").concat(o.modelContent.length," chars)")),console.log("   ZFTAMain.m: ".concat(o.zftaContent.length," chars")),await t.startMatlabWithMonitoring({shyftaPath:e,modelName:a.modelName,modelContent:o.modelContent,zftaContent:o.zftaContent},(e,t)=>{this.updateProgress(e,"\ud83d\udd04 MATLAB: ".concat(e.toFixed(2),"%"),"Log MATLAB in tempo reale:\n".concat(t)),console.log("\ud83d\udcca MATLAB Progress: ".concat(e.toFixed(2),"%")),console.log("\ud83d\udcdd MATLAB Output:",t)}),this.updateProgress(100,"\u2705 Simulazione completata!",'MATLAB terminato automaticamente.\nUsa il pulsante "Retrieve Results" per caricare i risultati quando sei pronto.'),this.progressCallback&&this.progressCallback({progress:100,currentStep:"\ud83c\udf89 Simulazione SHyFTA completata!",logOutput:'Simulazione eseguita dal backend.\nUsa "Retrieve Results" per caricare i dati di affidabilit\xe0.\n',isRunning:!1,isCompleted:!0}),this.isRunning=!1,this.abortController=null,i();else{console.error("\u274c Backend API non disponibile"),this.isRunning=!1,this.abortController=null;const e="Backend non disponibile per eseguire la simulazione MATLAB automaticamente.";this.progressCallback&&this.progressCallback({progress:0,currentStep:"\u274c Backend non disponibile",logOutput:"".concat(e,"\n\nPer risolvere:\n1. Avvia il backend: node backend-server.js\n2. Verifica che sia raggiungibile su http://").concat(window.location.hostname,":3001\n3. Riprova la simulazione\n"),isRunning:!1,isCompleted:!1}),r(new Error(e))}}catch(l){console.error("\u274c Errore durante esecuzione automatica:",l),this.isRunning=!1,this.abortController=null,this.progressCallback&&this.progressCallback({progress:0,currentStep:"\u274c Errore backend",logOutput:"Errore durante l'esecuzione via backend:\n".concat(l instanceof Error?l.message:"Errore sconosciuto","\n\nVerifica che:\n1. Il backend sia avviato (node backend-server.js)\n2. Il percorso SHyFTALib sia corretto\n3. MATLAB sia installato e nel PATH\n"),isRunning:!1,isCompleted:!1}),r(l)}}static checkSimulationResults(e,t,n){this.updateProgress(100,"\u2705 Simulazione completata!","MATLAB terminato con successo!\n\nOutput completo:\n".concat(t,"\n\nControlla output/results.mat per i risultati.")),this.progressCallback&&this.progressCallback({progress:100,currentStep:"\ud83c\udf89 Simulazione SHyFTA completata!",logOutput:"Simulazione terminata!\nLog completo MATLAB visibile nella console Node.js\n",isRunning:!1}),this.isRunning=!1,this.abortController=null,n()}static async prepareBatchFileContent(e){try{const t=await fetch("/assets/runSHyFTA.bat");let n=await t.text();const a=e.modelName.replace(/\.m$/,"");return n=n.replace("set SHYFTA_PATH=C:\\Path\\To\\SHyFTALib","set SHYFTA_PATH=".concat(e.shyftaLibFolder)).replace("set MODEL_NAME=ModelName","set MODEL_NAME=".concat(a)),console.log("Batch file content prepared for backend processing"),n}catch(t){throw new Error("Failed to prepare batch file content: ".concat(t instanceof Error?t.message:"Unknown error"))}}static async runSimulation(e,t){try{const n=this.validateConfig(t,e);if(n)throw new Error(n);this.updateProgress(0,"Preparazione simulazione...","Validazione configurazione e preparazione file...");const{modelContent:a,zftaContent:o}=await this.prepareFilesForBackend(e,t);await this.clearOutputFolder(t.shyftaLibFolder),await this.executeMatlabCommand(t.shyftaLibFolder,e,t,{modelContent:a,zftaContent:o})}catch(n){throw this.isRunning=!1,this.progressCallback&&this.progressCallback({progress:0,currentStep:"Errore durante la preparazione",logOutput:"Errore: ".concat(n instanceof Error?n.message:"Errore sconosciuto","\n"),isRunning:!1,isCompleted:!1}),n}}static async stopSimulation(){if(this.isRunning){try{const{MatlabExecutionService:e}=await n.e(699).then(n.bind(n,699));await e.stopMatlabSimulation()?console.log("\u2705 MATLAB simulation stopped via backend"):console.warn("\u26a0\ufe0f Failed to stop via backend, using fallback")}catch(e){console.error("\u274c Error stopping MATLAB via backend:",e)}this.abortController&&this.abortController.abort(),this.isRunning=!1,console.log("\ud83d\uded1 Simulation stop requested by user"),this.progressCallback&&this.progressCallback({progress:0,currentStep:"\u23f9\ufe0f Simulazione arrestata dall'utente",logOutput:"Simulazione interrotta manualmente.\n",isRunning:!1,isCompleted:!1})}}static isSimulationRunning(){return this.isRunning}static resetSimulation(){this.isRunning=!1,this.abortController&&(this.abortController.abort(),this.abortController=null),this.progressCallback&&this.progressCallback({progress:0,currentStep:"Pronto per nuova simulazione",logOutput:"",isRunning:!1}),this.progressCallback=null,console.log("\ud83e\uddf9 [SHyFTAService] Reset simulation state and cleared all references")}static generateDefaultModelName(){const e=new Date,t=e.getDate().toString().padStart(2,"0"),n=(e.getMonth()+1).toString().padStart(2,"0"),a=e.getFullYear(),o=e.getHours().toString().padStart(2,"0"),i=e.getMinutes().toString().padStart(2,"0"),r=e.getSeconds().toString().padStart(2,"0");return"initFaultTree_".concat(t).concat(n).concat(a,"_").concat(o,":").concat(i,":").concat(r,".m")}static parseProgressFromLog(e){const t=e.match(/Avanzamento:\s*(\d+\.?\d*)%/);return t?parseFloat(t[1]):null}}Eu.progressCallback=null,Eu.abortController=null,Eu.isRunning=!1;const Mu={shyftaLibFolder:"",defaultIterations:1e3,defaultConfidence:.95,defaultConfidenceToggle:!0,lastUsedModelName:"",resultsTimestep:1,percentageErrorTollerance:5,minIterationsForCI:1e3,maxIterationsForRobustness:1e6,stabilityCheckWindow:50,stabilityThreshold:.1,convergenceCheckWindow:20,convergenceThreshold:.15},Tu="shyfta-settings";class Pu{static loadSettings(){try{const e=localStorage.getItem(Tu);if(e){const t=JSON.parse(e);return u(u({},Mu),t)}}catch(e){console.warn("Error loading SHyFTA settings:",e)}return Mu}static saveSettings(e){try{localStorage.setItem(Tu,JSON.stringify(e))}catch(t){console.error("Error saving SHyFTA settings:",t)}}static updateSetting(e,t){const n=this.loadSettings();n[e]=t,this.saveSettings(n)}static resetSettings(){return this.saveSettings(Mu),Mu}static generateDefaultModelName(){const e=new Date,t=e.getDate().toString().padStart(2,"0"),n=(e.getMonth()+1).toString().padStart(2,"0"),a=e.getFullYear(),o=e.getHours().toString().padStart(2,"0"),i=e.getMinutes().toString().padStart(2,"0"),r=e.getSeconds().toString().padStart(2,"0");return"initFaultTree_".concat(t).concat(n).concat(a,"_").concat(o,"_").concat(i,"_").concat(r,".m")}static validateFolderPath(e){if(!e||0===e.trim().length)return!1;return/^[a-zA-Z]:(\\[^\\/:*?"<>|]+)*\\?$|^\/([^/]+\/)*[^/]*$/.test(e.trim())}}const zu=e=>{let{isOpen:t,onClose:n,onConfirm:a,simulationProgress:o=0}=e;if(!t)return null;return(0,Et.jsx)("div",{className:"stop-confirmation-overlay",onClick:n,children:(0,Et.jsxs)("div",{className:"stop-confirmation-modal",onClick:e=>e.stopPropagation(),children:[(0,Et.jsx)("div",{className:"stop-confirmation-header",children:(0,Et.jsx)("h2",{children:"\u26a0\ufe0f Conferma Interruzione"})}),(0,Et.jsxs)("div",{className:"stop-confirmation-content",children:[(0,Et.jsx)("div",{className:"warning-icon",children:"\ud83d\uded1"}),(0,Et.jsxs)("div",{className:"confirmation-message",children:[(0,Et.jsx)("h3",{children:"Sei sicuro di voler interrompere la simulazione?"}),(0,Et.jsx)("div",{className:"simulation-info",children:(0,Et.jsxs)("div",{className:"progress-info",children:[(0,Et.jsx)("span",{className:"label",children:"Progresso attuale:"}),(0,Et.jsxs)("div",{className:"mini-progress-bar",children:[(0,Et.jsx)("div",{className:"mini-progress-fill",style:{width:"".concat(o,"%")}}),(0,Et.jsxs)("span",{className:"progress-text",children:[o.toFixed(1),"%"]})]})]})}),(0,Et.jsxs)("div",{className:"warning-details",children:[(0,Et.jsxs)("p",{children:["\u26a0\ufe0f ",(0,Et.jsx)("strong",{children:"Attenzione:"})]}),(0,Et.jsxs)("ul",{children:[(0,Et.jsx)("li",{children:"La simulazione MATLAB verr\xe0 terminata immediatamente"}),(0,Et.jsx)("li",{children:"I risultati parziali potrebbero essere perduti"}),(0,Et.jsx)("li",{children:"Dovrai riavviare la simulazione dall'inizio"})]})]}),(0,Et.jsx)("div",{className:"recommendation",children:(0,Et.jsxs)("p",{children:["\ud83d\udca1 ",(0,Et.jsx)("strong",{children:"Suggerimento:"})," Se la simulazione sta procedendo normalmente, \xe8 consigliabile attendere il completamento automatico."]})})]})]}),(0,Et.jsxs)("div",{className:"stop-confirmation-actions",children:[(0,Et.jsx)("button",{className:"cancel-button",onClick:n,children:"\u21a9\ufe0f Continua Simulazione"}),(0,Et.jsx)("button",{className:"confirm-stop-button",onClick:()=>{a(),n()},children:"\ud83d\uded1 S\xec, Interrompi"})]})]})})},_u=(0,a.memo)(e=>{let{value:t,placeholder:n}=e;return(0,Et.jsx)("textarea",{value:t,readOnly:!0,rows:6,placeholder:n,style:{fontFamily:"monospace",fontSize:"12px"}})}),Ru=(0,a.memo)(e=>{let{progress:t}=e;return(0,Et.jsxs)("div",{className:"progress-bar",children:[(0,Et.jsx)("div",{className:"progress-fill",style:{width:"".concat(t,"%")}}),(0,Et.jsxs)("span",{className:"progress-text",children:[t.toFixed(1),"%"]})]})}),Au=e=>{let{isOpen:t,onClose:n,faultTreeModel:o,missionTime:i=500,onShowCIResults:r}=e;const l=()=>{Se.current&&(clearTimeout(Se.current),Se.current=null),Eu.resetSimulation(),console.log("\ud83e\uddf9 [SHyFTAModal] Cleanup on close - reset simulation state"),n()},[s,c]=(0,a.useState)(""),[u,d]=(0,a.useState)(1e3),[p,m]=(0,a.useState)(.95),[h,f]=(0,a.useState)(!0),[g,v]=(0,a.useState)(1),[b,y]=(0,a.useState)(5),[x,C]=(0,a.useState)(1e3),[S,w]=(0,a.useState)(1e6),[k,N]=(0,a.useState)(50),[j,E]=(0,a.useState)(.1),[M,T]=(0,a.useState)(20),[P,z]=(0,a.useState)(.15),[_,R]=(0,a.useState)(!1),[A,I]=(0,a.useState)(!1),[D,O]=(0,a.useState)(!1),[F,L]=(0,a.useState)(0),[B,U]=(0,a.useState)(""),[H,W]=(0,a.useState)(""),[V,G]=(0,a.useState)(!1),[Y,X]=(0,a.useState)(!1),[K,q]=(0,a.useState)(!1),[$,J]=(0,a.useState)(!1),[Q,Z]=(0,a.useState)(!1),[ee,te]=(0,a.useState)(!1),[ne,ae]=(0,a.useState)(!1),[oe,ie]=(0,a.useState)(!1),[re,le]=(0,a.useState)(!1),[se,ce]=(0,a.useState)(!1),[ue,de]=(0,a.useState)(!1),[pe,me]=(0,a.useState)(!1),[he,fe]=(0,a.useState)(!1),[ge,ve]=(0,a.useState)(null),[be,ye]=(0,a.useState)(!1),xe=(0,a.useRef)(0),Ce=(0,a.useRef)(""),Se=(0,a.useRef)(null),we=(0,a.useCallback)(e=>{const t=Date.now();L(e.progress),I(e.isRunning),U(e.currentStep);if((e.isCompleted||!1||e.progress>=100&&!e.isRunning)&&!e.isRunning){O(!0);const e=JSON.stringify({events:o.events.length,gates:o.gates.length,connections:o.connections.length,eventsHash:o.events.map(e=>e.id+e.name).join(""),gatesHash:o.gates.map(e=>e.id+e.name).join("")});ve(e),fe(!1),ye(!0),console.log("\u2705 [SHyFTAModal] Simulation completed - model hash saved, retrieve results enabled")}if(e.logOutput)if(Ce.current+=e.logOutput,t-xe.current>500){const e=Ce.current;Ce.current="",xe.current=t,W(t=>{const n=t+e;return n.length>1e4?n.slice(-8e3):n})}else Se.current||(Se.current=setTimeout(()=>{const e=Ce.current;Ce.current="",xe.current=Date.now(),Se.current=null,W(t=>{const n=t+e;return n.length>1e4?n.slice(-8e3):n})},500))},[o]);if((0,a.useEffect)(()=>{const e=JSON.stringify({events:o.events.length,gates:o.gates.length,connections:o.connections.length,eventsHash:o.events.map(e=>e.id+e.name).join(""),gatesHash:o.gates.map(e=>e.id+e.name).join("")});ge&&ge!==e&&(console.log("\ud83d\udd04 [SHyFTAModal] Model changed since last simulation - disabling retrieve results"),fe(!0),q(!1),ye(!1))},[o.events,o.gates,o.connections,ge]),(0,a.useEffect)(()=>{if(t){const e=Pu.loadSettings();e.shyftaLibFolder&&c(e.shyftaLibFolder),d(e.defaultIterations),m(e.defaultConfidence),f(e.defaultConfidenceToggle),v(e.resultsTimestep),void 0!==e.percentageErrorTollerance&&y(e.percentageErrorTollerance),void 0!==e.minIterationsForCI&&C(e.minIterationsForCI),void 0!==e.maxIterationsForRobustness&&w(e.maxIterationsForRobustness),void 0!==e.stabilityCheckWindow&&N(e.stabilityCheckWindow),void 0!==e.stabilityThreshold&&E(e.stabilityThreshold),void 0!==e.convergenceCheckWindow&&T(e.convergenceCheckWindow),void 0!==e.convergenceThreshold&&z(e.convergenceThreshold),Eu.setProgressCallback(we)}return()=>{Se.current&&(clearTimeout(Se.current),Se.current=null),Eu.resetSimulation(),console.log("\ud83e\uddf9 [SHyFTAModal] Cleaned up progress callback and reset simulation state")}},[t,we]),!t)return null;const ke=async()=>{const e={shyftaLibFolder:s,modelName:"ZFTATree.m",iterations:u,confidence:p,confidenceToggle:h,missionTime:i,percentageErrorTollerance:b,minIterationsForCI:x,maxIterationsForRobustness:S,stabilityCheckWindow:k,stabilityThreshold:j,convergenceCheckWindow:M,convergenceThreshold:P},t={shyftaLibFolder:s,defaultIterations:u,defaultConfidence:p,defaultConfidenceToggle:h,lastUsedModelName:"ZFTATree.m",resultsTimestep:g,percentageErrorTollerance:b,minIterationsForCI:x,maxIterationsForRobustness:S,stabilityCheckWindow:k,stabilityThreshold:j,convergenceCheckWindow:M,convergenceThreshold:P};Pu.saveSettings(t),I(!0),O(!1),L(0),W(""),U("Inizializzazione..."),fe(!1),q(!1),ye(!1);try{await Eu.runSimulation(o,e)}catch(n){alert("Errore durante la simulazione: ".concat(n instanceof Error?n.message:"Errore sconosciuto"))}finally{I(!1)}};return(0,Et.jsx)("div",{className:"shyfta-modal-overlay",onClick:l,children:(0,Et.jsxs)("div",{className:"shyfta-modal",onClick:e=>e.stopPropagation(),children:[(0,Et.jsxs)("div",{className:"shyfta-modal-header",children:[(0,Et.jsx)("h2",{children:"\ud83d\udd2c SHyFTA Simulation"}),(0,Et.jsx)("button",{className:"close-button",onClick:l,children:"\xd7"})]}),(0,Et.jsxs)("div",{className:"shyfta-modal-content",children:[(0,Et.jsxs)("div",{className:"config-section",children:[(0,Et.jsx)("h3",{children:"\u2699\ufe0f Configurazione"}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"\ud83d\udcc1 Cartella SHyFTALib:"}),(0,Et.jsx)("div",{className:"folder-input",children:(0,Et.jsx)("input",{type:"text",value:s,onChange:e=>{c(e.target.value),Pu.updateSetting("shyftaLibFolder",e.target.value)},placeholder:"SHyFTALib",disabled:A,className:"folder-name-input"})}),(0,Et.jsxs)("small",{className:"folder-help",children:["\ud83d\udca1 Inserisci il path assoluto della cartella SHyFTALib ",(0,Et.jsx)("br",{})]})]}),(0,Et.jsxs)("div",{className:"form-row",children:[(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"\ud83d\udd04 Iterazioni:"}),(0,Et.jsx)("input",{type:"number",value:u,onChange:e=>{const t=e.target.value;if(""===t||"0"===t)d(1);else{const e=Number(t);!isNaN(e)&&e>=1&&(d(e),Pu.updateSetting("defaultIterations",e))}},min:"1",disabled:A})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsxs)("label",{children:["Approssima con Intervallo di Confidenza",(0,Et.jsx)("span",{className:"info-icon",onClick:()=>J(!0),style:{cursor:"pointer",marginLeft:"8px",fontSize:"14px"},children:"\u2139\ufe0f"})]}),(0,Et.jsxs)("div",{className:"toggle-group",children:[(0,Et.jsxs)("label",{className:"toggle-switch",children:[(0,Et.jsx)("input",{type:"checkbox",checked:h,onChange:e=>{f(e.target.checked),Pu.updateSetting("defaultConfidenceToggle",e.target.checked)},disabled:A}),(0,Et.jsx)("span",{className:"toggle-slider"})]}),(0,Et.jsx)("span",{className:"toggle-status",children:h?"ON":"OFF"})]})]})]}),(0,Et.jsxs)("div",{className:"form-row",children:[(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsxs)("label",{children:["\ud83d\udcca Intervallo di Confidenza:",(0,Et.jsx)("span",{className:"info-icon",onClick:()=>Z(!0),style:{cursor:"pointer",marginLeft:"8px",fontSize:"14px"},children:"\u2139\ufe0f"})]}),(0,Et.jsx)("input",{type:"number",value:p,onChange:e=>{const t=e.target.value;if(""===t||"0"===t)m(.01);else{const e=Number(t);!isNaN(e)&&e>=.01&&e<=.99&&(m(e),Pu.updateSetting("defaultConfidence",e))}},min:"0.01",max:"0.99",step:"0.01",disabled:A||!h}),(0,Et.jsx)("div",{className:"field-help",children:(0,Et.jsxs)("small",{className:"help-text",children:["\ud83d\udccb ",(0,Et.jsx)("strong",{children:"Valori tipici:"}),(0,Et.jsx)("br",{}),"\u2022 ",(0,Et.jsx)("strong",{children:"0.90 (90%)"})," - Standard per analisi generali",(0,Et.jsx)("br",{}),"\u2022 ",(0,Et.jsx)("strong",{children:"0.95 (95%)"})," - Pi\xf9 conservativo, comunemente usato",(0,Et.jsx)("br",{}),"\u2022 ",(0,Et.jsx)("strong",{children:"0.99 (99%)"})," - Molto conservativo per analisi critiche",(0,Et.jsx)("br",{}),"\ud83d\udca1 Pi\xf9 alto = intervallo pi\xf9 ampio ma maggiore confidenza"]})})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsxs)("label",{children:["\ud83d\udcca Tolleranza Errore Percentuale (%):",(0,Et.jsx)("span",{className:"info-icon",onClick:()=>te(!0),style:{cursor:"pointer",marginLeft:"8px",fontSize:"14px"},children:"\u2139\ufe0f"})]}),(0,Et.jsx)("input",{type:"number",value:b,onChange:e=>{const t=e.target.value;if(""===t||"0"===t)y(.1);else{const e=Number(t);!isNaN(e)&&e>=.1&&e<=99.9&&(y(e),Pu.updateSetting("percentageErrorTollerance",e/100))}},min:"0.1",max:"99.9",step:"0.1",disabled:A||!h}),(0,Et.jsx)("div",{className:"field-help",children:(0,Et.jsxs)("small",{className:"help-text",children:["\ud83d\udccb ",(0,Et.jsx)("strong",{children:"Valori tipici:"}),(0,Et.jsx)("br",{}),"\u2022 ",(0,Et.jsx)("strong",{children:"1-2%"})," - Precisione elevata (eventi rari < 0.001)",(0,Et.jsx)("br",{}),"\u2022 ",(0,Et.jsx)("strong",{children:"3-5%"})," - Buona precisione (eventi moderati)",(0,Et.jsx)("br",{}),"\u2022 ",(0,Et.jsx)("strong",{children:"5-10%"})," - Precisione standard per analisi generali",(0,Et.jsx)("br",{}),"\u2022 ",(0,Et.jsx)("strong",{children:"10-20%"})," - Analisi preliminari o eventi comuni",(0,Et.jsx)("br",{}),"\ud83d\udca1 Pi\xf9 basso = maggiore precisione ma pi\xf9 iterazioni"]})})]})]})]}),(0,Et.jsxs)("div",{className:"config-section",children:[(0,Et.jsxs)("h3",{onClick:()=>R(!_),className:"collapsible-header",style:{cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[(0,Et.jsx)("span",{children:_?"\u25bc":"\u25b6"}),"\u2699\ufe0f Simulazione Avanzata"]}),_&&(0,Et.jsxs)("div",{className:"advanced-settings",children:[(0,Et.jsxs)("div",{className:"form-row",children:[(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsxs)("label",{children:["\ud83d\udd04 Min Iterazioni per CI:",(0,Et.jsx)("span",{className:"info-icon",onClick:()=>ae(!0),style:{cursor:"pointer",marginLeft:"8px",fontSize:"14px"},children:"\u2139\ufe0f"})]}),(0,Et.jsx)("input",{type:"number",value:x,onChange:e=>{const t=e.target.value;if(""===t||"0"===t)C(100);else{const e=Number(t);!isNaN(e)&&e>=100&&(C(e),Pu.updateSetting("minIterationsForCI",e))}},min:"100",disabled:A||!h}),(0,Et.jsx)("small",{className:"help-text",children:"Iterazioni minime prima controlli CI"})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsxs)("label",{children:["\ud83d\uded1 Max Iterazioni Robustezza:",(0,Et.jsx)("span",{className:"info-icon",onClick:()=>ie(!0),style:{cursor:"pointer",marginLeft:"8px",fontSize:"14px"},children:"\u2139\ufe0f"})]}),(0,Et.jsx)("input",{type:"number",value:S,onChange:e=>{const t=e.target.value;if(""===t||"0"===t)w(1e4);else{const e=Number(t);!isNaN(e)&&e>=1e4&&(w(e),Pu.updateSetting("maxIterationsForRobustness",e))}},min:"10000",disabled:A||!h}),(0,Et.jsx)("small",{className:"help-text",children:"Limite massimo iterazioni"})]})]}),(0,Et.jsxs)("div",{className:"form-row",children:[(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsxs)("label",{children:["\ud83d\udccf Finestra Controllo Stabilit\xe0:",(0,Et.jsx)("span",{className:"info-icon",onClick:()=>le(!0),style:{cursor:"pointer",marginLeft:"8px",fontSize:"14px"},children:"\u2139\ufe0f"})]}),(0,Et.jsx)("input",{type:"number",value:k,onChange:e=>{const t=e.target.value;if(""===t||"0"===t)N(10);else{const e=Number(t);!isNaN(e)&&e>=10&&(N(e),Pu.updateSetting("stabilityCheckWindow",e))}},min:"10",disabled:A||!h}),(0,Et.jsx)("small",{className:"help-text",children:"Finestra per controlli stabilit\xe0"})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsxs)("label",{children:["\ud83c\udfaf Soglia Stabilit\xe0:",(0,Et.jsx)("span",{className:"info-icon",onClick:()=>ce(!0),style:{cursor:"pointer",marginLeft:"8px",fontSize:"14px"},children:"\u2139\ufe0f"})]}),(0,Et.jsx)("input",{type:"number",value:j,onChange:e=>{const t=e.target.value;if(""===t||"0"===t)E(.01);else{const e=Number(t);!isNaN(e)&&e>=.01&&e<=1&&(E(e),Pu.updateSetting("stabilityThreshold",e))}},min:"0.01",max:"1.0",step:"0.01",disabled:A||!h}),(0,Et.jsx)("small",{className:"help-text",children:"Soglia per controlli stabilit\xe0"})]})]}),(0,Et.jsxs)("div",{className:"form-row",children:[(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsxs)("label",{children:["\ud83d\udcd0 Finestra Convergenza CI:",(0,Et.jsx)("span",{className:"info-icon",onClick:()=>de(!0),style:{cursor:"pointer",marginLeft:"8px",fontSize:"14px"},children:"\u2139\ufe0f"})]}),(0,Et.jsx)("input",{type:"number",value:M,onChange:e=>{const t=e.target.value;if(""===t||"0"===t)T(5);else{const e=Number(t);!isNaN(e)&&e>=5&&(T(e),Pu.updateSetting("convergenceCheckWindow",e))}},min:"5",disabled:A||!h}),(0,Et.jsx)("small",{className:"help-text",children:"Finestra per controlli convergenza"})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsxs)("label",{children:["\ud83d\udd0d Soglia Convergenza:",(0,Et.jsx)("span",{className:"info-icon",onClick:()=>me(!0),style:{cursor:"pointer",marginLeft:"8px",fontSize:"14px"},children:"\u2139\ufe0f"})]}),(0,Et.jsx)("input",{type:"number",value:P,onChange:e=>{const t=e.target.value;if(""===t||"0"===t)z(.01);else{const e=Number(t);!isNaN(e)&&e>=.01&&e<=1&&(z(e),Pu.updateSetting("convergenceThreshold",e))}},min:"0.01",max:"1.0",step:"0.01",disabled:A||!h}),(0,Et.jsx)("small",{className:"help-text",children:"Soglia per controlli convergenza CI"})]})]})]})]}),(A||D)&&(0,Et.jsxs)("div",{className:"progress-section",children:[(0,Et.jsx)("h3",{children:A?"\ud83d\udd04 Simulazione Automatica in Corso":"\u2705 Simulazione Completata"}),(0,Et.jsxs)("div",{className:"progress-info",children:[(0,Et.jsx)("div",{className:"current-step",children:D?"Simulazione completata con successo!":B}),(0,Et.jsx)(Ru,{progress:F})]}),(0,Et.jsxs)("div",{className:"log-output",children:[(0,Et.jsxs)("div",{className:"log-header",children:[(0,Et.jsx)("h4",{children:"\ud83d\udcdd Output Log:"}),D&&(0,Et.jsx)("button",{className:"close-log-button",onClick:()=>{O(!1),L(0),U(""),W("")},children:"\u2716\ufe0f Chiudi Log"})]}),(0,Et.jsx)(_u,{value:H,placeholder:"I log della simulazione appariranno qui..."})]})]}),(0,Et.jsxs)("div",{className:"config-section",children:[(0,Et.jsx)("h3",{children:"\ud83d\udcca Configurazione Analisi Risultati"}),(0,Et.jsx)("div",{className:"form-row",children:(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"\u23f1\ufe0f Timestep Analisi:"}),(0,Et.jsx)("input",{type:"number",value:g,onChange:e=>{const t=e.target.value;if(""===t||"0"===t)v(.01);else{const e=Number(t);!isNaN(e)&&e>=.01&&(v(e),Pu.updateSetting("resultsTimestep",e))}},min:"0.01",step:"0.1",disabled:A}),(0,Et.jsx)("small",{className:"help-text",children:"Delta temporale per calcoli PDF/CDF (ore)"})]})})]}),(0,Et.jsxs)("div",{className:"model-info",children:[(0,Et.jsx)("h3",{children:"\ud83d\udccb Informazioni Modello"}),(0,Et.jsxs)("div",{className:"info-grid",children:[(0,Et.jsxs)("div",{className:"info-item",children:[(0,Et.jsx)("span",{className:"info-label",children:"Eventi Base:"}),(0,Et.jsx)("span",{className:"info-value",children:o.events.length})]}),(0,Et.jsxs)("div",{className:"info-item",children:[(0,Et.jsx)("span",{className:"info-label",children:"Porte:"}),(0,Et.jsx)("span",{className:"info-value",children:o.gates.length})]}),(0,Et.jsxs)("div",{className:"info-item",children:[(0,Et.jsx)("span",{className:"info-label",children:"Connessioni:"}),(0,Et.jsx)("span",{className:"info-value",children:o.connections.length})]}),(0,Et.jsxs)("div",{className:"info-item",children:[(0,Et.jsx)("span",{className:"info-label",children:"Mission Time:"}),(0,Et.jsxs)("span",{className:"info-value",children:[i,"h"]})]})]})]})]}),(0,Et.jsxs)("div",{className:"shyfta-modal-actions",children:[(0,Et.jsx)("button",{className:"cancel-button",onClick:l,disabled:A,children:A?"Chiudi quando completato":"Chiudi"}),!A&&(0,Et.jsx)("button",{className:"test-button ".concat(!be||he?"disabled":""),onClick:be&&!he?async()=>{console.log("\ud83e\uddea [DEBUG] Testing results loading manually..."),X(!0);console.log("\ud83d\udcc1 Testing with path: ".concat("C:/SHyFTOO/output/results.mat"));try{await nu.loadResultsAfterSimulation("C:/SHyFTOO",o.events,o.gates,i,u,{timestep:g})?(q(!0),alert("\u2705 Real results loaded from results.mat! Check console and components for actual data.")):(q(!1),alert("\u274c Failed to load results - check console for details."))}catch(e){console.error("Error during test:",e),alert("\u274c Error: ".concat(e))}finally{X(!1)}}:void 0,title:be?he?"Il modello \xe8 cambiato dall'ultima simulazione. Esegui una nuova simulazione per abilitare il retrieve dei risultati.":"Carica risultati simulazione dal file results.mat":"Completa prima una simulazione SHyFTA per abilitare il caricamento dei risultati",disabled:Y||!be||he,children:Y?(0,Et.jsx)("span",{children:"\u23f3 Loading..."}):(0,Et.jsx)("span",{children:"\ud83d\udd0d Retrieve Results"})}),!A&&r&&(e=>{const t=nu.getCurrentResults(),n=(null===t||void 0===t?void 0:t.ciHistory)&&t.ciHistory.length>0,a=be&&!he&&K&&n;return console.log("\ud83e\udd2c [SHyFTA CI Button Debug]",{hasSimulationResults:be,modelChangedSinceLastRun:he,resultsLoaded:K,simulationResults:!!t,ciHistory:null===t||void 0===t?void 0:t.ciHistory,ciHistoryLength:(null===t||void 0===t||null===(e=t.ciHistory)||void 0===e?void 0:e.length)||0,hasCIData:n,isEnabled:a}),(0,Et.jsx)("button",{className:"test-button ".concat(a?"":"disabled"),onClick:a?r:void 0,disabled:!a,title:be?he?"Il modello \xe8 cambiato. Esegui una nuova simulazione per abilitare l'analisi CI.":K?n?"Visualizza analisi confidence interval della simulazione":"Nessun dato CI trovato. Abilita 'Approssima con intervallo di confidenza' e riesegui la simulazione.":"Premi prima 'Retrieve Results' per caricare i risultati della simulazione":"Esegui prima una simulazione SHyFTA per abilitare l'analisi CI",children:"\ud83d\udcc8 CI Analysis"})})(),!A&&!D&&(0,Et.jsx)("button",{className:"run-button primary",onClick:ke,disabled:!s,children:"\ud83d\ude80 Run SHyFTA"}),!A&&D&&(0,Et.jsx)("button",{className:"run-button primary",onClick:()=>{O(!1),L(0),U(""),W(""),ke()},disabled:!s,children:"\ud83d\udd04 Esegui Nuovamente"}),A&&(0,Et.jsx)("button",{className:"stop-button",onClick:()=>{G(!0)},children:"\u23f9\ufe0f Ferma Simulazione"})]}),(0,Et.jsx)(zu,{isOpen:V,onClose:()=>G(!1),onConfirm:async()=>{await Eu.stopSimulation(),G(!1)},simulationProgress:F}),$&&(0,Et.jsx)("div",{className:"modal-overlay",onClick:()=>J(!1),children:(0,Et.jsxs)("div",{className:"convergence-info-modal",onClick:e=>e.stopPropagation(),children:[(0,Et.jsxs)("div",{className:"modal-header",children:[(0,Et.jsx)("h2",{children:"\ud83d\udcca Criteri di Convergenza per Intervalli di Confidenza"}),(0,Et.jsx)("button",{className:"close-button",onClick:()=>J(!1),children:"\xd7"})]}),(0,Et.jsxs)("div",{className:"modal-body",children:[(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83d\udcca APPROSSIMA CON INTERVALLO DI CONFIDENZA"}),(0,Et.jsxs)("p",{children:["Questa modalit\xe0 attiva l'algoritmo Monte Carlo con ",(0,Et.jsx)("strong",{children:"criteri di convergenza automatici"}),"che fermano la simulazione quando viene raggiunta la precisione desiderata. Per informazioni dettagliate su ogni singolo parametro, clicca sull'icona \u2139\ufe0f accanto al parametro."]})]}),(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83d\udd04 REGOLE DI STOP DELLA SIMULAZIONE"}),(0,Et.jsxs)("div",{className:"criterion-detail",children:[(0,Et.jsx)("h4",{children:"\ud83d\udccb Opzione 1: CONVERGENZA RAGGIUNTA"}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Criterio Principale"})," soddisfatto + ",(0,Et.jsx)("strong",{children:"almeno 2 dei 3 criteri di supporto"})," soddisfatti"]}),(0,Et.jsx)("h4",{children:"\ud83d\udccb Opzione 2: ITERAZIONI COMPLETATE"}),(0,Et.jsxs)("p",{children:["Raggiunto il limite di ",(0,Et.jsx)("strong",{children:"Iterazioni Massime"})," anche se non converge"]}),(0,Et.jsx)("h4",{children:"\ud83d\udccb Protezione Minima"}),(0,Et.jsxs)("p",{children:["La verifica dei criteri inizia solo dopo ",(0,Et.jsxs)("strong",{children:["Iterazioni Minime CI: ",x.toLocaleString()]})]})]})]}),(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83c\udf9b\ufe0f OTTIMIZZAZIONE DEI PARAMETRI"}),(0,Et.jsxs)("div",{className:"criterion-detail",children:[(0,Et.jsx)("h4",{children:"\ud83c\udfaf Per Eventi Rari (probabilit\xe0 < 0.001)"}),(0,Et.jsxs)("p",{children:["\u2022 Tolleranza Errore: 1-2%",(0,Et.jsx)("br",{}),"\u2022 Soglia Convergenza: 10-15%",(0,Et.jsx)("br",{}),"\u2022 Soglia Stabilit\xe0: 5-10%"]}),(0,Et.jsx)("h4",{children:"\ud83c\udfaf Per Eventi Moderati (probabilit\xe0 0.001-0.1)"}),(0,Et.jsxs)("p",{children:["\u2022 Tolleranza Errore: 3-5%",(0,Et.jsx)("br",{}),"\u2022 Soglia Convergenza: 15-20%",(0,Et.jsx)("br",{}),"\u2022 Soglia Stabilit\xe0: 10-15%"]}),(0,Et.jsx)("h4",{children:"\ud83c\udfaf Per Analisi Veloci"}),(0,Et.jsxs)("p",{children:["\u2022 Tolleranza Errore: 5-10%",(0,Et.jsx)("br",{}),"\u2022 Iterazioni Minime CI: 500",(0,Et.jsx)("br",{}),"\u2022 Finestra Stabilit\xe0: 30"]})]})]}),(0,Et.jsxs)("div",{className:"info-section copy-section",children:[(0,Et.jsx)("h3",{children:"\ud83d\udcdd TESTO PER HARMONY LLM"}),(0,Et.jsxs)("div",{className:"copy-text",children:[(0,Et.jsx)("textarea",{readOnly:!0,value:"Spiegami in dettaglio l'algoritmo di convergenza per simulazioni Monte Carlo con intervalli di confidenza. Il sistema usa 4 criteri basati sui seguenti parametri configurabili:\n\nPARAMETRI CONFIGURABILI:\n- Intervallo di Confidenza: ".concat((100*p).toFixed(0),"%\n- Tolleranza Errore Percentuale: ").concat(b,"%\n- Iterazioni Minime CI: ").concat(x.toLocaleString(),"\n- Iterazioni Massime: ").concat(u.toLocaleString(),"\n- Soglia Convergenza: ").concat((100*P).toFixed(1),"%\n- Soglia Stabilit\xe0: ").concat((100*j).toFixed(1),"%\n- Finestra Controllo Stabilit\xe0: ").concat(k," iterazioni\n- Finestra Controllo Convergenza: ").concat(M," iterazioni\n\nI 4 CRITERI SONO:\n1. Precision CI: confronta larghezza intervallo confidenza con errore accettabile\n2. Precision Relative: errore relativo vs soglia convergenza\n3. Robustness Statistical: stabilit\xe0 errore standard vs soglia stabilit\xe0\n4. Stability Temporal: stabilit\xe0 stime nelle ultime iterazioni\n\nSpiegami come questi parametri influenzano ciascun criterio, come ottimizzarli per eventi rari vs comuni, e perch\xe9 la simulazione si ferma quando criterio principale + 2/3 supporto sono soddisfatti vs limite iterazioni."),onClick:e=>e.target.select()}),(0,Et.jsx)("p",{className:"copy-hint",children:"\ud83d\udc46 Clicca per selezionare tutto il testo e copiarlo"})]})]})]}),(0,Et.jsx)("div",{className:"modal-footer",children:(0,Et.jsx)("button",{className:"close-modal-button",onClick:()=>J(!1),children:"Chiudi"})})]})}),Q&&(0,Et.jsx)("div",{className:"modal-overlay",onClick:()=>Z(!1),children:(0,Et.jsxs)("div",{className:"parameter-info-modal",onClick:e=>e.stopPropagation(),children:[(0,Et.jsxs)("div",{className:"modal-header",children:[(0,Et.jsx)("h2",{children:"\ud83d\udcca Intervallo di Confidenza"}),(0,Et.jsx)("button",{className:"close-button",onClick:()=>Z(!1),children:"\xd7"})]}),(0,Et.jsxs)("div",{className:"modal-body",children:[(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83c\udfaf Cosa rappresenta"}),(0,Et.jsxs)("p",{children:["L'",(0,Et.jsx)("strong",{children:"Intervallo di Confidenza"})," definisce il livello di certezza statistica per l'approssimazione della probabilit\xe0 del Top Event. Un valore di 0.95 (95%) significa che c'\xe8 il 95% di probabilit\xe0 che il valore reale sia compreso nell'intervallo calcolato."]})]}),(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83d\udccb Valori tipici"}),(0,Et.jsxs)("div",{className:"criterion-detail",children:[(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"\u2022 0.90 (90%)"})," - Standard per analisi generali"]}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"\u2022 0.95 (95%)"})," - Pi\xf9 conservativo, comunemente usato"]}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"\u2022 0.99 (99%)"})," - Molto conservativo per analisi critiche"]})]})]}),(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83d\udca1 Come scegliere"}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Pi\xf9 alto = maggiore confidenza ma intervalli pi\xf9 ampi"}),(0,Et.jsx)("br",{}),"\u2022 Per analisi preliminari: 90%",(0,Et.jsx)("br",{}),"\u2022 Per studi di sicurezza: 95%",(0,Et.jsx)("br",{}),"\u2022 Per sistemi critici: 99%"]})]})]}),(0,Et.jsx)("div",{className:"modal-footer",children:(0,Et.jsx)("button",{className:"close-modal-button",onClick:()=>Z(!1),children:"Chiudi"})})]})}),ee&&(0,Et.jsx)("div",{className:"modal-overlay",onClick:()=>te(!1),children:(0,Et.jsxs)("div",{className:"parameter-info-modal",onClick:e=>e.stopPropagation(),children:[(0,Et.jsxs)("div",{className:"modal-header",children:[(0,Et.jsx)("h2",{children:"\ud83d\udcca Tolleranza Errore Percentuale "}),(0,Et.jsx)("button",{className:"close-button",onClick:()=>te(!1),children:"\xd7"})]}),(0,Et.jsxs)("div",{className:"modal-body",children:[(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83c\udfaf Cosa rappresenta"}),(0,Et.jsxs)("p",{children:["La ",(0,Et.jsx)("strong",{children:"Tolleranza Errore Percentuale"})," definisce l'errore massimo accettabile come percentuale del valore stimato. Questo parametro controlla la precisione dell'approssimazione Monte Carlo."]})]}),(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83d\udccb Valori tipici per tipo di evento"}),(0,Et.jsxs)("div",{className:"criterion-detail",children:[(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"\u2022 1-2%"})," - Precisione elevata per eventi rari (< 0.001)"]}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"\u2022 3-5%"})," - Buona precisione per eventi moderati"]}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"\u2022 5-10%"})," - Precisione standard per analisi generali"]}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"\u2022 10-20%"})," - Analisi preliminari o eventi comuni"]})]})]}),(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83d\udca1 Impatto sulla simulazione"}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Pi\xf9 basso = maggiore precisione ma pi\xf9 iterazioni richieste"}),(0,Et.jsx)("br",{}),"Se la probabilit\xe0 stimata \xe8 0.001 e la tolleranza \xe8 5%:",(0,Et.jsx)("br",{}),"\u2022 Errore accettabile = 0.001 \xd7 0.05 = 0.00005",(0,Et.jsx)("br",{}),"\u2022 L'intervallo di confidenza deve essere \u2264 0.00005"]})]})]}),(0,Et.jsx)("div",{className:"modal-footer",children:(0,Et.jsx)("button",{className:"close-modal-button",onClick:()=>te(!1),children:"Chiudi"})})]})}),ne&&(0,Et.jsx)("div",{className:"modal-overlay",onClick:()=>ae(!1),children:(0,Et.jsxs)("div",{className:"parameter-info-modal",onClick:e=>e.stopPropagation(),children:[(0,Et.jsxs)("div",{className:"modal-header",children:[(0,Et.jsx)("h2",{children:"\ud83d\udd04 Min Iterazioni per CI"}),(0,Et.jsx)("button",{className:"close-button",onClick:()=>ae(!1),children:"\xd7"})]}),(0,Et.jsxs)("div",{className:"modal-body",children:[(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83c\udfaf Cosa rappresenta"}),(0,Et.jsxs)("p",{children:["Le ",(0,Et.jsx)("strong",{children:"Iterazioni Minime per CI"})," definiscono il numero minimo di simulazioni Monte Carlo da eseguire prima di iniziare a controllare i criteri di convergenza degli intervalli di confidenza."]})]}),(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83d\udccb Perch\xe9 serve"}),(0,Et.jsxs)("div",{className:"criterion-detail",children:[(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Stabilit\xe0 Statistica:"})," Con poche iterazioni gli intervalli sono instabili"]}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Prevenzione Stop Prematuro:"})," Evita che la simulazione si fermi troppo presto"]}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Qualit\xe0 Risultati:"})," Garantisce una base statistica solida"]})]})]}),(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83d\udca1 Valori consigliati"}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"\u2022 500-1000:"})," Per analisi veloci",(0,Et.jsx)("br",{}),(0,Et.jsx)("strong",{children:"\u2022 1000-2000:"})," Standard per la maggior parte dei casi",(0,Et.jsx)("br",{}),(0,Et.jsx)("strong",{children:"\u2022 2000-5000:"})," Per eventi molto rari o analisi critiche"]})]})]}),(0,Et.jsx)("div",{className:"modal-footer",children:(0,Et.jsx)("button",{className:"close-modal-button",onClick:()=>ae(!1),children:"Chiudi"})})]})}),oe&&(0,Et.jsx)("div",{className:"modal-overlay",onClick:()=>ie(!1),children:(0,Et.jsxs)("div",{className:"parameter-info-modal",onClick:e=>e.stopPropagation(),children:[(0,Et.jsxs)("div",{className:"modal-header",children:[(0,Et.jsx)("h2",{children:"\ud83d\uded1 Max Iterazioni Robustezza"}),(0,Et.jsx)("button",{className:"close-button",onClick:()=>ie(!1),children:"\xd7"})]}),(0,Et.jsxs)("div",{className:"modal-body",children:[(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83c\udfaf Cosa rappresenta"}),(0,Et.jsxs)("p",{children:["Il ",(0,Et.jsx)("strong",{children:"Limite Massimo di Iterazioni"})," impedisce che la simulazione Monte Carlo continui indefinitamente se i criteri di convergenza non vengono mai raggiunti."]})]}),(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83d\udccb Quando entra in gioco"}),(0,Et.jsxs)("div",{className:"criterion-detail",children:[(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Protezione Timeout:"})," Ferma simulazioni che non convergono"]}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Eventi Molto Rari:"})," Per probabilit\xe0 < 10\u207b\u2076 pu\xf2 servire molto tempo"]}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Modelli Complessi:"})," Alberi con molti elementi richiedono pi\xf9 iterazioni"]})]})]}),(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83d\udca1 Valori consigliati"}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"\u2022 100,000:"})," Per modelli semplici e analisi veloci",(0,Et.jsx)("br",{}),(0,Et.jsx)("strong",{children:"\u2022 500,000:"})," Standard per la maggior parte dei casi",(0,Et.jsx)("br",{}),(0,Et.jsx)("strong",{children:"\u2022 1,000,000+:"})," Per eventi estremamente rari o modelli molto complessi"]})]})]}),(0,Et.jsx)("div",{className:"modal-footer",children:(0,Et.jsx)("button",{className:"close-modal-button",onClick:()=>ie(!1),children:"Chiudi"})})]})}),re&&(0,Et.jsx)("div",{className:"modal-overlay",onClick:()=>le(!1),children:(0,Et.jsxs)("div",{className:"parameter-info-modal",onClick:e=>e.stopPropagation(),children:[(0,Et.jsxs)("div",{className:"modal-header",children:[(0,Et.jsx)("h2",{children:"\ud83d\udccf Finestra Controllo Stabilit\xe0"}),(0,Et.jsx)("button",{className:"close-button",onClick:()=>le(!1),children:"\xd7"})]}),(0,Et.jsxs)("div",{className:"modal-body",children:[(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83c\udfaf Cosa rappresenta"}),(0,Et.jsxs)("p",{children:["La ",(0,Et.jsx)("strong",{children:"Finestra di Controllo Stabilit\xe0"})," definisce su quante iterazioni consecutive valutare la stabilit\xe0 temporale della stima di probabilit\xe0."]})]}),(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83d\udccb Come funziona"}),(0,Et.jsxs)("div",{className:"criterion-detail",children:[(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Controllo Oscillazioni:"})," Verifica che la probabilit\xe0 non oscilli troppo"]}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Stabilit\xe0 Temporale:"})," Uno dei 4 criteri di convergenza"]}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Finestra Mobile:"})," Si sposta con le ultime N iterazioni"]})]})]}),(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83d\udca1 Esempio pratico"}),(0,Et.jsxs)("p",{children:["Con finestra = 50 iterazioni:",(0,Et.jsx)("br",{}),"\u2022 Controlla le ultime 50 stime di probabilit\xe0",(0,Et.jsx)("br",{}),"\u2022 Se oscillano entro \xb12% \u2192 stabile",(0,Et.jsx)("br",{}),"\u2022 Se oscillano >20% \u2192 instabile",(0,Et.jsx)("br",{}),(0,Et.jsx)("strong",{children:"Valori tipici:"})," 20-100 iterazioni"]})]})]}),(0,Et.jsx)("div",{className:"modal-footer",children:(0,Et.jsx)("button",{className:"close-modal-button",onClick:()=>le(!1),children:"Chiudi"})})]})}),se&&(0,Et.jsx)("div",{className:"modal-overlay",onClick:()=>ce(!1),children:(0,Et.jsxs)("div",{className:"parameter-info-modal",onClick:e=>e.stopPropagation(),children:[(0,Et.jsxs)("div",{className:"modal-header",children:[(0,Et.jsx)("h2",{children:"\ud83c\udfaf Soglia Stabilit\xe0"}),(0,Et.jsx)("button",{className:"close-button",onClick:()=>ce(!1),children:"\xd7"})]}),(0,Et.jsxs)("div",{className:"modal-body",children:[(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83c\udfaf Cosa rappresenta"}),(0,Et.jsxs)("p",{children:["La ",(0,Et.jsx)("strong",{children:"Soglia di Stabilit\xe0"})," definisce la variazione percentuale massima accettabile dell'errore standard nelle iterazioni recenti per considerare la simulazione statisticamente robusta."]})]}),(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83d\udccb Come funziona"}),(0,Et.jsxs)("div",{className:"criterion-detail",children:[(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Criterio Robustezza:"})," Uno dei 4 criteri di convergenza"]}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Controllo Errore Standard:"})," Verifica che \u03c3 non vari troppo"]}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Stabilit\xe0 Statistica:"})," Indica affidabilit\xe0 dei risultati"]})]})]}),(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83d\udca1 Esempio pratico"}),(0,Et.jsxs)("p",{children:["Con soglia = 10%:",(0,Et.jsx)("br",{}),"\u2022 Se l'errore standard varia del 5% \u2192 \u2705 stabile",(0,Et.jsx)("br",{}),"\u2022 Se l'errore standard varia del 15% \u2192 \u274c instabile",(0,Et.jsx)("br",{}),(0,Et.jsx)("strong",{children:"Valori tipici:"})," 5-20% (default: 10%)"]})]})]}),(0,Et.jsx)("div",{className:"modal-footer",children:(0,Et.jsx)("button",{className:"close-modal-button",onClick:()=>ce(!1),children:"Chiudi"})})]})}),ue&&(0,Et.jsx)("div",{className:"modal-overlay",onClick:()=>de(!1),children:(0,Et.jsxs)("div",{className:"parameter-info-modal",onClick:e=>e.stopPropagation(),children:[(0,Et.jsxs)("div",{className:"modal-header",children:[(0,Et.jsx)("h2",{children:"\ud83d\udcd0 Finestra Convergenza CI"}),(0,Et.jsx)("button",{className:"close-button",onClick:()=>de(!1),children:"\xd7"})]}),(0,Et.jsxs)("div",{className:"modal-body",children:[(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83c\udfaf Cosa rappresenta"}),(0,Et.jsxs)("p",{children:["La ",(0,Et.jsx)("strong",{children:"Finestra di Convergenza CI"})," definisce su quante iterazioni consecutive controllare la convergenza dell'ampiezza dell'intervallo di confidenza."]})]}),(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83d\udccb Come funziona"}),(0,Et.jsxs)("div",{className:"criterion-detail",children:[(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Controllo Precisione:"})," Verifica convergenza dell'intervallo di confidenza"]}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Criterio Supporto:"})," Uno dei 3 criteri di supporto alla convergenza"]}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Ampiezza CI:"})," Controlla che l'intervallo si stia restringendo"]})]})]}),(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83d\udca1 Valori consigliati"}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"\u2022 10-20:"})," Per controlli frequenti ma meno stabili",(0,Et.jsx)("br",{}),(0,Et.jsx)("strong",{children:"\u2022 20-50:"})," Buon compromesso stabilit\xe0/reattivit\xe0 (default: 20)",(0,Et.jsx)("br",{}),(0,Et.jsx)("strong",{children:"\u2022 50-100:"})," Per controlli pi\xf9 stabili ma meno frequenti"]})]})]}),(0,Et.jsx)("div",{className:"modal-footer",children:(0,Et.jsx)("button",{className:"close-modal-button",onClick:()=>de(!1),children:"Chiudi"})})]})}),pe&&(0,Et.jsx)("div",{className:"modal-overlay",onClick:()=>me(!1),children:(0,Et.jsxs)("div",{className:"parameter-info-modal",onClick:e=>e.stopPropagation(),children:[(0,Et.jsxs)("div",{className:"modal-header",children:[(0,Et.jsx)("h2",{children:"\ud83d\udd0d Soglia Convergenza"}),(0,Et.jsx)("button",{className:"close-button",onClick:()=>me(!1),children:"\xd7"})]}),(0,Et.jsxs)("div",{className:"modal-body",children:[(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83c\udfaf Cosa rappresenta"}),(0,Et.jsxs)("p",{children:["La ",(0,Et.jsx)("strong",{children:"Soglia di Convergenza"})," definisce l'errore relativo massimo accettabile dell'intervallo di confidenza rispetto alla stima di probabilit\xe0 per il criterio di precisione relativa."]})]}),(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83d\udccb Come funziona"}),(0,Et.jsxs)("div",{className:"criterion-detail",children:[(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Precisione Relativa:"})," Uno dei 4 criteri di convergenza"]}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Calcolo:"})," (CI_max - CI_min) / probabilit\xe0_stimata"]}),(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Controllo Qualit\xe0:"})," Verifica che l'intervallo sia proporzionalmente stretto"]})]})]}),(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h3",{children:"\ud83d\udca1 Esempio pratico"}),(0,Et.jsxs)("p",{children:["Con soglia = 15% e probabilit\xe0 = 0.01:",(0,Et.jsx)("br",{}),"\u2022 Se CI = [0.008, 0.012] \u2192 errore = 40% \u2192 \u274c non converge",(0,Et.jsx)("br",{}),"\u2022 Se CI = [0.0098, 0.0102] \u2192 errore = 4% \u2192 \u2705 converge",(0,Et.jsx)("br",{}),(0,Et.jsx)("strong",{children:"Valori tipici:"})," 10-25% (default: 15%)"]})]})]}),(0,Et.jsx)("div",{className:"modal-footer",children:(0,Et.jsx)("button",{className:"close-modal-button",onClick:()=>me(!1),children:"Chiudi"})})]})})]})})},Iu=e=>{let{isOpen:t,onClose:n,onConfirm:a,title:o,message:i,confirmText:r="Conferma",cancelText:l="Annulla",confirmButtonClass:s="confirm-button"}=e;if(!t)return null;return(0,Et.jsx)("div",{className:"confirmation-modal-overlay",onClick:n,children:(0,Et.jsxs)("div",{className:"confirmation-modal",onClick:e=>e.stopPropagation(),children:[(0,Et.jsxs)("div",{className:"confirmation-modal-header",children:[(0,Et.jsx)("h2",{children:o}),(0,Et.jsx)("button",{className:"close-button",onClick:n,children:"\xd7"})]}),(0,Et.jsxs)("div",{className:"confirmation-modal-content",children:[(0,Et.jsx)("div",{className:"warning-icon",children:"\u26a0\ufe0f"}),(0,Et.jsx)("p",{className:"confirmation-message",children:i})]}),(0,Et.jsxs)("div",{className:"confirmation-modal-actions",children:[(0,Et.jsx)("button",{className:"".concat(s," primary"),onClick:()=>{a(),n()},children:r}),(0,Et.jsx)("button",{className:"cancel-button",onClick:n,children:l})]})]})})},Du={mobile:768,tablet:1024},Ou=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Du;const[t,n]=(0,a.useState)("desktop");return(0,a.useEffect)(()=>{const t=()=>{const t=window.innerWidth;t<e.mobile?n("mobile"):t<e.tablet?n("tablet"):n("desktop")};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[e]),t},Fu=e=>{let t="// Dynamic Fault Tree Code\n\n";return t+="// EVENTI BASE\n",e.events.forEach(e=>{if(t+="BaseEvent ".concat(e.name," {\n"),t+='  id: "'.concat(e.id,'"\n'),e.description&&(t+='  description: "'.concat(e.description,'"\n')),e.failureRate&&(t+="  failureRate: ".concat(e.failureRate,"\n")),e.failureProbabilityDistribution){switch(t+="  failureProbabilityDistribution: {\n",t+='    type: "'.concat(e.failureProbabilityDistribution.type,'"\n'),e.failureProbabilityDistribution.type){case"exponential":t+="    lambda: ".concat(e.failureProbabilityDistribution.lambda," // h\u207b\xb9\n");break;case"weibull":t+="    k: ".concat(e.failureProbabilityDistribution.k," // adimensionale\n"),t+="    lambda: ".concat(e.failureProbabilityDistribution.lambda," // h\n"),t+="    mu: ".concat(e.failureProbabilityDistribution.mu," // h\n");break;case"normal":t+="    mu: ".concat(e.failureProbabilityDistribution.mu," // h\n"),t+="    sigma: ".concat(e.failureProbabilityDistribution.sigma," // h\n");break;case"constant":t+="    probability: ".concat(e.failureProbabilityDistribution.probability," // adimensionale\n")}t+="  }\n"}if(e.repairProbabilityDistribution){switch(t+="  repairProbabilityDistribution: {\n",t+='    type: "'.concat(e.repairProbabilityDistribution.type,'"\n'),e.repairProbabilityDistribution.type){case"exponential":t+="    lambda: ".concat(e.repairProbabilityDistribution.lambda," // h\u207b\xb9\n");break;case"weibull":t+="    k: ".concat(e.repairProbabilityDistribution.k," // adimensionale\n"),t+="    lambda: ".concat(e.repairProbabilityDistribution.lambda," // h\n"),t+="    mu: ".concat(e.repairProbabilityDistribution.mu," // h\n");break;case"normal":t+="    mu: ".concat(e.repairProbabilityDistribution.mu," // h\n"),t+="    sigma: ".concat(e.repairProbabilityDistribution.sigma," // h\n");break;case"constant":t+="    probability: ".concat(e.repairProbabilityDistribution.probability," // adimensionale\n")}t+="  }\n"}e.parameters&&Object.entries(e.parameters).forEach(e=>{let[n,a]=e;t+="  ".concat(n,": ").concat(JSON.stringify(a),"\n")}),t+="}\n\n"}),t+="// PORTE\n",e.gates.forEach(e=>{t+="Gate ".concat(e.name," {\n"),t+='  id: "'.concat(e.id,'"\n'),t+='  type: "'.concat(e.gateType,'"\n'),e.description&&(t+='  description: "'.concat(e.description,'"\n')),e.inputs.length>0&&(t+="  inputs: [".concat(e.inputs.map(e=>'"'.concat(e,'"')).join(", "),"]\n")),e.parameters&&Object.entries(e.parameters).forEach(e=>{let[n,a]=e;t+="  ".concat(n,": ").concat(JSON.stringify(a),"\n")}),t+="}\n\n"}),e.connections.length>0&&(t+="// CONNESSIONI\n",e.connections.forEach(e=>{t+="Connection: ".concat(e.source," -> ").concat(e.target,"\n")})),t},Lu=()=>{const e=fe(),{showLLMConfigModal:t,setShowLLMConfigModal:n,updateLLMConfig:o}=Tt(),{saveFaultTreeSnapshot:i,getFaultTreeSnapshot:r,clearSnapshots:l,saveFaultTreeOpenedFile:s,getFaultTreeOpenedFile:c}=Rt(),{isDarkMode:d,toggleDarkMode:p}=Dt(),{isRightPanelCollapsed:m,toggleRightPanel:h}=Lt(),[f,g]=(0,a.useState)({events:[],gates:[],connections:[]}),[v,b]=(0,a.useState)(null),[y,x]=(0,a.useState)(!1),[C,S]=(0,a.useState)(!1),[w,k]=(0,a.useState)(!1),[N,j]=(0,a.useState)(!1),[E,M]=(0,a.useState)(!1),[T,P]=(0,a.useState)(!1),[z,_]=(0,a.useState)(!1),[R,A]=(0,a.useState)(null),[I,D]=(0,a.useState)(500),[O,F]=(0,a.useState)(0),L=c(),B=Ou(),U=(0,a.useCallback)(e=>{let t=0;e.events.forEach(e=>{const n=e.name.match(/^BE_(\d+)$/);n&&(t=Math.max(t,parseInt(n[1])))});let n=0;e.gates.forEach(e=>{const t=e.name.match(/_(\d+)$/);t&&(n=Math.max(n,parseInt(t[1])))}),q(t+1),J(n+1)},[]),[H,W]=(0,a.useState)(!1),[V,G]=(0,a.useState)(null),[Y,X]=(0,a.useState)(!1),[K,q]=(0,a.useState)(1),[$,J]=(0,a.useState)(1),Q=(0,a.useRef)(null);(0,a.useEffect)(()=>{X("mobile"===B||"tablet"===B)},[B]),(0,a.useEffect)(()=>{const e=r();e&&(g(e),U(e))},[r,U]),(0,a.useEffect)(()=>{(f.events.length>0||f.gates.length>0)&&i(f)},[f,i]),(0,a.useEffect)(()=>{const e=()=>{console.log("\ud83d\udd04 Simulation results loaded, updating UI"),F(e=>e+1)};return window.addEventListener("simulationResultsLoaded",e),()=>window.removeEventListener("simulationResultsLoaded",e)},[]);const Z=(0,a.useCallback)(()=>{if(H)G({type:"event"});else{const e={id:"event-".concat(Date.now()),type:"basic-event",name:"BE_".concat(K),position:{x:300+200*Math.random(),y:200+200*Math.random()},parameters:{},failureProbabilityDistribution:{type:"exponential",lambda:.01}};g(t=>u(u({},t),{},{events:[...t.events,e]})),q(e=>e+1)}},[H,K]),ee=(0,a.useCallback)(e=>{if(H)G({type:"gate",gateType:e});else{const t={id:"gate-".concat(Date.now()),type:"gate",gateType:e,name:"".concat(e,"_").concat($),position:{x:300+200*Math.random(),y:200+200*Math.random()},inputs:[],isFailureGate:!1,parameters:{}};g(e=>u(u({},e),{},{gates:[...e.gates,t]})),J(e=>e+1)}},[H,$]),te=(0,a.useCallback)(e=>{b(e),x(!0)},[]),ne=(0,a.useCallback)(e=>{if(V)if("event"===V.type){const t={id:"event-".concat(Date.now()),type:"basic-event",name:"BE_".concat(K),position:e,parameters:{},failureProbabilityDistribution:{type:"exponential",lambda:.01}};g(e=>u(u({},e),{},{events:[...e.events,t]})),q(e=>e+1)}else if("gate"===V.type&&V.gateType){const t={id:"gate-".concat(Date.now()),type:"gate",gateType:V.gateType,name:"".concat(V.gateType,"_").concat($),position:e,inputs:[],isFailureGate:!1,parameters:{}};g(e=>u(u({},e),{},{gates:[...e.gates,t]})),J(e=>e+1)}},[V,K,$]),ae=(0,a.useCallback)(()=>{W(e=>!e),G(null)},[]),oe=(0,a.useCallback)(e=>{if(Q.current){const t=Q.current(),n=u(u({},e),{},{events:e.events.map(e=>{const n=t.events.find(t=>t.id===e.id);return n?u(u({},e),{},{position:n.position}):e}),gates:e.gates.map(e=>{const n=t.gates.find(t=>t.id===e.id);return n?u(u({},e),{},{position:n.position}):e})});g(n)}else g(e)},[]),ie=(0,a.useCallback)(e=>{"basic-event"===e.type?g(t=>u(u({},t),{},{events:t.events.map(t=>t.id===e.id?e:t)})):g(t=>u(u({},t),{},{gates:t.gates.map(t=>t.id===e.id?e:t)})),x(!1),b(null)},[]),re=(0,a.useCallback)(e=>{A(e),P(!0),x(!1)},[]),le=(0,a.useCallback)(()=>{_(!0),x(!1)},[]),se=(0,a.useCallback)(async()=>{try{const e=await wu.saveModelWithOverwrite(f,"fault-tree",null===L||void 0===L?void 0:L.fileHandle,null===L||void 0===L?void 0:L.filename);s(e),alert("Fault Tree salvato con successo!")}catch(e){alert("Errore durante il salvataggio: ".concat(e instanceof Error?e.message:"Errore sconosciuto"))}},[f,s,L]),ce=(0,a.useCallback)(async e=>{var t;const n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(n)try{const{model:e}=await wu.openModelWithValidation(n,"fault-tree");g(e),U(e),s({url:URL.createObjectURL(n),filename:n.name}),alert("Fault Tree caricato con successo!")}catch(a){alert("Errore nel caricamento del file: ".concat(a instanceof Error?a.message:"Errore sconosciuto"))}},[U,s]),ue=(0,a.useCallback)(async()=>{if("undefined"!==typeof window&&"showOpenFilePicker"in window)try{const[e]=await window.showOpenFilePicker({types:[{description:"JSON Files",accept:{"application/json":[".json"]}}]}),t=await e.getFile(),{model:n}=await wu.openModelWithValidation(t,"fault-tree");g(n),U(n),s({url:URL.createObjectURL(t),filename:t.name,fileHandle:e}),alert("Fault Tree caricato con successo!")}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;if(e instanceof Error&&"NotAllowedError"===e.name)return void alert('Permessi negati per l\'accesso ai file. Usa il pulsante "Apri" per selezionare manualmente un file.');console.error("Errore durante l'apertura del file:",e),alert("Errore durante l'apertura del file: ".concat(e instanceof Error?e.message:"Errore sconosciuto"))}else{const e=document.createElement("input");e.type="file",e.accept=".json,.xml,.csv",e.onchange=e=>ce(e),e.click()}},[ce,U,s]),de=(0,a.useCallback)(async()=>{try{await wu.exportToXML(f)}catch(e){alert("Errore durante l'esportazione XML: ".concat(e instanceof Error?e.message:"Errore sconosciuto"))}},[f]),pe=(0,a.useCallback)(async()=>{try{await wu.exportToCSV(f)}catch(e){alert("Errore durante l'esportazione CSV: ".concat(e instanceof Error?e.message:"Errore sconosciuto"))}},[f]),me=(0,a.useCallback)(()=>{S(!0)},[]),he=(0,a.useCallback)(()=>{n(!0)},[n]),ge=(0,a.useCallback)(()=>{k(!0)},[]),ve=(0,a.useCallback)(()=>{j(!0)},[]),be=(0,a.useCallback)(e=>{D(e)},[]),ye=(0,a.useCallback)(e=>{o(e)},[o]),xe=(0,a.useCallback)(()=>{p()},[p]),Ce=(0,a.useCallback)(()=>{if(Q.current){const t=Q.current();g(t),setTimeout(()=>{i(t),e("/markov-chain-editor")},0)}else i(f),e("/markov-chain-editor")},[e,i,f]),Se=(0,a.useCallback)(()=>{},[]),we=(0,a.useCallback)(()=>{e("/")},[e]),ke=(0,a.useCallback)(()=>{X(e=>!e)},[]),Ne=(0,a.useCallback)(()=>{h()},[h]),je=(0,a.useCallback)(async()=>{try{const e=Fu(f);await wu.exportCode(e)}catch(e){alert("Errore durante l'esportazione del codice: ".concat(e instanceof Error?e.message:"Errore sconosciuto"))}},[f]),Ee=(0,a.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set;if(t.has(e))return[];t.add(e);const n=f.gates.find(t=>t.id===e);if(!n)return[];const a=[];return n.inputs.forEach(e=>{a.push(e);f.gates.find(t=>t.id===e)&&a.push(...Ee(e,t))}),a},[f.gates]),Me=(0,a.useCallback)(e=>{const t=[...f.events,...f.gates].find(t=>t.id===e);if(t)if("gate"===t.type){const t=Ee(e);g(n=>u(u({},n),{},{events:n.events.filter(e=>!t.includes(e.id)),gates:n.gates.filter(n=>n.id!==e&&!t.includes(n.id)),connections:n.connections.filter(n=>n.source!==e&&n.target!==e&&!t.includes(n.source)&&!t.includes(n.target))}))}else g(t=>u(u({},t),{},{events:t.events.filter(t=>t.id!==e),connections:t.connections.filter(t=>t.source!==e&&t.target!==e),gates:t.gates.map(t=>u(u({},t),{},{inputs:t.inputs.filter(t=>t!==e)}))}))},[f,Ee]),Te=(0,a.useCallback)(e=>{const t=f.connections.find(t=>t.id===e);t&&g(n=>u(u({},n),{},{connections:n.connections.filter(t=>t.id!==e),gates:n.gates.map(e=>e.id===t.target?u(u({},e),{},{inputs:e.inputs.filter(e=>e!==t.source)}):e)}))},[f]),Pe=(0,a.useCallback)(()=>{const e=[...f.events,...f.gates];if(0===e.length)return;const t=Math.ceil(Math.sqrt(e.length)),n=Math.ceil(e.length/t),a=e.map((e,a)=>{const o=Math.floor(a/t),i=400+120*(a%t-(t-1)/2),r=300+120*(o-(n-1)/2);return u(u({},e),{},{position:{x:i,y:r}})});g(e=>u(u({},e),{},{events:a.filter(e=>"basic-event"===e.type),gates:a.filter(e=>"gate"===e.type)}))},[f]),ze=(0,a.useCallback)(e=>{const t={events:[...f.events,...e.events],gates:[...f.gates,...e.gates],connections:[...f.connections,...e.connections],topEvent:e.topEvent||f.topEvent};g(t),U(t)},[f,U]),_e=(0,a.useCallback)(e=>{e.forEach(e=>{switch(e.type){case"add":if("event"===e.elementType){const t={id:"event-".concat(Date.now()),type:"basic-event",name:e.data.name||"Nuovo Evento",position:e.data.position||{x:300,y:200},parameters:e.data.parameters||{},failureProbabilityDistribution:e.data.failureProbabilityDistribution||{type:"exponential",lambda:.01}};g(e=>u(u({},e),{},{events:[...e.events,t]}))}else if("gate"===e.elementType){const t={id:"gate-".concat(Date.now()),type:"gate",gateType:e.data.gateType||"OR",name:e.data.name||"Nuova Porta",position:e.data.position||{x:300,y:200},inputs:[],isFailureGate:!1,parameters:e.data.parameters||{}};g(e=>u(u({},e),{},{gates:[...e.gates,t]}))}break;case"remove":e.elementId&&Me(e.elementId);break;case"update":e.elementId&&e.data&&g(t=>u(u({},t),{},{events:t.events.map(t=>t.id===e.elementId?u(u({},t),e.data):t),gates:t.gates.map(t=>t.id===e.elementId?u(u({},t),e.data):t)}))}})},[Me]),Re=(0,a.useCallback)(()=>{g({events:[],gates:[],connections:[]}),b(null),x(!1),G(null),s(null),q(1),J(1)},[s]),Ae=(0,a.useCallback)(()=>{f.events.length>0||f.gates.length>0||f.connections.length>0?M(!0):Re()},[f,Re]);return(0,Et.jsxs)("div",{className:"fault-tree-editor ".concat(d?"dark-mode":""),children:[(0,Et.jsx)(Ut,{onSave:se,onOpenWithFileSystem:ue,onExportCode:je,onShowSaveModal:me,onExportXML:de,onExportCSV:pe,onExportMatlab:ge,onShowLLMConfig:he,onShowSHyFTA:ve,isDarkMode:d,onToggleDarkMode:xe,onNewModel:Ae,onClearAllModels:l,openedFile:L,currentEditor:"fault-tree",onNavigateToFaultTree:Se,onNavigateToMarkov:Ce,onLogout:we}),(0,Et.jsxs)("div",{className:"editor-content ".concat(Y?"left-panel-collapsed":""," ").concat(m?"right-panel-collapsed":""),children:[(0,Et.jsx)(Ht,{onAddBaseEvent:Z,onAddGate:ee,clickToPlaceMode:H,onToggleClickToPlace:ae,componentToPlace:V,missionTime:I,onMissionTimeChange:be,isDarkMode:d,isCollapsed:Y,onToggleCollapse:ke}),(0,Et.jsx)(du,{faultTreeModel:f,onElementClick:te,onModelChange:oe,onDeleteElement:Me,onDeleteConnection:Te,onPanelClick:ne,componentToPlace:V,isDarkMode:d,disableDeletion:y,onReorganizeComponents:Pe,getCurrentPositionsRef:Q}),(0,Et.jsx)(vu,{onGenerateFaultTree:ze,onModifyFaultTree:_e,currentFaultTree:f,isDarkMode:d,isCollapsed:m,onToggleCollapse:Ne,editorType:"fault-tree"})]}),y&&v&&(0,Et.jsx)(bu,{element:v,onSave:ie,onClose:()=>{x(!1),b(null)},faultTreeModel:f,onShowResults:re},"".concat(v.id,"-").concat(O)),(0,Et.jsx)(ku,{isOpen:C,onClose:()=>S(!1),faultTreeModel:f}),(0,Et.jsx)(hu,{isOpen:t,onClose:()=>n(!1),onConfigChange:ye}),(0,Et.jsx)(ju,{isOpen:w,onClose:()=>k(!1),faultTreeModel:f,missionTime:I}),(0,Et.jsx)(Au,{isOpen:N,onClose:()=>j(!1),faultTreeModel:f,missionTime:I,onShowCIResults:le}),(0,Et.jsx)(Iu,{isOpen:E,onClose:()=>M(!1),onConfirm:Re,title:"\u26a0\ufe0f Nuovo Modello",message:"Il modello esistente verr\xe0 perduto se non \xe8 stato salvato. Sei sicuro di voler continuare?",confirmText:"S\xec, Nuovo Modello",cancelText:"Annulla",confirmButtonClass:"danger"}),(0,Et.jsx)(yu,{isOpen:T,onClose:()=>{P(!1),A(null)},elementId:R}),(0,Et.jsx)(xu,{isOpen:z,onClose:()=>_(!1)})]})},Bu=e=>{let{onAddState:t,clickToPlaceMode:n,onToggleClickToPlace:a,componentToPlace:o,setComponentToPlace:i,isDarkMode:r,isCollapsed:l,onToggleCollapse:s}=e;return(0,Et.jsxs)("div",{className:"markov-left-panel ".concat(r?"dark-mode":""," ").concat(l?"collapsed":""),children:[(0,Et.jsx)("div",{className:"panel-header",children:(0,Et.jsxs)("div",{className:"header-content",children:[(0,Et.jsx)("h3",{children:"\ud83d\udd17 Componenti Markov"}),(0,Et.jsx)("button",{className:"collapse-toggle",onClick:s,title:l?"Mostra pannello":"Nascondi pannello",children:l?"\u25b6":"\u25c0"})]})}),!l&&(0,Et.jsxs)("div",{className:"panel-content",children:[(0,Et.jsxs)("div",{className:"component-section",children:[(0,Et.jsx)("h4",{children:"States"}),(0,Et.jsx)("div",{className:"components-grid",children:(0,Et.jsxs)("div",{className:"component-item ".concat("state"===o?"selected":""),onClick:()=>{n?i("state"===o?null:"state"):(a(),i("state"))},title:"Add State",children:[(0,Et.jsx)("div",{className:"state-icon",children:(0,Et.jsx)("div",{className:"state-circle",children:"S"})}),(0,Et.jsx)("span",{children:"State"})]})})]}),(0,Et.jsxs)("div",{className:"mode-section",children:[(0,Et.jsx)("div",{className:"mode-toggle",children:(0,Et.jsxs)("label",{children:[(0,Et.jsx)("input",{type:"checkbox",checked:n,onChange:a}),(0,Et.jsx)("span",{children:"Click to Place Mode"})]})}),(0,Et.jsx)("p",{className:"mode-description",children:n?"state"===o?"\ud83c\udfaf State selected: Click canvas to place states, click State button to deselect":"\ud83d\udccb Click State button to select, then click canvas to place":"\u26a0\ufe0f Click State button to enable Click to Place Mode automatically"})]}),(0,Et.jsxs)("div",{className:"info-section",children:[(0,Et.jsx)("h4",{children:"Instructions"}),(0,Et.jsxs)("ul",{children:[(0,Et.jsx)("li",{children:"Click State button to enable placement mode"}),(0,Et.jsx)("li",{children:"Click canvas to place states where you want"}),(0,Et.jsx)("li",{children:"Drag states to move them around"}),(0,Et.jsx)("li",{children:"Connect states by dragging from one to another"}),(0,Et.jsx)("li",{children:"Click on states/transitions to edit properties"})]})]})]})]})};class Uu{constructor(){this.results={isLoaded:!1},this.listeners=[]}static getInstance(){return Uu.instance||(Uu.instance=new Uu),Uu.instance}async loadResults(){try{var e,t;console.log("\ud83d\udd04 [CTMCResults] Loading CTMC results...");const n=localStorage.getItem("msolver-library-directory");if(!n)throw new Error("Path della libreria CTMC non trovato.");const a="http://".concat(window.location.hostname,":3001/api/ctmc/results?libraryPath=").concat(encodeURIComponent(n)),o=await fetch(a);if(!o.ok)throw new Error("HTTP ".concat(o.status));const i=await o.json();console.log("\u2705 [CTMCResults] Raw data loaded:",i);let r=[];if(i.data&&i.data.result){const e=i.data.result;Array.isArray(e)?r=e:"string"===typeof e&&(r=e.trim().split(/\s+/).map(e=>parseFloat(e)).filter(e=>!isNaN(e)))}return this.results={solverMethod:(null===(e=i.data)||void 0===e?void 0:e.solverMethod)||"Unknown",result:null===(t=i.data)||void 0===t?void 0:t.result,steadyStateProbabilities:r,isLoaded:!0},console.log("\ud83d\udcca [CTMCResults] Parsed probabilities:",r),this.notifyListeners(),!0}catch(n){return console.error("\u274c [CTMCResults] Error loading results:",n),this.results={isLoaded:!1},this.notifyListeners(),!1}}getStateProbability(e){return this.results.isLoaded&&this.results.steadyStateProbabilities&&this.results.steadyStateProbabilities[e]||null}isResultsLoaded(){return this.results.isLoaded}getSolverMethod(){return this.results.solverMethod||null}clearResults(){this.results={isLoaded:!1},this.notifyListeners()}subscribe(e){return this.listeners.push(e),()=>{const t=this.listeners.indexOf(e);t>-1&&this.listeners.splice(t,1)}}notifyListeners(){this.listeners.forEach(e=>e())}}Uu.instance=void 0;const Hu=Uu.getInstance(),Wu=e=>{let{data:t,selected:n}=e;const{state:o,onStateClick:i,onDeleteState:r,onViewResults:l,isDarkMode:s,disableDeletion:c,matlabStateIndex:u}=t,d=(0,a.useCallback)(e=>{e.stopPropagation(),i(o)},[i,o]),p=(0,a.useCallback)(e=>{e.stopPropagation(),c||r(o.id)},[c,r,o.id]),m=(0,a.useCallback)(e=>{e.preventDefault(),c||r(o.id)},[c,r,o.id]),h=(0,a.useCallback)(e=>{e.stopPropagation(),l(o.id)},[l,o.id]),[f,g]=(0,a.useState)(null),[v,b]=(0,a.useState)(!1);(0,a.useEffect)(()=>{const e=()=>{const e=Hu.isResultsLoaded();if(b(e),e&&void 0!==u){const e=Hu.getStateProbability(u-1);g(e),console.log("\ud83d\udd0d [StateNode] State ".concat(o.name," (MATLAB index ").concat(u,"): probability = ").concat(e))}else g(null)};e();return Hu.subscribe(e)},[u,o.name]);const y=(0,a.useMemo)(()=>{const e=[],t=14;for(let n=0;n<12;n++){const a=(30*n-90)*(Math.PI/180),i=45*Math.cos(a),r=45*Math.sin(a);e.push((0,Et.jsx)(wl,{type:"source",position:Lr.Top,id:"handle-".concat(n),style:{position:"absolute",left:"calc(50% + ".concat(i,"px - ").concat(7,"px)"),top:"calc(50% + ".concat(r,"px - ").concat(7,"px)"),width:"".concat(t,"px"),height:"".concat(t,"px"),background:s?"#4CAF50":"#28a745",border:"2px solid ".concat("#ffffff"),borderRadius:"50%",boxShadow:"0 2px 4px rgba(0,0,0,0.3)",transform:"none",zIndex:10}},"".concat(o.id,"-handle-").concat(n))),e.push((0,Et.jsx)(wl,{type:"target",position:Lr.Top,id:"target-".concat(n),style:{position:"absolute",left:"calc(50% + ".concat(i,"px - ").concat(7,"px)"),top:"calc(50% + ".concat(r,"px - ").concat(7,"px)"),width:"".concat(t,"px"),height:"".concat(t,"px"),background:s?"#4CAF50":"#28a745",border:"2px solid ".concat("#ffffff"),borderRadius:"50%",boxShadow:"0 2px 4px rgba(0,0,0,0.3)",transform:"none",zIndex:9}},"".concat(o.id,"-target-").concat(n)))}return e},[o.id,s]);return(0,Et.jsxs)("div",{className:"state-node ".concat(s?"dark-mode":""," ").concat(n?"selected":""," ").concat(o.isAbsorbing?"absorbing":""," ").concat(o.isInitial?"initial":""),onClick:d,onContextMenu:m,children:[y,(0,Et.jsx)("div",{className:"state-circle drag-handle",children:(0,Et.jsxs)("div",{className:"state-content",children:[(0,Et.jsx)("div",{className:"state-name",children:o.name}),(0,Et.jsxs)("div",{className:"state-id",children:["Id: ",void 0!==u?u-1:parseInt(o.id.replace("state-",""))||0]}),1!==o.rewardFunction&&(0,Et.jsxs)("div",{className:"state-reward",children:["R: ",o.rewardFunction]}),null!==f&&(0,Et.jsxs)("div",{className:"state-probability",children:["\u03c0: ",(100*f).toFixed(2),"%"]})]})}),o.isAbsorbing&&(0,Et.jsx)("div",{className:"absorbing-indicator",title:"Absorbing State",children:(0,Et.jsx)("div",{className:"absorbing-ring"})}),o.isInitial&&(0,Et.jsx)("div",{className:"initial-indicator",title:"Initial State",children:(0,Et.jsx)("div",{className:"initial-arrow",children:"\u21d2"})}),(0,Et.jsx)("button",{className:"results-button",onClick:h,title:"View CTMC Results",children:"\ud83d\udcca"}),!c&&(0,Et.jsx)("button",{className:"delete-button",onClick:p,title:"Delete State",children:"\xd7"})]})},Vu=e=>{let{id:t,sourceX:n,sourceY:a,targetX:o,targetY:i,sourcePosition:r,targetPosition:l,data:s,selected:c}=e;if(!s)return null;const{transition:u,onTransitionClick:d,onDeleteTransition:p,isDarkMode:m,disableDeletion:h,sourceStateName:f,targetStateName:g}=s,[v,b,y]=Qr({sourceX:n,sourceY:a,sourcePosition:r,targetX:o,targetY:i,targetPosition:l}),x=e=>{e.stopPropagation(),d(u)};return(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)("path",{id:t,className:"transition-edge ".concat(m?"dark-mode":""," ").concat(c?"selected":""),d:v,onClick:x,style:{stroke:c?"#007bff":m?"#ffffff":"#333333",strokeWidth:c?3:2,cursor:"pointer"}}),(0,Et.jsx)(Ic,{children:(0,Et.jsxs)("div",{style:{position:"absolute",transform:"translate(-50%, -50%) translate(".concat(b,"px,").concat(y,"px)"),pointerEvents:"all"},className:"transition-label ".concat(m?"dark-mode":""),children:[(0,Et.jsxs)("div",{className:"label-content",onClick:x,title:"Transition: ".concat(f||u.source," \u2192 ").concat(g||u.target),children:[(0,Et.jsxs)("div",{className:"transition-direction",children:[f||u.source," \u2192 ",g||u.target]}),(0,Et.jsx)("div",{className:"probability-text",children:(()=>{const e=u.probabilityDistribution;switch(e.type){case"constant":return"p=".concat(e.probability);case"exponential":return"\u03bb=".concat(e.lambda);case"weibull":return"k=".concat(e.k,", \u03bb=").concat(e.lambda);case"normal":return"\u03bc=".concat(e.mu,", \u03c3=").concat(e.sigma);default:return"p=?"}})()})]}),!h&&(0,Et.jsx)("button",{className:"delete-transition-button",onClick:e=>{e.stopPropagation(),h||p(u.id)},title:"Delete Transition",children:"\xd7"})]})})]})},Gu={stateNode:(0,a.memo)(Wu)},Yu={transitionEdge:(0,a.memo)(Vu)},Xu=e=>{let{markovChainModel:t,onElementClick:n,onModelChange:o,onDeleteElement:i,onCreateConnection:r,onPanelClick:l,onViewResults:s,componentToPlace:c,isDarkMode:d,disableDeletion:p=!1,onReorganizeComponents:m}=e;const[h,f,g]=Oc([]),[v,b,y]=Fc([]),x=ls(),[C,S]=(0,a.useState)({x:0,y:0,show:!1}),[w,k]=(0,a.useState)(!1),N=(0,a.useCallback)(e=>{n(e)},[n]),j=(0,a.useCallback)(e=>{i(e)},[i]),E=(0,a.useMemo)(()=>{const e=[...t.states].sort((e,t)=>(parseInt(e.id.replace("state-",""))||0)-(parseInt(t.id.replace("state-",""))||0)),n=new Map;e.forEach((e,t)=>{n.set(e.id,t+1)});const a=t.states.map(e=>({id:e.id,type:"stateNode",position:e.position,data:{state:e,onStateClick:N,onDeleteState:j,onViewResults:s,isDarkMode:d,disableDeletion:p,matlabStateIndex:n.get(e.id)},dragHandle:".drag-handle",selectable:!0})),o=t.transitions.map(e=>{const n=t.states.find(t=>t.id===e.source),a=t.states.find(t=>t.id===e.target);return{id:e.id,source:e.source,target:e.target,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle,type:"transitionEdge",data:{transition:e,onTransitionClick:N,onDeleteTransition:j,isDarkMode:d,disableDeletion:p,sourceStateName:null===n||void 0===n?void 0:n.name,targetStateName:null===a||void 0===a?void 0:a.name},style:{stroke:d?"#ffffff":"#333333",strokeWidth:2}}});return{nodes:a,edges:o}},[t.states,t.transitions,N,j,s,d,p]);(0,a.useEffect)(()=>{const{nodes:e,edges:t}=E;f(t=>{const n=t.map(t=>{const n=e.find(e=>e.id===t.id);if(!n)return t;return JSON.stringify(t.data.state)!==JSON.stringify(n.data.state)?u(u({},t),{},{data:u(u({},t.data),{},{state:n.data.state})}):t}).filter(t=>e.some(e=>e.id===t.id)),a=e.filter(e=>!t.some(t=>t.id===e.id)),o=a.length>0||n.length!==t.length||n.some((e,n)=>{var a,o;return!t[n]||JSON.stringify(e.data.state)!==JSON.stringify(null===(a=t[n])||void 0===a||null===(o=a.data)||void 0===o?void 0:o.state)});return o?[...n,...a]:t}),b(e=>{if(e.length!==t.length)return t;return t.some(t=>{const n=e.find(e=>e.id===t.id);return!n||JSON.stringify(n.data.transition)!==JSON.stringify(t.data.transition)})?t:e})},[E,f,b]);const M=(0,a.useCallback)(e=>{e.filter(e=>"remove"===e.type).forEach(e=>{"remove"===e.type&&i(e.id)});const n=e.filter(e=>"remove"!==e.type);g(n);const a=n.filter(e=>"position"===e.type&&!!e.position);if(a.length>0){const e=t.states.map(e=>{const t=a.find(t=>t.id===e.id);return t?u(u({},e),{},{position:t.position}):e});o(u(u({},t),{},{states:e}))}},[g,t,o,i]),T=(0,a.useCallback)(e=>{y(e),e.forEach(e=>{"remove"===e.type&&i(e.id)})},[y,i]),P=(0,a.useCallback)(e=>{if(console.log("ReactFlow connection:",e),e.source&&e.target){const n=t.transitions.find(t=>t.source===e.source&&t.target===e.target);if(n)return void alert("Errore: Esiste gi\xe0 una transizione dallo stato ".concat(e.source," allo stato ").concat(e.target,".\n\nOgni coppia di stati pu\xf2 essere collegata una sola volta."));if(e.source===e.target)return void r(e.source,e.target,e.sourceHandle||void 0,e.targetHandle||void 0);r(e.source,e.target,e.sourceHandle||void 0,e.targetHandle||void 0)}},[r,t.transitions]),z=(0,a.useCallback)(e=>{if(c&&x){const t=x.screenToFlowPosition({x:e.clientX,y:e.clientY}),n={width:120,height:40},a={x:t.x-n.width/2,y:t.y-n.height/2};l(a)}},[c,l,x]),_=(0,a.useCallback)(e=>{if(!p)if("Delete"===e.key||"Backspace"===e.key){const t=h.filter(e=>e.selected),n=v.filter(e=>e.selected);t.forEach(e=>{i(e.id)}),n.forEach(e=>{i(e.id)}),e.preventDefault()}else e.ctrlKey&&"a"===e.key&&(e.preventDefault(),f(e=>e.map(e=>u(u({},e),{},{selected:!0}))),b(e=>e.map(e=>u(u({},e),{},{selected:!0}))))},[h,v,i,f,b,p]),R=(0,a.useCallback)(e=>{e.preventDefault(),S({x:e.clientX,y:e.clientY,show:!0})},[]),A=(0,a.useCallback)(()=>{S(e=>u(u({},e),{},{show:!1}))},[]),I=(0,a.useCallback)(()=>{f(e=>e.map(e=>u(u({},e),{},{selected:!0}))),b(e=>e.map(e=>u(u({},e),{},{selected:!0}))),A()},[f,b,A]),D=(0,a.useCallback)(()=>{f(e=>e.map(e=>u(u({},e),{},{selected:!1}))),b(e=>e.map(e=>u(u({},e),{},{selected:!1}))),A()},[f,b,A]),O=(0,a.useCallback)(()=>{const e=h.filter(e=>e.selected),t=v.filter(e=>e.selected);e.forEach(e=>i(e.id)),t.forEach(e=>i(e.id)),A()},[h,v,i,A]);(0,a.useEffect)(()=>(document.addEventListener("keydown",_),document.addEventListener("click",A),()=>{document.removeEventListener("keydown",_),document.removeEventListener("click",A)}),[_,A]);return(0,Et.jsxs)("div",{className:"markov-central-panel ".concat(d?"dark-mode":""," ").concat(c?"placing-component":""),children:[(0,Et.jsxs)("div",{className:"panel-header",children:[(0,Et.jsx)("h3",{children:"Markov Chain Diagram"}),(0,Et.jsxs)("div",{className:"diagram-info",children:[(0,Et.jsxs)("span",{children:["Stati: ",t.states.length]}),(0,Et.jsxs)("span",{children:["Transizioni: ",t.transitions.length]})]}),(0,Et.jsx)("div",{className:"diagram-help",children:(0,Et.jsx)("span",{children:"\ud83d\udca1 Tasto destro per menu \u2022 Trascina per selezione multipla \u2022 Ctrl+Click per selezione \u2022 Ctrl+A seleziona tutto \u2022 DEL/Backspace elimina"})})]}),(0,Et.jsxs)("div",{className:"react-flow-container ".concat(c?"placement-mode":""),onContextMenu:R,style:{cursor:c?"crosshair":"default"},children:[(0,Et.jsxs)(Rc,{nodes:h,edges:v,onNodesChange:M,onEdgesChange:T,onConnect:P,onPaneClick:z,nodeTypes:Gu,edgeTypes:Yu,connectionMode:Ar.Loose,snapToGrid:!0,snapGrid:[15,15],selectionMode:Dr.Partial,multiSelectionKeyCode:"Control",deleteKeyCode:null,selectionOnDrag:!c,panOnDrag:!c&&(!w&&[1,2]),nodesDraggable:!w,nodesConnectable:!w,elementsSelectable:!w,zoomOnScroll:!w,zoomOnPinch:!w,zoomOnDoubleClick:!1,preventScrolling:!1,attributionPosition:"bottom-left",proOptions:{hideAttribution:!0},style:{cursor:c?"crosshair":"default"},children:[(0,Et.jsx)(tu,{variant:Xc.Dots,gap:20,size:1,color:d?"#404040":"#e0e0e0"}),(0,Et.jsxs)("div",{className:"react-flow__panel react-flow__controls bottom left",children:[(0,Et.jsx)("button",{className:"react-flow__controls-button",onClick:()=>x.zoomIn(),title:"Zoom In (+)",children:"+"}),(0,Et.jsx)("button",{className:"react-flow__controls-button",onClick:()=>x.zoomOut(),title:"Zoom Out (-)",children:"-"}),(0,Et.jsx)("button",{className:"react-flow__controls-button",onClick:()=>x.fitView(),title:"Fit View",children:"\u229e"}),(0,Et.jsx)("button",{className:"react-flow__controls-button",onClick:()=>k(!w),title:w?"Sblocca Vista":"Blocca Vista",children:w?"\ud83d\udd13":"\ud83d\udd12"}),m&&(0,Et.jsx)("button",{className:"react-flow__controls-button",onClick:()=>{m(),setTimeout(()=>{x.fitView()},100)},title:"Riorganizza tutti gli stati al centro",children:"\ud83d\udd27"})]}),(0,Et.jsx)(Kc,{style:{backgroundColor:d?"#2a2a2a":"#ffffff",border:"1px solid ".concat(d?"#444":"#e0e0e0")},nodeColor:d?"#666":"#ccc",maskColor:d?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)",position:"top-right"})]}),C.show&&(0,Et.jsxs)("div",{className:"context-menu",style:{position:"fixed",top:C.y,left:C.x,zIndex:1e3},children:[(0,Et.jsx)("button",{onClick:I,children:"\ud83d\udd32 Seleziona tutto (Ctrl+A)"}),(0,Et.jsx)("button",{onClick:D,children:"\u2b1c Deseleziona tutto"}),(0,Et.jsx)("hr",{}),(0,Et.jsx)("button",{onClick:O,disabled:!h.some(e=>e.selected)&&!v.some(e=>e.selected),children:"\ud83d\uddd1\ufe0f Elimina selezionati (Del)"})]}),c&&(0,Et.jsx)("div",{className:"placement-hint",children:"Click on the canvas to place the selected component"})]})]})},Ku=e=>(0,Et.jsx)(Nc,{children:(0,Et.jsx)(Xu,u({},e))}),qu=e=>{let{state:t,onSave:n,onClose:o,isDarkMode:i,onRemoveTransitions:r,onSetAsInitial:l}=e;const[s,c]=(0,a.useState)(t.name),[d,p]=(0,a.useState)(t.description||""),[m,h]=(0,a.useState)(t.rewardFunction),[f,g]=(0,a.useState)(t.isAbsorbing),[v,b]=(0,a.useState)(t.isInitial||!1),[y,x]=(0,a.useState)(""),[C,S]=(0,a.useState)(""),w=(0,a.useCallback)(()=>{let e=!0;return s.trim()?s.trim().length>50?(x("State name must be 50 characters or less"),e=!1):x(""):(x("State name is required"),e=!1),isNaN(m)||m<0?(S("Reward function must be a non-negative number"),e=!1):S(""),e},[s,m]),k=(0,a.useCallback)(e=>{e&&r&&r(t.id),g(e)},[t.id,r]),N=(0,a.useCallback)(e=>{e&&l&&l(t.id),b(e)},[t.id,l]),j=(0,a.useCallback)(()=>{if(w()){const e=u(u({},t),{},{name:s.trim(),description:d.trim()||void 0,rewardFunction:m,isAbsorbing:f,isInitial:v});n(e)}},[t,s,d,m,f,v,n,w]),E=(0,a.useCallback)(e=>{"Enter"===e.key&&e.ctrlKey?j():"Escape"===e.key&&o()},[j,o]);return(0,a.useEffect)(()=>{(s.trim()||m!==t.rewardFunction)&&w()},[s,m,t.rewardFunction,w]),(0,Et.jsx)("div",{className:"modal-overlay ".concat(i?"dark-mode":""),onClick:o,children:(0,Et.jsxs)("div",{className:"markov-state-modal ".concat(i?"dark-mode":""),onClick:e=>e.stopPropagation(),onKeyDown:E,tabIndex:-1,children:[(0,Et.jsxs)("div",{className:"modal-header",children:[(0,Et.jsx)("h2",{children:"Edit State Properties"}),(0,Et.jsx)("button",{className:"close-button",onClick:o,"aria-label":"Close",children:"\xd7"})]}),(0,Et.jsxs)("div",{className:"modal-body",children:[(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsxs)("label",{htmlFor:"state-name",children:["State Name ",(0,Et.jsx)("span",{className:"required",children:"*"})]}),(0,Et.jsx)("input",{id:"state-name",type:"text",value:s,onChange:e=>c(e.target.value),placeholder:"Enter state name (e.g., S1, Working, Failed)",className:y?"error":"",maxLength:50,autoFocus:!0}),y&&(0,Et.jsx)("span",{className:"error-message",children:y})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{htmlFor:"state-description",children:"Description"}),(0,Et.jsx)("textarea",{id:"state-description",value:d,onChange:e=>p(e.target.value),placeholder:"Optional description of the state",rows:3,maxLength:500}),(0,Et.jsxs)("div",{className:"character-count",children:[d.length,"/500"]})]}),(0,Et.jsxs)("div",{className:"form-row",children:[(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsxs)("label",{htmlFor:"reward-function",children:["Reward Function ",(0,Et.jsx)("span",{className:"required",children:"*"})]}),(0,Et.jsx)("input",{id:"reward-function",type:"number",value:m,onChange:e=>h(parseFloat(e.target.value)||0),min:"0",step:"0.1",placeholder:"1.0",className:C?"error":""}),C&&(0,Et.jsx)("span",{className:"error-message",children:C}),(0,Et.jsx)("div",{className:"help-text",children:"The reward value associated with being in this state (default: 1)"})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsxs)("label",{className:"toggle-label",children:[(0,Et.jsx)("input",{type:"checkbox",checked:f,onChange:e=>k(e.target.checked)}),(0,Et.jsx)("span",{className:"toggle-switch"}),"Absorbing State"]}),(0,Et.jsx)("div",{className:"help-text",children:"An absorbing state is one where the process ends (no outgoing transitions)"})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsxs)("label",{className:"toggle-label",children:[(0,Et.jsx)("input",{type:"checkbox",checked:v,onChange:e=>N(e.target.checked)}),(0,Et.jsx)("span",{className:"toggle-switch"}),"Initial State"]}),(0,Et.jsx)("div",{className:"help-text",children:"The initial state where the Markov chain begins (only one state can be initial)"})]})]}),(0,Et.jsxs)("div",{className:"state-preview",children:[(0,Et.jsx)("h4",{children:"Preview"}),(0,Et.jsxs)("div",{className:"preview-state ".concat(f?"absorbing":""," ").concat(v?"initial":""),children:[(0,Et.jsxs)("div",{className:"preview-circle",children:[(0,Et.jsx)("div",{className:"preview-name",children:s||"State"}),1!==m&&(0,Et.jsxs)("div",{className:"preview-reward",children:["R: ",m]})]}),f&&(0,Et.jsx)("div",{className:"preview-indicator",children:"Absorbing"}),v&&(0,Et.jsx)("div",{className:"preview-indicator",children:"Initial"})]})]})]}),(0,Et.jsxs)("div",{className:"modal-footer",children:[(0,Et.jsx)("button",{className:"button secondary",onClick:o,children:"Cancel"}),(0,Et.jsx)("button",{className:"button primary",onClick:j,disabled:!!y||!!C,children:"Save State"})]}),(0,Et.jsx)("div",{className:"keyboard-shortcuts",children:(0,Et.jsxs)("small",{children:["Press ",(0,Et.jsx)("kbd",{children:"Ctrl+Enter"})," to save, ",(0,Et.jsx)("kbd",{children:"Esc"})," to cancel"]})})]})})},$u=e=>{let{transition:t,onSave:n,onClose:o,isDarkMode:i}=e;const[r,l]=(0,a.useState)(t.probabilityDistribution.type),[s,c]=(0,a.useState)("constant"===t.probabilityDistribution.type?t.probabilityDistribution.probability:.5),[d,p]=(0,a.useState)("exponential"===t.probabilityDistribution.type?t.probabilityDistribution.lambda:1),[m,h]=(0,a.useState)("weibull"===t.probabilityDistribution.type?t.probabilityDistribution.k:1),[f,g]=(0,a.useState)("weibull"===t.probabilityDistribution.type?t.probabilityDistribution.lambda:1),[v,b]=(0,a.useState)("weibull"===t.probabilityDistribution.type?t.probabilityDistribution.mu:0),[y,x]=(0,a.useState)("normal"===t.probabilityDistribution.type?t.probabilityDistribution.mu:0),[C,S]=(0,a.useState)("normal"===t.probabilityDistribution.type?t.probabilityDistribution.sigma:1),[w,k]=(0,a.useState)({}),N=(0,a.useCallback)(()=>{const e={};switch(r){case"constant":(s<0||s>1)&&(e.constant="Probability must be between 0 and 1");break;case"exponential":d<=0&&(e.lambda="Lambda must be positive");break;case"weibull":m<=0&&(e.weibullK="Shape parameter (k) must be positive"),f<=0&&(e.weibullLambda="Scale parameter (\u03bb) must be positive");break;case"normal":C<=0&&(e.normalSigma="Standard deviation (\u03c3) must be positive")}return k(e),0===Object.keys(e).length},[r,s,d,m,f,C]),j=(0,a.useCallback)(()=>{if(N()){let e;switch(r){case"constant":e={type:"constant",probability:s};break;case"exponential":e={type:"exponential",lambda:d};break;case"weibull":e={type:"weibull",k:m,lambda:f,mu:v};break;case"normal":e={type:"normal",mu:y,sigma:C};break;default:return}const a=u(u({},t),{},{probabilityDistribution:e});n(a)}},[t,r,s,d,m,f,v,y,C,N,n]),E=(0,a.useCallback)(e=>{"Enter"===e.key&&e.ctrlKey?j():"Escape"===e.key&&o()},[j,o]);(0,a.useEffect)(()=>{N()},[N]);return(0,Et.jsx)("div",{className:"modal-overlay ".concat(i?"dark-mode":""),onClick:o,children:(0,Et.jsxs)("div",{className:"markov-transition-modal ".concat(i?"dark-mode":""),onClick:e=>e.stopPropagation(),onKeyDown:E,tabIndex:-1,children:[(0,Et.jsxs)("div",{className:"modal-header",children:[(0,Et.jsx)("h2",{children:"Edit Transition Properties"}),(0,Et.jsx)("button",{className:"close-button",onClick:o,"aria-label":"Close",children:"\xd7"})]}),(0,Et.jsxs)("div",{className:"modal-body",children:[(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsxs)("label",{htmlFor:"distribution-type",children:["Probability Distribution ",(0,Et.jsx)("span",{className:"required",children:"*"})]}),(0,Et.jsxs)("select",{id:"distribution-type",value:r,onChange:e=>l(e.target.value),children:[(0,Et.jsx)("option",{value:"constant",children:"Constant"}),(0,Et.jsx)("option",{value:"exponential",children:"Exponential"}),(0,Et.jsx)("option",{value:"weibull",children:"Weibull"}),(0,Et.jsx)("option",{value:"normal",children:"Normal"})]}),(0,Et.jsx)("div",{className:"help-text",children:(e=>{switch(e){case"constant":return"Fixed probability value between 0 and 1";case"exponential":return"Exponential distribution with rate parameter \u03bb";case"weibull":return"Weibull distribution with shape k, scale \u03bb, and location \u03bc";case"normal":return"Normal distribution with mean \u03bc and standard deviation \u03c3"}})(r)})]}),(()=>{switch(r){case"constant":return(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsxs)("label",{htmlFor:"constant",children:["Probability ",(0,Et.jsx)("span",{className:"required",children:"*"})]}),(0,Et.jsx)("input",{id:"constant",type:"number",value:s,onChange:e=>c(parseFloat(e.target.value)||0),min:"0",max:"1",step:"0.01",className:w.constant?"error":""}),w.constant&&(0,Et.jsx)("span",{className:"error-message",children:w.constant}),(0,Et.jsx)("div",{className:"help-text",children:"Constant probability value (0 \u2264 p \u2264 1)"})]});case"exponential":return(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsxs)("label",{htmlFor:"lambda",children:["Rate Parameter (\u03bb) ",(0,Et.jsx)("span",{className:"required",children:"*"})]}),(0,Et.jsx)("input",{id:"lambda",type:"number",value:d,onChange:e=>p(parseFloat(e.target.value)||0),min:"0.001",step:"0.1",className:w.lambda?"error":""}),w.lambda&&(0,Et.jsx)("span",{className:"error-message",children:w.lambda}),(0,Et.jsxs)("div",{className:"help-text",children:["Rate parameter \u03bb ",">"," 0 (events per unit time)"]})]});case"weibull":return(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsxs)("div",{className:"form-row",children:[(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsxs)("label",{htmlFor:"weibull-k",children:["Shape (k) ",(0,Et.jsx)("span",{className:"required",children:"*"})]}),(0,Et.jsx)("input",{id:"weibull-k",type:"number",value:m,onChange:e=>h(parseFloat(e.target.value)||0),min:"0.001",step:"0.1",className:w.weibullK?"error":""}),w.weibullK&&(0,Et.jsx)("span",{className:"error-message",children:w.weibullK})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsxs)("label",{htmlFor:"weibull-lambda",children:["Scale (\u03bb) ",(0,Et.jsx)("span",{className:"required",children:"*"})]}),(0,Et.jsx)("input",{id:"weibull-lambda",type:"number",value:f,onChange:e=>g(parseFloat(e.target.value)||0),min:"0.001",step:"0.1",className:w.weibullLambda?"error":""}),w.weibullLambda&&(0,Et.jsx)("span",{className:"error-message",children:w.weibullLambda})]})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{htmlFor:"weibull-mu",children:"Location (\u03bc)"}),(0,Et.jsx)("input",{id:"weibull-mu",type:"number",value:v,onChange:e=>b(parseFloat(e.target.value)||0),step:"0.1"}),(0,Et.jsx)("div",{className:"help-text",children:"Location parameter \u03bc (shift along time axis)"})]})]});case"normal":return(0,Et.jsxs)("div",{className:"form-row",children:[(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{htmlFor:"normal-mu",children:"Mean (\u03bc)"}),(0,Et.jsx)("input",{id:"normal-mu",type:"number",value:y,onChange:e=>x(parseFloat(e.target.value)||0),step:"0.1"})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsxs)("label",{htmlFor:"normal-sigma",children:["Std Dev (\u03c3) ",(0,Et.jsx)("span",{className:"required",children:"*"})]}),(0,Et.jsx)("input",{id:"normal-sigma",type:"number",value:C,onChange:e=>S(parseFloat(e.target.value)||0),min:"0.001",step:"0.1",className:w.normalSigma?"error":""}),w.normalSigma&&(0,Et.jsx)("span",{className:"error-message",children:w.normalSigma})]})]})}})(),(0,Et.jsxs)("div",{className:"transition-info",children:[(0,Et.jsx)("h4",{children:"Transition Information"}),(0,Et.jsxs)("div",{className:"info-row",children:[(0,Et.jsx)("span",{className:"label",children:"From State:"}),(0,Et.jsx)("span",{className:"value",children:t.source})]}),(0,Et.jsxs)("div",{className:"info-row",children:[(0,Et.jsx)("span",{className:"label",children:"To State:"}),(0,Et.jsx)("span",{className:"value",children:t.target})]}),(0,Et.jsxs)("div",{className:"info-row",children:[(0,Et.jsx)("span",{className:"label",children:"Distribution:"}),(0,Et.jsx)("span",{className:"value",children:r})]})]})]}),(0,Et.jsxs)("div",{className:"modal-footer",children:[(0,Et.jsx)("button",{className:"button secondary",onClick:o,children:"Cancel"}),(0,Et.jsx)("button",{className:"button primary",onClick:j,disabled:Object.keys(w).length>0,children:"Save Transition"})]}),(0,Et.jsx)("div",{className:"keyboard-shortcuts",children:(0,Et.jsxs)("small",{children:["Press ",(0,Et.jsx)("kbd",{children:"Ctrl+Enter"})," to save, ",(0,Et.jsx)("kbd",{children:"Esc"})," to cancel"]})})]})})};class Ju{static validateExponentialTransitions(e){for(const t of e.transitions)if("exponential"!==t.probabilityDistribution.type)return"Transizione ".concat(t.source," \u2192 ").concat(t.target," non \xe8 esponenziale (tipo: ").concat(t.probabilityDistribution.type,"). Solo transizioni esponenziali sono supportate per la risoluzione CTMC.");return null}static validateConnectedStates(e){if(0===e.states.length)return"Il modello non contiene stati.";if(0===e.transitions.length)return"Il modello non contiene transizioni. Aggiungi almeno una transizione per connettere gli stati.";const t=new Set;e.transitions.forEach(e=>{t.add(e.source),t.add(e.target)});const n=e.states.filter(e=>!t.has(e.id));return n.length>0?(console.log("\ud83d\udd0d [CTMC Validation] Disconnected states found:",{disconnectedStates:n.map(e=>({id:e.id,name:e.name})),allStates:e.states.map(e=>({id:e.id,name:e.name})),allTransitions:e.transitions.map(e=>({source:e.source,target:e.target}))}),"Stati isolati: ".concat(n.map(e=>e.name).join(", "),". \n\nOgni stato deve avere almeno una transizione in ingresso o in uscita.\n\nSoluzioni:\n\u2022 Collega questi stati con nuove transizioni\n\u2022 Oppure elimina gli stati non necessari")):null}static generateStatesAndTransitions(e){const t=[...e.states].sort((e,t)=>(parseInt(e.id.replace("state-",""))||0)-(parseInt(t.id.replace("state-",""))||0)),n=t.length,a=new Map;t.forEach((e,t)=>{a.set(e.id,t+1)});const o="states = 0:".concat(n-1,";"),i=[];e.transitions.forEach(e=>{const t=a.get(e.source),n=a.get(e.target);let o=1;"exponential"===e.probabilityDistribution.type&&(o=e.probabilityDistribution.lambda),t&&n&&i.push("    ".concat(t,"  ").concat(n,"  ").concat(o,";   % State ").concat(t-1," \u2192 State ").concat(n-1," with rate ").concat(o))});return{statesDef:o,transitionsDef:"transitions = [\n".concat(i.join("\n"),"\n];"),stateCount:n}}static generateCTMCMatlabCode(e,t){const{statesDef:n,transitionsDef:a,stateCount:o}=this.generateStatesAndTransitions(e),i=e.states.find(e=>e.isInitial);let r=0;if(i){const e=parseInt(i.id.replace("state-",""));isNaN(e)||(r=e)}console.log("[CTMC] Creating initial distribution for ".concat(o," states, initial state: ").concat(r));const l=Array(o).fill(0);r>=0&&r<o?l[r]=1:(l[0]=1,console.warn("[CTMC] Initial state index ".concat(r," out of bounds, using state 0")));const s="pi0 = [".concat(l.join(" "),"];");console.log("[CTMC] Generated pi0: ".concat(s));let c="";if(t.simulationEnabled)c="Simulation";else switch(t.solverMethod){case"Transitorio":c="Transitorio";break;case"Uniformizzazione":c="Uniformized";break;case"Stazionario":c="Stazionario"}let u="",d="";switch(t.solverMethod){case"Transitorio":u="\n% Time evolution analysis\nt = ".concat(t.timeT,";\ndeltaT = ").concat(t.deltaT||.1,'; % Time step for probability evolution\n\n% Time loop for probability calculation\ntimeSteps = 0:deltaT:t;\nnumTimeSteps = length(timeSteps);\nnumStates = length(states);\n\n% Initialize probability matrix (time x states)\nprobabilityMatrix = zeros(numTimeSteps, numStates);\n\n% Calculate probability for each time step\nfprintf("\\nCalculating probability evolution...\\n");\nfor i = 1:numTimeSteps\n    currentTime = timeSteps(i);\n    if currentTime == 0\n        % Initial condition\n        probabilityMatrix(i, :) = pi0;\n    else\n        % Solve CTMC for current time\n        pi_t = solveCTMC(Q, pi0, currentTime);\n        probabilityMatrix(i, :) = pi_t;\n    end\n    \n    % Progress indicator\n    if mod(i, 10) == 0 || i == numTimeSteps\n        fprintf("Progress: %.1f%% (t=%.2f)\\n", (i/numTimeSteps)*100, currentTime);\n    end\nend\n\n% Final solution using expm\npi_t_expm = solveCTMC(Q, pi0, t);\nresult = pi_t_expm;'),d='fprintf("\\nDistribuzione transitoria a t=%.2f:\\n", t);\nfprintf("\u03c0(t=%.2f) = %s\\n", t, mat2str(result, 6));\nfprintf("Time evolution matrix: %dx%d (time x states)\\n", size(probabilityMatrix, 1), size(probabilityMatrix, 2));';break;case"Uniformizzazione":u="\n% Time evolution analysis using uniformization\nt = ".concat(t.timeT,";\ndeltaT = ").concat(t.deltaT||.1,'; % Time step for probability evolution\n\n% Time loop for probability calculation\ntimeSteps = 0:deltaT:t;\nnumTimeSteps = length(timeSteps);\nnumStates = length(states);\n\n% Initialize probability matrix (time x states)\nprobabilityMatrix = zeros(numTimeSteps, numStates);\n\n% Calculate probability for each time step\nfprintf("\\nCalculating probability evolution (uniformization)...\\n");\nfor i = 1:numTimeSteps\n    currentTime = timeSteps(i);\n    if currentTime == 0\n        % Initial condition\n        probabilityMatrix(i, :) = pi0;\n    else\n        % Solve CTMC for current time using uniformization\n        pi_t = solveCTMC(Q, pi0, currentTime, "method", "uniformization", "tol", 1e-12);\n        probabilityMatrix(i, :) = pi_t;\n    end\n    \n    % Progress indicator\n    if mod(i, 10) == 0 || i == numTimeSteps\n        fprintf("Progress: %.1f%% (t=%.2f)\\n", (i/numTimeSteps)*100, currentTime);\n    end\nend\n\n% Final solution using uniformization\npi_t_uni = solveCTMC(Q, pi0, t, "method", "uniformization", "tol", 1e-12);\nresult = pi_t_uni;'),d='fprintf("\\nDistribuzione transitoria (uniformizzazione) a t=%.2f:\\n", t);\nfprintf("\u03c0(t=%.2f) = %s\\n", t, mat2str(result, 6));\nfprintf("Time evolution matrix: %dx%d (time x states)\\n", size(probabilityMatrix, 1), size(probabilityMatrix, 2));';break;case"Stazionario":u="\n% Distribuzione stazionaria\npi_inf = stationaryPI(Q);\nresult = pi_inf;",d='fprintf("\\nDistribuzione stazionaria:\\n");\nfprintf("\u03c0(\u221e) = %s\\n", mat2str(result, 6));'}return"%% CTMC Solver - Generated by SHIFTAI\n% Modello: ".concat(e.states.length," stati, ").concat(e.transitions.length," transizioni\n% Metodo: ").concat(t.solverMethod,"\n% Tempo: ").concat(t.timeT,"\n\n% 1. Definisco lo spazio degli stati\n").concat(n,"\n\n% 2. Elenco delle transizioni [from to rate]\n").concat(a,"\n\n% 3. Costruisco il generatore Q\nQ = buildGenerator(states, transitions);\n\n% 4. Distribuzione iniziale\n").concat(s,"\n\n% 5. Risoluzione CTMC\n").concat(u,"\n\n% 6. Stampa risultati\n").concat(d,"\n\n% 7. Salvataggio risultati\nresultsFile = fullfile(pwd, 'output/results.mat');\nif exist('probabilityMatrix', 'var')\n    save(resultsFile, 'result', 'timeSteps', 'probabilityMatrix', 'Q', 'pi0', 'states', 'transitions', 't', 'deltaT');\n    fprintf(\"\\nRisultati salvati in: %s\\n\", resultsFile);\n    fprintf(\"Time evolution matrix: %dx%d (time x states)\\n\", size(probabilityMatrix, 1), size(probabilityMatrix, 2));\n    \n    % Also save as JSON for Node.js parsing\n    resultsStruct.timeSteps = timeSteps;\n    resultsStruct.probabilityMatrix = probabilityMatrix;\n    resultsStruct.result = result;\n    resultsStruct.states = states;\n    resultsStruct.transitions = transitions;\n    resultsStruct.t = t;\n    resultsStruct.deltaT = deltaT;\n    resultsStruct.Solver = '").concat(c,"';\n    resultsStruct.analysisTime = datestr(now, 'yyyy-mm-dd HH:MM:SS');\nelse\n    save(resultsFile, 'result', 'Q', 'pi0', 'states', 'transitions');\n    fprintf(\"\\nRisultati salvati in: %s\\n\", resultsFile);\n    \n    % Also save as JSON for Node.js parsing\n    resultsStruct.result = result;\n    resultsStruct.states = states;\n    resultsStruct.transitions = transitions;\n    resultsStruct.Solver = '").concat(c,"';\n    resultsStruct.analysisTime = datestr(now, 'yyyy-mm-dd HH:MM:SS');\nend\n\n% Convert to JSON and save\njsonFile = fullfile(pwd, 'output/results.json');\njsonText = jsonencode(resultsStruct);\nfid = fopen(jsonFile, 'w');\nif fid == -1\n    fprintf(\"Warning: Could not create JSON file\\n\");\nelse\n    fprintf(fid, '%s', jsonText);\n    fclose(fid);\n    fprintf(\"JSON results saved to: %s\\n\", jsonFile);\nend\n")}static async prepareFilesForBackend(e,t){try{console.log("\ud83d\udd0d [CTMC Export] Starting prepareFilesForBackend with model:",{states:e.states.length,transitions:e.transitions.length,options:t}),console.log("\ud83d\udd0d [CTMC Export] Validating exponential transitions...");const n=this.validateExponentialTransitions(e);if(n)throw console.error("\u274c [CTMC Export] Exponential validation failed:",n),new Error(n);console.log("\u2705 [CTMC Export] Exponential transitions validated"),console.log("\ud83d\udd0d [CTMC Export] Validating connected states...");const a=this.validateConnectedStates(e);if(a)throw console.error("\u274c [CTMC Export] Connectivity validation failed:",a),new Error(a);console.log("\u2705 [CTMC Export] Connected states validated"),console.log("\ud83d\udd0d [CTMC Export] Generating MATLAB code...");const o=this.generateCTMCMatlabCode(e,t);console.log("\u2705 [CTMC Export] MATLAB code generated: ".concat(o.length," chars")),console.log("\ud83d\udd0d [CTMC Export] Fetching CTMCSolver.m template...");const i=await fetch("/assets/CTMCSolver.m");if(!i.ok)throw console.error("\u274c [CTMC Export] Failed to fetch CTMCSolver.m:",i.status,i.statusText),new Error("Failed to fetch CTMCSolver.m template: ".concat(i.status," ").concat(i.statusText));let r=await i.text();return console.log("\u2705 [CTMC Export] CTMCSolver.m template fetched: ".concat(r.length," chars")),r.trim()||(console.log("\u26a0\ufe0f [CTMC Export] Template is empty, using generated code as fallback"),r=this.generateCTMCMatlabCode(e,t)),console.log("\u2705 [CTMC Export] CTMC files prepared - Model: ".concat(o.length," chars, Solver: ").concat(r.length," chars")),{modelContent:o,solverContent:r}}catch(n){throw console.error("\u274c [CTMC Export] prepareFilesForBackend failed:",n),console.error("\u274c [CTMC Export] Full error details:",{message:n instanceof Error?n.message:"Unknown error",stack:n instanceof Error?n.stack:"No stack trace",model:{states:e.states.length,transitions:e.transitions.length},options:t}),new Error("Failed to prepare CTMC files for backend: ".concat(n instanceof Error?n.message:"Unknown error"))}}static validateConfig(e,t){if(!e.libraryDirectory.trim())return"Seleziona una directory libreria valida";if(e.timeT<=0)return"Il tempo t deve essere maggiore di 0";if(0===t.states.length)return"Il modello CTMC \xe8 vuoto";const n=this.validateExponentialTransitions(t);if(n)return n;const a=this.validateConnectedStates(t);return a||null}static async exportToMatlab(e,t){const n=this.generateCTMCMatlabCode(e,t),a=new Blob([n],{type:"text/plain"});if("undefined"!==typeof window&&"showSaveFilePicker"in window)try{const e=t.filename||"ctmc-model-".concat((new Date).toISOString().split("T")[0],".m"),n=await window.showSaveFilePicker({suggestedName:e,types:[{description:"MATLAB Files",accept:{"text/plain":[".m"]}}]}),o=await n.createWritable();return await o.write(a),void await o.close()}catch(r){console.log("File System Access not available or cancelled, using fallback:",r)}const o=URL.createObjectURL(a),i=document.createElement("a");i.href=o,i.download=t.filename||"ctmc-model-".concat((new Date).toISOString().split("T")[0],".m"),i.click(),URL.revokeObjectURL(o)}}class Qu{static setProgressCallback(e){this.progressCallback=e}static updateProgress(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.progressCallback&&this.progressCallback({progress:e,currentStep:t,logOutput:n,isRunning:e<100,isCompleted:e>=100})}static async prepareFilesForBackend(e,t){try{console.log("\ud83d\udcc1 [CTMC] Preparing CTMC files for backend processing: ".concat(t.libraryDirectory));const n={timeT:t.timeT,deltaT:t.deltaT,solverMethod:t.solverMethod,simulationEnabled:t.simulationEnabled,filename:"ctmc-model-".concat((new Date).toISOString().split("T")[0],".m"),libraryDirectory:t.libraryDirectory};console.log("\ud83d\udd27 [CTMC] Export options:",n),console.log("\ud83d\udd0d [CTMC] Calling CTMCMatlabExportService.prepareFilesForBackend...");const a=await Ju.prepareFilesForBackend(e,n);return console.log("\u2705 [CTMC] CTMC files prepared - Model: ".concat(a.modelContent.length," chars, Solver: ").concat(a.solverContent.length," chars")),a}catch(n){throw console.error("\u274c [CTMC] prepareFilesForBackend failed:",n),console.error("\u274c [CTMC] Error details:",{message:n instanceof Error?n.message:"Unknown error",stack:n instanceof Error?n.stack:"No stack trace",config:t,modelStates:e.states.length,modelTransitions:e.transitions.length}),new Error("Failed to prepare CTMC files for backend: ".concat(n instanceof Error?n.message:"Unknown error"))}}static validateConfig(e,t){if(!e.libraryDirectory.trim())return"Seleziona una cartella libreria CTMC valida";if(e.timeT<=0)return"Il tempo t deve essere maggiore di 0";if(0===t.states.length)return"Il modello CTMC \xe8 vuoto";const n={timeT:e.timeT,deltaT:e.deltaT,solverMethod:e.solverMethod,simulationEnabled:e.simulationEnabled,libraryDirectory:e.libraryDirectory};return Ju.validateConfig(n,t)}static async executeMatlabCommand(e,t,n,a){return new Promise(async(o,i)=>{this.abortController=new AbortController,this.isRunning=!0;try{this.startCTMCMonitoring(e,t,n,a,o,i)}catch(r){this.isRunning=!1,this.abortController=null,i(r)}})}static async startCTMCMonitoring(e,t,a,o,i,r){this.updateProgress(0,"\ud83d\udd27 Controllo backend e avvio MATLAB...","Verifico backend e preparo analisi CTMC...");try{const{MatlabExecutionService:s}=await n.e(699).then(n.bind(n,699));if(await s.checkBackendAvailability()){this.updateProgress(0,"\ud83d\ude80 Lancio MATLAB via backend...","Backend API disponibile - avvio analisi CTMC automatica..."),console.log("\ud83d\udce6 Using prepared CTMC files for backend execution:"),console.log("   Model file: ".concat(o.modelContent.length," chars")),console.log("   Solver file: ".concat(o.solverContent.length," chars")),console.log("\ud83d\udd27 [CTMC Debug] Executing MATLAB with config:",{shyftaPath:e,modelName:"CTMCSolver",modelContentLength:o.modelContent.length,isCTMC:!0}),await s.startMatlabWithMonitoring({shyftaPath:e,modelName:"CTMCSolver",modelContent:o.modelContent,zftaContent:"% CTMC - No ZFTAMain needed",isCTMC:!0},(e,t)=>{console.log("\ud83d\udd0d [CTMC Debug] Raw progress: ".concat(e,"%")),console.log("\ud83d\udd0d [CTMC Debug] Raw output:",JSON.stringify(t));let n=e;["Simulazione completata con successo!","Risultati salvati in:","output/results.mat","results.mat","Time evolution matrix:","JSON results saved to:","results.json","SIMULATION_COMPLETED","\u03c0(t=","fprintf","save(","fullfile(pwd","mat2str("].some(e=>t.toLowerCase().includes(e.toLowerCase()))&&(n=100,console.log("\ud83c\udf89 [CTMC Debug] Success detected! Setting progress to 100%")),this.updateProgress(n,n>=100?"\u2705 MATLAB CTMC completato!":"\ud83d\udd04 MATLAB CTMC: ".concat(n.toFixed(2),"%"),"Log MATLAB CTMC:\n".concat(t)),console.log("\ud83d\udcca MATLAB CTMC Progress: ".concat(n.toFixed(2),"%"))}),this.updateProgress(100,"\u2705 Analisi CTMC completata! Caricamento risultati...","MATLAB CTMC terminato automaticamente.\nCaricamento e analisi dei risultati in corso...");try{console.log("\ud83d\udd04 [CTMCService] CTMC analysis completed successfully");await this.loadCTMCResults(e,t,a)?(console.log("\u2705 [CTMCService] CTMC results loaded successfully"),this.updateProgress(100,"\ud83c\udf89 Analisi CTMC completata! Risultati caricati.","Analisi CTMC completata con successo!\n\nMetodo: ".concat(a.solverMethod,"\nTempo: ").concat(a.timeT,"\nStati: ").concat(t.states.length,"\nTransizioni: ").concat(t.transitions.length,"\n\n\u2705 Risultati CTMC caricati e disponibili per la visualizzazione.\nControlla i dettagli degli stati per vedere le probabilit\xe0."))):(console.log("\u26a0\ufe0f [CTMCService] CTMC results loading failed"),this.updateProgress(100,"\u2705 Analisi CTMC completata!","Analisi CTMC completata con successo!\n\nMetodo: ".concat(a.solverMethod,"\nTempo: ").concat(a.timeT,"\nStati: ").concat(t.states.length,"\nTransizioni: ").concat(t.transitions.length,"\n\nRisultati salvati in output/results.mat")))}catch(l){console.error("\u274c [CTMCService] Error processing CTMC results:",l),this.updateProgress(100,"\u2705 Analisi CTMC completata!","MATLAB CTMC terminato automaticamente.\nControlla output/results.mat per i risultati.")}this.progressCallback&&this.progressCallback({progress:100,currentStep:"\ud83c\udf89 Analisi CTMC completata automaticamente!",logOutput:"Analisi CTMC eseguita dal backend.\nMetodo: ".concat(a.solverMethod,"\nRisultati disponibili in output/results.mat\n"),isRunning:!1,isCompleted:!0}),this.isRunning=!1,this.abortController=null,i()}else{console.error("\u274c Backend API non disponibile"),this.isRunning=!1,this.abortController=null;const e="Backend non disponibile per eseguire l'analisi CTMC MATLAB automaticamente.";this.progressCallback&&this.progressCallback({progress:0,currentStep:"\u274c Backend non disponibile",logOutput:"".concat(e,"\n\nPer risolvere:\n1. Avvia il backend: node backend-server.js\n2. Verifica che sia raggiungibile su http://").concat(window.location.hostname,":3001\n3. Riprova l'analisi CTMC\n"),isRunning:!1,isCompleted:!1}),r(new Error(e))}}catch(l){console.error("\u274c Errore durante esecuzione automatica CTMC:",l),this.isRunning=!1,this.abortController=null,this.progressCallback&&this.progressCallback({progress:0,currentStep:"\u274c Errore backend CTMC",logOutput:"Errore durante l'esecuzione CTMC via backend:\n".concat(l instanceof Error?l.message:"Errore sconosciuto","\n\nVerifica che:\n1. Il backend sia avviato (node backend-server.js)\n2. Il percorso libreria CTMC sia corretto\n3. MATLAB sia installato e nel PATH\n"),isRunning:!1,isCompleted:!1}),r(l)}}static async runAnalysis(e,t){try{console.log("\ud83d\udd04 [CTMC] Starting runAnalysis with config:",{libraryDirectory:t.libraryDirectory,timeT:t.timeT,deltaT:t.deltaT,solverMethod:t.solverMethod,simulationEnabled:t.simulationEnabled,statesCount:e.states.length,transitionsCount:e.transitions.length}),console.log("\ud83d\udd0d [CTMC] Step 1: Validating configuration...");const n=this.validateConfig(t,e);if(n)throw console.error("\u274c [CTMC] Validation failed:",n),new Error(n);console.log("\u2705 [CTMC] Validation passed"),this.updateProgress(0,"Preparazione analisi CTMC...","Validazione configurazione e preparazione file..."),console.log("\ud83d\udd0d [CTMC] Step 2: Preparing MATLAB files...");const a=await this.prepareFilesForBackend(e,t);console.log("\u2705 [CTMC] Files prepared successfully:",{modelContentLength:a.modelContent.length,solverContentLength:a.solverContent.length}),this.updateProgress(10,"Pulizia directory output...","Preparazione ambiente MATLAB..."),console.log("\ud83d\udd0d [CTMC] Step 4: Executing MATLAB command..."),await this.executeMatlabCommand(t.libraryDirectory,e,t,a),console.log("\u2705 [CTMC] MATLAB execution completed")}catch(n){throw console.error("\u274c [CTMC] runAnalysis failed:",n),console.error("\u274c [CTMC] Error stack:",n instanceof Error?n.stack:"No stack trace"),this.isRunning=!1,this.progressCallback&&this.progressCallback({progress:0,currentStep:"Errore durante la preparazione CTMC",logOutput:"Errore: ".concat(n instanceof Error?n.message:"Errore sconosciuto","\n\nStack trace:\n").concat(n instanceof Error?n.stack:"N/A","\n"),isRunning:!1,isCompleted:!1}),n}}static async stopAnalysis(){if(this.isRunning){try{const{MatlabExecutionService:e}=await n.e(699).then(n.bind(n,699));await e.stopMatlabSimulation()?console.log("\u2705 MATLAB CTMC analysis stopped via backend"):console.warn("\u26a0\ufe0f Failed to stop CTMC analysis via backend, using fallback")}catch(e){console.error("\u274c Error stopping MATLAB CTMC via backend:",e)}this.abortController&&this.abortController.abort(),this.isRunning=!1,console.log("\ud83d\uded1 CTMC analysis stop requested by user"),this.progressCallback&&this.progressCallback({progress:0,currentStep:"\u23f9\ufe0f Analisi CTMC arrestata dall'utente",logOutput:"Analisi CTMC interrotta manualmente.\n",isRunning:!1,isCompleted:!1})}}static isAnalysisRunning(){return this.isRunning}static resetAnalysis(){this.progressCallback&&this.progressCallback({progress:0,currentStep:"Pronto per nuova analisi CTMC",logOutput:"",isRunning:!1})}static async loadCTMCResults(e,t,n){try{return console.log("\ud83d\udd0d [CTMCService] Attempting to load CTMC results..."),!0}catch(a){return console.error("\u274c [CTMCService] Error loading CTMC results:",a),!1}}static generateDefaultModelName(){const e=new Date,t=e.getDate().toString().padStart(2,"0"),n=(e.getMonth()+1).toString().padStart(2,"0"),a=e.getFullYear(),o=e.getHours().toString().padStart(2,"0"),i=e.getMinutes().toString().padStart(2,"0"),r=e.getSeconds().toString().padStart(2,"0");return"CTMCSolver_".concat(t).concat(n).concat(a,"_").concat(o,":").concat(i,":").concat(r,".m")}}Qu.progressCallback=null,Qu.abortController=null,Qu.isRunning=!1;const Zu=e=>{let{isOpen:t,onClose:n,markovChainModel:o}=e;const[i,r]=(0,a.useState)(""),[l,s]=(0,a.useState)(100),[c,u]=(0,a.useState)(.1),[d,p]=(0,a.useState)(1e3),[m,h]=(0,a.useState)(.95),[f,g]=(0,a.useState)(!1),[v,b]=(0,a.useState)(!1),[y,x]=(0,a.useState)("Transitorio"),[C,S]=(0,a.useState)(!1),[w,k]=(0,a.useState)(!1),[N,j]=(0,a.useState)(0),[E,M]=(0,a.useState)(""),[T,P]=(0,a.useState)("");if((0,a.useEffect)(()=>{if(t){const e=localStorage.getItem("msolver-library-directory");e&&r(e),S(!1),k(!1),j(0),M(""),P("")}},[t]),(0,a.useEffect)(()=>{console.log("\ud83d\udd04 [MSolverModal] State update: isRunning=".concat(C,", isCompleted=").concat(w))},[C,w]),!t)return null;const z=async()=>{try{const e={libraryDirectory:i,timeT:l,deltaT:c,solverMethod:y,iterations:d,confidence:m,confidenceToggle:f,simulationEnabled:v};Qu.setProgressCallback(e=>{console.log("\ud83d\udd04 [MSolverModal] Progress update:",{progress:e.progress,isRunning:e.isRunning,isCompleted:e.isCompleted,currentStep:e.currentStep}),j(e.progress),M(e.currentStep),P(e.logOutput),S(e.isRunning),k(e.isCompleted||!1)}),await Qu.runAnalysis(o,e)}catch(e){S(!1),k(!1),j(0),M("\u274c Errore durante analisi CTMC");const t=e instanceof Error?e.message:"Errore sconosciuto";if(t.includes("Stati non collegati")){const e=t.match(/Stati non collegati trovati: ([^.]+)/),n=e?e[1]:"alcuni stati";alert("\u26a0\ufe0f Problema con il Modello Markov\n\n"+"Stato(i) isolato(i): ".concat(n,"\n\n")+"Ogni stato deve avere almeno una transizione in ingresso o in uscita per il solver CTMC.\n\nSoluzioni:\n"+"\u2022 Aggiungi transizioni per collegare ".concat(n,"\n")+"\u2022 Oppure elimina ".concat(n," se non necessario\n")+"\u2022 Verifica che tutte le transizioni siano state create correttamente")}else t.includes("non \xe8 esponenziale")?alert("\u26a0\ufe0f Problema con le Transizioni\n\n"+"".concat(t,"\n\n")+"Il solver CTMC richiede che tutte le transizioni abbiano distribuzione esponenziale.\n\nSoluzioni:\n\u2022 Cambia la distribuzione delle transizioni in 'Esponenziale'\n\u2022 Verifica i parametri \u03bb (lambda) delle transizioni"):t.includes("Backend non disponibile")?alert("\u26a0\ufe0f Backend Non Disponibile\n\nIl backend per l'esecuzione MATLAB non \xe8 raggiungibile.\n\nSoluzioni:\n\u2022 Avvia il backend: node backend-server.js\n\u2022 Verifica che sia raggiungibile su localhost:3001\n\u2022 Controlla la connessione di rete"):t.includes("Failed to fetch")?alert("\u26a0\ufe0f Problema di Connessione\n\nImpossibile caricare i file necessari per l'analisi CTMC.\n\nSoluzioni:\n\u2022 Verifica la connessione internet\n\u2022 Ricarica la pagina e riprova\n\u2022 Controlla che tutti i file siano presenti"):alert("\u274c Errore Analisi CTMC\n\n"+"".concat(t,"\n\n")+"Controlla la console per dettagli tecnici.");P("Errore: ".concat(t,"\n\nPossibili soluzioni:\n1. Verifica che tutti gli stati siano collegati\n2. Controlla che tutte le transizioni siano esponenziali\n3. Verifica che il backend sia attivo (node backend-server.js)\n4. Controlla il percorso della libreria CTMC\n"))}};return(0,Et.jsx)("div",{className:"msolver-modal-overlay",onClick:n,children:(0,Et.jsxs)("div",{className:"msolver-modal",onClick:e=>e.stopPropagation(),children:[(0,Et.jsxs)("div",{className:"msolver-modal-header",children:[(0,Et.jsx)("h2",{children:"\ud83d\udd2c MSolver - CTMC Analysis"}),(0,Et.jsx)("button",{className:"close-button",onClick:n,children:"\xd7"})]}),(0,Et.jsxs)("div",{className:"msolver-modal-content",children:[(0,Et.jsxs)("div",{className:"config-section",children:[(0,Et.jsx)("h3",{children:"\u2699\ufe0f Configurazione"}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"\ud83d\udcc1 Directory Libreria:"}),(0,Et.jsx)("div",{className:"folder-input",children:(0,Et.jsx)("input",{type:"text",value:i,onChange:e=>{r(e.target.value),localStorage.setItem("msolver-library-directory",e.target.value)},placeholder:"C:\\MSolver\\lib",disabled:C,className:"folder-name-input"})}),(0,Et.jsx)("small",{className:"folder-help",children:"\ud83d\udca1 Inserisci il path assoluto della directory della libreria MSolver"})]}),(0,Et.jsxs)("div",{className:"form-row",children:[(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"\u23f0 Tempo t:"}),(0,Et.jsx)("input",{type:"number",value:l,onChange:e=>s(Number(e.target.value)),min:"0.1",step:"0.1",disabled:C})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"\u23f1\ufe0f Delta t:"}),(0,Et.jsx)("input",{type:"number",value:c,onChange:e=>u(Number(e.target.value)),min:"0.01",step:"0.01",disabled:C})]})]}),(0,Et.jsxs)("div",{className:"simulation-settings-group",children:[(0,Et.jsxs)("div",{className:"simulation-toggle-header",children:[(0,Et.jsxs)("label",{className:"toggle-switch",children:[(0,Et.jsx)("input",{type:"checkbox",checked:v,onChange:e=>b(e.target.checked),disabled:C}),(0,Et.jsx)("span",{className:"toggle-slider"})]}),(0,Et.jsx)("span",{className:"toggle-label",children:"Abilita Simulazione"}),(0,Et.jsxs)("div",{className:"tooltip-container",children:[(0,Et.jsx)("span",{className:"info-icon",children:"\u2139\ufe0f"}),(0,Et.jsxs)("div",{className:"tooltip",children:[(0,Et.jsx)("strong",{children:"Simulazione vs Analitico:"}),(0,Et.jsx)("br",{}),"\u2022 ",(0,Et.jsx)("strong",{children:"Simulazione ON:"})," Usa algoritmi Monte Carlo per calcolare probabilit\xe0 attraverso campionamento stocastico. Supporta tutti i tipi di distribuzione.",(0,Et.jsx)("br",{}),"\u2022 ",(0,Et.jsx)("strong",{children:"Simulazione OFF:"})," Usa metodi analitici deterministici (expm, uniformizzazione). Solo per distribuzioni esponenziali.",(0,Et.jsx)("br",{}),(0,Et.jsx)("em",{children:"I due metodi sono mutuamente esclusivi."})]})]}),(0,Et.jsx)("span",{className:"toggle-status",children:v?"ABILITATA":"DISABILITATA"})]}),(0,Et.jsxs)("div",{className:"simulation-parameters",children:[(0,Et.jsxs)("div",{className:"form-row",children:[(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"\ud83d\udd04 Iterazioni:"}),(0,Et.jsx)("input",{type:"number",value:d,onChange:e=>p(Number(e.target.value)),min:"1",disabled:C||!v,className:v?"":"disabled-input"})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"\ud83d\udcca Intervallo di Confidenza:"}),(0,Et.jsx)("input",{type:"number",value:m,onChange:e=>h(Number(e.target.value)),min:"0.01",max:"0.99",step:"0.01",disabled:C||!v,className:v?"":"disabled-input"})]})]}),(0,Et.jsx)("div",{className:"form-group",children:(0,Et.jsxs)("div",{className:"stop-criteria-group",children:[(0,Et.jsx)("span",{className:"toggle-label",children:"Stop Criteria:"}),(0,Et.jsxs)("label",{className:"toggle-switch",children:[(0,Et.jsx)("input",{type:"checkbox",checked:f,onChange:e=>g(e.target.checked),disabled:C||!v}),(0,Et.jsx)("span",{className:"toggle-slider"})]}),(0,Et.jsx)("span",{className:"toggle-status",children:f?"ON":"OFF"})]})})]})]}),(0,Et.jsxs)("div",{className:"form-group",children:[(0,Et.jsx)("label",{children:"\ud83d\udd2c Metodo di Risoluzione Analitica:"}),(0,Et.jsxs)("select",{value:y,onChange:e=>x(e.target.value),disabled:C||v,className:"solver-method-select ".concat(v?"disabled-input":""),children:[(0,Et.jsx)("option",{value:"Transitorio",children:"Transitorio (expm)"}),(0,Et.jsx)("option",{value:"Uniformizzazione",children:"Uniformizzazione"}),(0,Et.jsx)("option",{value:"Stazionario",children:"Stazionario"})]}),(0,Et.jsxs)("small",{className:"solver-help",children:["\ud83d\udca1 ",v?"Disabilitato durante la simulazione":"Disponibile solo per risoluzione analitica (con transizioni esponenziali)"]})]})]}),(C||w)&&(0,Et.jsxs)("div",{className:"progress-section",children:[(0,Et.jsx)("h3",{children:C?"\ud83d\udd04 Analisi CTMC in Corso":"\u2705 Analisi CTMC Completata"}),(0,Et.jsxs)("div",{className:"progress-info",children:[(0,Et.jsx)("div",{className:"current-step",children:w?"Analisi completata con successo!":E}),(0,Et.jsxs)("div",{className:"progress-bar",children:[(0,Et.jsx)("div",{className:"progress-fill",style:{width:"".concat(N,"%")}}),(0,Et.jsxs)("span",{className:"progress-text",children:[N.toFixed(1),"%"]})]})]}),(0,Et.jsxs)("div",{className:"log-output",children:[(0,Et.jsxs)("div",{className:"log-header",children:[(0,Et.jsx)("h4",{children:"\ud83d\udcdd Output Log:"}),w&&(0,Et.jsx)("button",{className:"close-log-button",onClick:()=>{k(!1),j(0),M(""),P("")},children:"\u2716\ufe0f Chiudi Log"})]}),(0,Et.jsx)("textarea",{value:T,readOnly:!0,rows:6,placeholder:"I log dell'analisi CTMC appariranno qui..."})]})]}),(0,Et.jsxs)("div",{className:"model-info",children:[(0,Et.jsx)("h3",{children:"\ud83d\udccb Informazioni Modello Markov"}),(0,Et.jsxs)("div",{className:"info-grid",children:[(0,Et.jsxs)("div",{className:"info-item",children:[(0,Et.jsx)("span",{className:"info-label",children:"Stati:"}),(0,Et.jsx)("span",{className:"info-value",children:o.states.length})]}),(0,Et.jsxs)("div",{className:"info-item",children:[(0,Et.jsx)("span",{className:"info-label",children:"Transizioni:"}),(0,Et.jsx)("span",{className:"info-value",children:o.transitions.length})]}),(0,Et.jsxs)("div",{className:"info-item",children:[(0,Et.jsx)("span",{className:"info-label",children:"Tempo t:"}),(0,Et.jsx)("span",{className:"info-value",children:l})]}),(0,Et.jsxs)("div",{className:"info-item",children:[(0,Et.jsx)("span",{className:"info-label",children:"Delta t:"}),(0,Et.jsx)("span",{className:"info-value",children:c})]})]})]})]}),(0,Et.jsxs)("div",{className:"msolver-modal-actions",children:[(0,Et.jsx)("button",{className:"cancel-button",onClick:n,disabled:C,children:C?"Chiudi quando completato":"Chiudi"}),!C&&(0,Et.jsx)("button",{className:"test-button ".concat(w?"":"disabled"),onClick:w?async()=>{console.log("\ud83d\udd04 [MSolverModal] Retrieving CTMC results...");await Hu.loadResults()?alert("\u2705 Risultati CTMC caricati con successo! Le probabilit\xe0 sono ora visibili sui nodi degli stati."):alert("\u274c Errore nel caricamento dei risultati CTMC. Verifica che l'analisi sia stata completata.")}:void 0,disabled:!w,title:w?"Carica risultati CTMC dal file results.json":"Completa prima una Run CTMC per abilitare il caricamento dei risultati",children:"\ud83d\udd0d Retrieve Results"}),!C&&!w&&(0,Et.jsx)("button",{className:"run-button primary",onClick:z,disabled:!i,children:"\ud83d\ude80 RUN CTMC"}),!C&&w&&(0,Et.jsx)("button",{className:"run-button primary",onClick:()=>{k(!1),j(0),M(""),P(""),z()},disabled:!i,children:"\ud83d\udd04 Esegui Nuovamente"}),C&&(0,Et.jsx)("button",{className:"stop-button",onClick:async()=>{try{await Qu.stopAnalysis()}catch(e){console.error("Error stopping CTMC analysis:",e),S(!1),M("Analisi interrotta"),P(e=>e+"Analisi interrotta dall'utente\n")}},children:"\u23f9\ufe0f Ferma Analisi"})]})]})})},ed=e=>{let{isOpen:t,onClose:n,stateId:o,stateName:i,matlabStateIndex:r}=e;const[l,s]=(0,a.useState)(null),[c,u]=(0,a.useState)(!1),[d,p]=(0,a.useState)(null),[m,h]=(0,a.useState)(null);(0,a.useEffect)(()=>{t&&f()},[t]);const f=async()=>{u(!0),p(null);try{console.log("\ud83d\udd04 [CTMCResultsModal] loadCTMCResults called - using localStorage path");const e=localStorage.getItem("msolver-library-directory");if(console.log('\ud83d\udd0d Retrieved library path from localStorage: "'.concat(e,'"')),!e)throw new Error("Path della libreria CTMC non trovato. Configura il path nel MSolver e riprova.");const t="http://".concat(window.location.hostname,":3001/api/ctmc/results?libraryPath=").concat(encodeURIComponent(e));console.log("\ud83d\udd17 Requesting: ".concat(t));const n=await fetch(t);if(!n.ok)throw 404===n.status?new Error("Risultati CTMC non trovati. Assicurati di aver eseguito l'analisi CTMC con successo prima di visualizzare i risultati."):new Error("Errore nel caricamento dei risultati CTMC (".concat(n.status,"). Verifica che il backend sia attivo."));const a=await n.json();console.log("\u2705 CTMC data loaded:",a.source,a.data?"with data":"no data");const o=r?r-1:0,i=g(a.data||a,o);s(i)}catch(e){console.error("Error loading CTMC results:",e),p(e instanceof Error?e.message:"Errore nel caricamento dei risultati")}finally{u(!1)}},g=(e,t)=>{const n=e.Solver||e.solverMethod||"Transitorio",a="Stazionario"===n;console.log("\ud83d\udd0d [DEBUG] Extracting results for state ".concat(t,":")),console.log("   Solver method: ".concat(n)),console.log("   Is steady state: ".concat(a)),console.log("   Raw data.result:",e.result);let r=0;if(e.result&&Array.isArray(e.result))r=e.result[t]||0,console.log("   Using result array[".concat(t,"]: ").concat(r));else if(e.result&&"string"===typeof e.result){const n=e.result.trim().split(/\s+/).map(e=>parseFloat(e)).filter(e=>!isNaN(e));console.log("   Parsed probabilities from string:",n),r=n[t]||0,console.log("   Selected probability for state ".concat(t,": ").concat(r))}else e.result&&"number"===typeof e.result&&(r=0===t?e.result:0,console.log("   Using single number for state 0: ".concat(r)));if(a)return console.log("\u2705 Steady-state result for state ".concat(t,": ").concat(r)),{stateId:o,stateName:i||"State ".concat(t),stateIndex:t,probabilityEvolution:[],finalProbability:r,averageProbability:r,solverMethod:n,isSteadyState:!0};const l=e.timeSteps||[],s=e.probabilityMatrix||[];let c=[],u=r;return l.length>0&&s.length>0?(c=l.map((e,n)=>({time:e,probability:s[n]&&s[n][t]?s[n][t]:0})),c.length>0&&(u=c.reduce((e,t)=>e+t.probability,0)/c.length),console.log("\u2705 Transient evolution built: ".concat(c.length," time points"))):(console.log("\u26a0\ufe0f No time evolution data available, using final probability only"),c=[{time:0,probability:0===t?1:0},{time:e.t||1,probability:r}]),console.log("\u2705 Transient result for state ".concat(t,": final=").concat(r,", avg=").concat(u)),{stateId:o,stateName:i||"State ".concat(t),stateIndex:t,probabilityEvolution:c,finalProbability:r,averageProbability:u,solverMethod:n,isSteadyState:!1}},v=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;return parseFloat(e.toFixed(t)).toString()};return t?(0,Et.jsx)("div",{className:"modal-overlay",onClick:n,children:(0,Et.jsxs)("div",{className:"ctmc-results-modal",onClick:e=>e.stopPropagation(),children:[(0,Et.jsxs)("div",{className:"modal-header",children:[(0,Et.jsxs)("h2",{children:["\ud83d\udd2c Risultati CTMC - ",i||"Stato ".concat(r?r-1:0)]}),(0,Et.jsx)("button",{className:"close-button",onClick:n,children:"\xd7"})]}),(0,Et.jsx)("div",{className:"modal-content",children:c?(0,Et.jsxs)("div",{className:"loading-message",children:[(0,Et.jsx)("div",{className:"spinner"}),(0,Et.jsx)("p",{children:"Caricamento risultati CTMC..."})]}):d?(0,Et.jsxs)("div",{className:"error-message",children:[(0,Et.jsx)("h3",{children:"\u274c Errore"}),(0,Et.jsx)("p",{children:d}),(0,Et.jsx)("button",{onClick:f,className:"retry-button",children:"\ud83d\udd04 Riprova"})]}):l?(0,Et.jsxs)("div",{className:"results-content",children:[l?(0,Et.jsxs)("div",{className:"ctmc-results-summary",children:[(0,Et.jsx)("h3",{children:"\ud83d\udcca Risultati Stato CTMC"}),(0,Et.jsxs)("div",{className:"results-grid",children:[(0,Et.jsxs)("div",{className:"result-card",children:[(0,Et.jsx)("div",{className:"result-label",children:"Nome Stato"}),(0,Et.jsx)("div",{className:"result-value",children:l.stateName})]}),(0,Et.jsxs)("div",{className:"result-card",children:[(0,Et.jsx)("div",{className:"result-label",children:"Indice MATLAB"}),(0,Et.jsx)("div",{className:"result-value",children:l.stateIndex})]}),(0,Et.jsxs)("div",{className:"result-card",children:[(0,Et.jsx)("div",{className:"result-label",children:"Metodo"}),(0,Et.jsx)("div",{className:"result-value",children:l.solverMethod||"Transitorio"})]}),(0,Et.jsxs)("div",{className:"result-card probability-card",children:[(0,Et.jsx)("div",{className:"result-label",children:l.isSteadyState?"Probabilit\xe0 Stazionaria":"Probabilit\xe0 Finale"}),(0,Et.jsxs)("div",{className:"result-value probability-value",children:[(100*l.finalProbability).toFixed(2),"%"]})]}),!l.isSteadyState&&(0,Et.jsxs)("div",{className:"result-card average-card",children:[(0,Et.jsx)("div",{className:"result-label",children:"Probabilit\xe0 Media"}),(0,Et.jsxs)("div",{className:"result-value average-value",children:[(100*l.averageProbability).toFixed(2),"%"]})]})]}),(0,Et.jsxs)("div",{className:"detailed-info",children:[(0,Et.jsx)("h4",{children:"\ud83d\udccb Informazioni sull'Analisi CTMC"}),(0,Et.jsxs)("div",{className:"info-grid",children:[(0,Et.jsxs)("div",{className:"info-item",children:[(0,Et.jsx)("strong",{children:"Catena di Markov:"})," Processo stocastico che modella le transizioni tra stati con rates esponenziali."]}),l.isSteadyState?(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsxs)("div",{className:"info-item",children:[(0,Et.jsx)("strong",{children:"Analisi Stazionaria:"})," Calcola la distribuzione di probabilit\xe0 a regime (t \u2192 \u221e) quando il sistema raggiunge l'equilibrio."]}),(0,Et.jsxs)("div",{className:"info-item",children:[(0,Et.jsx)("strong",{children:"Probabilit\xe0 Stazionaria:"})," \u03c0",(0,Et.jsx)("sub",{children:l.stateIndex})," rappresenta la frazione di tempo che il sistema trascorre nello stato ",l.stateIndex," a lungo termine."]})]}):(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsxs)("div",{className:"info-item",children:[(0,Et.jsx)("strong",{children:"Probabilit\xe0 di Stato:"})," \u03c0",(0,Et.jsx)("sub",{children:l.stateIndex}),"(t) rappresenta la probabilit\xe0 di essere nello stato ",l.stateIndex," al tempo t."]}),(0,Et.jsxs)("div",{className:"info-item",children:[(0,Et.jsx)("strong",{children:"Evoluzione Temporale:"})," La probabilit\xe0 cambia nel tempo secondo l'equazione differenziale d\u03c0/dt = \u03c0Q."]})]})]})]})]}):null,(()=>{if(!l)return null;if(l.isSteadyState)return(0,Et.jsx)("div",{className:"chart-placeholder",children:(0,Et.jsxs)("div",{className:"steady-state-info",children:[(0,Et.jsx)("h3",{children:"\ud83d\udcca Analisi Stazionaria Completata"}),(0,Et.jsx)("div",{className:"steady-state-result",children:(0,Et.jsxs)("div",{className:"steady-state-card",children:[(0,Et.jsxs)("div",{className:"steady-state-label",children:["Probabilit\xe0 Stazionaria \u03c0",(0,Et.jsx)("sub",{children:l.stateIndex})]}),(0,Et.jsxs)("div",{className:"steady-state-value",children:[(100*l.finalProbability).toFixed(4),"%"]})]})}),(0,Et.jsxs)("p",{className:"steady-state-description",children:[(0,Et.jsx)("strong",{children:"Interpretazione:"})," A lungo termine, il sistema trascorre il ",(100*l.finalProbability).toFixed(2),"% del tempo nello stato ",l.stateIndex,". Questo valore rappresenta la probabilit\xe0 stazionaria calcolata risolvendo il sistema \u03c0Q = 0 con \u2211\u03c0",(0,Et.jsx)("sub",{children:"i"})," = 1."]})]})});if(!l.probabilityEvolution.length)return(0,Et.jsx)("div",{className:"chart-placeholder",children:(0,Et.jsxs)("div",{className:"chart-error",children:[(0,Et.jsx)("h3",{children:"Evoluzione Probabilit\xe0 nel Tempo"}),(0,Et.jsx)("p",{children:"\u274c Dati non disponibili per la visualizzazione"}),(0,Et.jsx)("p",{children:"Esegui prima l'analisi CTMC per generare i dati."})]})});const e=l.probabilityEvolution,t=Math.max(...e.map(e=>e.time)),n=Math.max(...e.map(e=>e.probability)),a=300,o=20,i=60,r=600-i-30,s=a-o-50,c=e.map((e,a)=>{const l=i+e.time/t*r,c=o+s-e.probability/n*s;return"".concat(0===a?"M":"L"," ").concat(l," ").concat(c)}).join(" ");return(0,Et.jsxs)("div",{className:"chart-container",children:[(0,Et.jsxs)("h3",{children:["\ud83d\udcc8 Evoluzione Probabilit\xe0 \u03c0",(0,Et.jsx)("sub",{children:l.stateIndex}),"(t)"]}),(0,Et.jsx)("div",{className:"chart-wrapper",children:(0,Et.jsxs)("svg",{width:600,height:a,className:"ctmc-chart",children:[(0,Et.jsx)("defs",{children:(0,Et.jsx)("pattern",{id:"ctmc-grid",width:"40",height:"30",patternUnits:"userSpaceOnUse",children:(0,Et.jsx)("path",{d:"M 40 0 L 0 0 0 30",fill:"none",stroke:"#e0e0e0",strokeWidth:"1"})})}),(0,Et.jsx)("rect",{width:r,height:s,x:i,y:o,fill:"url(#ctmc-grid)"}),(0,Et.jsx)("line",{x1:i,y1:o+s,x2:i+r,y2:o+s,stroke:"#333",strokeWidth:"2"}),(0,Et.jsx)("line",{x1:i,y1:o,x2:i,y2:o+s,stroke:"#333",strokeWidth:"2"}),(0,Et.jsx)("path",{d:c,fill:"none",stroke:"#3498db",strokeWidth:"3"}),e.filter((e,t)=>t%5===0).map((e,a)=>{const l=i+e.time/t*r,c=o+s-e.probability/n*s;return(0,Et.jsx)("circle",{cx:l,cy:c,r:"4",fill:"#3498db",stroke:"white",strokeWidth:"2",style:{cursor:"pointer"},onMouseEnter:()=>h({x:l,y:c-10,time:e.time,probability:e.probability}),onMouseLeave:()=>h(null)},a)}),(0,Et.jsx)("text",{x:i+r/2,y:290,textAnchor:"middle",className:"axis-label",children:"Tempo (unit\xe0)"}),(0,Et.jsxs)("text",{x:15,y:o+s/2,textAnchor:"middle",transform:"rotate(-90, 15, ".concat(o+s/2,")"),className:"axis-label",children:["Probabilit\xe0 \u03c0",(0,Et.jsx)("tspan",{fontSize:"10",dy:"3",children:l.stateIndex}),"(t)"]}),[0,.25,.5,.75,1].map(e=>(0,Et.jsx)("text",{x:i+e*r,y:275,textAnchor:"middle",className:"axis-tick",children:v(e*t,1)},e)),[0,.25,.5,.75,1].map(e=>(0,Et.jsx)("text",{x:i-10,y:o+s-e*s+5,textAnchor:"end",className:"axis-tick",children:v(e*n,3)},e)),m&&(0,Et.jsxs)("g",{children:[(0,Et.jsx)("rect",{x:m.x-40,y:m.y-30,width:"80",height:"25",fill:"#333",fillOpacity:"0.9",rx:"4",stroke:"#fff",strokeWidth:"1"}),(0,Et.jsxs)("text",{x:m.x,y:m.y-18,textAnchor:"middle",fill:"white",fontSize:"10",fontWeight:"bold",children:["t=",v(m.time,2)]}),(0,Et.jsxs)("text",{x:m.x,y:m.y-8,textAnchor:"middle",fill:"white",fontSize:"10",fontWeight:"bold",children:["\u03c0=",v(m.probability,4)]})]})]})}),(0,Et.jsxs)("div",{className:"chart-description",children:[(0,Et.jsxs)("p",{children:[(0,Et.jsx)("strong",{children:"Grafico:"})," Mostra l'evoluzione della probabilit\xe0 di essere nello stato ",l.stateIndex," nel tempo."]}),(0,Et.jsxs)("p",{className:"chart-stats",children:["\ud83d\udcca ",(0,Et.jsx)("strong",{children:"Punti dati:"})," ",e.length," |",(0,Et.jsx)("strong",{children:" Tempo max:"})," ",v(t,1)," |",(0,Et.jsx)("strong",{children:" Prob max:"})," ",v(n,3)]})]})]})})()]}):(0,Et.jsxs)("div",{className:"no-data-message",children:[(0,Et.jsx)("p",{children:"\u274c Nessun dato disponibile"}),(0,Et.jsx)("p",{children:"Esegui prima un'analisi CTMC per visualizzare i risultati."})]})}),(0,Et.jsx)("div",{className:"modal-footer",children:(0,Et.jsx)("button",{className:"close-modal-button",onClick:n,children:"Chiudi"})})]})}):null},td=()=>{var e;const t=fe(),{showLLMConfigModal:n,setShowLLMConfigModal:o,updateLLMConfig:i}=Tt(),{saveMarkovChainSnapshot:r,getMarkovChainSnapshot:l,clearSnapshots:s,saveMarkovChainOpenedFile:c,getMarkovChainOpenedFile:d}=Rt(),{isDarkMode:p,toggleDarkMode:m}=Dt(),{isRightPanelCollapsed:h,toggleRightPanel:f}=Lt(),[g,v]=(0,a.useState)({states:[],transitions:[]}),[b,y]=(0,a.useState)(null),[x,C]=(0,a.useState)(!1),[S,w]=(0,a.useState)(!1),[k,N]=(0,a.useState)(!1),[j,E]=(0,a.useState)(!1),[M,T]=(0,a.useState)(null),[P,z]=(0,a.useState)(!1),[_,R]=(0,a.useState)(!1),[A,I]=(0,a.useState)(null),[D,O]=(0,a.useState)(1),[F,L]=(0,a.useState)(!1),B=d(),U=(0,a.useCallback)(()=>{const e=g.states.map(e=>{const t=e.name.match(/^S(\d+)$/);return t?parseInt(t[1]):0}).filter(e=>e>0),t=e.length>0?Math.max(...e):0;O(t+1)},[g.states]);(0,a.useEffect)(()=>{U()},[U]),(0,a.useEffect)(()=>{const e=l();e&&0===g.states.length&&0===g.transitions.length&&(L(!0),v(e),setTimeout(()=>L(!1),100))},[l,g.states.length,g.transitions.length]),(0,a.useEffect)(()=>{(g.states.length>0||g.transitions.length>0)&&r(g)},[g,r]);const H=(0,a.useCallback)(e=>{const t={id:"state-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),type:"state",name:"S".concat(D),position:e||{x:100,y:100},rewardFunction:1,isAbsorbing:!1,isInitial:!1};v(e=>u(u({},e),{},{states:[...e.states,t]})),U()},[D,U]),W=(0,a.useCallback)(e=>{y(e),"state"===e.type?C(!0):"transition"===e.type&&w(!0)},[]),V=(0,a.useCallback)(e=>{_&&"state"===A&&H(e)},[_,A,H]),G=(0,a.useCallback)(()=>{R(e=>{const t=!e;return I(t?"state":null),t})},[]),Y=(0,a.useCallback)(e=>{"state"===e.type?(v(t=>u(u({},t),{},{states:t.states.map(t=>t.id===e.id?e:t)})),C(!1)):"transition"===e.type&&(v(t=>u(u({},t),{},{transitions:t.transitions.map(t=>t.id===e.id?e:t)})),w(!1)),y(null)},[]),X=(0,a.useCallback)(e=>{v(t=>u(u({},t),{},{states:t.states.filter(t=>t.id!==e),transitions:t.transitions.filter(t=>t.id!==e&&t.source!==e&&t.target!==e)}))},[]),K=(0,a.useCallback)(e=>{v(t=>u(u({},t),{},{transitions:t.transitions.filter(t=>t.source!==e)}))},[]),q=(0,a.useCallback)(e=>{v(t=>u(u({},t),{},{states:t.states.map(t=>u(u({},t),{},{isInitial:t.id===e}))}))},[]),$=(0,a.useCallback)((e,t,n,a)=>{console.log("Creating connection:",{source:e,target:t,sourceHandle:n,targetHandle:a});const o=g.states.find(t=>t.id===e);if(o&&o.isAbsorbing)return void alert("Cannot create transitions from an absorbing state. Absorbing states have no outgoing transitions.");const i={id:"transition-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),type:"transition",source:e,target:t,sourceHandle:n,targetHandle:a,probabilityDistribution:{type:"exponential",lambda:1}};v(e=>u(u({},e),{},{transitions:[...e.transitions,i]}))},[g.states]),J=(0,a.useCallback)(async()=>{try{const e=await wu.saveModelWithOverwrite(g,"markov-chain",null===B||void 0===B?void 0:B.fileHandle,null===B||void 0===B?void 0:B.filename);c(e),alert("Markov Chain salvato con successo!")}catch(e){alert("Errore durante il salvataggio: ".concat(e instanceof Error?e.message:"Errore sconosciuto"))}},[g,c,B]),Q=(0,a.useCallback)(async()=>{if("undefined"!==typeof window&&"showOpenFilePicker"in window)try{const[e]=await window.showOpenFilePicker({types:[{description:"JSON Files",accept:{"application/json":[".json"]}}]}),t=await e.getFile(),{model:n}=await wu.openModelWithValidation(t,"markov-chain");v(n),c({url:URL.createObjectURL(t),filename:t.name,fileHandle:e}),alert("Markov Chain caricato con successo!")}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;if(e instanceof Error&&"NotAllowedError"===e.name)return void alert('Permessi negati per l\'accesso ai file. Usa il pulsante "Apri" per selezionare manualmente un file.');console.error("Errore durante l'apertura del file:",e),alert("Errore durante l'apertura del file: ".concat(e instanceof Error?e.message:"Errore sconosciuto"))}else{const t=document.createElement("input");t.type="file",t.accept=".json",t.onchange=async t=>{var n;const a=null===(n=t.target.files)||void 0===n?void 0:n[0];if(a)try{const{model:e}=await wu.openModelWithValidation(a,"markov-chain");v(e),c({url:URL.createObjectURL(a),filename:a.name}),alert("Markov Chain caricato con successo!")}catch(e){alert("Errore nel caricamento del file: ".concat(e instanceof Error?e.message:"Errore sconosciuto"))}},t.click()}},[c]),Z=(0,a.useCallback)(()=>{const e="// Markov Chain Model\n// States: ".concat(g.states.length,"\n// Transitions: ").concat(g.transitions.length,"\n\nStates:\n").concat(g.states.map(e=>"- ".concat(e.name,": ").concat(e.isAbsorbing?"Absorbing":"Transient",", Reward: ").concat(e.rewardFunction)).join("\n"),"\n\nTransitions:\n").concat(g.transitions.map(e=>{var t,n;const a=(null===(t=g.states.find(t=>t.id===e.source))||void 0===t?void 0:t.name)||e.source,o=(null===(n=g.states.find(t=>t.id===e.target))||void 0===n?void 0:n.name)||e.target,i=e.probabilityDistribution;let r="";switch(i.type){case"constant":r="p=".concat(i.probability);break;case"exponential":r="\u03bb=".concat(i.lambda);break;case"weibull":r="k=".concat(i.k,", \u03bb=").concat(i.lambda,", \u03bc=").concat(i.mu);break;case"normal":r="\u03bc=".concat(i.mu,", \u03c3=").concat(i.sigma)}return"- ".concat(a," \u2192 ").concat(o,": ").concat(i.type,"(").concat(r,")")}).join("\n")),t=new Blob([e],{type:"text/plain"}),n=URL.createObjectURL(t),a=document.createElement("a");a.href=n,a.download="markov-chain-code-".concat(Date.now(),".txt"),a.click(),URL.revokeObjectURL(n)},[g]),ee=(0,a.useCallback)(()=>{J()},[J]),te=(0,a.useCallback)(()=>{alert("XML export for Markov chains not implemented yet")},[]),ne=(0,a.useCallback)(()=>{const e=["ID,Name,Type,RewardFunction,IsAbsorbing",...g.states.map(e=>"".concat(e.id,",").concat(e.name,",State,").concat(e.rewardFunction,",").concat(e.isAbsorbing))].join("\n"),t=["ID,Source,Target,DistributionType,Parameters",...g.transitions.map(e=>{const t=e.probabilityDistribution;let n="";switch(t.type){case"constant":n="probability=".concat(t.probability);break;case"exponential":n="lambda=".concat(t.lambda);break;case"weibull":n="k=".concat(t.k,";lambda=").concat(t.lambda,";mu=").concat(t.mu);break;case"normal":n="mu=".concat(t.mu,";sigma=").concat(t.sigma)}return"".concat(e.id,",").concat(e.source,",").concat(e.target,",").concat(t.type,',"').concat(n,'"')})].join("\n"),n="States:\n".concat(e,"\n\nTransitions:\n").concat(t),a=new Blob([n],{type:"text/csv"}),o=URL.createObjectURL(a),i=document.createElement("a");i.href=o,i.download="markov-chain-".concat(Date.now(),".csv"),i.click(),URL.revokeObjectURL(o)},[g]),ae=(0,a.useCallback)(()=>{alert("MATLAB export for Markov chains not implemented yet")},[]),oe=(0,a.useCallback)(()=>{o(!0)},[o]),ie=(0,a.useCallback)(e=>{i(e)},[i]),re=(0,a.useCallback)(e=>{v(e)},[]),le=(0,a.useCallback)(()=>{(g.states.length>0||g.transitions.length>0)&&window.confirm("Are you sure you want to create a new model? All unsaved changes will be lost.")&&(v({states:[],transitions:[]}),y(null),c(null))},[g,c]),se=(0,a.useCallback)(()=>{m()},[m]),ce=(0,a.useCallback)(()=>{r(g),t("/fault-tree-editor")},[t,r,g]),ue=(0,a.useCallback)(()=>{},[]),de=(0,a.useCallback)(()=>{N(!0)},[]),pe=(0,a.useCallback)(e=>{T(e),E(!0)},[]),me=(0,a.useCallback)(()=>{t("/")},[t]),he=(0,a.useCallback)(e=>{v(e)},[]),ge=(0,a.useCallback)(()=>{z(e=>!e)},[]),ve=(0,a.useCallback)(()=>{f()},[f]),be=(0,a.useCallback)(()=>{if(0===g.states.length)return;const e=Math.ceil(Math.sqrt(g.states.length)),t=g.states.map((t,n)=>{const a=Math.floor(n/e),o=n%e;return u(u({},t),{},{position:{x:200*o,y:200*a}})});v(u(u({},g),{},{states:t}))},[g]);return(0,Et.jsxs)("div",{className:"markov-chain-editor ".concat(p?"dark-mode":""),children:[(0,Et.jsx)(Ut,{onSave:J,onOpenWithFileSystem:Q,onExportCode:Z,onShowSaveModal:ee,onExportXML:te,onExportCSV:ne,onExportMatlab:ae,onShowLLMConfig:oe,onShowMSolver:de,isDarkMode:p,onToggleDarkMode:se,onNewModel:le,onClearAllModels:s,openedFile:B,currentEditor:"markov-chain",onNavigateToFaultTree:ce,onNavigateToMarkov:ue,onLogout:me}),(0,Et.jsx)(Bu,{onAddState:H,clickToPlaceMode:_,onToggleClickToPlace:G,componentToPlace:A,setComponentToPlace:I,isDarkMode:p,isCollapsed:P,onToggleCollapse:ge}),(0,Et.jsx)("div",{className:"editor-content ".concat(P?"left-panel-collapsed":""," ").concat(h?"right-panel-collapsed":""),children:(0,Et.jsx)(Ku,{markovChainModel:g,onElementClick:W,onModelChange:he,onDeleteElement:X,onCreateConnection:$,onPanelClick:V,onViewResults:pe,componentToPlace:A,isDarkMode:p,disableDeletion:x||S,onReorganizeComponents:be})}),(0,Et.jsx)(vu,{onGenerateFaultTree:()=>{},onModifyFaultTree:()=>{},currentFaultTree:{events:[],gates:[],connections:[]},isDarkMode:p,isCollapsed:h,onToggleCollapse:ve,editorType:"markov-chain",onGenerateMarkovChain:re}),x&&b&&"state"===b.type&&(0,Et.jsx)(qu,{state:b,onSave:Y,onClose:()=>{C(!1),y(null)},isDarkMode:p,onRemoveTransitions:K,onSetAsInitial:q}),S&&b&&"transition"===b.type&&(0,Et.jsx)($u,{transition:b,onSave:Y,onClose:()=>{w(!1),y(null)},isDarkMode:p}),(0,Et.jsx)(hu,{isOpen:n,onClose:()=>o(!1),onConfigChange:ie}),(0,Et.jsx)(Zu,{isOpen:k,onClose:()=>N(!1),markovChainModel:g}),(0,Et.jsx)(ed,{isOpen:j,onClose:()=>{E(!1),T(null)},stateId:M,stateName:M&&(null===(e=g.states.find(e=>e.id===M))||void 0===e?void 0:e.name)||null,matlabStateIndex:M?[...g.states].sort((e,t)=>(parseInt(e.id.replace("state-",""))||0)-(parseInt(t.id.replace("state-",""))||0)).findIndex(e=>e.id===M)+1:void 0})]})},nd=()=>(0,Et.jsx)("div",{className:"app",children:(0,Et.jsx)(It,{children:(0,Et.jsx)(Ft,{children:(0,Et.jsx)(Pt,{children:(0,Et.jsx)(_t,{children:(0,Et.jsx)(ht,{children:(0,Et.jsxs)(Ae,{children:[(0,Et.jsx)(_e,{path:"/",element:(0,Et.jsx)(Bt,{})}),(0,Et.jsx)(_e,{path:"/fault-tree-editor",element:(0,Et.jsx)(Lu,{})}),(0,Et.jsx)(_e,{path:"/markov-chain-editor",element:(0,Et.jsx)(td,{})})]})})})})})})});o.createRoot(document.getElementById("root")).render((0,Et.jsx)(a.StrictMode,{children:(0,Et.jsx)(nd,{})}))})();
//# sourceMappingURL=main.33d69d97.js.map